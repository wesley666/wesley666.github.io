<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Wesley&#39;s Blog</title>
  <icon>https://iwesley.top/icon.png</icon>
  <subtitle>æˆ‘æœªæ›¾çæƒœçš„ï¼Œæˆ‘ä¸å†æ‹¥æœ‰ã€‚</subtitle>
  <link href="https://iwesley.top/atom.xml" rel="self"/>
  
  <link href="https://iwesley.top/"/>
  <updated>2025-05-02T09:49:15.528Z</updated>
  <id>https://iwesley.top/</id>
  
  <author>
    <name>Wesley</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>btrace2.0ä½¿ç”¨æ–¹æ³•</title>
    <link href="https://iwesley.top/article/788e44fe/"/>
    <id>https://iwesley.top/article/788e44fe/</id>
    <published>2025-05-02T09:32:42.000Z</published>
    <updated>2025-05-02T09:49:15.528Z</updated>
    
    <content type="html"><![CDATA[<p>2022 å¹´æˆ‘ç ”ç©¶å®‰å“æ€§èƒ½ä¼˜åŒ–çš„æ—¶å€™ï¼Œå†™è¿‡ä¸€ç¯‡ï¼š<a href="https://iwesley.top/article/69f32e87/">btrace1.0ä½¿ç”¨æ–¹æ³• - Wesleyâ€™s Blog</a>ï¼Œç°åœ¨ brace è¿›åŒ–åˆ° 2.0 äº†ï¼Œè®©æˆ‘ä»¬ä¸€èµ·æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ã€‚</p><p>å…·ä½“çš„æ¥å…¥æµç¨‹å¯ä»¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼š</p><p><a href="https://github.com/bytedance/btrace">bytedance&#x2F;btrace: ğŸ”¥ğŸ”¥ btrace(AKA RheaTrace) is a high performance Android trace tool which is based on Perfetto, it support to define custom events automatically during building apk and using bhook to provider more native events like Render&#x2F;Binder&#x2F;IO etc.</a></p><p>æˆ‘è¿™é‡Œä¸»è¦è®°å½•ä¸€ä¸‹æ¥å…¥çš„ä¸€äº›æŠ¥é”™é—®é¢˜ï¼š</p><p>ç›®å‰æœ€æ–°ç‰ˆæœ¬æ˜¯2.0.3-rc03</p><p>é¡¹ç›®çš„gradleç‰ˆæœ¬æ˜¯7.0.2ï¼Œgradle pluginæ˜¯7.0.0</p><h2 id="ç¼–è¯‘æŠ¥é”™"><a href="#ç¼–è¯‘æŠ¥é”™" class="headerlink" title="ç¼–è¯‘æŠ¥é”™"></a>ç¼–è¯‘æŠ¥é”™</h2><blockquote><p>org.gradle.workers.WorkerExecutionException: There was a failure while executing work items</p><p>â€‹at org.gradle.workers.internal.DefaultWorkerExecutor.workerExecutionException(DefaultWorkerExecutor.java:270)</p><p>â€‹at org.gradle.workers.internal.DefaultWorkerExecutor.await(DefaultWorkerExecutor.java:252)</p><p>â€‹at com.android.build.gradle.internal.tasks.DexArchiveBuilderTaskDelegate.doProcess(DexArchiveBuilderTaskDelegate.kt:227)</p><p>â€‹at com.android.build.gradle.internal.tasks.DexArchiveBuilderTask.doTaskAction(DexArchiveBuilderTask.kt:256)</p><p>â€‹at com.android.build.gradle.internal.tasks.NewIncrementalTask$taskAction$$inlined$recordTaskAction$1.invoke(BaseTask.kt:66)</p><p>â€‹at com.android.build.gradle.internal.tasks.Blocks.recordSpan(Blocks.java:51)</p><p>Caused by: com.android.tools.r8.CompilationFailedException: <strong>Compilation failed to complete</strong>, position: Lcom&#x2F;xxx&#x2F;web&#x2F;CommonHeader;<init>()V, origin: D:\Project\p_dev\app\build\intermediates\transforms\analyticsTrack\Production\release\720.jar:com&#x2F;xxx&#x2F;web&#x2F;CommonHeader.class</p></blockquote><p>éœ€è¦å…³æ³¨<strong>Compilation failed to complete</strong>åé¢çš„ç±»</p><p>å¦‚æœå“ªä¸ªç±»æŠ¥é”™å°±å¯ä»¥åŠ å…¥ä¸‹é¢çš„é…ç½®ï¼Œè·¯å¾„â€${project.rootDir}&#x2F;trace-filter&#x2F;traceFilter.txtâ€</p><p><a href="https://github.com/bytedance/btrace/blob/master/GRADLE_CONFIG.MD">btrace&#x2F;GRADLE_CONFIG.MD at master Â· bytedance&#x2F;btrace</a></p><p>æ³¨æ„ï¼šallowpackageå¿…é¡»å…ˆé…ç½®ï¼Œblockpackageå¿…é¡»åœ¨å…¶å­åŒ…ä¸‹é¢ï¼Œå¯ä»¥æ˜¯ç±»æˆ–è€…åŒ…å</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs yaml">[<span class="hljs-string">package</span>]<br><span class="hljs-string">-allowpackage</span> <span class="hljs-string">com</span><br><span class="hljs-string">-allowpackage</span> <span class="hljs-string">org</span><br><span class="hljs-string">-allowpackage</span> <span class="hljs-string">androidx</span><br><br><span class="hljs-string">-blockpackage</span> <span class="hljs-string">androidx/exifinterface/media</span><br><span class="hljs-string">-blockpackage</span> <span class="hljs-string">com/google/android/exoplayer2/ui</span><br><span class="hljs-string">-blockpackage</span> <span class="hljs-string">com/xxx/web/CommonHeader</span><br><span class="hljs-string">-blockpackage</span> <span class="hljs-string">org/bouncycastle/jcajce/provider/asymmetric/x509</span><br><span class="hljs-string">-blockpackage</span> <span class="hljs-string">org/bouncycastle/jcajce/provider/asymmetric/dh</span><br><span class="hljs-string">-blockpackage</span> <span class="hljs-string">com/nineoldandroids/util</span><br><span class="hljs-string">-blockpackage</span> <span class="hljs-string">org/bouncycastle/jce/provider/JCEDHPublicKey</span><br><span class="hljs-comment"># org/bouncycastle/jce/provider/X509CertificateObject</span><br><span class="hljs-string">-blockpackage</span> <span class="hljs-string">org/bouncycastle/jce/provider</span><br></code></pre></td></tr></table></figure><h3 id="ç‰¹åˆ«æ³¨æ„"><a href="#ç‰¹åˆ«æ³¨æ„" class="headerlink" title="ç‰¹åˆ«æ³¨æ„"></a>ç‰¹åˆ«æ³¨æ„</h3><p>å¦‚æœæ˜¯windowsç”¨æˆ·ï¼ŒtraceFilter.txtæ¢è¡Œç¬¦å¿…é¡»æ”¹ä¸ºLF</p><h4 id="åŸå› "><a href="#åŸå› " class="headerlink" title="åŸå› "></a>åŸå› </h4><p>com&#x2F;bytedance&#x2F;rheatrace&#x2F;plugin&#x2F;compiling&#x2F;filter&#x2F;RheaTraceMethodFilter.kt</p><p>parseTraceFilterFile</p><p>methodKeepStr.trim { it &lt;&#x3D; â€˜ â€˜ }.replace(â€œ&#x2F;â€œ, â€œ.â€).split(â€œ\nâ€).toTypedArray()</p><p>è¿™é‡Œåªæ›¿æ¢äº†\nï¼Œæ²¡æœ‰æ›¿æ¢\rï¼Œä¼šå¯¼è‡´è§£æå‡ºæ¥çš„åŒ…åå¸¦æœ‰\rï¼Œå¯¼è‡´checkPathå¤±è´¥ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">checkPath</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">if</span> (allowPackages.isEmpty()) &#123;<br>        <span class="hljs-keyword">return</span><br>    &#125;<br>    <span class="hljs-keyword">for</span> (blockPath <span class="hljs-keyword">in</span> blockPackages) &#123;<br>        <span class="hljs-keyword">var</span> isContain = <span class="hljs-literal">false</span><br>        <span class="hljs-keyword">for</span> (allowPackage <span class="hljs-keyword">in</span> allowPackages) &#123;<br>            <span class="hljs-keyword">if</span> (blockPath == allowPackage) &#123;<br>                RheaLog.e(TAG, <span class="hljs-string">&quot;blockpackage cannot be equal to allowpackage:%s&quot;</span>, blockPath)<br>            &#125;<br>            <span class="hljs-keyword">if</span> (blockPath.startsWith(allowPackage)) &#123;<br>                isContain = <span class="hljs-literal">true</span><br>                <span class="hljs-keyword">break</span><br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (!isContain) &#123;<br>            <span class="hljs-keyword">throw</span> GradleException(<span class="hljs-string">&quot;allowpackage do not contains <span class="hljs-variable">$blockPath</span>&quot;</span>)<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://juejin.cn/post/7350256387161047077">BTraceå’ŒPerfettoå¦‚ä½•åˆ†ææ€§èƒ½æ‰‹æŠŠæ‰‹æ•™ä½ ä½¿ç”¨BTraceå’ŒPerfettoåˆ†ææ€§èƒ½ é«˜çº§androidå¼€å‘å·¥ - æ˜é‡‘</a></p><p><a href="https://mvnrepository.com/artifact/com.bytedance.btrace/rhea-gradle-plugin">Maven Repository: com.bytedance.btrace Â» rhea-gradle-plugin</a></p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;p&gt;2022 å¹´æˆ‘ç ”ç©¶å®‰å“æ€§èƒ½ä¼˜åŒ–çš„æ—¶å€™ï¼Œå†™è¿‡ä¸€ç¯‡ï¼š&lt;a href=&quot;https://iwesley.top/article/69f32e87/&quot;&gt;btrace1.0ä½¿ç”¨æ–¹æ³• - Wesleyâ€™s Blog&lt;/a&gt;ï¼Œç°åœ¨ brace è¿›åŒ–åˆ° 2.0</summary>
        
      
    
    
    
    <category term="Androidæ€§èƒ½ä¼˜åŒ–" scheme="https://iwesley.top/categories/Android%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    
    
    <category term="æ€§èƒ½ä¼˜åŒ–" scheme="https://iwesley.top/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    
    <category term="btrace" scheme="https://iwesley.top/tags/btrace/"/>
    
    <category term="systrace" scheme="https://iwesley.top/tags/systrace/"/>
    
    <category term="perfetto" scheme="https://iwesley.top/tags/perfetto/"/>
    
  </entry>
  
  <entry>
    <title>btrace1.0ä½¿ç”¨æ–¹æ³•</title>
    <link href="https://iwesley.top/article/69f32e87/"/>
    <id>https://iwesley.top/article/69f32e87/</id>
    <published>2025-05-02T08:35:23.000Z</published>
    <updated>2025-05-02T09:30:00.285Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>è®°äº 2022 å¹´ 6 æœˆ 24 æ—¥</p></blockquote><p><strong>æ³¨æ„ï¼šç›®å‰ä»…é™äºmacoså’Œlinuxä½¿ç”¨</strong></p><p><a href="https://github.com/bytedance/btrace/blob/master/README.zh-CN.md">btrace&#x2F;README.zh-CN.md at master Â· bytedance&#x2F;btrace Â· GitHub</a></p><p>btrace(åˆå RheaTrace) æ˜¯ä¸€ä¸ªåŸºäº <a href="https://developer.android.com/topic/performance/tracing">Systrace</a> å®ç°çš„é«˜æ€§èƒ½ Android trace å·¥å…·ï¼Œå®ƒæ”¯æŒåœ¨ App ç¼–è¯‘æœŸé—´è‡ªåŠ¨æ³¨å…¥è‡ªå®šä¹‰äº‹ä»¶ï¼Œå¹¶ä½¿ç”¨ <a href="https://github.com/bytedance/bhook">bhook</a> é¢å¤–æä¾› IO ç­‰ native äº‹ä»¶ã€‚</p><h2 id="å…³é”®ç‰¹å¾"><a href="#å…³é”®ç‰¹å¾" class="headerlink" title="å…³é”®ç‰¹å¾"></a>å…³é”®ç‰¹å¾</h2><p>æ”¯æŒè‡ªåŠ¨æ³¨å…¥è‡ªå®šä¹‰äº‹ä»¶ï¼Œåœ¨ç¼–è¯‘ Apk æœŸé—´ä¸º App æ–¹æ³•è‡ªåŠ¨æ³¨å…¥Trace#beginSection(String) å’Œ Trace#endSection()ã€‚</p><p>æä¾›é¢å¤– IO ç­‰ native äº‹ä»¶ï¼Œæ–¹ä¾¿å®šä½è€—æ—¶åŸå› ã€‚</p><p>æ”¯æŒä»…é‡‡é›†ä¸»çº¿ç¨‹ trace äº‹ä»¶ã€‚</p><p>ä½¿ç”¨ä¾¿æ·ï¼Œç¨³å®šæ€§é«˜ï¼Œæ€§èƒ½ä¼˜äº Systraceã€‚</p><h2 id="å¼€å§‹"><a href="#å¼€å§‹" class="headerlink" title="å¼€å§‹"></a>å¼€å§‹</h2><p><strong>æ³¨æ„ï¼šå­˜å‚¨æƒé™è¦ç”³è¯·</strong></p><p>è‡ªå®šä¹‰çš„applicationå¿…é¡»æœ‰ä»¥ä¸‹ä»£ç ï¼Œå¦åˆ™ä¼šå¯¼è‡´btraceæ’å…¥åˆå§‹åŒ–ä»£ç å¤±è´¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@OverRide</span><br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">attachBaseContext</span><span class="hljs-params">(Context base)</span> &#123;<br>     <span class="hljs-built_in">super</span>.attachBaseContext(base);<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨æ‚¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ build.gradle æ–‡ä»¶ä¸­å¢åŠ  rhea-gradle-plugin ä½œä¸ºä¾èµ–ã€‚</p><p>æ³¨æ„ï¼šbtraceç‰ˆæœ¬å·å¯ä»¥åœ¨è¿™é‡ŒæŸ¥è¯¢ï¼š<a href="https://search.maven.org/">https://search.maven.org/</a> å¦‚æœæ‰“ä¸å¼€å¯ä»¥åœ¨é˜¿é‡Œäº‘æŸ¥è¯¢ï¼š<a href="https://developer.aliyun.com/mvn/search">https://developer.aliyun.com/mvn/search</a></p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2025/20250502163842049.png" alt="image-20250502163841997"></p><p>ç›®å‰ç‰ˆæœ¬å·æ˜¯1.0.2</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs Groovy">buildscript &#123;<br>    repositories &#123;<br>        ...<br>        mavenCentral()<br>        ...<br>    &#125;<br>    dependencies &#123;<br>        classpath <span class="hljs-string">&#x27;com.bytedance.btrace:rhea-gradle-plugin:1.0.2&#x27;</span><br>    &#125;<br>&#125;<br><br>allprojects &#123;<br>    repositories &#123;<br>        ...<br>        mavenCentral()<br>        ...<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ¥ç€åœ¨ app&#x2F;build.gradle æ–‡ä»¶ä¸­åº”ç”¨å¦‚ä¸‹æ‰€ç¤ºæ’ä»¶å’Œä¾èµ–ã€‚</p><h3 id="androidxé¡¹ç›®"><a href="#androidxé¡¹ç›®" class="headerlink" title="androidxé¡¹ç›®"></a>androidxé¡¹ç›®</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs Groovy">dependencies &#123;<br>    <span class="hljs-comment">//rheatrace core lib</span><br>    implementation <span class="hljs-string">&quot;com.bytedance.btrace:rhea-core:1.0.2&quot;</span><br>&#125;<br><br>apply <span class="hljs-attr">plugin:</span> <span class="hljs-string">&#x27;com.bytedance.rhea-trace&#x27;</span><br>rheaTrace &#123;<br><br>   compilation &#123;<br>      <span class="hljs-comment">//ä¸ºå‡å°‘ APK ä½“ç§¯, ä½ å¯ä»¥ä¸º App ä¸­éœ€è¦è·Ÿè¸ªçš„æ–¹æ³•è®¾ç½® id ä»¥æ­¤æ¥è·Ÿè¸ªæ­¤è‡ªå®šä¹‰äº‹ä»¶, é»˜è®¤å€¼ falseã€‚</span><br>      traceWithMethodID = <span class="hljs-literal">false</span> <br>      <span class="hljs-comment">//è¯¥æ–‡ä»¶é…ç½®å†³å®šå“ªäº›æ–¹æ³•æ‚¨ä¸å¸Œæœ›è·Ÿè¸ª, é»˜è®¤å€¼ nullã€‚</span><br>      traceFilterFilePath = <span class="hljs-string">&quot;$&#123;project.rootDir&#125;/rhea-trace/traceFilter.txt&quot;</span><br>      <span class="hljs-comment">//ç”¨ç‰¹æŒ‡å®šæ–¹æ³• id æ¥è®¾ç½®è‡ªå®šä¹‰äº‹ä»¶åç§°, é»˜è®¤å€¼ nullã€‚</span><br>      applyMethodMappingFilePath = <span class="hljs-string">&quot;$&#123;project.rootDir&#125;/rhea-trace/keep-method-id.txt&quot;</span><br>  &#125;<br><br>   runtime &#123;<br>      <span class="hljs-comment">//ä»…åœ¨ä¸»çº¿ç¨‹æŠ“å–è·Ÿè¸ªäº‹ä»¶, é»˜è®¤å€¼ falseã€‚</span><br>      mainThreadOnly <span class="hljs-literal">true</span> <br>      <span class="hljs-comment">//åœ¨ App å¯åŠ¨ä¹‹åˆå¼€å§‹æŠ“å–è·Ÿè¸ªäº‹ä»¶, é»˜è®¤å€¼ trueã€‚</span><br>      startWhenAppLaunch <span class="hljs-literal">true</span><br>      <span class="hljs-comment">//æŒ‡å®šå†…å­˜å­˜å‚¨ atrace æ•°æ® ring buffer çš„å¤§å°ã€‚</span><br>      atraceBufferSize <span class="hljs-string">&quot;500000&quot;</span><br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="android-supporté¡¹ç›®"><a href="#android-supporté¡¹ç›®" class="headerlink" title="android-supporté¡¹ç›®"></a>android-supporté¡¹ç›®</h3><p><strong>æœ¬åœ°éœ€è¦ä¾èµ–çš„æ–‡ä»¶ï¼š</strong> <a href="https://github.com/wesley666/source/blob/main/btrace-Android-support.zip">https://github.com/wesley666/source/blob/main/btrace-Android-support.zip</a></p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs Groovy">dependencies &#123;<br>    <span class="hljs-comment">//rheatrace core lib</span><br>    implementation <span class="hljs-string">&quot;org.jetbrains.kotlin:kotlin-stdlib:1.3.72&quot;</span><br>    implementation files(<span class="hljs-string">&#x27;libs/rhea-common-1.0.2.jar&#x27;</span>)<br>    implementation files(<span class="hljs-string">&#x27;libs/rhea-core-release.aar&#x27;</span>)<br>    implementation files(<span class="hljs-string">&#x27;libs/rhea-atrace-release.aar&#x27;</span>)<br>    implementation <span class="hljs-string">&quot;com.bytedance:bytehook:1.0.3&quot;</span><br>&#125;<br><br>apply <span class="hljs-attr">plugin:</span> <span class="hljs-string">&#x27;com.bytedance.rhea-trace&#x27;</span><br>rheaTrace &#123;<br><br>   compilation &#123;<br>      <span class="hljs-comment">//ä¸ºå‡å°‘ APK ä½“ç§¯, ä½ å¯ä»¥ä¸º App ä¸­éœ€è¦è·Ÿè¸ªçš„æ–¹æ³•è®¾ç½® id ä»¥æ­¤æ¥è·Ÿè¸ªæ­¤è‡ªå®šä¹‰äº‹ä»¶, é»˜è®¤å€¼ falseã€‚</span><br>      traceWithMethodID = <span class="hljs-literal">false</span> <br>      <span class="hljs-comment">//è¯¥æ–‡ä»¶é…ç½®å†³å®šå“ªäº›æ–¹æ³•æ‚¨ä¸å¸Œæœ›è·Ÿè¸ª, é»˜è®¤å€¼ nullã€‚</span><br>      traceFilterFilePath = <span class="hljs-string">&quot;$&#123;project.rootDir&#125;/rhea-trace/traceFilter.txt&quot;</span><br>      <span class="hljs-comment">//ç”¨ç‰¹æŒ‡å®šæ–¹æ³• id æ¥è®¾ç½®è‡ªå®šä¹‰äº‹ä»¶åç§°, é»˜è®¤å€¼ nullã€‚</span><br>      applyMethodMappingFilePath = <span class="hljs-string">&quot;$&#123;project.rootDir&#125;/rhea-trace/keep-method-id.txt&quot;</span><br>  &#125;<br><br>   runtime &#123;<br>      <span class="hljs-comment">//ä»…åœ¨ä¸»çº¿ç¨‹æŠ“å–è·Ÿè¸ªäº‹ä»¶, é»˜è®¤å€¼ falseã€‚</span><br>      mainThreadOnly <span class="hljs-literal">true</span> <br>      <span class="hljs-comment">//åœ¨ App å¯åŠ¨ä¹‹åˆå¼€å§‹æŠ“å–è·Ÿè¸ªäº‹ä»¶, é»˜è®¤å€¼ trueã€‚</span><br>      startWhenAppLaunch <span class="hljs-literal">true</span><br>      <span class="hljs-comment">//æŒ‡å®šå†…å­˜å­˜å‚¨ atrace æ•°æ® ring buffer çš„å¤§å°ã€‚</span><br>      atraceBufferSize <span class="hljs-string">&quot;500000&quot;</span><br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å…³äº <code>rheaTrace </code>ï¼Œä»<a href="https://github.com/bytedance/btrace/blob/master/GRADLE_CONFIG.zh-CN.MD">RheaTrace Gradle Config</a>ä¸­äº†è§£æ›´å¤šä¿¡æ¯ã€‚</p><p>æœ€åï¼Œæ£€æµ‹æ‚¨ç”µè„‘ python ç‰ˆæœ¬ï¼Œç”±äº Systrace çš„å…³ç³» RheaTrace ä»…æ”¯æŒ python 2.7 ç‰ˆæœ¬ï¼Œè¯·å°† systrace ç¯å¢ƒå˜é‡é…ç½®åœ¨ <em>~&#x2F;.bash_profile</em> æ–‡ä»¶ä¸­ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Shell">export PATH=$&#123;PATH&#125;:/Users/$&#123;user_name&#125;/Library/Android/sdk/platform-tools/systrace<br></code></pre></td></tr></table></figure><p>RheaTraceä½¿ç”¨æ–¹æ³•è¯·å‚è€ƒï¼š</p><p><a href="https://github.com/bytedance/btrace/blob/master/README.zh-CN.md">btrace&#x2F;README.zh-CN.md at master Â· bytedance&#x2F;btrace Â· GitHub</a></p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;è®°äº 2022 å¹´ 6 æœˆ 24 æ—¥&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ³¨æ„ï¼šç›®å‰ä»…é™äºmacoså’Œlinuxä½¿ç”¨&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a</summary>
        
      
    
    
    
    <category term="Androidæ€§èƒ½ä¼˜åŒ–" scheme="https://iwesley.top/categories/Android%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    
    
    <category term="æ€§èƒ½ä¼˜åŒ–" scheme="https://iwesley.top/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    
    <category term="btrace" scheme="https://iwesley.top/tags/btrace/"/>
    
    <category term="systrace" scheme="https://iwesley.top/tags/systrace/"/>
    
  </entry>
  
  <entry>
    <title>éŸ³è§†é¢‘ç¼“å­˜æ•°å­¦æ¨¡å‹</title>
    <link href="https://iwesley.top/article/36f6f986/"/>
    <id>https://iwesley.top/article/36f6f986/</id>
    <published>2025-03-16T09:55:28.000Z</published>
    <updated>2025-03-16T10:04:42.652Z</updated>
    
    <content type="html"><![CDATA[<p class="note note-success">2024å¹´8æœˆçš„ç¬”è®°</p><p>æ’­æ”¾å™¨ä½œä¸ºæ¶ˆè´¹è€…ï¼Œç¼“å­˜ä½œä¸ºç”Ÿäº§è€…ã€‚</p><h2 id="è¿›å…¥ç¼“å†²ä¸€æ¬¡"><a href="#è¿›å…¥ç¼“å†²ä¸€æ¬¡" class="headerlink" title="è¿›å…¥ç¼“å†²ä¸€æ¬¡"></a>è¿›å…¥ç¼“å†²ä¸€æ¬¡</h2><p>è®¾æ¶ˆè´¹è€…é€Ÿç‡ä¸ºv1ï¼Œç”Ÿäº§è€…ä¸ºv2ï¼Œè§†é¢‘é•¿åº¦ä¸ºlï¼Œxä¸ºç”Ÿäº§è€…è‡³å°‘è·ç¦»æ¶ˆè´¹è€…å¤šè¿œæ‰èƒ½ä¿è¯åœ¨æ’­å®Œè§†é¢‘å‰ä¸¤è€…é‡åˆã€‚å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªè¿½åŠé—®é¢˜ã€‚</p><p>v1<em>t &#x3D; v2</em>t + xï¼Œå³ l &#x3D; v2*l&#x2F;v1 + xï¼Œå› ä¸ºæ’­æ”¾å™¨é€Ÿåº¦æ˜¯1ï¼Œç»§ç»­ç®€åŒ–å¾— x &#x3D; l(1 - v2)</p><p>å¦‚æœv2å¤§äº1ï¼Œå³æ»¡è¶³æ¶ˆè´¹è€…éœ€æ±‚æ—¶ï¼Œå¯ä»¥æµç•…æ’­æ”¾ã€‚</p><p>è®¾læ˜¯ä¸€éƒ¨45åˆ†é’Ÿçš„ç”µè§†å‰§ï¼Œå³x &#x3D; 45<em>60</em>(1 - v2)</p><p>å¦‚æœv2æ˜¯1ï¼Œå³1så¯ä»¥ç¼“å­˜1sæ—¶é•¿è§†é¢‘ï¼Œåˆ™x &#x3D; 0</p><p>v2æ˜¯0.9ï¼Œå³1så¯ä»¥ç¼“å­˜0.9sæ—¶é•¿è§†é¢‘ï¼Œåˆ™ x &#x3D; 270ï¼Œæ„å‘³ç€è¦æå‰ç¼“å­˜270sçš„è§†é¢‘æ‰å¯ä»¥åç»­ä¸è¿›å…¥ç¼“å†²çŠ¶æ€ã€‚</p><p>åŒç†ï¼Œv2&#x3D;0.8ï¼Œx&#x3D; 540</p><p>â€¦â€¦â€¦â€¦.</p><p>v2 &#x3D; 0.1ï¼Œx&#x3D;2430</p><p>æ–œç‡æ˜¯-2700ï¼Œæ„å‘³ç€æ¯å˜åŒ–ç™¾åˆ†ä¹‹0.1ï¼Œç¼“å­˜é•¿åº¦éƒ½è¦å¢åŠ 270sã€‚</p><p>æ‹¿v2&#x3D;0.9ï¼Œx&#x3D; 270ä½œä¸ºä¾‹å­ï¼Œè¦æå‰ç¼“å­˜270sï¼Œéœ€è¦èŠ±è´¹çš„æ—¶é—´æ˜¯t&#x3D;270&#x2F;0.9&#x3D;300s</p><p>åŒç†ï¼Œv2&#x3D;0.8ï¼Œx&#x3D; 540ï¼Œt&#x3D;540&#x2F;0.8&#x3D;675s</p><p>â€¦â€¦..</p><p>v2 &#x3D; 0.1ï¼Œx&#x3D;2430,t&#x3D;2430&#x2F;0.1&#x3D;24300s&#x3D;405åˆ†é’Ÿ</p><h2 id="è¿›å…¥ç¼“å†²å¤šæ¬¡"><a href="#è¿›å…¥ç¼“å†²å¤šæ¬¡" class="headerlink" title="è¿›å…¥ç¼“å†²å¤šæ¬¡"></a>è¿›å…¥ç¼“å†²å¤šæ¬¡</h2><p>å®é™…ä¸Šï¼Œç”¨æˆ·æ˜¯ä¸èƒ½å®¹å¿ç­‰è¿™ä¹ˆä¹…çš„ï¼Œæ‰€ä»¥æ„å‘³ç€æ’­æ”¾å¼€å§‹åä¼šåå¤è¿›å…¥ç¼“å†²çŠ¶æ€ã€‚</p><p>å‡è®¾ç¼“å­˜1sæ’­1sï¼Œ</p><p>v2&#x3D;1ï¼Œæ˜¯å¯ä»¥æ­£å¸¸æ’­æ”¾</p><p>v2&#x3D;0.9ï¼Œåˆ™ç”¨æˆ·è¦ç­‰å¾…æ—¶é•¿ä¸º 1&#x2F;0.9&#x3D;1.1111sï¼Œå…ˆç¼“å­˜1sï¼Œåˆ™å¹³å‡1&#x2F;ï¼ˆ1-0.9ï¼‰&#x3D;10sè¿›å…¥ç¼“å†²çŠ¶æ€ï¼Œæ¯æ¬¡1.1111s</p><p>v2&#x3D;0.8ï¼Œåˆ™ç”¨æˆ·è¦ç­‰å¾…æ—¶é•¿ä¸º 1&#x2F;0.8&#x3D;1.25sï¼Œå…ˆç¼“å­˜1sï¼Œåˆ™å¹³å‡1&#x2F;ï¼ˆ1-0.8ï¼‰&#x3D;5sè¿›å…¥ç¼“å†²çŠ¶æ€ï¼Œæ¯æ¬¡1.25s</p><p>â€¦â€¦.</p><p>v2&#x3D;0.1ï¼Œåˆ™ç”¨æˆ·è¦ç­‰å¾…æ—¶é•¿ä¸º 1&#x2F;0.1&#x3D;10sï¼Œå…ˆç¼“å­˜1sï¼Œåˆ™å¹³å‡1&#x2F;ï¼ˆ1-0.1ï¼‰&#x3D;1.1111sè¿›å…¥ç¼“å†²çŠ¶æ€ï¼Œæ¯æ¬¡10s</p><p>åŒç†æ¯æ¬¡ç¼“å­˜å¤š1så†æ’­æ”¾ï¼Œéƒ½ä¼šå¢åŠ ä¸€å€è¿›å…¥ç¼“å†²çš„æ—¶é—´å’Œç­‰å¾…æ—¶é—´ã€‚</p><p>æ„å‘³ç€ï¼Œå¦‚æœé€šè¿‡å¤šçº¿ç¨‹ä¸èƒ½æ˜¾è‘—æé«˜v2é€Ÿåº¦è¶…è¿‡1ï¼Œå¯¹ç”¨æˆ·æ¥è¯´éƒ½æ˜¯å¡é¡¿ï¼Œæ— æ³•å¿å—çš„ã€‚</p><p>å½“ç„¶ï¼Œä¸Šé¢åªæ˜¯ä¸€ä¸ªç†è®ºæ¨¡å‹ï¼Œå®é™…ä¸Šè¦å¤æ‚ä¸€äº›ï¼Œå› ä¸ºæ¯ä¸ªtsåŒ…å«çš„æ’­æ”¾æ—¶é—´æ˜¯ä¸ä¸€æ ·çš„ã€‚</p><h2 id="æƒ…å†µåˆ†æ"><a href="#æƒ…å†µåˆ†æ" class="headerlink" title="æƒ…å†µåˆ†æ"></a>æƒ…å†µåˆ†æ</h2><p>è‹¥å¸¦å®½å°äºCDNé€Ÿåº¦ï¼Œå³v2æ€»æ˜¯å°äºv1ï¼Œè¿™æ ·æ— è®ºæ€ä¹ˆä¼˜åŒ–éƒ½ä¼šå¡é¡¿ã€‚</p><p>è‹¥å¸¦å®½å¤§äºCDNé€Ÿåº¦ï¼Œè‹¥v2å¤§äºv1åˆ™å¯ä»¥æ­£å¸¸æ’­æ”¾ï¼›è‹¥å•çº¿ç¨‹ä¸èƒ½æ»¡è¶³v2å¤§äºv1ï¼Œå¤šçº¿ç¨‹æ—¶v2å¤§äºv1ï¼Œä¹Ÿå¯ä»¥æ­£å¸¸æ’­æ”¾ã€‚</p><h2 id="ç¼“å­˜ç­–ç•¥"><a href="#ç¼“å­˜ç­–ç•¥" class="headerlink" title="ç¼“å­˜ç­–ç•¥"></a>ç¼“å­˜ç­–ç•¥</h2><p>å¯¹äºä¸‹è½½æ—¶é—´å°äºtsæ–‡ä»¶æ—¶é•¿çš„ï¼Œåˆ™ä¸²è¡Œä¸‹è½½ï¼Œä¸éœ€è¦å¹¶å‘ã€‚</p><p>ä»¥ä¸‹æ˜¯é’ˆå¯¹CDNé€Ÿåº¦å°äºç½‘ç»œå¸¦å®½çš„ï¼š</p><h3 id="1-åˆå§‹ä¸‹è½½è®¾ç½®"><a href="#1-åˆå§‹ä¸‹è½½è®¾ç½®" class="headerlink" title="1. åˆå§‹ä¸‹è½½è®¾ç½®"></a>1. <strong>åˆå§‹ä¸‹è½½è®¾ç½®</strong></h3><ul><li><strong>åˆå§‹å¹¶å‘æ•°</strong>ï¼šä»1ä¸ªæ–‡ä»¶å¼€å§‹ä¸‹è½½ã€‚</li><li><strong>ç›‘æ§ä¸‹è½½é€Ÿåº¦</strong>ï¼šç›‘æ§ä¸‹è½½é€Ÿåº¦å’Œè®°å½•æœ€å¤§ä¸‹è½½é€Ÿåº¦ã€‚</li></ul><h3 id="2-é€æ­¥å¢åŠ å¹¶å‘"><a href="#2-é€æ­¥å¢åŠ å¹¶å‘" class="headerlink" title="2. é€æ­¥å¢åŠ å¹¶å‘"></a>2. é€æ­¥å¢åŠ å¹¶å‘</h3><ul><li><strong>é€æ­¥å¢åŠ </strong>ï¼šä¸‹è½½æˆåŠŸåï¼Œå¢åŠ ä¸€ä¸ªå¹¶å‘ä¸‹è½½ä»»åŠ¡ã€‚</li><li><strong>ç›‘æ§å˜åŒ–</strong>ï¼šæ¯æ¬¡å¢åŠ å¹¶å‘åï¼Œè§‚å¯Ÿå•ä¸ªæ–‡ä»¶çš„ä¸‹è½½é€Ÿåº¦å˜åŒ–ã€‚</li></ul><h3 id="3-æ£€æµ‹ç“¶é¢ˆ"><a href="#3-æ£€æµ‹ç“¶é¢ˆ" class="headerlink" title="3. æ£€æµ‹ç“¶é¢ˆ"></a>3. <strong>æ£€æµ‹ç“¶é¢ˆ</strong></h3><ul><li><strong>è§‚å¯Ÿé™é€Ÿ</strong>ï¼šå½“ä¸‹è½½é€Ÿåº¦è¾¾åˆ°æŸä¸ªç¨³å®šå€¼ï¼ˆå’Œæœ€å¤§ä¸‹è½½é€Ÿåº¦ç›¸æ¯”ä¸è¶…è¿‡ç™¾åˆ†ä¹‹åï¼‰ï¼Œæˆ–è€…å•ä¸ªæ–‡ä»¶ä¸‹è½½é€Ÿåº¦æ˜¾è‘—ä¸‹é™æ—¶ï¼Œè¯´æ˜å¯èƒ½è§¦æ‘¸åˆ°äº†å¸¦å®½ä¸Šé™æˆ–æœåŠ¡å™¨é™é€Ÿã€‚</li><li><strong>å›é€€ä¼˜åŒ–</strong>ï¼šå¦‚æœå‘ç°å¹¶å‘æ•°å¢åŠ åè€Œå¯¼è‡´ä¸‹è½½é€Ÿåº¦ä¸‹é™ï¼Œè¦å‡å°‘å¹¶å‘æ•°ï¼Œæ‰¾åˆ°ä¸€ä¸ªæœ€ä½³çš„ä¸‹è½½é‡ã€‚</li></ul>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;p class=&quot;note note-success&quot;&gt;2024å¹´8æœˆçš„ç¬”è®°&lt;/p&gt;

&lt;p&gt;æ’­æ”¾å™¨ä½œä¸ºæ¶ˆè´¹è€…ï¼Œç¼“å­˜ä½œä¸ºç”Ÿäº§è€…ã€‚&lt;/p&gt;
&lt;h2 id=&quot;è¿›å…¥ç¼“å†²ä¸€æ¬¡&quot;&gt;&lt;a href=&quot;#è¿›å…¥ç¼“å†²ä¸€æ¬¡&quot; class=&quot;headerlink&quot;</summary>
        
      
    
    
    
    <category term="éŸ³è§†é¢‘" scheme="https://iwesley.top/categories/%E9%9F%B3%E8%A7%86%E9%A2%91/"/>
    
    
    <category term="éŸ³è§†é¢‘" scheme="https://iwesley.top/tags/%E9%9F%B3%E8%A7%86%E9%A2%91/"/>
    
  </entry>
  
  <entry>
    <title>å®‰å“å±ä¿è°ƒè¯•</title>
    <link href="https://iwesley.top/article/98c55340/"/>
    <id>https://iwesley.top/article/98c55340/</id>
    <published>2025-03-15T06:37:37.000Z</published>
    <updated>2025-03-16T09:34:10.864Z</updated>
    
    <content type="html"><![CDATA[<p>å…ˆçœ‹ä¸€ä¸‹åœ¨è®¾ç½®ç‚¹å‡»å±ä¿é¢„è§ˆåçš„è°ƒç”¨é“¾ï¼ˆAndroid 14ï¼‰</p><pre><code class=" mermaid">sequenceDiagram    participant User    participant MaterialButton    participant View    participant DreamSettings    participant DreamBackend    User-&gt;&gt;MaterialButton: ç‚¹å‡»æŒ‰é’®ï¼ˆ performClick()ï¼‰    MaterialButton-&gt;&gt;View: performClick()    View-&gt;&gt;DreamSettings: è§¦å‘ onClick() (lambda è¡¨è¾¾å¼)    DreamSettings-&gt;&gt;DreamBackend: è°ƒç”¨ preview()</code></pre><p>DreamControllerçš„æ‰“å°ä¿¡æ¯</p><blockquote><p>Starting dream: name&#x3D;ComponentInfo{com.google.android.apps.tv.dreamx&#x2F;com.google.android.apps.tv.dreamx.service.Backdrop}, <strong>isPreviewMode&#x3D;true</strong>, canDoze&#x3D;false, userId&#x3D;0, reason&#x3D;â€™test dreamâ€™</p></blockquote><p>DreamActivityæ˜¯ä¸€ä¸ªä¸éœ€è¦æ³¨å†Œçš„Activityï¼Œè¿è¡Œåœ¨å„ä¸ªå±ä¿è¿›ç¨‹ã€‚</p><p>å±ä¿åº”ç”¨å®ç°DreamServiceå³å¯ã€‚</p><p>å±ä¿çŠ¶æ€æ—¶ï¼Œåå°èµ·åº”ç”¨ä¼šè¿›å…¥ onStop çŠ¶æ€ï¼ˆè¯¥ä¾‹å­ onStop é‡Œé¢è°ƒç”¨äº† finishï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2025/20250315143803024.png" alt="img"></p><h2 id="é€€å‡ºå±ä¿çš„æ–¹æ³•"><a href="#é€€å‡ºå±ä¿çš„æ–¹æ³•" class="headerlink" title="é€€å‡ºå±ä¿çš„æ–¹æ³•"></a>é€€å‡ºå±ä¿çš„æ–¹æ³•</h2><h3 id="1ã€æœ‰è§¦æ‘¸æˆ–è€…æŒ‰é”®è¾“å…¥"><a href="#1ã€æœ‰è§¦æ‘¸æˆ–è€…æŒ‰é”®è¾“å…¥" class="headerlink" title="1ã€æœ‰è§¦æ‘¸æˆ–è€…æŒ‰é”®è¾“å…¥"></a>1ã€æœ‰è§¦æ‘¸æˆ–è€…æŒ‰é”®è¾“å…¥</h3><h3 id="2ã€é…ç½®config-dismissDreamOnActivityStart-ä¸º-true-åˆ™ä¼šåœ¨æ–°-activity-èµ·æ¥åé€€å‡ºå±ä¿"><a href="#2ã€é…ç½®config-dismissDreamOnActivityStart-ä¸º-true-åˆ™ä¼šåœ¨æ–°-activity-èµ·æ¥åé€€å‡ºå±ä¿" class="headerlink" title="2ã€é…ç½®config_dismissDreamOnActivityStart ä¸º true åˆ™ä¼šåœ¨æ–° activity èµ·æ¥åé€€å‡ºå±ä¿"></a>2ã€é…ç½®config_dismissDreamOnActivityStart ä¸º true åˆ™ä¼šåœ¨æ–° activity èµ·æ¥åé€€å‡ºå±ä¿</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"> <span class="hljs-comment">&lt;!-- Whether to dismiss the active dream when an activity is started. Doesn&#x27;t apply to</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">          assistant activities (ACTIVITY_TYPE_ASSISTANT) --&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">bool</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;config_dismissDreamOnActivityStart&quot;</span>&gt;</span>false<span class="hljs-tag">&lt;/<span class="hljs-name">bool</span>&gt;</span><br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2025/20250315143803153.png" alt="img"></p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2025/20250315143803189.png" alt="img"></p><h3 id="3ã€è·¨è¿›ç¨‹è°ƒç”¨DreamManagerService-çš„awakenï¼ˆéœ€è¦ç³»ç»Ÿç­¾åï¼‰"><a href="#3ã€è·¨è¿›ç¨‹è°ƒç”¨DreamManagerService-çš„awakenï¼ˆéœ€è¦ç³»ç»Ÿç­¾åï¼‰" class="headerlink" title="3ã€è·¨è¿›ç¨‹è°ƒç”¨DreamManagerService çš„awakenï¼ˆéœ€è¦ç³»ç»Ÿç­¾åï¼‰"></a>3ã€è·¨è¿›ç¨‹è°ƒç”¨DreamManagerService çš„awakenï¼ˆéœ€è¦ç³»ç»Ÿç­¾åï¼‰</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> android.os.IBinder<br><span class="hljs-keyword">import</span> androidx.annotation.RequiresPermission<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">DreamManager</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">val</span> <span class="hljs-variable">TAG</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;DreamManager&quot;</span><br>    <span class="hljs-comment">//private var mDreamManager: Any? = context.getSystemService(&quot;dream&quot;)</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> mDreamManager: Any? = <span class="hljs-literal">null</span><br><br>    init &#123;<br>        mDreamManager = <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">val</span> <span class="hljs-variable">dream</span> <span class="hljs-operator">=</span> Reflector.on(<span class="hljs-string">&quot;android.os.ServiceManager&quot;</span>).method(<span class="hljs-string">&quot;getService&quot;</span>, String::class.java).call&lt;Any&gt;(<span class="hljs-string">&quot;dreams&quot;</span>)<br>            Reflector.on(<span class="hljs-string">&quot;android.service.dreams.IDreamManager\$Stub&quot;</span>).method(<span class="hljs-string">&quot;asInterface&quot;</span>, IBinder::class.java).call&lt;Any&gt;(dream)<br>        &#125; <span class="hljs-keyword">catch</span> (e: Exception) &#123;<br>            <span class="hljs-literal">null</span><br>        &#125;<br>    &#125;<br><br>    <span class="hljs-meta">@RequiresPermission(&quot;android.permission.READ_DREAM_STATE&quot;)</span><br>    fun <span class="hljs-title function_">isDreaming</span><span class="hljs-params">()</span>: Boolean &#123;<br>        <span class="hljs-keyword">if</span> (mDreamManager == <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">try</span> &#123;<br>            Reflector.with(mDreamManager!!).method(<span class="hljs-string">&quot;isDreaming&quot;</span>).call()<br>        &#125; <span class="hljs-keyword">catch</span> (e: Exception) &#123;<br>            <span class="hljs-literal">false</span><br>        &#125;<br>    &#125;<br><br>    <span class="hljs-meta">@RequiresPermission(&quot;android.permission.WRITE_DREAM_STATE&quot;)</span><br>    fun <span class="hljs-title function_">stopDream</span><span class="hljs-params">()</span> &#123;<br>        mDreamManager?.let &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                Reflector.with(it).method(<span class="hljs-string">&quot;awaken&quot;</span>).call&lt;Unit&gt;()<br>            &#125; <span class="hljs-keyword">catch</span> (e: Exception) &#123;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å±ä¿è°ƒè¯•å‘½ä»¤ï¼šcmd-dreams"><a href="#å±ä¿è°ƒè¯•å‘½ä»¤ï¼šcmd-dreams" class="headerlink" title="å±ä¿è°ƒè¯•å‘½ä»¤ï¼šcmd dreams"></a>å±ä¿è°ƒè¯•å‘½ä»¤ï¼šcmd dreams</h2><blockquote><p>roc_rk3588s_pc:&#x2F; # cmd dreams -h</p><p>Dream manager (dreams) commands:</p><p>  help</p><p>â€‹      Print this help text.</p><p>  start-dreaming</p><p>â€‹      Start the currently configured dream.</p><p>  stop-dreaming</p><p>â€‹      Stops any active dream</p></blockquote><p>cmd dreams start-dreaming</p><p>cmd dreams stop-dreaming</p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;p&gt;å…ˆçœ‹ä¸€ä¸‹åœ¨è®¾ç½®ç‚¹å‡»å±ä¿é¢„è§ˆåçš„è°ƒç”¨é“¾ï¼ˆAndroid 14ï¼‰&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot; mermaid&quot;&gt;sequenceDiagram
    participant User
    participant MaterialButton
   </summary>
        
      
    
    
    
    <category term="AndroidFrameworkFeature" scheme="https://iwesley.top/categories/AndroidFrameworkFeature/"/>
    
    
    <category term="DreamManagerService" scheme="https://iwesley.top/tags/DreamManagerService/"/>
    
    <category term="Framework" scheme="https://iwesley.top/tags/Framework/"/>
    
    <category term="å±ä¿" scheme="https://iwesley.top/tags/%E5%B1%8F%E4%BF%9D/"/>
    
  </entry>
  
  <entry>
    <title>å®‰å“å†…å­˜æ³„éœ²ä¹‹DMA-BUFå¼‚å¸¸å¢é•¿:Android Studioé•œåƒå¼•èµ·DMAå†…å­˜æ³„éœ²</title>
    <link href="https://iwesley.top/article/f148a913/"/>
    <id>https://iwesley.top/article/f148a913/</id>
    <published>2025-03-04T13:10:58.000Z</published>
    <updated>2025-03-04T13:40:23.876Z</updated>
    
    <content type="html"><![CDATA[<p>ä»Šå¤©ç”¨ç€å®‰å“ 14 çš„æ¿å­çš„æ—¶å€™çªç„¶ç³»ç»Ÿå¡æ­»ã€‚</p><p>æŸ¥çœ‹æ—¥å¿—å‘ç°launcheréƒ½è¢«å¹²æ‰äº†</p><blockquote><p>03-04 06:13:35.544 7872 8479 I ActivityManager: vis BFGS 18740: com.android.launcher3 (pid 8407) service</p><p>03-04 06:13:35.544 7872 8479 I ActivityManager: com.android.launcher3&#x2F;com.android.quickstep.TouchInteractionService&lt;&#x3D;Proc{8077:com.android.systemui&#x2F;u0a70}</p><p>03-04 06:13:36.155 277 277 I lowmemorykiller: Kill â€˜com.android.launcher3â€™ (8407), uid 10071, oom_score_adj 100 to free 39504kB rss, 46224kB swap; reason: device is low on swap (91200kB &lt; 199552kB) and thrashing (200%)</p></blockquote><p>çœ‹<code>dumpsys meminfo</code>å‘ç°DMA-BUFå äº†3Gå¤šï¼ˆ4Gè®¾å¤‡ï¼‰ï¼Œåº”ç”¨free ramåŸºæœ¬æ²¡äº†ã€‚</p><p>åˆšå¼€å§‹ä»¥ä¸ºæ˜¯scrcpyçš„é—®é¢˜ã€‚åæ¥ç»è°ƒæŸ¥å‘ç°æ˜¯android studioçš„å±å¹•é•œåƒé—®é¢˜ã€‚</p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>å¼€æœºä¸€æ®µæ—¶é—´å</p><blockquote><p>Total RAM: 3,991,080K (status normal)</p><p>Free RAM: 1,166,810K (  124,454K cached pss +   623,088K cached kernel +   419,268K free)</p><p><strong>DMA-BUF: 1,477,628K (      876K mapped + 1,476,752K unmapped)</strong></p><p>DMA-BUF Heaps: 1,477,628K</p><p>DMA-BUF Heaps pool:   249,088K</p><p>â€‹      GPU:   202,320K</p><p> Used RAM: 2,763,593K (1,036,373K used pss + 1,727,220K kernel)</p><p> Lost RAM:   195,490K</p><p>â€‹     ZRAM:    72,700K physical used for   215,296K in swap (1,995,536K total swap)</p><p>   Tuning: 192 (large 512), oom   322,560K, restore limit   107,520K (high-end-gfx)</p></blockquote><p><code>cat /sys/kernel/dmabuf/buffers/*/size</code>ï¼Œå‘ç°æœ‰å¥½å¤š483328å­—èŠ‚çš„ inode</p><p><code>cat /sys/kernel/dmabuf/buffers/*/size  | grep 483328 | wc -l</code></p><p>æœ‰2957ä¸ªï¼Œè®¡ç®—ï¼š2957*483328&#x3D;1429200896&#x3D;1.4Gï¼Œå’Œä¸Šé¢çš„ç»“æœå·®ä¸å¤šã€‚</p><p>éšä¾¿æŸ¥çœ‹ä¸€ä¸ªinode</p><blockquote><p>roc_rk3588s_pc:&#x2F; # lsof | grep -w 7248</p><p><a href="mailto:&#x63;&#50;&#64;&#x31;&#x2e;&#x31;&#45;&#115;&#x65;&#x72;&#118;&#x69;&#99;&#x65;">&#x63;&#50;&#64;&#x31;&#x2e;&#x31;&#45;&#115;&#x65;&#x72;&#118;&#x69;&#99;&#x65;</a>   543 mediacodec 2553u     0000                0,8       0t0       7248 &#x2F;dmabuf:system</p><p>main       4146       root 5088u     0000                0,8       0t0       7248 &#x2F;dmabuf:system</p><p>main       4146       root 5089u     0000                0,8       0t0       7248 &#x2F;dmabuf:system</p></blockquote><p><code>lsof | grep &quot;4146&quot; | grep dmabuf  | wc -l</code></p><p>æœ‰2958æ¡è¿™æ ·çš„æ¡ç›®</p><p><code>main       4146       root 5973u     0000                0,8       0t0       7690 /dmabuf:system</code></p><p>å’Œä¸Šé¢çš„æ•°ç›®ä¸€ä¸€å¯¹åº”</p><p>æŸ¥çœ‹æ˜¯å“ªä¸€ä¸ªç¨‹åº</p><blockquote><p>roc_rk3588s_pc:&#x2F; # cat &#x2F;proc&#x2F;543&#x2F;cmdline</p><p>&#x2F;vendor&#x2F;bin&#x2F;hw&#x2F;<a href="mailto:&#x61;&#110;&#x64;&#x72;&#x6f;&#105;&#100;&#x2e;&#104;&#x61;&#114;&#x64;&#119;&#97;&#114;&#x65;&#46;&#109;&#101;&#100;&#105;&#x61;&#x2e;&#99;&#50;&#64;&#49;&#x2e;&#49;&#45;&#115;&#101;&#x72;&#x76;&#105;&#99;&#x65;">&#x61;&#110;&#x64;&#x72;&#x6f;&#105;&#100;&#x2e;&#104;&#x61;&#114;&#x64;&#119;&#97;&#114;&#x65;&#46;&#109;&#101;&#100;&#105;&#x61;&#x2e;&#99;&#50;&#64;&#49;&#x2e;&#49;&#45;&#115;&#101;&#x72;&#x76;&#105;&#99;&#x65;</a></p><p>roc_rk3588s_pc:&#x2F; # cat &#x2F;proc&#x2F;4146&#x2F;cmdline</p><p>app_process&#x2F;data&#x2F;local&#x2F;tmp&#x2F;.studiocom.android.tools.screensharing.Mainâ€“socket&#x3D;screen-sharing-agent-8055â€“flags&#x3D;16</p></blockquote><p>å‘ç°æ˜¯android studioé•œåƒå¯¼è‡´çš„ï¼šåº”è¯¥æ˜¯å› ä¸ºä¸€ç›´é»‘å±å¯¼è‡´åå¤ç”³è¯·å†…å­˜å¯¼è‡´DMA-BUFæ³„éœ²ã€‚</p><p>å…³é—­Android Studioçš„Device MirroringåŠŸèƒ½åï¼Œåé¢ä½¿ç”¨è®¾å¤‡å°±æ­£å¸¸äº†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2025/20250304211421729.png" alt="img"></p><h2 id="dmabuf-dump"><a href="#dmabuf-dump" class="headerlink" title="dmabuf_dump"></a>dmabuf_dump</h2><p>é€šè¿‡dmabuf_dumpå‘½ä»¤å¯ä»¥æ›´å¿«åœ°æŸ¥çœ‹å¼‚å¸¸ç¨‹åº</p><blockquote><p>roc_rk3588s_pc:&#x2F; # dmabuf_dump -h</p><p>Usage: dmabuf_dump [-abh] [per-process&#x2F;per-buffer stats]</p><p>-a       show all dma buffers (ion) in big table, [buffer x process] grid</p><p>-b       show DMA-BUF per-buffer, per-exporter and per-device statistics</p><p>-h       show this help</p><p>â€‹         If PID is supplied, the dmabuf information for that process is shown.</p><p>â€‹         Per-buffer DMA-BUF stats do not take an argument.</p></blockquote><p>é€šè¿‡<code>dmabuf_dump</code>å°±å¯ä»¥æŸ¥çœ‹å„ä¸ªç¨‹åºDMA-BUFçš„å ç”¨æƒ…å†µï¼ˆåŒ…å«ç¨‹åºåå­—ã€pidã€inodeç­‰ç­‰ï¼‰æˆ–è€…åŠ å…¶ä»–å‚æ•°è¾“å‡ºä¸åŒç»“æœã€‚</p><blockquote><p>roc_rk3588s_pc:&#x2F; # dmabuf_dump 4146</p><p>â€‹            main:4146</p><p>â€‹                  Name              Rss              Pss         nr_procs            Inode</p><p>â€‹                system           472 kB           472 kB                1             4735</p><p>â€‹                system           472 kB           472 kB                1             4736</p><p>â€‹                system           472 kB           472 kB                1             4737</p><p>â€‹               </p><p>â€‹               â€”â€”â€”â€”â€”â€”ï¼ˆçœç•¥å‡ åƒè¡Œï¼‰â€”â€”â€”â€”â€”-</p><p>â€‹          </p><p>â€‹                system           472 kB           472 kB                1             7688</p><p>â€‹                system           472 kB           472 kB                1             7689</p><p>â€‹                system           472 kB           472 kB                1             7690</p><p>â€‹         PROCESS TOTAL       1395232 kB       1395232 kB</p><p>-â€”â€”â€”â€”â€”â€”â€”</p><p>dmabuf total: 1477628 kB kernel_rss: 82396 kB userspace_rss: 1395232 kB userspace_pss: 1395232 kB</p></blockquote><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://source.android.com/docs/core/graphics/implement-dma-buf-gpu-mem">Implement DMABUF and GPU memory accounting in Android 12  |  Android Open Source Project</a></p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;p&gt;ä»Šå¤©ç”¨ç€å®‰å“ 14 çš„æ¿å­çš„æ—¶å€™çªç„¶ç³»ç»Ÿå¡æ­»ã€‚&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹æ—¥å¿—å‘ç°launcheréƒ½è¢«å¹²æ‰äº†&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;03-04 06:13:35.544 7872 8479 I ActivityManager: vis BFGS 18740:</summary>
        
      
    
    
    
    <category term="Androidæ€§èƒ½ä¼˜åŒ–" scheme="https://iwesley.top/categories/Android%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    
    
    <category term="å†…å­˜" scheme="https://iwesley.top/tags/%E5%86%85%E5%AD%98/"/>
    
    <category term="æ€§èƒ½ä¼˜åŒ–" scheme="https://iwesley.top/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>å®‰å“ç»„ä»¶åŒ–ä¹‹åŠ¨æ€ä¾èµ–åŠŸèƒ½æ¨¡å—</title>
    <link href="https://iwesley.top/article/67ca89d4/"/>
    <id>https://iwesley.top/article/67ca89d4/</id>
    <published>2025-03-03T10:34:03.000Z</published>
    <updated>2025-03-03T12:42:15.461Z</updated>
    
    <content type="html"><![CDATA[<p>å¯¹äºæ‹¥æœ‰ä¸åŒæ¸ é“çš„ APP æ¥è¯´ï¼Œå¯èƒ½éœ€è¦é›†æˆä¸åŒçš„åŠŸèƒ½æ¨¡å—ï¼Œä¹Ÿå¯èƒ½åŒä¸€ä¸ªåŠŸèƒ½æœ‰ä¸åŒå®ç°ã€‚æœ€ç®€å•çš„æ–¹æ³•å¯èƒ½æ˜¯é€šè¿‡æ¥å£ã€å·¥å‚æ¨¡å¼ã€ flavorImplement å’Œæ¸ é“è‡ªå®šä¹‰ä»£ç çš„æ–¹æ³•æ¥å®ç°äº†ã€‚ä½†æ˜¯ï¼Œå¦‚æœä¸æƒ³å»ºé‚£ä¹ˆå¤šæ¸ é“ä»£ç ç›®å½•ï¼Œéœ€è¦é€šè¿‡ä¸€å¥—ä»£ç æ¥åˆå§‹åŒ–æ¨¡å—ï¼Œé‚£ä¹ˆä¸Šè¿°æ–¹æ³•å°±ä¸è¡Œäº†ã€‚</p><p>é‚£ä¹ˆå¦‚ä½•åœ¨ä¸ä¾èµ–æ¨¡å—çš„å‰æä¸‹åŠ¨æ€è°ƒç”¨å…¶åŠŸèƒ½å‘¢ï¼Ÿ</p><p>æœ‰å‡ ç§æ–¹æ³•ï¼š</p><p>1ã€åå°„ã€æ¥å£éš”ç¦»å’Œå·¥å‚æ¨¡å¼</p><p>2ã€åŠ¨æ€åŠŸèƒ½æ¨¡å—ï¼ˆDynamic Feature Moduleï¼‰ï¼Œå›½å†…ä¸é€‚ç”¨ã€‚</p><p>3ã€åˆ©ç”¨ Java çš„ <code>ServiceLoader</code> æœºåˆ¶ï¼Œé€šè¿‡é…ç½®æ–‡ä»¶å£°æ˜æ¥å£å®ç°ç±»ã€‚</p><p>ç»¼åˆè€ƒè™‘åå†³å®šé‡‡ç”¨åå°„ã€æ¥å£éš”ç¦»å’Œå·¥å‚æ¨¡å¼ã€‚</p><h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><p>ç¯å¢ƒï¼šagp 8.7.0ï¼Œgradeï¼š8.10.2</p><h3 id="gradleï¼šå®ç°æ¨¡å—åŠ¨æ€åŠ è½½"><a href="#gradleï¼šå®ç°æ¨¡å—åŠ¨æ€åŠ è½½" class="headerlink" title="gradleï¼šå®ç°æ¨¡å—åŠ¨æ€åŠ è½½"></a>gradleï¼šå®ç°æ¨¡å—åŠ¨æ€åŠ è½½</h3><p>é‡‡ç”¨yamlæ–‡ä»¶è¿›è¡ŒåŠŸèƒ½é…ç½®</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment">#åŠŸèƒ½å®šä¹‰</span><br><span class="hljs-attr">features:</span><br>  <span class="hljs-attr">featureA:</span><br>    <span class="hljs-comment">#é»˜è®¤é…ç½®</span><br>    <span class="hljs-attr">enable:</span> <span class="hljs-literal">false</span><br>    <span class="hljs-attr">name:</span> <span class="hljs-string">&#x27;:feature:featureA&#x27;</span> <span class="hljs-comment">#æ¨¡å—åå­—</span><br>    <span class="hljs-comment">#ä¸¤ä¸ªåˆ—è¡¨ä¼˜å…ˆçº§æœ€é«˜ï¼Œä½†ä¸èƒ½åŒæ—¶åŒ…å«ä¸€æ ·çš„flavor</span><br>    <span class="hljs-comment">#å¦‚æœenableä¸ºtrueï¼Œåˆ™å»ºè®®ä½¿ç”¨disableFlavorsListã€‚åä¹‹ï¼Œäº¦ç„¶ã€‚</span><br>    <span class="hljs-attr">enableFlavorsList:</span> [<span class="hljs-string">demo</span>, <span class="hljs-string">companyA</span>, <span class="hljs-string">companyB</span>]<br>    <span class="hljs-attr">disableFlavorsList:</span> []<br></code></pre></td></tr></table></figure><p>libs.versions.toml</p><figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs toml"><span class="hljs-attr">snakeyaml</span> = <span class="hljs-string">&quot;1.33&quot;</span><br><span class="hljs-attr">snakeyaml</span> = &#123; module = <span class="hljs-string">&quot;org.yaml:snakeyaml&quot;</span>, version.ref = <span class="hljs-string">&quot;snakeyaml&quot;</span> &#125;<br></code></pre></td></tr></table></figure><p>æ ¹build.gradle</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">// Top-level build file where you can add configuration options common to all sub-projects/modules.</span><br>buildscript &#123;<br>    <span class="hljs-comment">// è‡ªå®šä¹‰ gradle æ’ä»¶</span><br>    dependencies &#123;<br>        <span class="hljs-comment">//classpath(libs.plugin)</span><br>        classpath libs.snakeyaml <span class="hljs-comment">// æ·»åŠ  YAML è§£æåº“</span><br>    &#125;<br>&#125;<br><br>plugins &#123;<br>    alias(libs.plugins.android.application) apply <span class="hljs-literal">false</span><br>    alias(libs.plugins.kotlin.android) apply <span class="hljs-literal">false</span><br>    alias(libs.plugins.android.library) apply <span class="hljs-literal">false</span><br>&#125;<br></code></pre></td></tr></table></figure><p>app build.gradle ï¼ˆæ ¹æ®é…ç½®åŠ¨æ€ä¾èµ–æ¨¡å—å®ç°ï¼‰</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//Yamlæ”¾åœ¨å…¶ä»–xxx.gradle importä¼šæŠ¥æ‰¾ä¸åˆ°</span><br><span class="hljs-keyword">import</span> org.yaml.snakeyaml.Yaml<br>ext &#123;<br>    loadYamlConfig = &#123; String fileName -&gt;<br>        <span class="hljs-keyword">def</span> configFile = file(fileName)<br>        <span class="hljs-keyword">if</span> (!configFile.exists()) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> GradleException(<span class="hljs-string">&quot;YAML config file not found: $&#123;configFile.absolutePath&#125;&quot;</span>)<br>        &#125;<br>        <span class="hljs-keyword">def</span> yaml = <span class="hljs-keyword">new</span> Yaml()<br>        <span class="hljs-keyword">def</span> config<br>        <span class="hljs-keyword">try</span> &#123;<br>            configFile.withReader &#123; reader -&gt;<br>                config = yaml.load(reader)<br>            &#125;<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> GradleException(<span class="hljs-string">&quot;Failed to parse YAML file: $&#123;configFile.name&#125;&quot;</span>, e)<br>        &#125;<br>        <span class="hljs-keyword">return</span> config.asImmutable()<br>    &#125;<br>&#125;<br><br><br><span class="hljs-keyword">def</span> printlnRed(String msg) &#123;<br>    <span class="hljs-keyword">def</span> ANSI_RESET = <span class="hljs-string">&quot;\u001B[0m&quot;</span><br>    <span class="hljs-keyword">def</span> ANSI_RED = <span class="hljs-string">&quot;\u001B[31m&quot;</span><br>    println(<span class="hljs-string">&quot;$&#123;ANSI_RED&#125;$&#123;msg&#125;$&#123;ANSI_RESET&#125;&quot;</span>)<br>&#125;<br><br><span class="hljs-keyword">def</span> featureConfig = loadYamlConfig(<span class="hljs-string">&quot;feature_config.yaml&quot;</span>)<br>println(<span class="hljs-string">&quot;featureConfig: $&#123;featureConfig&#125;&quot;</span>)<br>afterEvaluate &#123;<br>    android.applicationVariants.configureEach &#123; variant -&gt;<br>        <span class="hljs-keyword">def</span> flavorCompanyName = variant.productFlavors.find &#123; it.dimension == <span class="hljs-string">&quot;COMPANY&quot;</span> &#125;?.name<br>        if (!flavorCompanyName) &#123;<br>            throw new GradleException(<span class="hljs-string">&quot;Variant $&#123;variant.name&#125; has no COMPANY flavor!&quot;</span>)<br>        &#125;<br>        println(<span class="hljs-string">&quot;variant.name:$&#123;variant.name&#125; variant.flavorName:$&#123;variant.flavorName&#125;&quot;</span>)<br>        featureConfig.features.each &#123; featureKey, defaultConfig  -&gt;<br>            def featureName = defaultConfig.name<br>            boolean isEnabled = defaultConfig.enable<br>            def enableFlavorsList = defaultConfig.enableFlavorsList<br>            def disableFlavorsList = defaultConfig.disableFlavorsList<br>            boolean hasFound = false<br>            for (flavor in enableFlavorsList) &#123;<br>                if (flavor == flavorCompanyName) &#123;<br>                    isEnabled = true<br>                    println(<span class="hljs-string">&quot;enable in enableFlavorsList&quot;</span>)<br>                    hasFound = true<br>                    break<br>                &#125;<br>            &#125;<br>            for (flavor in disableFlavorsList) &#123;<br>                if (flavor == flavorCompanyName) &#123;<br>                    if (hasFound) &#123;<br>                        throw new GradleException(<span class="hljs-string">&quot;Feature $featureKey in flavor $flavorCompanyName must not be in both enableFlavorsList and disableFlavorsList!&quot;</span>)<br>                    &#125;<br>                    isEnabled = false<br>                    printlnRed(<span class="hljs-string">&quot;disable in disableFlavorsList&quot;</span>)<br>                    break<br>                &#125;<br>            &#125;<br>            if (isEnabled) &#123;<br>                println(<span class="hljs-string">&quot;$&#123;flavorCompanyName&#125;Implementation $&#123;featureName&#125;&quot;</span>)<br>                <span class="hljs-comment">//åŠ¨æ€ä¾èµ–æ¨¡å—</span><br>                dependencies.add(<span class="hljs-string">&quot;$&#123;flavorCompanyName&#125;Implementation&quot;</span>, project(featureName))<br>            &#125; else &#123;<br>                printlnRed(<span class="hljs-string">&quot;$&#123;variant.name&#125; $&#123;flavorCompanyName&#125; Not Implementation $&#123;featureName&#125;&quot;</span>)<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æ¨¡å—å®ç°"><a href="#æ¨¡å—å®ç°" class="headerlink" title="æ¨¡å—å®ç°"></a>æ¨¡å—å®ç°</h3><h4 id="å…¬å…±æ¨¡å—"><a href="#å…¬å…±æ¨¡å—" class="headerlink" title="å…¬å…±æ¨¡å—"></a>å…¬å…±æ¨¡å—</h4><p>å®šä¹‰æ¥å£</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">IFeature</span> &#123;<br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">doSomething</span><span class="hljs-params">()</span></span><br>&#125;<br></code></pre></td></tr></table></figure><p>å®šä¹‰ä¸€ä¸ª Helper</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">object</span> FeatureHelper : IFeature &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> mFeature: IFeature? = <span class="hljs-literal">null</span><br>    <br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">setFeatureImpl</span><span class="hljs-params">(feature: <span class="hljs-type">IFeature</span>?)</span></span> &#123;<br>        mFeature = feature<br>    &#125;<br>    <br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">doSomething</span><span class="hljs-params">()</span></span> &#123;<br>        mFeature?.doSomething()<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="åŠŸèƒ½æ¨¡å—"><a href="#åŠŸèƒ½æ¨¡å—" class="headerlink" title="åŠŸèƒ½æ¨¡å—"></a>åŠŸèƒ½æ¨¡å—</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Module</span> &#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">       é‡‡ç”¨javaç±» æ–¹ä¾¿ä½¿ç”¨ java çš„æ–¹å¼è¿›è¡Œåå°„</span><br><span class="hljs-comment">     * æ³¨æ„ï¼šåŒ…åå’Œç±»åã€æ–¹æ³•åå’Œå‚æ•°ä¸èƒ½éšæ„ä¿®æ”¹ï¼Œå¦åˆ™åå°„ä¼šæ‰¾ä¸åˆ°</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> context Context</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> IFeature</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> IFeature <span class="hljs-title function_">load</span><span class="hljs-params">(Context context)</span> &#123;<br>        <span class="hljs-comment">//FeatureManagerå®ç°IFeatureæ¥å£</span><br>        <span class="hljs-type">FeatureManager</span> <span class="hljs-variable">manager</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FeatureManager</span>(context);<br>        manager.init();<br>        <span class="hljs-keyword">return</span> manager;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="app-æ¨¡å—"><a href="#app-æ¨¡å—" class="headerlink" title="app æ¨¡å—"></a>app æ¨¡å—</h4><p><a href="https://iwesley.top/article/ba67228f/">Javaåå°„çš„ä¼˜é›…ä½¿ç”¨ - Wesleyâ€™s Blog</a></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadFeatureModule</span><span class="hljs-params">(application: <span class="hljs-type">Application</span>)</span></span>: IFeature? &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">try</span> &#123;<br>        Reflector.on(<span class="hljs-string">&quot;com.wesley.feature.Module&quot;</span>)<br>            .method(<span class="hljs-string">&quot;load&quot;</span>, Context::<span class="hljs-keyword">class</span>.java).call&lt;IFeature&gt;(application)<br>    &#125; <span class="hljs-keyword">catch</span> (e: Exception) &#123;<br>        <span class="hljs-literal">null</span> <span class="hljs-comment">// æ¨¡å—æœªå¯ç”¨æˆ–æœªå®ç°</span><br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">initModules</span><span class="hljs-params">(application: <span class="hljs-type">Application</span>)</span></span> &#123;<br>  FeatureHelper.setFeatureImpl(loadFeatureModule(application))<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://zhuanlan.zhihu.com/p/97498337">Android æ¨¡å—è§£è€¦å’Œçš„å®è·µ</a></p><p><a href="https://blog.csdn.net/fesdgasdgasdg/article/details/106888077">Android ä¸­ä½¿ç”¨ ServiceLoaderã€AutoService æ‘”å‘è®°å½•</a></p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;p&gt;å¯¹äºæ‹¥æœ‰ä¸åŒæ¸ é“çš„ APP æ¥è¯´ï¼Œå¯èƒ½éœ€è¦é›†æˆä¸åŒçš„åŠŸèƒ½æ¨¡å—ï¼Œä¹Ÿå¯èƒ½åŒä¸€ä¸ªåŠŸèƒ½æœ‰ä¸åŒå®ç°ã€‚æœ€ç®€å•çš„æ–¹æ³•å¯èƒ½æ˜¯é€šè¿‡æ¥å£ã€å·¥å‚æ¨¡å¼ã€ flavorImplement</summary>
        
      
    
    
    
    <category term="AndroidAPPæ¶æ„" scheme="https://iwesley.top/categories/AndroidAPP%E6%9E%B6%E6%9E%84/"/>
    
    
    <category term="Android" scheme="https://iwesley.top/tags/Android/"/>
    
    <category term="gradle" scheme="https://iwesley.top/tags/gradle/"/>
    
    <category term="ç»„ä»¶åŒ–" scheme="https://iwesley.top/tags/%E7%BB%84%E4%BB%B6%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>DLNAåº“Platinumæ–°å¢å®‰å“64ä½soç¼–è¯‘æ–¹æ³•</title>
    <link href="https://iwesley.top/article/4339b418/"/>
    <id>https://iwesley.top/article/4339b418/</id>
    <published>2025-01-18T04:52:15.000Z</published>
    <updated>2025-01-18T11:12:45.426Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸‹è½½ä»£ç ï¼ˆè¯¥ä»“åº“æˆ‘å·²ç»ä¿®æ”¹ç›¸å…³ç¼–è¯‘é”™è¯¯å’Œæ”¯æŒå®‰å“ 64 ä½ so ç¼–è¯‘ï¼‰</p><p><code>git clone https://github.com/wesley666/Platinum -b master</code></p><p>ä¸‹è½½Neptune</p><p><code>git submodule update --init</code></p><p>ä¸‹è½½ ndk15ï¼š</p><p><a href="https://dl.google.com/android/repository/android-ndk-r15c-linux-x86_64.zip">https://dl.google.com/android/repository/android-ndk-r15c-linux-x86_64.zip</a></p><p>å»ºè®®å®‰è£… conda ç¯å¢ƒæ¥è¿›è¡Œç¼–è¯‘</p><p><a href="https://www.anaconda.com/download/success">https://www.anaconda.com/download/success</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">conda create -n dlna  python=2.7<br><br>pip install scons<br><br>conda activate dlna<br></code></pre></td></tr></table></figure><p>ç¼–è¯‘</p> <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">ä»¥ä½ çš„è·¯å¾„ä¸ºå‡†ï¼Œå¦‚æœå‡ºç°è·¯å¾„é”™è¯¯ï¼Œå¯ä»¥æ”¹æˆç»å¯¹è·¯å¾„</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-built_in">export</span> ANDROID_NDK_ROOT=/home/wesley/ndk/android-ndk-r15c/</span> <br>export ANDROID_NDK_ROOT=~/ndk/android-ndk-r15c/ <br>scons -c target=arm-android-linux build_config=Release<br>scons target=arm-android-linux build_config=Release<br>scons -c target=arm64-android-linux build_config=Release<br>scons target=arm64-android-linux build_config=Release<br>cd Source/Platform/Android/module/platinum<br>~/ndk/android-ndk-r15c/ndk-build clean<br>~/ndk/android-ndk-r15c/ndk-build NDK_DEBUG=0<br></code></pre></td></tr></table></figure><blockquote><p>(dlna) wesley@Wesley:~&#x2F;Project&#x2F;Platinum&#x2F;Source&#x2F;Platform&#x2F;Android&#x2F;module&#x2F;platinum$ ~&#x2F;ndk&#x2F;android-ndk-r15c&#x2F;ndk-build<br>Android NDK: Found platform level in .&#x2F;project.properties. Setting APP_PLATFORM to android-14.<br>jni&#x2F;Android.mk:5: â€œTARGET_ARCH_ABI:armeabiâ€<br>jni&#x2F;Android.mk:5: â€œTARGET_ARCH_ABI:armeabi-v7aâ€<br>jni&#x2F;Android.mk:5: â€œTARGET_ARCH_ABI:arm64-v8aâ€<br>jni&#x2F;Android.mk:15: â€œbuild arm64â€<br>[armeabi] Compile++ thumb: platinum-jni &lt;&#x3D; platinum-jni.cpp<br>[armeabi] StaticLibrary  : libstdc++.a<br>[armeabi] SharedLibrary  : libplatinum-jni.so<br>[armeabi] Install        : libplatinum-jni.so &#x3D;&gt; libs&#x2F;armeabi&#x2F;libplatinum-jni.so<br>[armeabi-v7a] Compile++ thumb: platinum-jni &lt;&#x3D; platinum-jni.cpp<br>[armeabi-v7a] StaticLibrary  : libstdc++.a<br>[armeabi-v7a] SharedLibrary  : libplatinum-jni.so<br>[armeabi-v7a] Install        : libplatinum-jni.so &#x3D;&gt; libs&#x2F;armeabi-v7a&#x2F;libplatinum-jni.so<br>[arm64-v8a] Compile++      : platinum-jni &lt;&#x3D; platinum-jni.cpp<br>[arm64-v8a] StaticLibrary  : libstdc++.a<br>[arm64-v8a] SharedLibrary  : libplatinum-jni.so<br>[arm64-v8a] Install        : libplatinum-jni.so &#x3D;&gt; libs&#x2F;arm64-v8a&#x2F;libplatinum-jni.so</p></blockquote><p>objå’Œ libsç›®å½•åŒºåˆ«ï¼šä¸€ä¸ªç”¨äºè¿½æº¯å’Œè°ƒè¯•ï¼Œä¸€ä¸ªç”¨äºæ­£å¼ç‰ˆå‘å¸ƒã€‚</p><blockquote><p>(dlna) wesley@Wesley:~&#x2F;Project&#x2F;Platinum&#x2F;Source&#x2F;Platform&#x2F;Android&#x2F;module&#x2F;platinum$ file libs&#x2F;arm64-v8a&#x2F;libplatinum-jni.so<br>libs&#x2F;arm64-v8a&#x2F;libplatinum-jni.so: ELF 64-bit LSB shared object, ARM aarch64, version 1 (SYSV), dynamically linked, BuildID[sha1]&#x3D;a8cdaa3a1288bd98c13556fbd4a1499e31005091, <strong>stripped</strong></p><p>(dlna) wesley@Wesley:~&#x2F;Project&#x2F;Platinum&#x2F;Source&#x2F;Platform&#x2F;Android&#x2F;module&#x2F;platinum$ file obj&#x2F;local&#x2F;arm64-v8a&#x2F;libplatinum-jni.so<br>obj&#x2F;local&#x2F;arm64-v8a&#x2F;libplatinum-jni.so: ELF 64-bit LSB shared object, ARM aarch64, version 1 (SYSV), dynamically linked, BuildID[sha1]&#x3D;a8cdaa3a1288bd98c13556fbd4a1499e31005091, <strong>with debug_info, not stripped</strong></p></blockquote>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;p&gt;ä¸‹è½½ä»£ç ï¼ˆè¯¥ä»“åº“æˆ‘å·²ç»ä¿®æ”¹ç›¸å…³ç¼–è¯‘é”™è¯¯å’Œæ”¯æŒå®‰å“ 64 ä½ so ç¼–è¯‘ï¼‰&lt;/p&gt;
&lt;p&gt;&lt;code&gt;git clone https://github.com/wesley666/Platinum -b</summary>
        
      
    
    
    
    <category term="æŠ•å±" scheme="https://iwesley.top/categories/%E6%8A%95%E5%B1%8F/"/>
    
    
    <category term="æŠ•å±" scheme="https://iwesley.top/tags/%E6%8A%95%E5%B1%8F/"/>
    
    <category term="DLNA" scheme="https://iwesley.top/tags/DLNA/"/>
    
  </entry>
  
  <entry>
    <title>å®‰å“Activityæ‰§è¡ŒfinishåonNewIntentä¹Ÿæ‰§è¡Œäº†</title>
    <link href="https://iwesley.top/article/88a54bc8/"/>
    <id>https://iwesley.top/article/88a54bc8/</id>
    <published>2025-01-04T09:34:44.000Z</published>
    <updated>2025-01-04T10:36:03.481Z</updated>
    
    <content type="html"><![CDATA[<p>æµ‹è¯•ååº”æŠ•å±æ—¶ä¸‹ä¸€é›†å¯èƒ½æ’­æ”¾ä¸æˆåŠŸã€‚</p><p>é¦–å…ˆçœ‹ä¸€ä¸‹æ—¥å¿—ï¼š</p><blockquote><p>onCompletion<br>onCast<br>handlerMessage: 2<br>finish: PlayerActivity@abc7fdc<br>onPause: PlayerActivity@abc7fdc<br>onNewIntent: PlayerActivity@abc7fdc<br>onResume: PlayerActivity@abc7fdc<br>onPause: PlayerActivity@abc7fdc<br>onResume: HomeActivity@71ec50a<br>onstop: PlayerActivity@abc7fdc<br>onDestroy:PlayerActivity@abc7fdc</p></blockquote><p>çœ‹åˆ°æ—¥å¿—æ—¶å¾ˆè¿·æƒ‘ï¼Œä¸ºä»€ä¹ˆ finish äº†ï¼Œå®‰å“è¿˜ä¼šæ‰§è¡ŒonNewIntentï¼Œä¸åº”è¯¥æ˜¯æ–°å»ºä¸€ä¸ª activity å—ï¼Ÿ</p><p>å…ˆæ¥çœ‹ä¸€ä¸‹åœºæ™¯æè¿°ï¼š</p><p>è§†é¢‘æ’­å®Œåä¼šå‘é€ä¸€ä¸ª finish ä¿¡æ¯ï¼Œå¦‚æœ 3s å†…æ²¡æœ‰ä¸‹ä¸€ä¸ªè§†é¢‘è¿›æ¥å°±ä¼šæ‰§è¡Œ finishï¼Œæœ‰è§†é¢‘è¿›æ¥å°±ä¼šåœ¨ onNewIntent ä¸­ remove æ‰è¿™æ¡ä¿¡æ¯ã€‚</p><p>ç»è¿‡å®éªŒå’Œè¯¦ç»†åˆ†æåï¼Œç»ˆäºæ‰¾åˆ°äº†é—®é¢˜åŸå› ï¼š</p><p>é¦–å…ˆå› ä¸ºè§†é¢‘æ’­æ”¾ç»“æŸå‘äº†ä¸€æ¡finishæ¶ˆæ¯ï¼Œfinishæ¶ˆæ¯æ²¡æœ‰æ‰§è¡Œæ—¶çªç„¶æ¥äº†ä¸‹ä¸€é›†çš„æ¶ˆæ¯ï¼Œè¿™æ—¶å€™æ‰§è¡ŒstartActivtyä¼šæ’å…¥ä¸€æ¡onNewIntentæ¶ˆæ¯ã€‚ç»“æœï¼Œè¿™æ—¶å€™finishå› ä¸ºæ—¶é—´åˆ°äº†ï¼Œè¯¥æ‰§è¡Œäº†ã€‚ç„¶å finish æ‰§è¡Œå®Œåï¼ŒonNewIntent ä¹Ÿè¯¥æ‰§è¡Œäº†ã€‚æ‰§è¡Œå®Œåå› ä¸º finish çš„åŸå› ï¼Œ onDestroyä¹Ÿæ‰§è¡Œäº†ã€‚ç»“æœå°±æ˜¯ä¸‹ä¸€é›†æ²¡æ’­å®Œå°±é€€å‡ºæ¥äº†ã€‚</p><p>è§£å†³åŠæ³•ï¼šåœ¨startActivityå‰removeæ‰finishæ¶ˆæ¯ï¼Œæ¯”onNewIntent çš„æ—¶é—´èŠ‚ç‚¹è¿˜è¦æå‰ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>é¢è¯•å¿…å¤‡ï¼šAndroidï¼ˆ9.0ï¼‰Activityå¯åŠ¨æµç¨‹(ä¸€) : <a href="https://juejin.cn/post/6844903959581163528">https://juejin.cn/post/6844903959581163528</a></p><p>é¢è¯•å¿…å¤‡ï¼šAndroidï¼ˆ9.0ï¼‰Activityå¯åŠ¨æµç¨‹(äºŒ) : <a href="https://juejin.cn/post/6844903959589552142">https://juejin.cn/post/6844903959589552142</a></p><p><a href="https://stackoverflow.com/questions/24639272/onnewintent-called-after-finish-executed">android - onNewIntent called after finish() executed - Stack Overflow</a></p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;p&gt;æµ‹è¯•ååº”æŠ•å±æ—¶ä¸‹ä¸€é›†å¯èƒ½æ’­æ”¾ä¸æˆåŠŸã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆçœ‹ä¸€ä¸‹æ—¥å¿—ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;onCompletion&lt;br&gt;onCast&lt;br&gt;handlerMessage: 2&lt;br&gt;finish:</summary>
        
      
    
    
    
    <category term="AndroidBugFix" scheme="https://iwesley.top/categories/AndroidBugFix/"/>
    
    
    <category term="Android" scheme="https://iwesley.top/tags/Android/"/>
    
    <category term="AndroidActivity" scheme="https://iwesley.top/tags/AndroidActivity/"/>
    
  </entry>
  
  <entry>
    <title>å®‰å“åº”ç”¨4å­—èŠ‚ä¸å¯¹é½å¯¼è‡´soåŠ è½½å¤±è´¥</title>
    <link href="https://iwesley.top/article/18f59983/"/>
    <id>https://iwesley.top/article/18f59983/</id>
    <published>2025-01-04T03:12:24.000Z</published>
    <updated>2025-01-04T08:32:28.983Z</updated>
    
    <content type="html"><![CDATA[<p>ä»Šå¤©æŠŠä¸€ä¸ªapkç»™å‚å•†ç­¾ååç›´æ¥pushåˆ°æœºå™¨çš„&#x2F;system&#x2F;app,ç»“æœè¿è¡Œappæ—¶æ˜¾ç¤ºsoæ‰¾ä¸åˆ°ã€‚æŠ¥é”™ï¼š</p><blockquote><p> java stacktrace:<br>java.lang.UnsatisfiedLinkError: Library mmkv not found; tried [&#x2F;system&#x2F;lib&#x2F;libmmkv.so, &#x2F;product&#x2F;lib&#x2F;libmmkv.so]<br>at java.lang.Runtime.loadLibrary0(Runtime.java:1101)<br>at java.lang.System.loadLibrary(System.java:1669)<br>at com.tencent.mmkv.MMKV.doInitialize(MMKV.java:226)<br>at com.tencent.mmkv.MMKV.initialize(MMKV.java:208)<br>at com.tencent.mmkv.MMKV.initialize(MMKV.java:94)<br>at com.wesley.CustomApplication.onCreate(CustomApplication.kt:14)<br>at android.app.Instrumentation.callApplicationOnCreate(Instrumentation.java:1154)<br>at android.app.ActivityThread.handleBindApplication(ActivityThread.java:5871)<br>at android.app.ActivityThread.access$1100(ActivityThread.java:199)<br>at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1650)<br>at android.os.Handler.dispatchMessage(Handler.java:106)<br>at android.os.Looper.loop(Looper.java:193)<br>at android.app.ActivityThread.main(ActivityThread.java:6669)<br>at java.lang.reflect.Method.invoke(Native Method)<br>at com.android.internal.os.RuntimeInit$MethodAndArgsCaller.run(RuntimeInit.java:493)<br>at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:922)  </p></blockquote><p>æ—¥å¿—ï¼ˆxcrash è‡ªå·±æœ‰soå¼‚å¸¸æ•è·ï¼Œæ‰€ä»¥ç›´åˆ°åŠ è½½ mmkv æ‰æŠ›å‡ºå¼‚å¸¸ï¼‰</p><blockquote><p> 12-27 14:58:04.840  9717  9717 E System  : ##loadLibrary0## &#x2F;system&#x2F;app&#x2F;demo&#x2F;demo_V1.0.0(2412261921)-release-signed.apk!&#x2F;lib&#x2F;armeabi-v7a&#x2F;libxcrash.so error: dlopen failed: library â€œ&#x2F;system&#x2F;app&#x2F;demo&#x2F;demo_V1.0.0(2412261921)-release-signed.apk!&#x2F;lib&#x2F;armeabi-v7a&#x2F;libxcrash.soâ€ not found, and try to find so file from the lib path<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper: xcrash: NativeHandler System.loadLibrary failed<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper: java.lang.UnsatisfiedLinkError: Library xcrash not found; tried [&#x2F;system&#x2F;lib&#x2F;libxcrash.so, &#x2F;product&#x2F;lib&#x2F;libxcrash.so]<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at java.lang.Runtime.loadLibrary0(Runtime.java:1101)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at java.lang.System.loadLibrary(System.java:1669)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at xcrash.NativeHandler.initialize(NativeHandler.java:89)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at xcrash.XCrash.init(XCrash.java:189)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at com.wesley.base.apm.XCrashWrapper.<init>(XCrashWrapper.kt:131)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at com.wesley.base.apm.XCrashWrapper.<init>(XCrashWrapper.kt:17)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at com.wesley.CastApplication.attachBaseContext(CastApplication.kt:43)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at android.app.Application.attach(Application.java:212)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at android.app.Instrumentation.newApplication(Instrumentation.java:1121)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at android.app.LoadedApk.makeApplication(LoadedApk.java:1065)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at android.app.ActivityThread.handleBindApplication(ActivityThread.java:5842)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at android.app.ActivityThread.access$1100(ActivityThread.java:199)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1650)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at android.os.Handler.dispatchMessage(Handler.java:106)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at android.os.Looper.loop(Looper.java:193)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at android.app.ActivityThread.main(ActivityThread.java:6669)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at java.lang.reflect.Method.invoke(Native Method)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at com.android.internal.os.RuntimeInit$MethodAndArgsCaller.run(RuntimeInit.java:493)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:922)  </p></blockquote><p>å› ä¸ºå®‰å“6å¼€å§‹æ”¯æŒç›´æ¥åŠ è½½apkå†…éƒ¨soï¼Œå¦‚æœç¼–è¯‘åçš„ apk å†…éƒ¨ so æ˜¯ä¸å‹ç¼©çš„ï¼Œé‚£ä¹ˆå°±ä¸éœ€è¦é‡Šæ”¾åˆ°ç›®å½•äº†ã€‚æ‰€ä»¥æ’é™¤æ˜¯å› ä¸ºä¸è§£å‹ so åˆ°&#x2F;system&#x2F;app&#x2F;demo&#x2F;lib&#x2F;arm å¼•èµ·çš„é—®é¢˜ï¼Œè™½ç„¶è¿™æ ·ä¹Ÿå¯ä»¥è§£å†³é—®é¢˜ã€‚</p><blockquote><p>å¦‚æœapkçš„minSdkVersion &gt;&#x3D; 23 å¹¶ä¸” Android Gradle plugin &gt;&#x3D; 3.6.0æƒ…å†µä¸‹ï¼Œæ‰“åŒ…æ—¶android:extractNativeLibs&#x3D;falseï¼Œapkçš„soé»˜è®¤æ˜¯ä¸å‹ç¼©çš„ã€‚</p><p>åœ¨minSdkVersion &lt; 23 æˆ– Android Gradle plugin &lt; 3.6.0æƒ…å†µä¸‹ï¼Œæ‰“åŒ…æ—¶ android:extractNativeLibs&#x3D;trueï¼Œapkçš„soé»˜è®¤æ˜¯å‹ç¼©çš„ã€‚</p></blockquote><p>ç„¶åï¼Œæˆ‘å°è¯•pushæ²¡æœ‰ç»™å‚å•†ç­¾åå‰çš„ç‰ˆæœ¬ apk åˆ°æœºå™¨ä¸Šæ˜¯æ­£å¸¸çš„ï¼Œé‚£ä¹ˆåº”è¯¥æ˜¯å‚å•†ç­¾åå¯¼è‡´ apk å‘ç”Ÿäº†å˜åŒ–ã€‚åˆšå¥½å‰å‡ å¤©ç¢°åˆ°å®‰å“ç­¾åé—®é¢˜<a href="https://iwesley.top/article/133f2b7a/">å®‰å“15é¢„ç½®ç¬¬ä¸‰æ–¹apkæ—¶ç­¾åæŠ¥é”™é—®é¢˜è§£å†³ - Wesleyâ€™s Blog</a>ã€‚ç„¶åæˆ‘å°±ç”¨å‘½ä»¤çœ‹äº†ä¸€ä¸‹ï¼š<code>zipalign -c -v  4 demo_sign.apk</code></p><p><a href="https://developer.android.com/tools/zipalign">zipalign  | Android Studio  | Android Developers</a></p><p>æ˜¾ç¤ºï¼š<code>Verification FAILED</code>ï¼Œé‚£å°±æ˜¯ 4 å­—èŠ‚æ²¡æœ‰å¯¹é½ã€‚</p><p>æŸ¥çœ‹ç­¾åç‰ˆæœ¬<code>apksigner verify -v demo_sign.apk | grep Verified</code></p><p>åªæœ‰v1ç­¾å</p><blockquote><p>~&#x2F;Project$ apksigner verify -v demo_sign.apk | grep Verified</p><p>Verified using v1 scheme (JAR signing): true</p><p>Verified using v2 scheme (APK Signature Scheme v2): false</p><p>Verified using v3 scheme (APK Signature Scheme v3): false</p><p>Verified using v3.1 scheme (APK Signature Scheme v3.1): false</p><p>Verified using v4 scheme (APK Signature Scheme v4): false</p><p>Verified for SourceStamp: false</p></blockquote><p>å› ä¸ºæ˜¯v1ç­¾åï¼Œæ‰§è¡Œ<code>zipalign -v -p 4 demo_sign.apk  demo_sign_align.apk</code>å¯¹é½4 å­—èŠ‚ä¸ä¼šç ´åå‚å•†çš„ç­¾åä¿¡æ¯ï¼Œç„¶åpushè¿›å»æœç„¶å¥½äº†ã€‚</p><p>ç„¶åæˆ‘åˆè¯•ç€å®‰è£…æ²¡æœ‰å¯¹é½å‰çš„ï¼Œç»“æœç›´æ¥æŠ¥é”™äº†ï¼š</p><blockquote><p>PS C:\Users\Wesley&gt; adb  install Y:\Project\demo_sign.apk</p><p>Performing Streamed Install</p><p>adb: failed to install Y:\Project\demo_sign.apk: Failure [INSTALL_FAILED_INVALID_APK: Failed to extract native libraries, res&#x3D;-2]</p></blockquote><p>ä½†æ˜¯ç³»ç»Ÿæ‰«æå®‰è£…å´æ˜¯å¯ä»¥é€šè¿‡çš„ï¼Œæ‰€ä»¥å¾ˆéš¾å‘ç°æ˜¯å­—èŠ‚ä¸å¯¹é½å¼•èµ·çš„ã€‚</p><h2 id="æ·±ç©¶"><a href="#æ·±ç©¶" class="headerlink" title="æ·±ç©¶"></a>æ·±ç©¶</h2><p>ä¹‹å‰ç›´æ¥æœç´¢å®‰å“java.lang.UnsatisfiedLinkErroræ˜¯å¾ˆéš¾æ‰¾åˆ°é’ˆå¯¹è¿™ç§é—®é¢˜çš„è§£å†³æ–¹æ³•çš„ã€‚å› ä¸ºç°åœ¨æœ‰äº†è§£å†³åŠæ³•ï¼Œæ‰€ä»¥æ¢æˆUnsatisfiedLinkError zipalignè¿›è¡Œè°·æ­Œæœç´¢ã€‚ç»“æœå°±å‡ºæ¥äº†ï¼š</p><p><a href="https://stackoverflow.com/questions/72544099/java-lang-unsatisfiedlinkerror-when-installing-as-system-app">android - java.lang.UnsatisfiedLinkError when installing as system app - Stack Overflow</a></p><p><a href="https://ask.seowhy.com/question/175285">zipflingerå¯¼è‡´çš„UnsatisfiedLinkErroråˆ†æ - æœå¤–SEOé—®ç­”</a></p><p><a href="https://blog.51cto.com/u_15075514/3336070">zipflingerå¯¼è‡´çš„UnsatisfiedLinkErroråˆ†æ_mb5ff2f24b42377çš„æŠ€æœ¯åšå®¢_51CTOåšå®¢</a></p><p>ç”¨ AIå¤§æ¨¡å‹æ€»ç»“ä¸€ä¸‹ï¼š</p><blockquote><p>è¿™ç¯‡æ–‡ç« ä¸»è¦åˆ†æäº†åœ¨Androidå¼€å‘ä¸­ï¼Œç”±äºå‡çº§Android Gradle Plugin (AGP) ç‰ˆæœ¬å¯¼è‡´çš„UnsatisfiedLinkErroré—®é¢˜ï¼Œå¹¶æä¾›äº†ç›¸åº”çš„è§£å†³æ–¹æ¡ˆã€‚ä»¥ä¸‹æ˜¯æ–‡ç« çš„ä¸»è¦å†…å®¹æ€»ç»“ï¼š</p><h3 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h3><ul><li><strong>é—®é¢˜ç°è±¡</strong>ï¼šåœ¨Android 9.0ç¯å¢ƒä¸‹ï¼Œå°†AGPä»3.6.1å‡çº§åˆ°4.1.0åï¼Œé¢„è£…åœ¨&#x2F;system&#x2F;priv-appä¸‹çš„APPå‡ºç°äº†UnsatisfiedLinkErrorå´©æºƒã€‚</li><li><strong>é—®é¢˜åŸå› </strong>ï¼šå‡çº§AGPåï¼Œç³»ç»Ÿåœ¨åŠ è½½soæ–‡ä»¶æ—¶å¤±è´¥ï¼Œå…·ä½“è¡¨ç°ä¸ºsoæ–‡ä»¶åœ¨APKä¸­çš„å¯¹é½æ–¹å¼æœ‰é—®é¢˜ã€‚</li></ul><h3 id="é—®é¢˜åˆ†æ"><a href="#é—®é¢˜åˆ†æ" class="headerlink" title="é—®é¢˜åˆ†æ"></a>é—®é¢˜åˆ†æ</h3><ul><li><strong>soæ–‡ä»¶åŠ è½½æµç¨‹</strong>ï¼šç³»ç»Ÿä½¿ç”¨â€œ!&#x2F;â€åˆ†éš”ç¬¦æ¥å®šä½soæ–‡ä»¶è·¯å¾„ï¼Œå¹¶åœ¨APKä¸­æŸ¥æ‰¾å¯¹åº”çš„entryã€‚é—®é¢˜å‡ºåœ¨zipalignå¤„ç†ä¸Šï¼Œå¯¼è‡´soæ–‡ä»¶çš„å¯¹é½ä¸æ­£ç¡®ã€‚</li><li><strong>zipalignçš„ä½œç”¨</strong>ï¼šç¡®ä¿APKä¸­æ‰€æœ‰æœªå‹ç¼©æ•°æ®åœ¨4å­—èŠ‚è¾¹ç•Œä¸Šå¯¹é½ï¼Œä»¥ä¾¿ä½¿ç”¨mmap()ç›´æ¥è®¿é—®ï¼Œå‡å°‘RAMæ¶ˆè€—ã€‚</li><li><strong>ç³»ç»Ÿç¼–è¯‘å¤„ç†</strong>ï¼šAndroidç³»ç»Ÿåœ¨ç¼–è¯‘æ—¶ä¼šå¯¹privileged appæ‰§è¡Œuncompress-dexsæ“ä½œï¼Œå°†å‹ç¼©å­˜å‚¨çš„dexæ–‡ä»¶å˜ä¸ºä¸å‹ç¼©å­˜å‚¨ã€‚ä¹‹åè¿˜ä¼šè¿›è¡Œalign-packageæ“ä½œã€‚</li></ul><h3 id="é—®é¢˜åŸå› "><a href="#é—®é¢˜åŸå› " class="headerlink" title="é—®é¢˜åŸå› "></a>é—®é¢˜åŸå› </h3><ul><li><strong>zipflingerå·¥å…·</strong>ï¼šä»AGP 4.1å¼€å§‹ï¼Œé»˜è®¤åœ¨æ„å»ºreleaseç‰ˆæœ¬æ—¶å¯ç”¨zipflingerå·¥å…·è¿›è¡Œæ‰“åŒ…ã€‚zipflingeræ”¹å˜äº†APKçš„æ‰“åŒ…æ–¹å¼ï¼Œå¯¼è‡´uncompress-dexsæ“ä½œåzipalignå‡ºç°é—®é¢˜ã€‚</li></ul><h3 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><ul><li><strong>ç¦ç”¨zipflinger</strong>ï¼šåœ¨appå·¥ç¨‹çš„gradle.propertiesä¸­åŠ å…¥é…ç½®ä»¥ç¦ç”¨zipflingerã€‚</li><li><strong>ä¸è§£å‹ dex</strong>ï¼šDONT_UNCOMPRESS_PRIV_APPS_DEXS :&#x3D; trueï¼Œå¯èƒ½ä¼šé™ä½ dex åŠ è½½é€Ÿåº¦ã€‚</li><li><strong>ä½¿ç”¨zip2zipå·¥å…·</strong>ï¼šåœ¨æœ€æ–°çš„AOSPæºç ä¸­ï¼Œä½¿ç”¨zip2zipå·¥å…·æ¥å¤„ç†dexæ–‡ä»¶çš„è§£å‹ç¼©ï¼Œä»¥é€‚é…zipflingeræ‰“åŒ…çš„APKã€‚</li><li><strong>å…¶ä»–æ–¹æ³•</strong>ï¼šåŒ…æ‹¬å›é€€AGPç‰ˆæœ¬ã€ä¿®æ”¹ç³»ç»Ÿç¼–è¯‘è„šæœ¬ç­‰ï¼Œä½†è¿™äº›æ–¹æ³•å„æœ‰ä¼˜ç¼ºç‚¹ã€‚</li></ul></blockquote><p>è™½ç„¶å¼•èµ·é—®é¢˜çš„åŸå› ä¸ä¸€æ ·ï¼Œä½†éƒ½æ˜¯å› ä¸ºå­—èŠ‚ä¸å¯¹é½å¼•èµ·çš„ so æ‰¾ä¸åˆ°ã€‚</p><p>ä¸‹é¢æ¥åˆ†æä¸€ä¸‹å…·ä½“åŸå› ï¼š</p><p>soåŠ è½½è°ƒç”¨æ ˆ</p><blockquote><p>ojluni&#x2F;src&#x2F;main&#x2F;java&#x2F;java&#x2F;lang&#x2F;System.java  â€“&gt; System.loadLibrary</p><p>ojluni&#x2F;src&#x2F;main&#x2F;java&#x2F;java&#x2F;lang&#x2F;Runtime.java  â€“&gt; Runtime.loadLibrary0 -&gt; nativeLoad</p><p>ojluni&#x2F;src&#x2F;main&#x2F;native&#x2F;Runtime.c  â€“&gt; Runtime_nativeLoad</p><p>art&#x2F;openjdkjvm&#x2F;OpenjdkJvm.cc  â€“&gt; JVM_NativeLoad</p><p>art&#x2F;runtime&#x2F;java_vm_ext.cc â€“&gt; JavaVMExt::LoadNativeLibrary</p><p>system&#x2F;core&#x2F;libnativeloader&#x2F;native_loader.cpp â€“&gt; OpenNativeLibrary</p><p>bionic&#x2F;libdl&#x2F;libdl.cpp â€“&gt; android_dlopen_ext</p><p>bionic&#x2F;linker&#x2F;dlfcn.cpp â€“&gt; __loader_android_dlopen_ext</p><p>bionic&#x2F;linker&#x2F;dlfcn.cpp â€“&gt; dlopen_ext</p><p>bionic&#x2F;linker&#x2F;linker.cpp â€“&gt; do_dlopen</p><p>bionic&#x2F;linker&#x2F;linker.cpp â€“&gt; find_library</p><p>bionic&#x2F;linker&#x2F;linker.cpp â€“&gt; find_libraries</p><p>bionic&#x2F;linker&#x2F;linker.cpp â€“&gt; find_library_internal</p><p>bionic&#x2F;linker&#x2F;linker.cpp â€“&gt; load_library</p><p>bionic&#x2F;linker&#x2F;linker.cpp â€“&gt; open_library</p><p>bionic&#x2F;linker&#x2F;linker.cpp â€“&gt; open_library_in_zipfile</p></blockquote><p>é‡ç‚¹çœ‹ <code>bionic/linker/linker.cpp --&gt; open_library_in_zipfile</code> è¿™ä¸ªå‡½æ•°ï¼Œå¯¼è‡´åŠ è½½å¤±è´¥çš„æ˜¯ä»¥ä¸‹æ¡ä»¶ <code>entry.offset % PAGE_SIZE != 0</code></p><p><a href="http://xrefandroid.com/android-9.0.0_r61/xref/bionic/linker/linker.cpp#992">http://xrefandroid.com/android-9.0.0_r61/xref/bionic/linker/linker.cpp#992</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">if</span> (entry.method != kCompressStored || (entry.offset % PAGE_SIZE) != <span class="hljs-number">0</span>) &#123;<br>    <span class="hljs-built_in">close</span>(fd);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ€»ç»“æ¥è¯´ï¼Œå°±æ˜¯ç­¾åçš„æ—¶å€™ç ´åäº†4å­—èŠ‚å¯¹é½ï¼Œå¯¼è‡´ so åŠ è½½å¤±è´¥ã€‚æ‰€ä»¥ï¼Œä»¥åç¢°åˆ°æ­¤ç±»é—®é¢˜æ—¶ï¼Œå¯ä»¥æ‰§è¡Œ<code>zipalign -c -v  4 xxx.apk</code>å…ˆçœ‹ä¸€ä¸‹æ˜¯å¦4å­—èŠ‚å¯¹é½ã€‚</p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;p&gt;ä»Šå¤©æŠŠä¸€ä¸ªapkç»™å‚å•†ç­¾ååç›´æ¥pushåˆ°æœºå™¨çš„&amp;#x2F;system&amp;#x2F;app,ç»“æœè¿è¡Œappæ—¶æ˜¾ç¤ºsoæ‰¾ä¸åˆ°ã€‚æŠ¥é”™ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt; java</summary>
        
      
    
    
    
    <category term="Android Build System" scheme="https://iwesley.top/categories/Android-Build-System/"/>
    
    
    <category term="Android" scheme="https://iwesley.top/tags/Android/"/>
    
    <category term="aospç¼–è¯‘" scheme="https://iwesley.top/tags/aosp%E7%BC%96%E8%AF%91/"/>
    
    <category term="Android.mk" scheme="https://iwesley.top/tags/Android-mk/"/>
    
    <category term="Android.bp" scheme="https://iwesley.top/tags/Android-bp/"/>
    
  </entry>
  
  <entry>
    <title>å®‰å“å¤šæ¸ é“apké…ç½®ä¸åŒç­¾å</title>
    <link href="https://iwesley.top/article/611fb416/"/>
    <id>https://iwesley.top/article/611fb416/</id>
    <published>2024-12-24T13:39:40.000Z</published>
    <updated>2024-12-29T07:06:02.588Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸€èˆ¬ç­¾åéƒ½æ˜¯æ”¾åœ¨buildTypesé‡Œé¢ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs groovy">...<br>android &#123;<br>    ...<br>    defaultConfig &#123;...&#125;<br>    signingConfigs &#123;<br>        release &#123;<br>            storeFile file(<span class="hljs-string">&quot;myreleasekey.keystore&quot;</span>)<br>            storePassword <span class="hljs-string">&quot;password&quot;</span><br>            keyAlias <span class="hljs-string">&quot;MyReleaseKey&quot;</span><br>            keyPassword <span class="hljs-string">&quot;password&quot;</span><br>        &#125;<br>    &#125;<br>    buildTypes &#123;<br>        release &#123;<br>            ...<br>            signingConfig signingConfigs.release<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯å¤šæ¸ é“æ—¶ï¼Œä½¿ç”¨é…ç½®çš„ä¼˜å…ˆçº§ä»é«˜åˆ°ä½åˆ†åˆ«æ˜¯buildTypesã€productFlavorã€defaultConfigï¼Œå¦‚æœæŒ‰ä¸Šé¢é…ç½®çš„è¯ï¼Œæ ¹æœ¬ä¿®æ”¹ä¸äº†ç­¾åã€‚æ‰€ä»¥ä¿®æ”¹æˆä»¥ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs groovy">android &#123;<br>    ...<br>    signingConfigs &#123;<br>        release &#123;<br>            storeFile file(<span class="hljs-string">&quot;myreleasekey.keystore&quot;</span>)<br>            storePassword <span class="hljs-string">&quot;password&quot;</span><br>            keyAlias <span class="hljs-string">&quot;MyReleaseKey&quot;</span><br>            keyPassword <span class="hljs-string">&quot;password&quot;</span><br>        &#125;<br>        demo &#123;<br>            storeFile file(<span class="hljs-string">&quot;myreleasekey.keystore&quot;</span>)<br>            storePassword <span class="hljs-string">&quot;password&quot;</span><br>            keyAlias <span class="hljs-string">&quot;MyReleaseKey&quot;</span><br>            keyPassword <span class="hljs-string">&quot;password&quot;</span><br>        &#125;<br>    &#125;<br>    defaultConfig &#123;<br>        signingConfig signingConfigs.release <span class="hljs-comment">//é»˜è®¤ç­¾å</span><br>    &#125;<br>    buildTypes &#123;<br>        debug&#123;<br>            signingConfig <span class="hljs-literal">null</span> <span class="hljs-comment">//è¿™é‡Œä¸€å®šè¦ç½®nullï¼Œå¦åˆ™graldeä¼šæ’å…¥é»˜è®¤ç­¾å</span><br>        &#125;<br>        release&#123;...&#125;<br>    &#125;<br>    <span class="hljs-comment">// Specifies one flavor dimension.</span><br>    flavorDimensions <span class="hljs-string">&quot;version&quot;</span><br>    productFlavors &#123;<br>        demo &#123;<br>            dimension <span class="hljs-string">&quot;version&quot;</span><br>            applicationIdSuffix <span class="hljs-string">&quot;.demo&quot;</span><br>            versionNameSuffix <span class="hljs-string">&quot;-demo&quot;</span><br>            signingConfig signingConfigs.demo <span class="hljs-comment">//æ¸ é“ç­¾å</span><br>        &#125;<br>        full &#123;<br>            dimension <span class="hljs-string">&quot;version&quot;</span><br>            applicationIdSuffix <span class="hljs-string">&quot;.full&quot;</span><br>            versionNameSuffix <span class="hljs-string">&quot;-full&quot;</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æŒ‰ä¸Šé¢é…ç½®å®Œåï¼Œæ¸ é“å¯ä»¥æŒ‰ç…§è‡ªå·±éœ€æ±‚æ›¿æ¢ç­¾åäº†ã€‚ç‰¹åˆ«æ³¨æ„debugç±»å‹é‚£é‡Œè¦ç½®<code>signingConfig null</code>ï¼Œå¦åˆ™ç¼–è¯‘debugç‰ˆæœ¬æ—¶ç­¾åä¼šä¸ç”Ÿæ•ˆï¼Œå› ä¸ºgradleä¼šæ’å…¥é»˜è®¤ç­¾åï¼Œæ›¿æ¢æ‰æ¸ é“çš„ç­¾åã€‚</p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;p&gt;ä¸€èˆ¬ç­¾åéƒ½æ˜¯æ”¾åœ¨buildTypesé‡Œé¢ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight groovy&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span</summary>
        
      
    
    
    
    <category term="AppBuild" scheme="https://iwesley.top/categories/AppBuild/"/>
    
    
    <category term="Android" scheme="https://iwesley.top/tags/Android/"/>
    
    <category term="Androidå¤šæ¸ é“" scheme="https://iwesley.top/tags/Android%E5%A4%9A%E6%B8%A0%E9%81%93/"/>
    
  </entry>
  
  <entry>
    <title>å®‰å“15é¢„ç½®ç¬¬ä¸‰æ–¹apkæ—¶ç­¾åæŠ¥é”™é—®é¢˜è§£å†³</title>
    <link href="https://iwesley.top/article/133f2b7a/"/>
    <id>https://iwesley.top/article/133f2b7a/</id>
    <published>2024-12-24T13:13:45.000Z</published>
    <updated>2024-12-29T07:06:02.588Z</updated>
    
    <content type="html"><![CDATA[<p>æœ‰åŒäº‹åé¦ˆé›†æˆapkæ—¶å®‰è£…å¤±è´¥</p><blockquote><p>PackageManager: Failed to scan &#x2F;product&#x2F;app&#x2F;test: No APK Signature Scheme v2 signature in package &#x2F;product&#x2F;app&#x2F;test&#x2F;test.apk</p></blockquote><p>æŸ¥çœ‹ç¼–è¯‘åçš„apkç­¾åä¿¡æ¯</p><blockquote><p>DOES NOT VERIFY</p><p>ERROR: JAR signer CERT.RSA: JAR signature META-INF&#x2F;CERT.SF indicates the APK is signed using APK Signature Scheme v2 but no such signature was found. Signature stripped?</p></blockquote><p>ä½†æ˜¯ç”¨å‘½ä»¤æŸ¥çœ‹æˆ‘çš„apkæ˜¯æ­£å¸¸çš„<code>apksigner  verify -v  test.apk  | grep Verified</code></p><blockquote><p>Verified using v1 scheme (JAR signing): true</p><p>Verified using v2 scheme (APK Signature Scheme v2): true</p><p>Verified using v3 scheme (APK Signature Scheme v3): false</p><p>Verified using v3.1 scheme (APK Signature Scheme v3.1): false</p><p>Verified using v4 scheme (APK Signature Scheme v4): false</p><p>Verified for SourceStamp: false</p></blockquote><p>é‚£ä¹ˆåº”è¯¥æ˜¯ç¼–è¯‘è¿‡ç¨‹åšäº†æŸäº›å˜åŠ¨ã€‚</p><h1 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•"></a>è§£å†³åŠæ³•</h1><h2 id="é€šè¿‡é¢„ç¼–è¯‘çš„æ–¹æ³•"><a href="#é€šè¿‡é¢„ç¼–è¯‘çš„æ–¹æ³•" class="headerlink" title="é€šè¿‡é¢„ç¼–è¯‘çš„æ–¹æ³•"></a>é€šè¿‡é¢„ç¼–è¯‘çš„æ–¹æ³•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java">android_app_import &#123;<br>    name: <span class="hljs-string">&quot;test&quot;</span>,<br>    apk: <span class="hljs-string">&quot;test.apk&quot;</span>,<br>    <span class="hljs-comment">// ä¿ç•™apkè‡ªå·±çš„ç­¾å</span><br>    presigned: <span class="hljs-literal">true</span>,<br>    preprocessed: <span class="hljs-literal">true</span>,<br>    <span class="hljs-comment">// æ‰“å¼€å°†æ”¾åˆ°å¯¹åº”åˆ†åŒºç›®å½•çš„priv-appæ–‡ä»¶å¤¹ä¸‹</span><br>    <span class="hljs-comment">// privileged: true,</span><br>    <span class="hljs-comment">// æ‰“å¼€å°†æ”¾åˆ°system_extåˆ†åŒº</span><br>    <span class="hljs-comment">// system_ext_specific: true,</span><br>    <span class="hljs-comment">// æ‰“å¼€å°†æ”¾åˆ°productåˆ†åŒº</span><br>    <span class="hljs-comment">// product_specific: true,</span><br>    <span class="hljs-comment">// æ‰“å¼€å°†æ”¾åˆ°vendoråˆ†åŒº</span><br>    <span class="hljs-comment">// proprietary: true,</span><br>    <span class="hljs-comment">// odmåˆ†åŒº</span><br>    <span class="hljs-comment">// device_specific: true</span><br>    <span class="hljs-comment">// apkä¼˜åŒ–ï¼Œå†…ç½®ä¸‰æ–¹apkæ—¶å»ºè®®å…³é—­</span><br>    dex_preopt: &#123;<br>        enabled: <span class="hljs-literal">false</span>,<br>    &#125;,<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨å®‰å“15ä¸Šæ–°å¢äº†<a href="http://xrefandroid.com/android-15.0.0_r1/xref/build/soong/java/app_import.go#376">app_import.go - OpenGrok cross reference for &#x2F;build&#x2F;soong&#x2F;java&#x2F;app_import.go</a></p><p>validatePresignedApkæ£€æµ‹</p><p>å¦‚æœåŠ äº†presignedï¼Œä½†ä¸åŠ preprocessedï¼ŒåŒæ—¶targetSdkå¤§äºç­‰äº30å°±ä¼šç¼–è¯‘æŠ¥é”™ï¼Œæ›´åŠ æ–¹ä¾¿å¼€å‘è€…å®šä½é—®é¢˜ï¼š</p><blockquote><p>[100% 5&#x2F;5 0s remaining] Check presigned apkFAILED: out&#x2F;soong&#x2F;.intermediates&#x2F;packages&#x2F;test&#x2F;test&#x2F;android_common&#x2F;validated-prebuilt&#x2F;check.stampbuild&#x2F;soong&#x2F;scripts&#x2F;check_prebuilt_presigned_apk.py â€“aapt2 out&#x2F;host&#x2F;linux-x86&#x2F;bin&#x2F;aapt2 â€“zipalign out&#x2F;host&#x2F;linux-x86&#x2F;bin&#x2F;zipalign packages&#x2F;test&#x2F;test.apk out&#x2F;soong&#x2F;.intermediates&#x2F;packages&#x2F;test&#x2F;test&#x2F;android_common&#x2F;validated-prebuilt&#x2F;check.stamppackages&#x2F;test&#x2F;test.apk: Prebuilt, presigned apks with targetSdkVersion &gt;&#x3D; 30 (or a codename targetSdkVersion) must set <strong>preprocessed: true</strong> in the Android.bp definition (because they must be signed with signature v2, and the build system would wreck that signature otherwise)</p></blockquote><p>å¦å¤–apké‡Œé¢çš„soä¸èƒ½å‹ç¼©ï¼Œå¦åˆ™ä¼šæŠ¥é”™</p><blockquote><p>FAILED: out&#x2F;soong&#x2F;.intermediates&#x2F;packages&#x2F;test&#x2F;test&#x2F;android_common&#x2F;validated-prebuilt&#x2F;check.stamp</p><p>build&#x2F;soong&#x2F;scripts&#x2F;check_prebuilt_presigned_apk.py â€“aapt2 out&#x2F;host&#x2F;linux-x86&#x2F;bin&#x2F;aapt2 â€“zipalign out&#x2F;host&#x2F;linux-x86&#x2F;bin&#x2F;zipalign â€“preprocessed packages&#x2F;test&#x2F;test.apk out&#x2F;soong&#x2F;.intermediates&#x2F;packages&#x2F;test&#x2F;test&#x2F;android_common&#x2F;validated-prebuilt&#x2F;check.stamp</p><p>packages&#x2F;test&#x2F;test.apk: <strong>Contains compressed JNI libraries</strong></p></blockquote><p>å› ä¸ºå®‰å“6å¼€å§‹æ”¯æŒç›´æ¥åŠ è½½apké‡Œé¢çš„soï¼Œå¦‚æœå‹ç¼©çš„è¯ï¼Œé¢„ç¼–è¯‘ä¼šåœ¨apkå†…éƒ¨è¿›è¡Œè§£å‹ï¼Œé‚£ä¹ˆå°±ä¼šç ´åapkç­¾åã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2023/202412242117760.png" alt="img"></p><p>å…¶å®ï¼Œå¦‚æœapkçš„minSdkVersion &gt;&#x3D; 23 å¹¶ä¸” Android Gradle plugin &gt;&#x3D; 3.6.0æƒ…å†µä¸‹ï¼Œæ‰“åŒ…æ—¶android:extractNativeLibs&#x3D;falseï¼Œapkçš„soé»˜è®¤æ˜¯ä¸å‹ç¼©çš„ã€‚</p><p>åœ¨minSdkVersion &lt; 23 æˆ– Android Gradle plugin &lt; 3.6.0æƒ…å†µä¸‹ï¼Œæ‰“åŒ…æ—¶ android:extractNativeLibs&#x3D;trueï¼Œapkçš„soé»˜è®¤æ˜¯å‹ç¼©çš„ã€‚</p><p>å‚è€ƒï¼š<a href="https://juejin.cn/post/6943920550125420558">https://juejin.cn/post/6943920550125420558</a></p><p><a href="https://blog.csdn.net/yzyeilin/article/details/139968840">Android13è§£å†³android_app_importå†…ç½®ç¬¬ä¸‰æ–¹APKå®‰è£…å¤±è´¥é—®é¢˜_but no such signature was found. signature strippe-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/chuyouyinghe/article/details/131001532">æµ…è°ˆextractNativeLibs</a></p><h2 id="é€šè¿‡ç›´æ¥æ‹·è´çš„æ–¹æ³•"><a href="#é€šè¿‡ç›´æ¥æ‹·è´çš„æ–¹æ³•" class="headerlink" title="é€šè¿‡ç›´æ¥æ‹·è´çš„æ–¹æ³•"></a>é€šè¿‡ç›´æ¥æ‹·è´çš„æ–¹æ³•</h2><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/wangwei6227/article/details/123727372">https://blog.csdn.net/wangwei6227/article/details/123727372</a></p><p>åŒæ ·è¦æ³¨æ„apk soçš„å‹ç¼©é—®é¢˜ï¼Œå¦‚æœæ˜¯å‹ç¼©è¿‡çš„ï¼Œå¿…é¡»æå–å‡ºæ¥ï¼Œå¹¶æ‹·è´åˆ°apkæœºå™¨ç›®å½•ã€‚</p><h2 id="å¯èƒ½é‡åˆ°çš„selinuxæƒé™é—®é¢˜"><a href="#å¯èƒ½é‡åˆ°çš„selinuxæƒé™é—®é¢˜" class="headerlink" title="å¯èƒ½é‡åˆ°çš„selinuxæƒé™é—®é¢˜"></a>å¯èƒ½é‡åˆ°çš„selinuxæƒé™é—®é¢˜</h2><blockquote><p>01-01 12:00:39.520000  5326  5326 W om.skype.raider: type&#x3D;1400 audit(0.0:64): avc: denied { read } for name&#x3D;â€libSkypeAndroid.soâ€ dev&#x3D;â€mmcblk0p22â€ ino&#x3D;770074 scontext&#x3D;u:r:untrusted_app:s0:c512,c768 tcontext&#x3D;u:object_r:system_data_file:s0 tclass&#x3D;file permissive&#x3D;0</p></blockquote><p>#&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; untrusted_app.te &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</p><p>allow untrusted_app system_data_file:file r_file_perms;</p><p>å‚è€ƒï¼š<a href="https://www.codeleading.com/article/6471686269/">é‡‡ç”¨Signature Scheme v2ç­¾åæ–¹å¼çš„APKé¢„ç½®å¤±è´¥ </a></p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;p&gt;æœ‰åŒäº‹åé¦ˆé›†æˆapkæ—¶å®‰è£…å¤±è´¥&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;PackageManager: Failed to scan &amp;#x2F;product&amp;#x2F;app&amp;#x2F;test: No APK Signature Scheme v2</summary>
        
      
    
    
    
    <category term="Android Build System" scheme="https://iwesley.top/categories/Android-Build-System/"/>
    
    
    <category term="Android" scheme="https://iwesley.top/tags/Android/"/>
    
    <category term="aospç¼–è¯‘" scheme="https://iwesley.top/tags/aosp%E7%BC%96%E8%AF%91/"/>
    
    <category term="Android.mk" scheme="https://iwesley.top/tags/Android-mk/"/>
    
    <category term="Android.bp" scheme="https://iwesley.top/tags/Android-bp/"/>
    
  </entry>
  
  <entry>
    <title>å’ªå’•è§†é¢‘DLNAæŠ•å±è·³é›†é—®é¢˜åˆ†æ</title>
    <link href="https://iwesley.top/article/73728aea/"/>
    <id>https://iwesley.top/article/73728aea/</id>
    <published>2024-12-08T12:08:50.000Z</published>
    <updated>2024-12-24T12:51:46.756Z</updated>
    
    <content type="html"><![CDATA[<p>QAåœ¨æµ‹è¯•å…¬å¸æŠ•å±åº”ç”¨æ—¶ï¼Œå‘ç°å’ªå’•è§†é¢‘DLNAæŠ•å‰§é›†æ—¶æœ‰æ—¶å€™ä¼šè·³è¿‡ä¸€é›†ç›´æ¥æ’­ä¸‹ä¸€é›†çš„é—®é¢˜ã€‚</p><p>å°è¯•è‡ªè¡Œåˆ†æè§£å†³ä¸äº†åï¼Œæˆ‘å†³å®šåˆ†æä¸€ä¸‹ç«å“åº”ç”¨ï¼šå½“è´æŠ•å±ï¼Œç»“æœå‘ç°å®ƒæ˜¯æ­£å¸¸çš„ã€‚ç”±äºå½“è´æŠ•å±æ˜¯ä¸ªé»‘ç›’å­ï¼Œæ‰€ä»¥å†³å®šæŠ“åŒ…çœ‹ä¸€ä¸‹ã€‚</p><p><a href="https://www.androidtcpdump.com/android-tcpdump/downloads">Android tcpdump</a></p><p><code>tcpdump tcp -i any -p -s 0 -w /sdcard/capture.pcap</code></p><h2 id="å½“è´æŠ•å±æŠ“åŒ…åˆ†æ"><a href="#å½“è´æŠ•å±æŠ“åŒ…åˆ†æ" class="headerlink" title="å½“è´æŠ•å±æŠ“åŒ…åˆ†æ"></a>å½“è´æŠ•å±æŠ“åŒ…åˆ†æ</h2><p>è¿è¡Œå‘½ä»¤åå¼€å§‹æŠ•å‰§é›†åˆ°å½“è´æŠ•å±å¹¶é€šè¿‡è¿›åº¦æ¡æ“ä½œè§¦å‘åˆ‡é›†ï¼ŒæŠŠæŠ“åŒ…æ–‡ä»¶adb pullå‡ºæ¥æ”¾åˆ°WireSharkå»åˆ†æã€‚</p><p>ç”±äºDLNAå»ºè¿åçš„å‘½ä»¤äº¤äº’æ˜¯é€šè¿‡httpçš„ï¼Œæ‰€ä»¥è¿™é‡Œåªæ˜¾ç¤ºhttpåè®®ï¼Œå¹¶é€šè¿‡æœç´¢SetAVTransportURIå®šä½åˆ°æŠ•å±æ—¶é—´ç‚¹ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2023/202412082026499-wireshark.jpg" alt="img_v3_02h8_65bf3dab-7966-48b1-bdaa-8343bca7898g"></p><p>é¦–å…ˆçœ‹ä¸€ä¸‹å³å°†åˆ‡é›†å‰æ‰‹æœºç«¯è·å–åˆ°çš„ä¿¡æ¯ï¼š</p><p>å¯ä»¥çœ‹åˆ°å½±ç‰‡çš„æ—¶é•¿å’Œè¿›åº¦éƒ½æœ‰å€¼ï¼Œå¿«æ’­å®Œäº†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2023/202412082039758-wireshark.jpg" alt="img_v3_02h8_fe3604f0-5242-41b8-b950-fab2c62663dg"></p><p>åˆ‡é›†æ—¶ï¼š</p><p>æ‰‹æœºç«¯è·å–åˆ°çš„æ’­æ”¾çŠ¶æ€æ˜¯stoppedï¼Œå½±ç‰‡æ—¶é•¿å’Œè¿›åº¦éƒ½æ˜¯0</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2023/202412082042875.jpg" alt="img_v3_02h8_954cb5c2-08c9-47ec-8d47-0c14b51b600g"></p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2023/202412082041740.jpg" alt="img_v3_02h8_613904b8-aa1e-4128-b904-164ff238ed3g"></p><p>åˆ‡é›†åï¼š</p><p>æ‰‹æœºç«¯è·å–çš„ä¿¡æ¯æ­£å¸¸</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2023/202412082044535.jpg" alt="img_v3_02h8_f8a5dc01-ae9d-47d8-9abc-0a395a68bd8g"></p><h2 id="æˆ‘å¸æŠ•å±æŠ“åŒ…åˆ†æ"><a href="#æˆ‘å¸æŠ•å±æŠ“åŒ…åˆ†æ" class="headerlink" title="æˆ‘å¸æŠ•å±æŠ“åŒ…åˆ†æ"></a>æˆ‘å¸æŠ•å±æŠ“åŒ…åˆ†æ</h2><p>åˆ‡é›†å‰ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2023/202412082045162.jpg" alt="img_v3_02h8_ef543816-16f1-4e55-a74b-e703ef21e46g"></p><p>åˆ‡é›†åï¼š</p><p>è·å–åˆ°çš„å½±ç‰‡è¿›åº¦å’Œæ—¶é•¿éƒ½æ˜¯ä¸Šä¸ªè§†é¢‘çš„ä¿¡æ¯ï¼Œå¯¼è‡´å’ªå’•äº§ç”Ÿäº†è¯¯åˆ¤æ–­ï¼Œè®¤ä¸ºè¿™ä¸€é›†ä¹Ÿæ’­å®Œäº†ï¼Œé€ æˆè·³é›†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2023/202412082045275.jpg" alt="img_v3_02h8_dac2eede-52f2-4137-8b42-18b7081eaaeg"></p><h2 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h2><p>æ”¶åˆ°æ‰‹æœºç«¯çš„stopæŒ‡ä»¤åï¼Œç«‹å³å°†æ’­æ”¾çŠ¶æ€ç½®stoppedï¼ŒåŒæ—¶å°†å½±ç‰‡æ—¶é•¿å’Œè¿›åº¦ä¹Ÿç½®0ã€‚æ­¤å¤–ï¼Œè¿˜è¦æ‹¦æˆªæ’­æ”¾å™¨åˆ°æ‰‹æœºç«¯çš„çŠ¶æ€åŒæ­¥ç›´åˆ°æ–°çš„è§†é¢‘èµ·æ’­ã€‚</p><p>å¦å¤–è¿˜è¦æ³¨æ„å¤„ç†çº¿ç¨‹è°ƒåº¦å»¶è¿Ÿçš„é—®é¢˜ï¼Œå¦‚æœstopæŒ‡ä»¤å’ŒsetUriæŒ‡ä»¤å‘é€æ—¶é—´æ¯”è¾ƒæ¥è¿‘ï¼Œè™½ç„¶çœ‹èµ·æ¥æ˜¯stopåœ¨å‰ï¼ŒsetUriåœ¨åï¼Œä½†å¦‚æœæ˜¯åœ¨ä¸åŒçº¿ç¨‹å›è°ƒä¸Šæ¥çš„ï¼Œå¯èƒ½å­˜åœ¨setUriå…ˆæ‰§è¡Œçš„æƒ…å†µï¼Œè¦æ³¨æ„å¤„ç†è¿™ç§æƒ…å†µï¼Œé¿å…è¯¯é€€å‡ºã€‚</p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;p&gt;QAåœ¨æµ‹è¯•å…¬å¸æŠ•å±åº”ç”¨æ—¶ï¼Œå‘ç°å’ªå’•è§†é¢‘DLNAæŠ•å‰§é›†æ—¶æœ‰æ—¶å€™ä¼šè·³è¿‡ä¸€é›†ç›´æ¥æ’­ä¸‹ä¸€é›†çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;å°è¯•è‡ªè¡Œåˆ†æè§£å†³ä¸äº†åï¼Œæˆ‘å†³å®šåˆ†æä¸€ä¸‹ç«å“åº”ç”¨ï¼šå½“è´æŠ•å±ï¼Œç»“æœå‘ç°å®ƒæ˜¯æ­£å¸¸çš„ã€‚ç”±äºå½“è´æŠ•å±æ˜¯ä¸ªé»‘ç›’å­ï¼Œæ‰€ä»¥å†³å®šæŠ“åŒ…çœ‹ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a</summary>
        
      
    
    
    
    <category term="æŠ•å±" scheme="https://iwesley.top/categories/%E6%8A%95%E5%B1%8F/"/>
    
    
    <category term="æŠ•å±" scheme="https://iwesley.top/tags/%E6%8A%95%E5%B1%8F/"/>
    
    <category term="DLNA" scheme="https://iwesley.top/tags/DLNA/"/>
    
  </entry>
  
  <entry>
    <title>Android.mkåŸºç¡€çŸ¥è¯†</title>
    <link href="https://iwesley.top/article/eaba12cd/"/>
    <id>https://iwesley.top/article/eaba12cd/</id>
    <published>2024-11-17T11:11:07.000Z</published>
    <updated>2024-12-24T12:51:46.755Z</updated>
    
    <content type="html"><![CDATA[<p>Android æµ…åº¦è§£æï¼šmké¢„ç½®AARã€SOæ–‡ä»¶ã€APPåŒ…å’Œç­¾å-é˜¿é‡Œäº‘å¼€å‘è€…ç¤¾åŒº: <a href="https://developer.aliyun.com/article/1488469">https://developer.aliyun.com/article/1488469</a></p><p>androidç³»ç»Ÿæ·»åŠ é¢„ç½®APPï¼ˆsoåº“è‡ªåŠ¨é‡Šæ”¾) - åºšæ‹“å¤©ä¸‹ - åšå®¢å›­: <a href="https://www.cnblogs.com/genggeng/p/10563585.html">https://www.cnblogs.com/genggeng/p/10563585.html</a></p><p>ä½¿ç”¨@ç¬¦å·å’Œä¸ä½¿ç”¨@ç¬¦å·çš„åŒºåˆ«<br>åœ¨Android.mkä¸­ï¼Œä½¿ç”¨@ç¬¦å·å’Œä¸ä½¿ç”¨@ç¬¦å·æœ‰ä¸€äº›åŒºåˆ«ï¼š<br>? ä½¿ç”¨@ç¬¦å·å¯ä»¥æé«˜æ€§èƒ½ï¼Œå› ä¸ºä¸éœ€è¦è§£å‹å’Œæ‹·è´SOæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥èŠ‚çœç©ºé—´ï¼Œå› ä¸ºä¸éœ€è¦å­˜å‚¨å¤šä½™çš„SOæ–‡ä»¶ã€‚<br>? ä¸ä½¿ç”¨@ç¬¦å·å¯ä»¥æé«˜å…¼å®¹æ€§ï¼Œå› ä¸ºå¯ä»¥é’ˆå¯¹ä¸åŒçš„å¹³å°æä¾›ç›¸åº”çš„SOæ–‡ä»¶ï¼Œè€Œä¸éœ€è¦è€ƒè™‘APKä¸­æ˜¯å¦æœ‰å¯¹åº”å¹³å°çš„SOæ–‡ä»¶ã€‚</p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;p&gt;Android æµ…åº¦è§£æï¼šmké¢„ç½®AARã€SOæ–‡ä»¶ã€APPåŒ…å’Œç­¾å-é˜¿é‡Œäº‘å¼€å‘è€…ç¤¾åŒº: &lt;a</summary>
        
      
    
    
    
    <category term="Android Build System" scheme="https://iwesley.top/categories/Android-Build-System/"/>
    
    
    <category term="å®‰å“Makefile" scheme="https://iwesley.top/tags/%E5%AE%89%E5%8D%93Makefile/"/>
    
  </entry>
  
  <entry>
    <title>Android APP drawableä¸åŒæ–‡ä»¶å¤¹çš„ç”¨æ³•</title>
    <link href="https://iwesley.top/article/b1dcee32/"/>
    <id>https://iwesley.top/article/b1dcee32/</id>
    <published>2024-11-17T10:33:19.000Z</published>
    <updated>2025-01-04T13:32:28.888Z</updated>
    
    <content type="html"><![CDATA[<p>Screen compatibility: <a href="https://developer.android.com/guide/practices/screens_support.html">https://developer.android.com/guide/practices/screens_support.html</a></p><p>App resources: <a href="https://developer.android.com/guide/topics/resources/providing-resources.html#AlternativeResources">https://developer.android.com/guide/topics/resources/providing-resources.html#AlternativeResources</a></p><p>Support different pixel densities: <a href="https://developer.android.com/training/multiscreen/screendensities">https://developer.android.com/training/multiscreen/screendensities</a></p><p>Drawable resources : <a href="https://developer.android.com/guide/topics/resources/drawable-resource">https://developer.android.com/guide/topics/resources/drawable-resource</a></p><p>res&#x2F;drawable&#x2F; is a legacy synonym for res&#x2F;drawable-mdpi&#x2F;, indicating that the drawables in that directory are set for mdpi density. If the device is running another density, those images will be downsampled (to ldpi) or upsampled (to anything else) to match the device density.</p><p>res&#x2F;drawable-nodpi&#x2F; says â€œthese drawables should not be resampled for any density, but instead should be used as-is on all densitiesâ€.</p><p>drawable-nodpi will bypass scaling and drawable will use the default scaling:</p><p>mdpi &#x3D; 1x<br>hdpi &#x3D; 1.5x<br>xhdpi &#x3D; 2x<br>xxhdpi &#x3D; 3x<br>xxxhdpi &#x3D; 4x<br>drawable-nodpi is efficient if your code will be doing its own scaling (or no scaling) and you donâ€™t want the image pre-scaled by Android.</p><p>There is also drawable-anydpi, just to make things more confusing.</p><p>drawable with no specifications will be used if an exact match on density and screen specifications does not exist. drawable-nodpi will be used after drawable.</p><p>UPDATE If you have both drawable and drawble-nodpi, the select order is either a more complex rule not documented or Android is broken. Through experimentation I confirmed that devices with screen density &lt; xhdpi will correctly select the drawable image. Devices with screen density &gt;&#x3D; xhdpi will select the drawable-nodpi.</p><p>Selection rule: 1. Pick match to screen density, one of these:</p><p>drawable-ldpi<br>drawable-mdpi<br>drawable-hdpi<br>drawable-xhdpi<br>drawable-xxhdpi<br>drawable-xxxhdpi<br>If no match on density, then select one of these<br>drawable (automatic scaling mdpi&#x3D;noneâ€¦ xxxhdpi&#x3D;4x)<br>drawable-nodpi (no scaling)<br>drawable-tvdpi<br>drawable-anydpi (no scaling)</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>android - Will a density qualified drawable folder or drawable-nodpi take precedence? - Stack Overflow: <a href="https://stackoverflow.com/questions/24682094/will-a-density-qualified-drawable-folder-or-drawable-nodpi-take-precedence">https://stackoverflow.com/questions/24682094/will-a-density-qualified-drawable-folder-or-drawable-nodpi-take-precedence</a></p><p>android - What is the difference between putting images in drawable and drawable-nodpi folder? - Stack Overflow: <a href="https://stackoverflow.com/questions/33631995/what-is-the-difference-between-putting-images-in-drawable-and-drawable-nodpi-fol">https://stackoverflow.com/questions/33631995/what-is-the-difference-between-putting-images-in-drawable-and-drawable-nodpi-fol</a></p><p>ç©è½¬Android drawableå›¾ç‰‡é€‚é… - æ¼«æ€ - åšå®¢å›­: <a href="https://www.cnblogs.com/sexintercourse/p/17020569.html">https://www.cnblogs.com/sexintercourse/p/17020569.html</a></p><p>Android é€‚é…ï¼ˆdrawableæ–‡ä»¶å¤¹ï¼‰å›¾ç‰‡é€‚é…ï¼ˆäºŒï¼‰ - å¼ äºšæ¥  - åšå®¢å›­: <a href="https://www.cnblogs.com/huihuizhang/p/9473698.html">https://www.cnblogs.com/huihuizhang/p/9473698.html</a></p><p>androidï¼ˆdrawableæ–‡ä»¶å¤¹ï¼‰å›¾ç‰‡é€‚é…_drawableæ˜¯ä»€ä¹ˆæ–‡ä»¶-CSDNåšå®¢: <a href="https://blog.csdn.net/xuaho0907/article/details/72848520#:~:text=%E5%A6%82%E6%9E%9C%E5%9B%BE%E7%89%87%E6%89%80%E5%9C%A8%E7%9B%AE%E5%BD%95%E4%B8%BA,%E5%9B%BE%E7%89%87%E5%A4%A7%E5%B0%8F%EF%BC%8C%E4%B8%8D%E8%BF%9B%E8%A1%8C%E7%BC%A9%E6%94%BE%E3%80%82&text=drawable%2Dnodpi%E6%96%87%E4%BB%B6%E5%A4%B9%EF%BC%8C%E8%BF%99%E4%B8%AA,%E5%B0%B1%E4%BC%9A%E5%AE%9E%E9%99%85%E5%B1%95%E7%A4%BA%E5%A4%9A%E5%A4%A7%E3%80%82">https://blog.csdn.net/xuaho0907/article/details/72848520#:~:text=%E5%A6%82%E6%9E%9C%E5%9B%BE%E7%89%87%E6%89%80%E5%9C%A8%E7%9B%AE%E5%BD%95%E4%B8%BA,%E5%9B%BE%E7%89%87%E5%A4%A7%E5%B0%8F%EF%BC%8C%E4%B8%8D%E8%BF%9B%E8%A1%8C%E7%BC%A9%E6%94%BE%E3%80%82&amp;text=drawable%2Dnodpi%E6%96%87%E4%BB%B6%E5%A4%B9%EF%BC%8C%E8%BF%99%E4%B8%AA,%E5%B0%B1%E4%BC%9A%E5%AE%9E%E9%99%85%E5%B1%95%E7%A4%BA%E5%A4%9A%E5%A4%A7%E3%80%82</a></p><p>AndroidçŸ¥è¯†ä½“ç³»ä¹‹drawableæ–‡ä»¶å¤¹é¡ºåº - ä½œä¸šéƒ¨è½ Cmd Markdown ç¼–è¾‘é˜…è¯»å™¨: <a href="https://www.zybuluo.com/TryLoveCatch/note/590965">https://www.zybuluo.com/TryLoveCatch/note/590965</a></p><p>Android drawableæ–‡ä»¶å¤¹é‚£äº›äº‹_å®‰å“drawableæ–‡ä»¶å¤¹çš„ä½œç”¨-CSDNåšå®¢: <a href="https://blog.csdn.net/qq_34341338/article/details/86706751">https://blog.csdn.net/qq_34341338/article/details/86706751</a></p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;p&gt;Screen compatibility: &lt;a</summary>
        
      
    
    
    
    <category term="å®‰å“APP" scheme="https://iwesley.top/categories/%E5%AE%89%E5%8D%93APP/"/>
    
    
    <category term="Android" scheme="https://iwesley.top/tags/Android/"/>
    
    <category term="AndroidAPPUI" scheme="https://iwesley.top/tags/AndroidAPPUI/"/>
    
  </entry>
  
  <entry>
    <title>Android ADB å¸¸ç”¨å‘½ä»¤</title>
    <link href="https://iwesley.top/article/dfa112ac/"/>
    <id>https://iwesley.top/article/dfa112ac/</id>
    <published>2024-11-17T10:27:15.000Z</published>
    <updated>2025-01-19T09:08:40.979Z</updated>
    
    <content type="html"><![CDATA[<h2 id="toyboxå’Œbusybox"><a href="#toyboxå’Œbusybox" class="headerlink" title="toyboxå’Œbusybox"></a>toyboxå’Œbusybox</h2><p><a href="https://blog.csdn.net/weixin_44311012/article/details/130203207">toybox å’Œ busybox çš„ä½œç”¨</a></p><p>am monitor  å¯ä»¥æŒç»­ç›‘æ§Appçš„åŒ…åï¼Œå½“åˆ‡æ¢åº”ç”¨æ—¶ï¼Œå¦‚æœåŒ…åæœ‰å˜åŒ–ï¼Œå°±ä¼šåœ¨ç»ˆç«¯è¾“å‡º</p><h2 id="Audio"><a href="#Audio" class="headerlink" title="Audio"></a>Audio</h2><p>æŸ¥çœ‹audioçš„å…¨éƒ¨ä¿¡æ¯ï¼ˆå„éŸ³é¢‘æµéŸ³é‡ï¼Œç„¦ç‚¹ï¼Œç­–ç•¥ç­‰ï¼‰</p><p>dumpsys audio</p><h3 id="éŸ³é‡"><a href="#éŸ³é‡" class="headerlink" title="éŸ³é‡"></a>éŸ³é‡</h3><h4 id="æŒ‰é”®æ–¹å¼"><a href="#æŒ‰é”®æ–¹å¼" class="headerlink" title="æŒ‰é”®æ–¹å¼"></a>æŒ‰é”®æ–¹å¼</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">å¢åŠ </span><br>input keyevent 24<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">å‡å°‘</span><br>input keyevent 25<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">é™éŸ³</span><br>input keyevent 164<br></code></pre></td></tr></table></figure><h4 id="mediaå‘½ä»¤"><a href="#mediaå‘½ä»¤" class="headerlink" title="mediaå‘½ä»¤"></a>mediaå‘½ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">è®¾ç½®éŸ³é‡å¹¶ä¸”æ˜¾ç¤ºéŸ³é‡UI</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">3 ä»£è¡¨STREAM_SYSTEM</span><br>media volume --show --stream 3 --set 11 <br>media volume --show --stream 3 --adj raise<br>media volume --show --stream 0 --adj lower<br>media volume --show --stream 3 --get<br><span class="hljs-meta prompt_">#</span><span class="language-bash">æ§åˆ¶æ’­æ”¾æš‚åœ</span><br>media dispatch play<br>media dispatch pause<br></code></pre></td></tr></table></figure><p>å®‰å“ 11 å¼€å§‹ media å‘½ä»¤æ²¡æœ‰äº†ï¼Œä½¿ç”¨<code>cmd media_session</code> </p><p><code>cmd media_session  volume  --stream 3 --get</code></p><p><code>cmd media_session  volume --show --stream 3 --set 11</code></p><h4 id="å…¶ä»–æ–¹æ³•"><a href="#å…¶ä»–æ–¹æ³•" class="headerlink" title="å…¶ä»–æ–¹æ³•"></a>å…¶ä»–æ–¹æ³•</h4><p><code>service call audio</code></p><p><code>adb shell service call audio 9 i32 &lt;ç¼–å·&gt; i32 &lt;ç±»å‹&gt; i32 1</code></p><p>ä½¿ç”¨ADBè°ƒæ•´Androidè®¾å¤‡éŸ³é‡åŠè§£å†³å¸¸è§é—®é¢˜-CSDNåšå®¢: <a href="https://blog.csdn.net/run068/article/details/122824920">https://blog.csdn.net/run068/article/details/122824920</a></p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h2 id=&quot;toyboxå’Œbusybox&quot;&gt;&lt;a href=&quot;#toyboxå’Œbusybox&quot; class=&quot;headerlink&quot; title=&quot;toyboxå’Œbusybox&quot;&gt;&lt;/a&gt;toyboxå’Œbusybox&lt;/h2&gt;&lt;p&gt;&lt;a</summary>
        
      
    
    
    
    <category term="Androidè°ƒè¯•ç›¸å…³" scheme="https://iwesley.top/categories/Android%E8%B0%83%E8%AF%95%E7%9B%B8%E5%85%B3/"/>
    
    
    <category term="Android" scheme="https://iwesley.top/tags/Android/"/>
    
  </entry>
  
  <entry>
    <title>Android APPç»„ä»¶åŒ–</title>
    <link href="https://iwesley.top/article/69eef408/"/>
    <id>https://iwesley.top/article/69eef408/</id>
    <published>2024-11-17T09:58:13.000Z</published>
    <updated>2024-12-24T12:51:46.755Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰å¯¼çŸ¥è¯†"><a href="#å‰å¯¼çŸ¥è¯†" class="headerlink" title="å‰å¯¼çŸ¥è¯†"></a>å‰å¯¼çŸ¥è¯†</h2><p>é…ç½® build å˜ä½“ ?|? Android Studio ?|? Android Developers: <a href="https://developer.android.com/build/build-variants?hl=zh-cn#groovy">https://developer.android.com/build/build-variants?hl=zh-cn#groovy</a></p><p>Androidæ¨¡å—åŒ–ä¹‹MicroModuleï¼ˆå¾®ä¿¡Pinså·¥ç¨‹ï¼‰ç›¸ä¿¡ä½ çœ‹è¿‡å¾®ä¿¡å…³äºæ¨¡å—åŒ–çš„åˆ†äº«ã€Šå¾®ä¿¡Androidæ¨¡å—åŒ– - æ˜é‡‘: <a href="https://juejin.cn/post/6844903647956959246?from=search-suggest">https://juejin.cn/post/6844903647956959246?from=search-suggest</a></p><p>æ€ä¹ˆå®ç°å¾®ä¿¡Android Pinså·¥ç¨‹ç»“æ„ï¼ŸPinså·¥ç¨‹ç»“æ„æ˜¯ä»€ä¹ˆï¼Ÿ å¦‚ä½•åšä»£ç è¾¹ç•Œæ£€æŸ¥ï¼Ÿ - æ˜é‡‘: <a href="https://juejin.cn/post/6844903602645893128">https://juejin.cn/post/6844903602645893128</a></p><p>å¾®ä¿¡Androidæ¨¡å—åŒ–æ¶æ„é‡æ„å®è·µ: <a href="https://mp.weixin.qq.com/s/6Q818XA5FaHd7jJMFBG60w">https://mp.weixin.qq.com/s/6Q818XA5FaHd7jJMFBG60w</a></p><p>ç¾å›¢å¤–å–Androidå¹³å°åŒ–æ¶æ„æ¼”è¿›å®è·µ - ç¾å›¢æŠ€æœ¯å›¢é˜Ÿ: <a href="https://tech.meituan.com/2018/03/16/meituan-food-delivery-android-architecture-evolution.html">https://tech.meituan.com/2018/03/16/meituan-food-delivery-android-architecture-evolution.html</a></p><p>Androidæ¶ˆæ¯æ€»çº¿çš„æ¼”è¿›ä¹‹è·¯ï¼šç”¨LiveDataBusæ›¿ä»£RxBusã€EventBus - ç¾å›¢æŠ€æœ¯å›¢é˜Ÿ: <a href="https://tech.meituan.com/2018/07/26/android-livedatabus.html">https://tech.meituan.com/2018/07/26/android-livedatabus.html</a></p><p>Androidç»„ä»¶åŒ–æ–¹æ¡ˆåŠç»„ä»¶æ¶ˆæ¯æ€»çº¿modular-eventå®æˆ˜ - ç¾å›¢æŠ€æœ¯å›¢é˜Ÿ: <a href="https://tech.meituan.com/2018/12/20/modular-event.html">https://tech.meituan.com/2018/12/20/modular-event.html</a></p><p>åˆ›å»º Android åº“ ?|? Android Studio ?|? Android Developers: <a href="https://developer.android.com/studio/projects/android-library?hl=zh-cn">https://developer.android.com/studio/projects/android-library?hl=zh-cn</a></p><p>æ·»åŠ  build ä¾èµ–é¡¹ ?|? Android Studio ?|? Android Developers: <a href="https://developer.android.com/build/dependencies?hl=zh-cn">https://developer.android.com/build/dependencies?hl=zh-cn</a></p><p>é«˜çº§æµ‹è¯•è®¾ç½® ?|? Android Studio ?|? Android Developers: <a href="https://developer.android.com/studio/test/advanced-test-setup?hl=zh-cn#create-instrumented-test-for-build-variant">https://developer.android.com/studio/test/advanced-test-setup?hl=zh-cn#create-instrumented-test-for-build-variant</a></p><p>Andriod å¤šæ¸ é“åˆ†åŒ…ï¼Œå®ç”¨çš„moduleåˆ†å±‚ï¼Œå¼€å‘ä»£ç æ··æ·†è§„Andriod studio 3.0 æœ‰å¿…è¦é‡æ–°å­¦ä¹ æ›´ - æ˜é‡‘: <a href="https://juejin.cn/post/6844903518411702286">https://juejin.cn/post/6844903518411702286</a> ï¼ˆæ··æ·†è§„åˆ™ï¼‰</p><h2 id="èµ„æºå†²çª"><a href="#èµ„æºå†²çª" class="headerlink" title="èµ„æºå†²çª"></a>èµ„æºå†²çª</h2><p>Android ç»„ä»¶èµ„æºè¦†ç›–å†²çªè§£å†³æ–¹æ¡ˆåœ¨ Android çš„æ—¥å¸¸å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨åˆ°å¤§é‡çš„ç¬¬ä¸‰æ–¹åº“æˆ–è€…è‡ªå·±ç¼–å†™çš„ç»„ä»¶åº“ - æ˜é‡‘: <a href="https://juejin.cn/post/6844903993894780942">https://juejin.cn/post/6844903993894780942</a></p><p><a href="https://github.com/hust201010701/CheckResourceConflict">https://github.com/hust201010701/CheckResourceConflict</a></p><p>Android Gradle Plugin 3.3 ç‰ˆæœ¬åŠå…¶ä»¥ä¸Šï¼Œæä¾›äº†ä¸€ä¸ª API å¯ä»¥è·å–ç¼–è¯‘æ‰€æœ‰çš„èµ„æºæ–‡ä»¶ã€‚</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs groovy">variants.forEach &#123; variant -&gt;<br>    variant <span class="hljs-keyword">as</span> BaseVariantImpl<br>    <span class="hljs-comment">// files å³å¯¹åº”æ‰€æœ‰çš„ç¼–è¯‘èµ„æº</span><br>    <span class="hljs-keyword">def</span> files = variant.allRawAndroidResources.files<br><br></code></pre></td></tr></table></figure><p>ç»ˆäºç†è§£ï½Android æ¨¡å—åŒ–é‡Œçš„èµ„æºå†²çª? å‰è¨€ ä½œä¸º Android å¼€å‘è€…ï¼Œæˆ‘ä»¬å¸¸å¸¸éœ€è¦å»ç®¡ç†éå¸¸å¤šä¸åŒçš„èµ„æºæ–‡ - æ˜é‡‘: <a href="https://juejin.cn/post/7170562275374268447">https://juejin.cn/post/7170562275374268447</a></p><p>åˆ©ç”¨Android Gradleè¿›è¡Œè‡ªåŠ¨åŒ–è®¾ç½®èµ„æºåå‘½åè§„åˆ™ä¸€ã€èƒŒæ™¯æè¿°ï¼š ????å…¬å¸å†ä¸æ–­æ¨è¿›ç»„ä»¶åŒ–ï¼Œå¤šä¸ªModul - æ˜é‡‘: <a href="https://juejin.cn/post/7065889116780494855">https://juejin.cn/post/7065889116780494855</a></p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs groovy">android &#123;  <br>  <br>  flavorDimensions <span class="hljs-string">&quot;versionCode&quot;</span>  <br>  <br>  productFlavors &#123;  <br>      productFlavors.all &#123;<span class="hljs-comment">//éå†productFlavorså¤šæ¸ é“ï¼Œè®¾ç½®æ¸ é“å·ï¼ˆxiaomi ã€huaweiï¼‰  </span><br>          flavor -&gt; flavor.manifestPlaceholders.put(<span class="hljs-string">&quot;CHANNEL&quot;</span>, name)  <br>      &#125;<br>  &#125;<br>  applicationVariants.all &#123; variant -&gt;  <br>      <span class="hljs-comment">// æ‰“åŒ…å®Œæˆåè¾“å‡ºè·¯å¾„</span><br>      <span class="hljs-keyword">def</span> name = ((project.name != <span class="hljs-string">&quot;app&quot;</span>) ? project.name : rootProject.name.replace(<span class="hljs-string">&quot; &quot;</span>, <span class="hljs-string">&quot;&quot;</span>)) + <br>      <span class="hljs-string">&quot;_&quot;</span> + variant.flavorName + <br>      <span class="hljs-string">&quot;_&quot;</span> + variant.buildType.name + <br>      <span class="hljs-string">&quot;_&quot;</span> + variant.versionName + <br>      <span class="hljs-string">&quot;_&quot;</span> + <span class="hljs-keyword">new</span> Date().format(<span class="hljs-string">&#x27;yyyyMMddhhmm&#x27;</span>) + <span class="hljs-string">&quot;.apk&quot;</span>  <br>      <span class="hljs-comment">//ç›¸å¯¹è·¯å¾„app/build/outputs/apk/huawei/release/</span><br>      <span class="hljs-keyword">def</span> path = <span class="hljs-string">&quot;../../../../../apk/&quot;</span> <span class="hljs-comment">//ç›¸å½“äºè·¯å¾„ app/apk/</span><br>      variant.outputs.each &#123; output -&gt;<br>          <span class="hljs-keyword">def</span> outputFile = output.outputFile<br>          <span class="hljs-keyword">if</span> (outputFile != <span class="hljs-literal">null</span> &amp;&amp; outputFile.name.endsWith(<span class="hljs-string">&#x27;.apk&#x27;</span>)) &#123;<br>               <span class="hljs-comment">//æŒ‡å®šè·¯å¾„è¾“å‡º</span><br>               output.outputFileName = <span class="hljs-keyword">new</span> File(path, name)<br>          &#125;<br>      &#125; <br>      <span class="hljs-comment">// åœ¨æ‰“åŒ…å®Œæˆåè¿˜å¯ä»¥åšä¸€äº›åˆ«çš„æ“ä½œï¼Œå¯ä»¥å¤åˆ¶åˆ°æŒ‡å®šç›®å½•ï¼Œæˆ–è€…ç§»åŠ¨æ–‡ä»¶åˆ°æŒ‡å®šç›®å½•</span><br>      variant.assemble.doLast &#123;  <br>          File out = <span class="hljs-keyword">new</span> File(â€œ$&#123;project.rootDir&#125;/apkâ€)  <br>          variant.outputs.forEach &#123; file -&gt;  <br>            <span class="hljs-comment">//å¤åˆ¶apkåˆ°æŒ‡å®šæ–‡ä»¶å¤¹</span><br>            <span class="hljs-comment">//copy &#123;  </span><br>            <span class="hljs-comment">//  from file.outputFile  </span><br>            <span class="hljs-comment">//  into out  </span><br>            <span class="hljs-comment">//&#125;</span><br>         <span class="hljs-comment">//æŠŠæ–‡ä»¶ç§»åŠ¨åˆ°æŒ‡å®šæ–‡ä»¶å¤¹  </span><br>          ant.move <span class="hljs-attr">file:</span> file.outputFile,  <br>                 <span class="hljs-symbol">todir:</span> <span class="hljs-string">&quot;$&#123;project.rootDir&#125;/apk&quot;</span><br>        &#125;  <br>      &#125; <br>  &#125;<br><span class="hljs-comment">//å¤šæ¸ é“ç­¾åçš„é…ç½®</span><br>  signingConfigs &#123;<br>     test &#123;<br>        storeFile file(<span class="hljs-string">&quot;../test.keystore&quot;</span>)<br>        storePassword <span class="hljs-string">&#x27;test&#x27;</span><br>        keyAlias <span class="hljs-string">&#x27;test&#x27;</span><br>        keyPassword <span class="hljs-string">&#x27;test&#x27;</span><br>        v1SigningEnabled <span class="hljs-literal">true</span><br>        v2SigningEnabled <span class="hljs-literal">true</span><br>     &#125;<br>     xiaomi &#123;<br>        storeFile file(<span class="hljs-string">&quot;../xiaomi.keystore&quot;</span>)<br>        storePassword <span class="hljs-string">&#x27;xiaomi&#x27;</span><br>        keyAlias <span class="hljs-string">&#x27;xiaomi&#x27;</span><br>        keyPassword <span class="hljs-string">&#x27;xiaomi&#x27;</span><br>        v1SigningEnabled <span class="hljs-literal">true</span><br>        v2SigningEnabled <span class="hljs-literal">true</span><br>     &#125;<br>  &#125;<br>  buildTypes &#123;<br>       debug &#123;<br><span class="hljs-comment">//        debugè¿™é‡Œè®¾ç½®ä¸èµ·ä½œç”¨ï¼Œå¯èƒ½æ˜¯ç¼–è¯‘å™¨çš„é—®é¢˜ï¼Ÿ</span><br><span class="hljs-comment">//         productFlavors.xiaomi.signingConfig signingConfigs.test</span><br><span class="hljs-comment">//         productFlavors.huawei.signingConfig signingConfigs.test</span><br>       &#125;<br>       release &#123;<br>           productFlavors.xiaomi.signingConfig signingConfigs.xiaomi<br>           productFlavors.huawei.signingConfig signingConfigs.huawei<br>       &#125;<br>  &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs groovy">android &#123;<br>    variantFilter &#123; variant -&gt;<br>        <span class="hljs-keyword">if</span> (variant.buildType.name.equals(<span class="hljs-string">&#x27;debug&#x27;</span>)) &#123;<br>            variant.setIgnore(<span class="hljs-literal">true</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//æ‰§è¡Œlintæ£€æŸ¥ï¼Œæœ‰ä»»ä½•çš„é”™è¯¯æˆ–è€…è­¦å‘Šæç¤ºï¼Œéƒ½ä¼šç»ˆæ­¢æ„å»ºï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶å…³æ‰ã€‚</span><br>    lintOptions &#123;<br>        checkReleaseBuilds <span class="hljs-literal">false</span><br>        abortOnError <span class="hljs-literal">false</span><br>        <span class="hljs-comment">// é˜²æ­¢åœ¨å‘å¸ƒçš„æ—¶å€™å‡ºç°å› MissingTranslationå¯¼è‡´Build Failed!</span><br>        disable <span class="hljs-string">&#x27;MissingTranslation&#x27;</span><br>    &#125;<br> <br>    dexOptions &#123;<br>        incremental <span class="hljs-literal">true</span><br>        javaMaxHeapSize <span class="hljs-string">&quot;8g&quot;</span><br>        jumboMode = <span class="hljs-literal">true</span><br>        preDexLibraries = <span class="hljs-literal">false</span><br>        threadCount =<span class="hljs-string">&quot;8&quot;</span><br>    &#125;<br><br></code></pre></td></tr></table></figure><p>missingDimensionStrategy </p><p>é…ç½®äº§å“å˜ç§productFlavors matchingFallbacks missingDimensionStrategy - ç®€ä¹¦: <a href="https://www.jianshu.com/p/4b311bd9840d">https://www.jianshu.com/p/4b311bd9840d</a></p><p>gradle - Android buildTypes vs. productFlavors error - Stack Overflow: <a href="https://stackoverflow.com/questions/64758477/android-buildtypes-vs-productflavors-error">https://stackoverflow.com/questions/64758477/android-buildtypes-vs-productflavors-error</a></p><p>ProductFlavorå¤šæ¸ é“çš„ç¥å™¨ - ç®€ä¹¦: <a href="https://www.jianshu.com/p/00ceb35b090b">https://www.jianshu.com/p/00ceb35b090b</a></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>Android å¤šæ¸ é“æ‰“åŒ…å¤šæ¸ é“é…ç½®ï¼ˆ2 ç§æ–¹å¼ï¼‰ 1ã€å¯å†™åœ¨ä¸»æ¨¡å—ï¼ˆappï¼‰çš„ build.gradle ä¸‹ 2ã€åœ¨é¡¹ - æ˜é‡‘: <a href="https://juejin.cn/post/7023661293781385247">https://juejin.cn/post/7023661293781385247</a></p><p>Gradleå¤šæ¸ é“æ‰“åŒ…(åŠ¨æ€è®¾å®šAppåç§°ï¼Œåº”ç”¨å›¾æ ‡ï¼Œæ›¿æ¢å¸¸é‡ï¼Œæ›´æ”¹åŒ…åï¼Œå˜æ›´æ¸ é“) - ç®€ä¹¦: <a href="https://www.jianshu.com/p/533240d222d3">https://www.jianshu.com/p/533240d222d3</a></p><p>Android å®˜æ–¹æ¨¡å—åŒ–æ–¹æ¡ˆè§£è¯»å¿«é€Ÿäº†è§£ Android å®˜æ–¹æ¨¡å—åŒ–æ–¹æ¡ˆã€‚è¿˜æœ‰ä¸€äº›ä½ å¯èƒ½ä¸çŸ¥é“çš„å®ç”¨å°æŠ€å·§ã€‚è¿˜æœ‰å®˜æ–¹æ¨¡ - æ˜é‡‘: <a href="https://juejin.cn/post/7142884855091560479">https://juejin.cn/post/7142884855091560479</a></p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h2 id=&quot;å‰å¯¼çŸ¥è¯†&quot;&gt;&lt;a href=&quot;#å‰å¯¼çŸ¥è¯†&quot; class=&quot;headerlink&quot; title=&quot;å‰å¯¼çŸ¥è¯†&quot;&gt;&lt;/a&gt;å‰å¯¼çŸ¥è¯†&lt;/h2&gt;&lt;p&gt;é…ç½® build å˜ä½“ ?|? Android Studio ?|? Android Developers: &lt;a</summary>
        
      
    
    
    
    <category term="AndroidAPPæ¶æ„" scheme="https://iwesley.top/categories/AndroidAPP%E6%9E%B6%E6%9E%84/"/>
    
    
    <category term="Android" scheme="https://iwesley.top/tags/Android/"/>
    
    <category term="AndroidAPP" scheme="https://iwesley.top/tags/AndroidAPP/"/>
    
  </entry>
  
  <entry>
    <title>Tencent mars Xlogç¼–è¯‘åŠä½¿ç”¨æ–¹æ³•</title>
    <link href="https://iwesley.top/article/ca471381/"/>
    <id>https://iwesley.top/article/ca471381/</id>
    <published>2024-11-17T09:40:51.000Z</published>
    <updated>2024-12-24T12:51:46.755Z</updated>
    
    <content type="html"><![CDATA[<p>Window11ç¼–è¯‘</p><blockquote><p>å¦‚æœå·²ç»å®‰è£…äº†cygwinï¼Œä¸éœ€è¦å¸è½½é‡è£…ï¼Œåªéœ€è¦å†æ¬¡è¿è¡Œå®‰è£…æ–‡ä»¶setup-x86_64.exeå°±å¯ä»¥ä¸‹è½½æˆ–è€…å¸è½½åŒ…ã€‚</p></blockquote>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;p&gt;Window11ç¼–è¯‘&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å¦‚æœå·²ç»å®‰è£…äº†cygwinï¼Œä¸éœ€è¦å¸è½½é‡è£…ï¼Œåªéœ€è¦å†æ¬¡è¿è¡Œå®‰è£…æ–‡ä»¶setup-x86_64.exeå°±å¯ä»¥ä¸‹è½½æˆ–è€…å¸è½½åŒ…ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
</summary>
        
      
    
    
    
    <category term="AndroidThirdPartSDK" scheme="https://iwesley.top/categories/AndroidThirdPartSDK/"/>
    
    
    <category term="Android" scheme="https://iwesley.top/tags/Android/"/>
    
    <category term="AndroidThirdPartySDK" scheme="https://iwesley.top/tags/AndroidThirdPartySDK/"/>
    
  </entry>
  
  <entry>
    <title>gitå¸¸è§é—®é¢˜</title>
    <link href="https://iwesley.top/article/ca7dd2f8/"/>
    <id>https://iwesley.top/article/ca7dd2f8/</id>
    <published>2024-11-17T09:20:38.000Z</published>
    <updated>2025-01-18T14:35:28.362Z</updated>
    
    <content type="html"><![CDATA[<p>gerrit draft and topic |: <a href="https://breezetemple.github.io/2019/08/30/gerrit-draft-and-topic/">https://breezetemple.github.io/2019/08/30/gerrit-draft-and-topic/</a></p><p>Gerritç›¸å¯¹Gitæä¾›äº†ä¸€ä¸ªç‰¹æœ‰çš„å‘½åç©ºé—´refs&#x2F;for&#x2F;ç”¨æ¥å®šä¹‰æˆ‘ä»¬çš„æäº¤ä¸Šä¼ åˆ°å“ªä¸ªbranchï¼Œä¸”å¯ä»¥ç”¨æ¥åŒºåˆ†æˆ‘ä»¬çš„commitæ˜¯æäº¤åˆ°Gerritè¿›è¡Œå®¡æ ¸è¿˜æ˜¯ç›´æ¥æäº¤åˆ°Gitä»“åº“ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š</p><p>refs&#x2F;for&#x2F;<target-branch></p><p>Push ä¸€ä¸ª Commit åˆ° Gerrit: git push origin HEAD:refs&#x2F;for&#x2F;master<br>ç›´æ¥ Push ä¸€ä¸ª commit åˆ° Git ä»“åº“ï¼šï¼ˆé»˜è®¤é…ç½®æˆä¸å…è®¸ï¼‰ git push origin HEAD:master<br>å½“commit Pushåˆ°Gerritç­‰å¾…reviewæ—¶ï¼ŒGerritä¼šå°†æ­¤commitä¿å­˜åœ¨ä¸€ä¸ªåä¸ºrefs&#x2F;changes&#x2F;xx&#x2F;yy&#x2F;zzçš„ä¸€ä¸ªæš‚å­˜branchä¸­ã€‚</p><p>zzä¸ºè¿™ä¸ªcommitçš„patch setå·<br>yyæ˜¯changeå·<br>xxæ˜¯changeå·çš„åä¸¤ä½</p><p>Draft<br>refs&#x2F;drafts&#x2F;<target branch></p><p>$ git push origin HEAD:refs&#x2F;drafts&#x2F;xxx<br>åœ¨Gerritä¸­ç‚¹å‡»PublishæŒ‰é’®è½¬æ¢ä¸ºæ­£å¼Change</p><p>Topic<br>refs&#x2F;for&#x2F;<target branch><br>refs&#x2F;for&#x2F;<target branch>&#x2F;<topic name></p><p>$ git push origin HEAD:refs&#x2F;for&#x2F;xxx%topic&#x3D;123<br>$ git push origin HEAD:refs&#x2F;for&#x2F;xxx&#x2F;123<br>Topicç”¨äºå½’ç±»ç›¸å…³çš„æäº¤ï¼Œå¯ä»¥ç”¨ä¸Šè¿°çš„å‘½ä»¤ï¼ŒåŒæ—¶å¯ä»¥åœ¨Gerritä¸­ç¼–è¾‘Topic</p><h2 id="ä»£ç†"><a href="#ä»£ç†" class="headerlink" title="ä»£ç†"></a>ä»£ç†</h2><p>ä¸º http è®¾ç½®ä»£ç†</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">ä¸€æ¬¡æ€§ä»£ç†</span><br>git clone -c http.proxy=&quot;http://127.0.0.1:1087&quot; https://github.com/<br><span class="hljs-meta prompt_"># </span><span class="language-bash">å…¨å±€è®¾ç½®ä»£ç†</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">ä»…ä¸ºgithub.comè®¾ç½®socks5ä»£ç†</span><br>git config --global http.https://github.com.proxy socks5://127.0.0.1:1086<br><br>git config --global https.proxy http://127.0.0.1:1080<br><br>git config --global https.proxy https://127.0.0.1:1080<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">å–æ¶ˆ</span><br><br>git config --global --unset http.proxy<br><br>git config --global --unset https.proxy<br></code></pre></td></tr></table></figure><p>ä¸º ssh åè®®è®¾ç½®ä»£ç†</p><blockquote><p>ä¸‹æ–‡é…ç½®å…¶ä¸­çš„ipå’Œç«¯å£ä¿®æ”¹æˆä½ è‡ªå·±ä»£ç†çš„å‚æ•°</p></blockquote><p>windows</p><p>ä¿®æ”¹C:\Users${your username}.sshç›®å½•ä¸‹çš„configæ–‡ä»¶ï¼Œè‹¥æ²¡æœ‰åˆ™æ–°å»º</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">Host github.com                                                <br>    Hostname ssh.github.com                                    <br>    Port 443                                                  <br>    User git<br>    ProxyCommand connect -S 127.0.0.1:7890 %h %p<br></code></pre></td></tr></table></figure><p>Linuxã€MacOS</p><p>ä¿®æ”¹~&#x2F;.sshç›®å½•ä¸‹çš„configæ–‡ä»¶ï¼Œè‹¥æ²¡æœ‰åˆ™æ–°å»º</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">Host github.com<br>        Hostname ssh.github.com<br>        Port 443<br>        User git<br>        ProxyCommand nc -v -x 172.28.208.1:7890 %h %p<br></code></pre></td></tr></table></figure><p>éªŒè¯</p><p><code>ssh -T git@github.com</code></p><p>è‹¥å‡ºç°é”™è¯¯ï¼Œåˆ™åˆ é™¤.sshç›®å½•ä¸­known_hostsæ–‡ä»¶é‡è¯•</p><p><a href="https://seepine.com/git/ssh-proxy/">Git ä¸º ssh åè®®è®¾ç½®ä»£ç† - Seepineâ€™s Blog</a></p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;p&gt;gerrit draft and topic |: &lt;a</summary>
        
      
    
    
    
    <category term="git" scheme="https://iwesley.top/categories/git/"/>
    
    
    <category term="git" scheme="https://iwesley.top/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>Android Activityå¸¸è§é—®é¢˜</title>
    <link href="https://iwesley.top/article/a218b21a/"/>
    <id>https://iwesley.top/article/a218b21a/</id>
    <published>2024-11-17T09:15:36.000Z</published>
    <updated>2025-01-04T13:33:26.143Z</updated>
    
    <content type="html"><![CDATA[<p>android finishAffinity()-CSDNåšå®¢: <a href="https://blog.csdn.net/mr_orange_klj/article/details/43244603">https://blog.csdn.net/mr_orange_klj/article/details/43244603</a></p><p>è°ƒç”¨activityå¯¹è±¡çš„finishiAffinity()æ–¹æ³•ï¼Œå¯ä»¥å…³é—­å½“å‰activityæ‰€å±çš„activityæ ˆä¸­æ‰€æœ‰çš„activityã€‚å¦‚æœæ‰€æœ‰activityéƒ½ä¿å­˜åœ¨é»˜è®¤æ ˆä¸­ï¼Œåˆ™ä½¿ç”¨è¯¥æ–¹æ³•ä¼šç›´æ¥é€€å‡ºç¨‹åºã€‚å¦‚æœè¦å›åˆ°ç¨‹åºçš„ä¸»ç•Œé¢ï¼Œåˆ™å¯ä»¥åœ¨manifestæ–‡ä»¶ä¸­å°†ä¸»ç•Œé¢çš„activityè®¾ç½®ä¸ºå•ç‹¬çš„æ ˆä¿å­˜ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"> <span class="hljs-tag">&lt;<span class="hljs-name">activity</span></span><br><span class="hljs-tag">            <span class="hljs-attr">android:name</span>=<span class="hljs-string">&quot;com.weishi.UserMain&quot;</span></span><br><span class="hljs-tag">            <span class="hljs-attr">android:taskAffinity</span>=<span class="hljs-string">&quot;:finish&quot;</span>//<span class="hljs-attr">è¯¥å¥ç”¨æ¥æŒ‡å®šæ ˆ</span></span><br><span class="hljs-tag">            <span class="hljs-attr">android:label</span>=<span class="hljs-string">&quot;@string/title_activity_user_main&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">activity</span>&gt;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;p&gt;android finishAffinity()-CSDNåšå®¢: &lt;a</summary>
        
      
    
    
    
    <category term="Android" scheme="https://iwesley.top/categories/Android/"/>
    
    
    <category term="Android" scheme="https://iwesley.top/tags/Android/"/>
    
    <category term="AndroidActivity" scheme="https://iwesley.top/tags/AndroidActivity/"/>
    
  </entry>
  
  <entry>
    <title>å®‰å“å¸¸ç”¨å·¥å…·æ–¹æ³•</title>
    <link href="https://iwesley.top/article/bf556c88/"/>
    <id>https://iwesley.top/article/bf556c88/</id>
    <published>2024-11-17T08:17:32.000Z</published>
    <updated>2024-12-24T12:51:46.756Z</updated>
    
    <content type="html"><![CDATA[<p>è·å–è¿›ç¨‹åå­—</p><p>ã€Androidã€‘è·å–å½“å‰è¿›ç¨‹åçš„å››ç§æ–¹æ³•åŠæ•ˆç‡å¯¹æ¯”_androidè·å–å½“å‰è¿›ç¨‹å-CSDNåšå®¢: <a href="https://blog.csdn.net/qq_23049111/article/details/126097443">https://blog.csdn.net/qq_23049111/article/details/126097443</a></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getAppProcessName</span><span class="hljs-params">()</span></span>: String &#123;<br>    <span class="hljs-keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.P) &#123;<br>        <span class="hljs-keyword">return</span> Application.getProcessName()<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.JELLY_BEAN_MR2) &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">val</span> processName =<br>                Reflector.on(<span class="hljs-string">&quot;android.app.ActivityThread&quot;</span>).method(<span class="hljs-string">&quot;currentProcessName&quot;</span>)<br>                    .call&lt;String&gt;()<br>            Log.d(TAG, <span class="hljs-string">&quot;getAppProcessName: <span class="hljs-variable">$processName</span>&quot;</span>)<br>            <span class="hljs-keyword">return</span> processName<br>        &#125; <span class="hljs-keyword">catch</span> (e: Exception) &#123;<br>            Log.e(TAG, <span class="hljs-string">&quot;getAppProcessName error&quot;</span>, e)<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span><br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//å®‰å“4.2çš„çš„currentPackageNameå®é™…ä¸Šå°±æ˜¯currentProcessName</span><br>            <span class="hljs-comment">//http://xrefandroid.com/android-4.2.2_r1/xref/frameworks/base/core/java/android/app/ActivityThread.java</span><br>            <span class="hljs-keyword">val</span> processName =<br>                Reflector.on(<span class="hljs-string">&quot;android.app.ActivityThread&quot;</span>).method(<span class="hljs-string">&quot;currentPackageName&quot;</span>)<br>                    .call&lt;String&gt;()<br>            Log.d(TAG, <span class="hljs-string">&quot;getAppProcessName: <span class="hljs-variable">$processName</span>&quot;</span>)<br>            <span class="hljs-keyword">return</span> processName<br>        &#125; <span class="hljs-keyword">catch</span> (e: Exception) &#123;<br>            Log.e(TAG, <span class="hljs-string">&quot;getAppProcessName error&quot;</span>, e)<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è·å–åº”ç”¨åç§°</p><p>Android è·å–åº”ç”¨çš„iconã€åå­—ã€ç‰ˆæœ¬å·_æŸ¥çœ‹å®‰å“appç±»å-CSDNåšå®¢: <a href="https://blog.csdn.net/LoveDou0816/article/details/78135201">https://blog.csdn.net/LoveDou0816/article/details/78135201</a></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> Context.<span class="hljs-title">getAppName</span><span class="hljs-params">(pkgName: <span class="hljs-type">String</span>)</span></span>: String &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">val</span> info: PackageInfo = packageManager.getPackageInfo(pkgName, <span class="hljs-number">0</span>)<br>        <span class="hljs-comment">//resources.getString(info.applicationInfo.labelRes)</span><br>        info.applicationInfo.loadLabel(packageManager).toString() <span class="hljs-comment">//å…¼å®¹android:label=&quot;$&#123;APP_NAME&#125;&quot;</span><br>    &#125; <span class="hljs-keyword">catch</span> (e: PackageManager.NameNotFoundException) &#123;<br>        Log.e(TAG, <span class="hljs-string">&quot;getAppName error&quot;</span>, e)<br>        <span class="hljs-string">&quot;&quot;</span><br>    &#125; <span class="hljs-keyword">catch</span> (e: Resources.NotFoundException) &#123;<br>        Log.e(TAG, <span class="hljs-string">&quot;getAppName error&quot;</span>, e)<br>        <span class="hljs-string">&quot;&quot;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;p&gt;è·å–è¿›ç¨‹åå­—&lt;/p&gt;
&lt;p&gt;ã€Androidã€‘è·å–å½“å‰è¿›ç¨‹åçš„å››ç§æ–¹æ³•åŠæ•ˆç‡å¯¹æ¯”_androidè·å–å½“å‰è¿›ç¨‹å-CSDNåšå®¢: &lt;a</summary>
        
      
    
    
    
    <category term="Android" scheme="https://iwesley.top/categories/Android/"/>
    
    
    <category term="Android" scheme="https://iwesley.top/tags/Android/"/>
    
    <category term="AndroidUtils" scheme="https://iwesley.top/tags/AndroidUtils/"/>
    
  </entry>
  
</feed>
