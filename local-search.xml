<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>é‡è¯»ã€Šç™¾å¹´å­¤ç‹¬ã€‹åçš„å›å¿†</title>
    <link href="/article/6eef96b2/"/>
    <url>/article/6eef96b2/</url>
    
    <content type="html"><![CDATA[<p>å¤šå¹´ä»¥åï¼Œé¢å¯¹ç”µå­ç›¸å†Œçš„å¾€å¹´ä»Šæ—¥ï¼Œé¢å¯¹ä»æœªä¸¢å¤±å´æ²‰å¯‚å·²ä¹…çš„çŸ­ä¿¡ï¼Œä»–ä¼šæ¸…æ™°åœ°å›å¿†èµ·åå¹´å‰é‚£æ®µæ—§æ—¶å…‰â€”â€”åœ¨äººæ¥äººå¾€çš„æ•™å®¤é•¿å»Šé‡Œä¸å¥¹æ¬¢ä¹äº¤è°ˆï¼Œé“ƒå£°å“èµ·ä»ç„¶æ„Ÿè§‰æ„çŠ¹æœªå°½ï¼Œé’æ˜¥çš„ä½è¯­æ··åˆç€å°˜åŸƒçš„å¾®å…‰é£˜æµ®ï¼›åœ¨é»„è‰²çš„ä¿¡çº¸ä¸Šå†™ä¸‹è¿‡ä¹¦ç±è¯»åæ„Ÿï¼Œå†™ä¸‹è¿‡å½¼æ­¤çš„ç¾å¥½ç¥æ„¿ä¸é¼“åŠ±ï¼Œä¹Ÿå†™ä¸‹è¿‡å¯¹ç”Ÿæ´»çš„æ„Ÿæ‚Ÿï¼Œé»‘è‰²çš„å¢¨è¿¹æ‰¿è½½äº†ä¸€æ®µé’æ˜¥èˆæ›²ï¼›åœ¨ä¸Šå­¦å‰ï¼Œä»–æœ‰æ„æ— æ„åœ°æœ›å‘çª—å¤–ï¼Œçœ‹åˆ°å¥¹çš„èº«å½±ç»è¿‡ï¼Œå¿ƒé‡Œé£˜å¿½ä¸å®šï¼›åœ¨ä¸€ä¸ªæ— å¸¸çš„å‘¨æœ«ï¼Œä»–ååœ¨æ•™å®¤é‡Œæ›¾é‡å¤å¬ç€æŸä¸€é¦–æ­Œï¼Œå†…å¿ƒå……æ»¡ç€çº ç»“ï¼Œç›´åˆ°ä»Šå¤©å†æ¬¡å”±èµ·ä»ç„¶æ„Ÿæ…¨ä¸‡åƒã€‚åæ¥ï¼Œä»–æ„è¯†åˆ°è¿‡åˆ†çš„å…³å¿ƒå¯èƒ½å¼•èµ·äº†å¥¹çš„é€ƒé¿å’Œæ— å¿ƒçš„æ— è§†ï¼Œä»–å†³å®šç”»å¥½ç•Œé™ã€‚åœ¨ä¸€ä¸ªå¤œæ™šç›¸èšåï¼Œä»–éª‘è‡ªè¡Œè½¦é€å¥¹å›å®¶ï¼Œå¯èƒ½æ˜¯å› ä¸ºå¤§é£æˆ–è€…æ²™å­è¿›äº†çœ¼ç›ï¼Œæœ‰çƒ­æ³ªæµäº†å‡ºæ¥ï¼Œä»–æ„Ÿè§‰åé¢å¯èƒ½å†ä¹Ÿæ²¡æœ‰è§é¢çš„æœºä¼šäº†ã€‚</p><p>æ­¤åçš„è¿‡å¹´æœŸé—´ï¼Œæœ‰ä¸€æ¬¡ä»–ä»¬åœ¨è¶…å¸‚ç›¸é‡ï¼Œå¥½åƒé™Œç”Ÿäººä¸€æ ·ï¼Œå½¼æ­¤é—®å€™åå°±æ­¤åˆ«è¿‡ã€‚è¿˜æ˜¯å¤ªå¹´è½»ï¼Œå¦‚æœå¯ä»¥é‡æ¥ï¼Œä»–ä»¬å¯ä»¥ä¸€èµ·åä¸‹æ¥å–æ¯å¥¶èŒ¶ï¼Œèšèšæ—§ã€‚ä»–å’Œæœ‹å‹çš„èšä¼šä¸­ï¼Œè¿˜æ˜¯èƒ½ç»å¸¸å¬åˆ°å¥¹çš„æ¶ˆæ¯ï¼Œä»–ä¸ä½œå£°ï¼Œåªæ˜¯è†å¬ã€‚</p><p>å­¤ç‹¬æ¥è‡ªè„†å¼±çš„æ•æ„Ÿã€‚</p><p>ç°åœ¨ï¼Œä»–ä»¬ä¸ç»å¸¸è”ç»œäº†ã€‚å¹´åˆä»–çœ‹ç€å¥¹æ¯•ä¸šçš„ç…§ç‰‡æ—¶ï¼Œçœ‹åˆ°äº†å’Œåå¹´å‰ä¸€æ ·çº¯çœŸåŠ¨äººçš„ç¬‘å®¹ï¼Œå²æœˆæ©ç›–ä¸ä½å¥¹æ˜äº®çš„çœ¼ç›ï¼Œç¥æ„¿å¥¹å¹³å®‰å¿«ä¹ï¼</p>]]></content>
    
    
    <categories>
      
      <category>éšç¬”</category>
      
    </categories>
    
    
    <tags>
      
      <tag>éšç¬”</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è¯´è¯´9æœˆ8å·ä»¥æ¥çš„çŸ­å­¦æœŸ</title>
    <link href="/article/daa12744/"/>
    <url>/article/daa12744/</url>
    
    <content type="html"><![CDATA[<blockquote><p>ç¿»çœ‹ä¾¿ç­¾çœ‹åˆ°äº†ä¸€ç¯‡æ—§æ–‡ï¼Œå†™äº2017å¹´9æœˆ16å·ä¸‹åˆ1ç‚¹35åˆ†</p></blockquote><p>å—¯â€¦â€¦æˆ–è€…å¯ä»¥è¯´æ˜¯ä¸€æ¬¡â€œå‡ç ”ç©¶ç”Ÿâ€â€œå‡å­¦é•¿â€çš„ç»å†â€¦â€¦ï¼Œå› ä¸ºä»–ä»¬æ˜¯å‡†å¤‡è¯»å¤§ä¸‰å¤§å››çš„çœŸå­¦é•¿å­¦å§â€¦â€¦</p><p>è¿™ä¸ªçŸ­å­¦æœŸä¸»è¦æ˜¯ç”±æˆ‘ä»¬å®éªŒå®¤æ‰¿æ‹…çš„ä¸€ä¸ªpicå•ç‰‡æœºçŸ­å­¦æœŸå­¦ä¹ ä»»åŠ¡ï¼Œæˆ‘ä»¬å¼€å§‹æ˜¯ç»™ä»–ä»¬è®²è®²è¯¾ï¼Œè®²ä¸€äº›è½¯ä»¶æ“ä½œå’Œä¸€äº›åŸºæœ¬é—®é¢˜ï¼Œåæ¥åŸºæœ¬å°±æ˜¯ä¸€ä¸ªåŠ©æ•™çš„è§’è‰²ï¼Œè¾…åŠ©ä»–ä»¬è§£å†³ä¸€äº›é—®é¢˜ï¼Œæœ€åå†è´Ÿè´£éªŒæ”¶ä¸€ä¸‹å°±okäº†â€¦â€¦</p><p>è¿™æœŸé—´å‘ç”Ÿäº†ä¸¤æ¬¡å°´å°¬çš„äº‹ï¼Œä¸€æ¬¡æ˜¯è€å¸ˆä»‹ç»æˆ‘ä»¬æ—¶ï¼Œè¯´æˆ‘ä»¬æ˜¯ç ”ç©¶ç”ŸğŸ˜‚ï¼Œå½“æ—¶çš„ååº”å°±æ˜¯å°´å°¬åœ°ç¬‘ç¬‘â€¦â€¦ç¬¬äºŒæ¬¡å°´å°¬å‘ç”Ÿåœ¨ä»Šå¤©ï¼Œæœ‰ä¸€ä½åŒå­¦é—®æˆ‘ä¸€äº›å…³äºç ”ç©¶ç”Ÿå¯¼å¸ˆçš„é—®é¢˜ï¼Œæˆ‘å‹‰å¼ºè¯´äº†ä¸€äº›ï¼Œæœ€åè¿˜æ˜¯å¦è®¤äº†è¿™ä¸ªèº«ä»½ï¼Œå‹‰å¼ºåœ°ç»•å‡ºå»äº†ï¼Œä¹Ÿæ²¡è¯´æ˜¯å¤§ä¸€çš„â€¦â€¦</p><blockquote><p>å—¯â€¦â€¦è®©æˆ‘æƒ³èµ·äº†è€ç½—çš„ä¸€ä¸ªæ•…äº‹<br>æˆ‘å°çš„æ—¶å€™å‘¢ï¼Œè„¸çš®åšå«â€œè„¸çš®åšâ€ï¼Œæ— è€»å«â€œæ— è€»â€ï¼Œç°åœ¨éƒ½å«å¿ƒç†ç´ è´¨å¥½ã€‚(lolâ€¦) çœŸå¥‡æ€ªï¼åƒæˆ‘è·Ÿå‡ ä¸ªæœ‹å‹å»çˆ¬å±±ï¼Œç„¶åä¸‹æ¥ç´¯äº†ï¼Œåœ¨é‚£ä¸ªé•¿å‡³ä¸Šï¼Œæˆ‘ä»¬5ã€6ä¸ªåæˆä¸€æ’ä¼‘æ¯ï¼Œç„¶åå¤§å®¶æ‹¿äº†ä¸€äº›ç“œå­ï¼Œç„¶åæ‹¿äº†ä¸ªå¡‘æ–™è¢‹ï¼Œå—‘å®Œäº†ç“œå­å°±æ‰”åˆ°å¡‘æ–™è¢‹é‡Œå»äº†ï¼Œä½†æ˜¯åƒå®Œæ‰‹ä¸é»‘äº†å—ï¼Ÿäºæ˜¯å¤§å®¶æå‡ºä¸€ç‚¹çº¸å·¾ï¼Œäº’ç›¸åˆ†ï¼Œç„¶åæŠŠæ‰‹æ“¦ä¸€æ“¦ã€‚ç„¶åæŠŠé‚£ä¸ªå°±æ”¾åˆ°åº§ä½ä¸Šäº†ï¼Œç»“æœä¸€é˜µé£ä¸€å¹å‘¢éƒ½åˆ®åœ°ä¸Šäº†ï¼Œä¸æ˜¯æ•…æ„æ‰”åœ°ä¸Šçš„ï¼Œè¢«åˆ®åˆ°åœ°ä¸Šå»äº†ï¼Œç„¶åååœ¨é‚£å„¿æ²¡èµ°å˜›ï¼Œä¸€æ‡’ï¼Œæš‚æ—¶å°±æ²¡æ‹£ï¼Œéƒ½ä¸‹äº†å±±ï¼ŒæŒºç´¯çš„ã€‚ç»“æœæ¸…æ´äººå‘˜å°±è¿‡æ¥äº†ï¼Œè¯´â€œå“ï½è¿™ä¸ªçº¸æ˜¯ä¸æ˜¯ä½ ä»¬ç»™æ‰”çš„å•Šï¼Ÿâ€ç„¶åæˆ‘è„¸ä¸€ä¸‹å°±çº¢äº†ï¼Œç„¶åä»–ä»¬å‡ ä¸ªéƒ½æ²¡äº‹ï¼Œ(lolâ€¦) ç„¶åæˆ‘è¯´â€œæ˜¯â€ï¼Œç„¶åä»–è¯´â€œç½šæ¬¾â€ï¼Œæˆ‘è¯´â€œå¥½â€ï¼Œç„¶åæˆ‘å°±æŠŠç½šæ¬¾äº¤äº†ï¼Œæˆ‘åˆè‡ªå·±æŠŠé‚£çº¸ç»™æ‹£èµ·æ¥äº†ã€‚ç„¶åé‚£ä¸ªç½šæ¬¾çš„äººèµ°äº†ä»¥åï¼Œä»–ä»¬å‡ ä¸ªäººå°±çœ‹ç€æˆ‘è¯´â€œå“ï¼Œè€ç½—ä½ æ€ä¹ˆå¿ƒç†ç´ è´¨é‚£ä¹ˆå·®ï¼Ÿâ€(lolâ€¦) â€œä¸æ‰¿è®¤ä¸å°±è¡Œäº†ä¹ˆï¼Ÿâ€ä½†æ˜¯ä½ è„¸å·²ç»çº¢äº†ï¼Œæ‰€ä»¥ä½ ä¸æ‰¿è®¤ä¹Ÿä¸è¡Œã€‚â€œä½ æ€ä¹ˆå¿ƒç†ç´ è´¨é‚£ä¹ˆå·®ï¼Ÿâ€å¥½æˆ‘å°±å¥‡æ€ªäº†ï¼Œæˆ‘æ‰çŸ¥é“â€œå¿ƒç†ç´ è´¨â€æ˜¯è¿™ä¸ªæ„æ€ã€‚è¿‡å»æˆ‘ä»¬å«â€œæ— è€»â€ï¼Œç°åœ¨å«â€œå¿ƒç†ç´ è´¨â€ã€‚æ˜æ˜æ˜¯ä½ å¹²çš„ï¼Œä½ æ€ä¹ˆèƒ½å¿ƒç†ç´ è´¨é‚£ä¹ˆå¥½å‘¢ï¼Ÿ(lolâ€¦) å¥½â€¦â€¦è¿™æ˜¯â€¦â€¦é¢˜è¿˜æ²¡è®²å‘¢ï¼(lolâ€¦) å‘å¤§å®¶éƒ‘é‡é“æ­‰ï¼(lolâ€¦)</p></blockquote><p>å“å‘€ï¼Œè¯šå®æ˜¯ä¸€ä¸ªå¥¢ä¾ˆçš„å“è´¨ï¼</p><p>çŸ­å­¦æœŸæ€»ä½“æ¥è¯´æ„Ÿè§‰è¿˜æ˜¯ä¸é”™çš„ï¼Œè™½ç„¶å¤´ä¸‰å¤©å¯èƒ½æ˜¯å› ä¸ºç”Ÿç‰©é’Ÿæ²¡è°ƒèŠ‚è¿‡æ¥ï¼Œè¿ç»­å¤±çœ ï¼Œç²¾ç¥ä¸å¥½ï¼Œä½†åæ¥æ…¢æ…¢å°±å¾ˆå¿«ç¡ç€äº†â€¦â€¦ç»™ä»–ä»¬è®²è¯¾ï¼Œè¾…åŠ©ä»–ä»¬ï¼Œæœ‰ç§å›åˆ°é«˜ä¸­å¸®åˆ«äººè§£é¢˜çš„æ„Ÿè§‰ï¼Œå¯¹ï¼Œé‚£ç§æ„Ÿè§‰ç‰¹åˆ«ç¾å¥½ï¼å“ˆå“ˆï¼</p><p>å“¦ï¼ŒæœŸé—´å®éªŒå®¤ä¸¾è¡Œäº†â€œå­µåŒ–å™¨æ¯â€çš„ç¬¬ä¸€å±Šç¾½æ¯›çƒæ¯”èµ›ï¼Œé‚£å¤©æ˜¯9æœˆ9å·ï¼Œé‚£å¤©ç”±äºä¸€äº›äººå¼ƒèµ›ï¼Œæˆ‘ç›´æ¥å°±è·³è¿‡ç¬¬ä¸€è½®ï¼Œç›´æ¥æ™‹çº§äº†â€¦â€¦ä¸‹åˆï¼Œè¿æ‰“äº†ä¸‰å±€ï¼Œéƒ½æ¯”è¾ƒå¹¸è¿æƒŠé™©åœ°è·èƒœäº†ï¼Œæˆ‘éƒ½æ²¡æƒ³åˆ°å¾—åˆ°äº†ä¸€ç­‰å¥–ğŸ˜œâ€¦â€¦è™½ç„¶å­¦äº†ä¸€å­¦æœŸçš„ç¾½æ¯›çƒï¼Œä½†æ„Ÿè§‰é«˜è¿œçƒè¿™äº›éƒ½æ²¡æ€ä¹ˆè¿ç”¨ï¼Œè¿˜æ˜¯ä»»é‡é“è¿œâ€¦â€¦</p><p>é‚£äº›å¹´ï¼Œæ›¾ç»åœ¨å­µåŒ–å™¨æ¯ä¸Šèµ°è¿‡è¿™ä¹ˆä¸€ä¸ªè¡€è‚‰ä¹‹èº¯â€¦â€¦<img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2025/20250706225434744.jpg" alt="Notes_1751813220024"></p>]]></content>
    
    
    <categories>
      
      <category>éšç¬”</category>
      
    </categories>
    
    
    <tags>
      
      <tag>éšç¬”</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®‰å“å¯¹å¤–å‘å¸ƒå·¥ç¨‹æºç :æ€ä¹ˆåšåˆ°ä»…UIå±‚å…¬å¸ƒ</title>
    <link href="/article/9f1bc6ae/"/>
    <url>/article/9f1bc6ae/</url>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘æ–°å®¢æˆ·è¦æ±‚å°†è½¯ä»¶çš„ä»£ç å…¬å¼€ç»™ä»–ä»¬ï¼Œå…è®¸ä»–ä»¬è‡ªå·±ä¿®æ”¹ UIï¼Œè¿›è¡Œå®šåˆ¶ã€‚ç”±äºæˆ‘ä»¬å·¥ç¨‹åŒ…å«å…¶ä»–æ ¸å¿ƒæ¨¡å—ï¼Œä¸èƒ½å…¨éƒ¨å¼€æ”¾ï¼Œæ‰€ä»¥éœ€è¦å°†é UI æ¨¡å—è¿›è¡Œæ•´åˆå¹¶æ··æ·†å†å‘å¸ƒã€‚</p><p>ç”±äºå·¥ç¨‹å…·æœ‰è‰¯å¥½çš„æ¨¡å—åŒ–ï¼Œæ‰€ä»¥ä¸€å¼€å§‹æƒ³åˆ°çš„æ˜¯å‚è€ƒ<a href="https://iwesley.top/article/a43c0ba5/">å®‰å“å®˜æ–¹ç‰ˆfat-aar:ä½¿ç”¨Fused Libraryå°†å¤šä¸ªAndroidåº“å‘å¸ƒä¸ºä¸€ä¸ªåº“ - Wesleyâ€™s Blog</a>å°†é UI æ¨¡å—åˆå¹¶æˆä¸€ä¸ª aarã€‚</p><p>ä½†æœ‰æŒ‘æˆ˜ï¼š</p><ul><li><p>ä¾èµ–ä¼ é€’å¾ˆéš¾å¤„ç†ï¼Œå°±ç®—å¤„ç†äº†ä¹Ÿä¸æ–¹ä¾¿åç»­ç»´æŠ¤</p></li><li><p>å­˜åœ¨éƒ¨åˆ†å†…ç½‘ SDK ä¾èµ–</p></li></ul><p>ä¸ºäº†ä¸æ”¹å˜ maven çš„ç®¡ç†æ–¹å¼ï¼Œå†³å®šä½¿ç”¨æœ¬åœ° maven çš„æ–¹å¼ã€‚</p><p>å¯ä»¥å…ˆç”¨<code>gradlew build --scan</code>ç”Ÿæˆä¸€æ£µä¾èµ–æ ‘ï¼Œç½‘é¡µç‰ˆæ–¹ä¾¿æŸ¥çœ‹ app æœ‰å“ªäº›ä¾èµ–ï¼Œè¿˜å¯ä»¥å®šä½å†…ç½‘çš„ä¾èµ–æ¥è‡ªäºå“ªä¸ªåœ°å€ã€‚</p><h2 id="å®æ–½"><a href="#å®æ–½" class="headerlink" title="å®æ–½"></a>å®æ–½</h2><p>åœ¨gradle.properties å®šä¹‰æœ¬åœ° maven è·¯å¾„</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs groovy">LOCAL_MAVEN_URL=maven_repo<br>GROUP_ID=com.wesley.test<br>SDK_VERSION=<span class="hljs-number">1.0</span><span class="hljs-number">.0</span> #ç»Ÿä¸€æ§åˆ¶æ‰€æœ‰æ¨¡å—ç‰ˆæœ¬<br></code></pre></td></tr></table></figure><p>settings.gradleå¼•å…¥æœ¬åœ°ä¾èµ–</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs groovy">maven &#123;<br>            url = uri(<span class="hljs-string">&quot;file://$&#123;rootProject.projectDir&#125;/$&#123;LOCAL_MAVEN_URL&#125;&quot;</span>)<br><br>        &#125;<br></code></pre></td></tr></table></figure><p>å„è‡ªæ¨¡å—æ¥å…¥maven-publish</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs groovy">plugins &#123;<br>    alias(libs.plugins.android.library)<br>    alias(libs.plugins.kotlin.android)<br>    id <span class="hljs-string">&#x27;maven-publish&#x27;</span><br>&#125;<br><span class="hljs-keyword">def</span> ARTIFACT_ID=<span class="hljs-string">&#x27;base-base&#x27;</span><br>android &#123;<br>    <span class="hljs-comment">//ä¸èƒ½å‘å¸ƒæºç ç»™ç¬¬ä¸‰æ–¹</span><br>    publishing &#123;<br>        singleVariant(<span class="hljs-string">&#x27;release&#x27;</span>) <span class="hljs-comment">// ä¸ç”Ÿæˆ sources JAR</span><br>    &#125;<br><br>    ...............<br><br>     <span class="hljs-comment">//å¦‚æœæœ‰æ¨¡å—é‡åï¼Œæ¯”å¦‚ feature:base, base:base, éœ€è¦å®šä¹‰</span><br>    compileOptions &#123;<br>        kotlinOptions.freeCompilerArgs += [<span class="hljs-string">&#x27;-module-name&#x27;</span>, <span class="hljs-string">&quot;$GROUP_ID.$ARTIFACT_ID&quot;</span>]<br>    &#125;<br>    <br>&#125;<br><br><br>publishing &#123;<br>    publications &#123;<br>        maven(MavenPublication) &#123;<br>            groupId GROUP_ID<br>            artifactId ARTIFACT_ID<br>            version SDK_VERSION<br><br>            afterEvaluate &#123;<br>                from components.release<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    repositories &#123;<br>        maven &#123;<br>            url rootProject.file(LOCAL_MAVEN_URL).toURI()<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>å¦‚æœæ¨¡å—å­˜åœ¨å¤šä¸ª flavorï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs groovy">plugins &#123;<br>    alias(libs.plugins.android.library)<br>    alias(libs.plugins.kotlin.android)<br>    id <span class="hljs-string">&#x27;maven-publish&#x27;</span><br>&#125;<br>android &#123;<br>    publishing &#123;<br>        multipleVariants &#123;<br>            allVariants()<br>            <span class="hljs-comment">//withJavadocJar()</span><br>        &#125;<br>    &#125;<br>&#125;<br><br>publishing &#123;<br>    publications &#123;<br>        maven(MavenPublication) &#123;<br>            groupId GROUP_ID<br>            artifactId <span class="hljs-string">&quot;feature-xxx&quot;</span><br>            version SDK_VERSION<br><br>            afterEvaluate &#123;<br>                from components.<span class="hljs-keyword">default</span><br>            &#125;<br>        &#125;<br>    &#125;<br><br>    repositories &#123;<br>        maven &#123;<br>            url rootProject.file(LOCAL_MAVEN_URL).toURI()<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¦‚æœè¦åœ¨å‘å¸ƒæ—¶æ§åˆ¶æŸäº›ä»£ç ä¸æ··æ·†æˆ–è€…ä¾èµ–æ–¹å¼å˜æ›´ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">// åœ¨æ ¹é¡¹ç›®çš„ build.gradle ä¸­</span><br>ext &#123;<br>    <span class="hljs-comment">// å®šä¹‰åˆ¤æ–­æ˜¯å¦æ˜¯å‘å¸ƒä»»åŠ¡çš„æ–¹æ³•</span><br>    isPublishTask = &#123; -&gt;<br>        gradle.startParameter.taskNames.any &#123;<br>            it.startsWith(<span class="hljs-string">&quot;publish&quot;</span>)<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-keyword">if</span> (isPublishTask()) &#123;<br>        <span class="hljs-comment">// å‘å¸ƒæ—¶å°† aar æ‰“åŒ…è¿› sdk</span><br>        println(<span class="hljs-string">&quot;wesley publish&quot;</span>)<br>        <span class="hljs-comment">//embed(project( &quot;:feature:testAAR&quot; ))</span><br>        <span class="hljs-comment">// id(&quot;com.kezong.fat-aar&quot;)</span><br>        embed project(<span class="hljs-attr">path:</span> <span class="hljs-string">&quot;:feature:testAAR&quot;</span>, <span class="hljs-attr">configuration:</span> <span class="hljs-string">&#x27;default&#x27;</span>)<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        implementation(project( <span class="hljs-string">&quot;:feature:testAAR&quot;</span> ))<br>    &#125;<br></code></pre></td></tr></table></figure><h3 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h3><p>å¯¹äºä¸æºå¸¦ aar åŒ…çš„æ¨¡å—ï¼Œæ¯”å¦‚æŸ B æ¨¡å—implementation(project( â€œ:base:baseâ€ ))ï¼Œå¦‚æœ:base:base ä¹Ÿé…ç½®äº† publish ä»»åŠ¡ï¼Œä¾èµ–å®ƒçš„æ¨¡å—ä¸éœ€è¦ä¿®æ”¹æˆè¿œç¨‹ä¾èµ–æ–¹å¼ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿé—®äº†ä¸€ä¸‹ AIï¼š</p><blockquote><h3 id="æ ¸å¿ƒåŸå› ï¼šé¡¹ç›®å†…ä¾èµ–ï¼ˆProject-Dependencyï¼‰-vs-Maven-ä¾èµ–ï¼ˆMaven-Dependencyï¼‰çš„è½¬æ¢"><a href="#æ ¸å¿ƒåŸå› ï¼šé¡¹ç›®å†…ä¾èµ–ï¼ˆProject-Dependencyï¼‰-vs-Maven-ä¾èµ–ï¼ˆMaven-Dependencyï¼‰çš„è½¬æ¢" class="headerlink" title="æ ¸å¿ƒåŸå› ï¼šé¡¹ç›®å†…ä¾èµ–ï¼ˆProject Dependencyï¼‰ vs. Maven ä¾èµ–ï¼ˆMaven Dependencyï¼‰çš„è½¬æ¢"></a>æ ¸å¿ƒåŸå› ï¼šé¡¹ç›®å†…ä¾èµ–ï¼ˆProject Dependencyï¼‰ vs. Maven ä¾èµ–ï¼ˆMaven Dependencyï¼‰çš„è½¬æ¢</h3><ol><li><strong>åœ¨æ¨¡å— A çš„æ„å»ºæœŸé—´ï¼š (<code>implementation project(&quot;:base:base&quot;)</code>)</strong><ul><li>å½“ Gradle æ„å»ºä½ çš„ <code>A</code> æ¨¡å—æ—¶ï¼Œå®ƒçœ‹åˆ°äº† <code>implementation project(&quot;:base:base&quot;)</code>ã€‚</li><li>è¿™é‡Œçš„ <code>project(...)</code> å‘Šè¯‰ Gradleï¼šâ€œè¿™æ˜¯ä¸€ä¸ª<strong>é¡¹ç›®å†…ä¾èµ–</strong>ã€‚ä½ ä¸éœ€è¦å»è¿œç¨‹ä»“åº“ä¸‹è½½ä»»ä½•ä¸œè¥¿ï¼Œç›´æ¥åœ¨æœ¬æ¬¡æ„å»ºä¸­æ‰¾åˆ° <code>:base:base</code> æ¨¡å—ï¼Œç¼–è¯‘å®ƒï¼Œç„¶åè®© <code>A</code> æ¨¡å—ä½¿ç”¨å®ƒçš„ä»£ç å³å¯ã€‚â€</li><li>åœ¨è¿™ä¸ªé˜¶æ®µï¼Œä¸€åˆ‡éƒ½åœ¨ä½ çš„æœ¬åœ°é¡¹ç›®ä¸­è¿›è¡Œï¼Œä¸ Maven ä»“åº“å’Œç‰ˆæœ¬ <code>1.1</code> æ˜¯å¦å·²å‘å¸ƒ<strong>å®Œå…¨æ— å…³</strong>ã€‚</li></ul></li><li><strong>åœ¨å‘å¸ƒæ¨¡å— A æ—¶ï¼šï¼ˆç”Ÿæˆ <code>pom.xml</code>ï¼‰</strong><ul><li>å½“ä½ è¿è¡Œ <code>publish</code> ä»»åŠ¡æ—¶ï¼Œ<code>maven-publish</code> æ’ä»¶çš„èŒè´£æ˜¯ä¸ºæ¨¡å— <code>A</code> åˆ›å»ºä¸€ä¸ªå…ƒæ•°æ®æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯ <code>pom.xml</code>ã€‚</li><li>è¿™ä¸ª POM æ–‡ä»¶æ˜¯ç»™<strong>å¤–éƒ¨ç”¨æˆ·</strong>çœ‹çš„ã€‚å¤–éƒ¨ç”¨æˆ·ï¼ˆæ¯”å¦‚ä½ çš„åŒäº‹æˆ–è€…ä¸€ä¸ªCIæœåŠ¡å™¨ï¼‰æ²¡æœ‰ä½ é¡¹ç›®çš„å®Œæ•´æºç ï¼Œä»–ä»¬éœ€è¦é€šè¿‡ Maven åæ ‡ï¼ˆgroupId:artifactId:versionï¼‰æ¥ä¸‹è½½ä¾èµ–ã€‚</li><li>å› æ­¤ï¼Œ<code>maven-publish</code> æ’ä»¶å¿…é¡»å°†é¡¹ç›®å†…ä¾èµ– <code>project(&quot;:base:base&quot;)</code> <strong>â€œç¿»è¯‘â€</strong> æˆä¸€ä¸ªå¤–éƒ¨ç”¨æˆ·å¯ä»¥ç†è§£çš„ Maven ä¾èµ–ã€‚</li></ul></li></ol><h3 id="â€œç¿»è¯‘â€çš„è¿‡ç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ"><a href="#â€œç¿»è¯‘â€çš„è¿‡ç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ" class="headerlink" title="â€œç¿»è¯‘â€çš„è¿‡ç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ"></a>â€œç¿»è¯‘â€çš„è¿‡ç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ</h3><p><code>maven-publish</code> æ’ä»¶éå¸¸æ™ºèƒ½ï¼Œå®ƒä¼šæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p><ol><li><p>å®ƒå‘ç° <code>A</code> ä¾èµ–äº <code>project(&quot;:base:base&quot;)</code>ã€‚</p></li><li><p>å®ƒä¼šå»æ£€æŸ¥ <code>:base:base</code> æ¨¡å—çš„ <code>build.gradle.kts</code> æ–‡ä»¶ã€‚</p></li><li><p>å®ƒåœ¨æ–‡ä»¶ä¸­æ‰¾åˆ°äº† </p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">publishing</span><br></code></pre></td></tr></table></figure><p> é…ç½®å—ï¼Œå¹¶è¯»å–äº†é‡Œé¢å®šä¹‰çš„ Maven åæ ‡ï¼š</p><ul><li><code>groupId: &quot;com.wesley.test&quot;</code></li><li><code>artifactId: &quot;base-base&quot;</code></li><li><code>version: &quot;1.1&quot;</code></li></ul></li><li><p>ç„¶åï¼Œå®ƒå°†è¿™äº›ä¿¡æ¯å¿ å®åœ°å†™å…¥ <code>A</code> æ¨¡å—çš„ <code>pom.xml</code> æ–‡ä»¶ä¸­ï¼Œç”Ÿæˆäº†ä½ çœ‹åˆ°çš„ <code>&lt;dependency&gt;</code> å—ã€‚</p></li></ol><blockquote><p><strong>ä¸€ä¸ªå½¢è±¡çš„æ¯”å–»ï¼š</strong> è¿™å°±åƒä½ åœ¨å†™ä¸€ä»½èœè°±ï¼ˆå‘å¸ƒæ¨¡å— Aï¼‰ã€‚ä½ åœ¨èœè°±é‡Œå†™åˆ°éœ€è¦â€œæˆ‘ç¥–æ¯çš„ç§˜åˆ¶é…±æ–™â€ï¼ˆé¡¹ç›®å†…ä¾èµ– <code>:base:base</code>ï¼‰ã€‚ä¸ºäº†è®©åˆ«äººä¹Ÿèƒ½åšå‡ºè¿™é“èœï¼Œä½ å¿…é¡»åœ¨èœè°±çš„é…æ–™è¡¨ä¸Šå†™æ¸…æ¥šè¿™ç§é…±æ–™åœ¨è¶…å¸‚é‡Œçš„å•†å“åå’Œå“ç‰Œï¼ˆMavenåæ ‡ <code>com.wesley.test:base-base:1.1</code>ï¼‰ï¼Œè€Œä¸æ˜¯åªå†™â€œæˆ‘ç¥–æ¯çš„ç§˜åˆ¶é…±æ–™â€ã€‚</p><p><code>maven-publish</code> å°±æ˜¯é‚£ä¸ªè´Ÿè´£æŠŠâ€œæˆ‘ç¥–æ¯çš„ç§˜åˆ¶é…±æ–™â€ç¿»è¯‘æˆå•†å“åçš„è§’è‰²ã€‚å®ƒå¹¶ä¸å…³å¿ƒæ­¤åˆ»è¶…å¸‚é‡Œåˆ°åº•æœ‰æ²¡æœ‰è´§ï¼ˆ<code>1.1</code> ç‰ˆæœ¬æ˜¯å¦å·²å‘å¸ƒï¼‰ï¼Œå®ƒåªè´Ÿè´£æ­£ç¡®åœ°ç¿»è¯‘èœè°±ã€‚</p></blockquote><hr><h3 id="ä¸ºä»€ä¹ˆå®ƒä¸å…³å¿ƒ-1-1-æ˜¯å¦å·²å‘å¸ƒï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆå®ƒä¸å…³å¿ƒ-1-1-æ˜¯å¦å·²å‘å¸ƒï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆå®ƒä¸å…³å¿ƒ 1.1 æ˜¯å¦å·²å‘å¸ƒï¼Ÿ"></a>ä¸ºä»€ä¹ˆå®ƒä¸å…³å¿ƒ <code>1.1</code> æ˜¯å¦å·²å‘å¸ƒï¼Ÿ</h3><p><code>publish</code> ä»»åŠ¡çš„èŒè´£æ˜¯<strong>ç”Ÿæˆå¹¶ä¸Šä¼ å½“å‰æ¨¡å—çš„æ„ä»¶å’Œå…ƒæ•°æ®</strong>ã€‚å®ƒå‡è®¾ä½ ï¼ˆå¼€å‘è€…ï¼‰ä¼šç¡®ä¿æ‰€æœ‰å£°æ˜çš„ä¾èµ–é¡¹æœ€ç»ˆéƒ½æ˜¯å¯ç”¨çš„ã€‚</p><ul><li><strong>åæœçš„æ‰¿æ‹…è€…æ˜¯æ¶ˆè´¹è€…ï¼š</strong> å¦‚æœä½ å‘å¸ƒäº† <code>A</code>ï¼Œä½†æ²¡æœ‰å‘å¸ƒ <code>:base:base</code> çš„ <code>1.1</code> ç‰ˆæœ¬ï¼Œé‚£ä¹ˆé—®é¢˜ä¸ä¼šåœ¨ä½ å‘å¸ƒæ—¶å‡ºç°ï¼Œè€Œæ˜¯åœ¨<strong>åˆ«äººä½¿ç”¨ä½ çš„ <code>A</code> æ¨¡å—æ—¶</strong>å‡ºç°ã€‚å½“ä»–ä»¬çš„é¡¹ç›®å°è¯•æ ¹æ® <code>A</code> çš„ <code>pom.xml</code> å»ä¸‹è½½ com.wesley.test:base-base:1.1&#96; æ—¶ï¼ŒMaven ä¼šå› ä¸ºæ‰¾ä¸åˆ°è¿™ä¸ªä¾èµ–è€Œæ„å»ºå¤±è´¥ã€‚</li><li><strong>è´£ä»»åœ¨ä½ ï¼š</strong> Gradle å°†ä¿è¯ä¾èµ–å…³ç³»é“¾æ­£ç¡®çš„è´£ä»»äº¤ç»™äº†å¼€å‘è€…ã€‚ä½ éœ€è¦åœ¨å‘å¸ƒ <code>A</code> ä¹‹å‰ï¼Œå…ˆå°†å®ƒçš„æ‰€æœ‰ä¾èµ–ï¼ˆå¦‚ <code>:base:base</code>ï¼‰å‘å¸ƒåˆ° Maven ä»“åº“ã€‚</li></ul></blockquote><p>æœ€åæ‰§è¡Œ publishä»»åŠ¡ï¼Œæ‰€æœ‰æ¨¡å—éƒ½å‘å¸ƒåˆ°maven_repo é‡Œé¢äº†ï¼Œä»¥åå‘å®¢æˆ·æ›´æ–°è¿™ä¸ªç›®å½•å°±è¡Œã€‚</p><p>è€Œå¯¹äºå†…ç½‘ SDKï¼Œå¯ä»¥åœ¨ç½‘é¡µç‰ˆä¾èµ–æ ‘æ‰¾åˆ°ä»–ä»¬ï¼Œç„¶åé€šè¿‡ç±»ä¼¼</p><p><code>wget -r -np -nH --cut-dirs=8 -R &quot;index.html*&quot;      http://172.20.135.19:8080/nexus/content/repositories/releases/com/wesley/sdk/protocol/2.1.8/</code>çš„å‘½ä»¤ä¸‹è½½ï¼ŒæŠŠæ–‡ä»¶ä¸¢è¿›maven_repoï¼ˆæ³¨æ„ç›®å½•ç»“æ„ï¼‰ï¼Œè¿™æ ·ä¾èµ–ä¹Ÿå¯ä»¥æ­£ç¡®ä¼ é€’äº†ã€‚ï¼ˆå¦‚æœåŒ…å«æºç ï¼Œå¯ä»¥è€ƒè™‘åˆ é™¤ï¼‰</p><h2 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h2><p>åˆ æ‰å·¥ç¨‹ç­¾åæ–‡ä»¶ã€‚</p><p>å¦‚æœæœ‰äº›æ¨¡å—ä¸èƒ½å…¬å¼€ï¼Œæ··æ·†åä¸èƒ½å‘å¸ƒæºç ã€‚</p><p>ä¸èƒ½æºå¸¦ .git ç›®å½•ã€‚</p><p>æ³¨æ„å¤„ç† UI æ¨¡å—ä¾èµ–å…¶ä»–æ¨¡å—çš„æ–¹æ³•æˆ–è€…ç±»ï¼Œä¸èƒ½æ··æ·†ã€‚</p><p>æ³¨æ„å¤„ç†ä¸€äº›é…ç½®ä¿¡æ¯æˆ–è€…å…³é”®ä»£ç ï¼Œå¯ä»¥è€ƒè™‘è½¬ç§»åˆ° native å±‚ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>AppBuild</category>
      
    </categories>
    
    
    <tags>
      
      <tag>gradle</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®‰å“å®˜æ–¹ç‰ˆfat-aar:ä½¿ç”¨Fused Libraryå°†å¤šä¸ªAndroidåº“å‘å¸ƒä¸ºä¸€ä¸ªåº“</title>
    <link href="/article/a43c0ba5/"/>
    <url>/article/a43c0ba5/</url>
    
    <content type="html"><![CDATA[<p>åœ¨å¼€å‘ sdk æ—¶ï¼Œå†…éƒ¨ä¸€èˆ¬ä¼šåˆ’åˆ†å¥½å‡ ä¸ªæ¨¡å—ã€‚ä½†å½“éœ€è¦æ‰“åŒ…æˆä¸€ä¸ªæ¨¡å—å‘å¸ƒæ—¶ï¼Œå¾€å¾€éœ€è¦ä¾èµ–ç¬¬ä¸‰æ–¹æ’ä»¶ã€‚æ¯”å¦‚è‘—åçš„ fat-aarï¼š<a href="https://github.com/kezong/fat-aar-android%EF%BC%8C%E4%BD%86%E8%AF%A5%E5%BA%93%E4%B8%8D%E6%94%AF%E6%8C%81">https://github.com/kezong/fat-aar-androidï¼Œä½†è¯¥åº“ä¸æ”¯æŒ</a> AGP8.0 äº†ï¼Œæœ‰å…¶ä»–å¼€å‘è€…å•ç‹¬forkäº†ä¸€ä¸ªä»“åº“æ¥è¿›è¡Œç»´æŠ¤ï¼Œæ”¯æŒ AGP8.0+ï¼š<a href="https://github.com/aasitnikov/fat-aar-android">aasitnikov&#x2F;fat-aar-android: Gradle plugin for merging android libraries (AAR)</a>ã€‚</p><p>ç°åœ¨å®‰å“å®˜æ–¹ç»ˆäºæ”¯æŒå°†å¤šä¸ªåº“æ‰“åŒ…æˆä¸€ä¸ªaar äº†ï¼š<a href="https://developer.android.com/build/publish-library/fused-library">Publish multiple Android libraries as one with Fused Library  |  Android Studio  |  Android Developers</a>ã€‚å®£å¸ƒä» AGP8.12 å¼€å§‹å¯ä»¥ä½¿ç”¨<code>com.android.fused-library</code>æ¥è¿›è¡Œåˆå¹¶å¤šæ¨¡å—ã€‚ä¸è¿‡ä»<a href="https://mvnrepository.com/artifact/com.android.fused-library/com.android.fused-library.gradle.plugin">Maven Repository: com.android.fused-library Â» com.android.fused-library.gradle.plugin</a>ä¸Šé¢å¯ä»¥çœ‹åˆ°ï¼Œä¸€äº›æ—©æœŸç‰ˆæœ¬ä¹Ÿå¯ä»¥æ”¯æŒçš„ï¼Œä¸è¿‡å¯èƒ½æœ‰ bugï¼Œæˆ‘è¯•äº† AGP8.10 ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</p><p>ç›¸æ¯” fat-aar çš„ä¼˜ç‚¹æ˜¯ï¼š</p><ul><li>å®˜æ–¹æ”¯æŒ</li><li>åˆå¹¶æ¨¡å—æ—¶æ”¯æŒä¾èµ–ä¼ é€’ï¼Œä¹Ÿå°±æ˜¯å­æ¨¡å—çš„ä¾èµ–æ ‘ä¼šå‡ºç°åœ¨ pom æ–‡ä»¶é‡Œé¢ã€‚fat-aar éœ€è¦é€šè¿‡pom.withXml æ¥å¤„ç†ã€‚</li></ul><p>ç¼ºç‚¹æ˜¯ï¼š</p><ul><li>æ”¯æŒæ’ä»¶ç‰ˆæœ¬æœ‰é™ï¼Œå®˜æ–¹è¡¨ç¤ºæ˜¯AGP8.12 å¼€å§‹æ‰æ”¯æŒã€‚</li><li>ä¼ é€’ä¾èµ–é¡¹ä¸ä¼šæ‰“åŒ…ã€‚éœ€è¦é€ä¸ªæŒ‡å®šæ‰“åŒ…è¿› aar çš„ä¾èµ–ã€‚</li></ul><p>åé¢è¿˜ä¼šç»§ç»­è¯´è¯¥åº“ç›®å‰çš„é—®é¢˜ï¼Œå…ˆçœ‹çœ‹æ€ä¹ˆç”¨ã€‚</p><p>å®˜æ–¹çš„å·¥ç¨‹ç¤ºèŒƒï¼š</p><blockquote><p>readme çš„æ’ä»¶åç§°ç›®å‰æ˜¯å†™é”™äº†çš„ï¼šåº”è¯¥æ˜¯<code>com.android.fused-library</code></p></blockquote><p><a href="https://github.com/android/gradle-recipes/tree/agp-8.10/applyFusedLibraryPlugin">gradle-recipes&#x2F;applyFusedLibraryPlugin at agp-8.10 Â· android&#x2F;gradle-recipes</a></p><p>å¯ä»¥å‚è€ƒè¿™ä¸ªè¿›è¡Œæ’ä»¶å¼•å…¥ï¼š</p><p><a href="https://developer.android.com/build/publish-library/fused-library">Publish multiple Android libraries as one with Fused Library  |  Android Studio  |  Android Developers</a></p><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><h3 id="åµŒå¥—ä¾èµ–ä¸æ”¯æŒæ‰“åŒ…"><a href="#åµŒå¥—ä¾èµ–ä¸æ”¯æŒæ‰“åŒ…" class="headerlink" title="åµŒå¥—ä¾èµ–ä¸æ”¯æŒæ‰“åŒ…"></a>åµŒå¥—ä¾èµ–ä¸æ”¯æŒæ‰“åŒ…</h3><p>å®˜æ–¹çš„ä¾‹å­æ˜¯æ”¯æŒåµŒå¥—çš„ï¼š</p><blockquote><p><code>*</code> indicates an <code>include</code> dependency of the <code>:fusedLibrary</code> module</p></blockquote><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs elixir">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<br>â”‚             <span class="hljs-symbol">:app</span>                        â”‚<br>â”‚               â–²                         â”‚<br>â”‚               â”‚                         â”‚<br>â”‚         <span class="hljs-symbol">:fusedLibrary</span>                   â”‚<br>â”‚         â–²           â–²                   â”‚<br>â”‚         â”‚           â”‚                   â”‚<br>â”‚    <span class="hljs-symbol">:androidLib2*</span>  <span class="hljs-symbol">:androidLib1*</span>         â”‚<br>â”‚         â–²            â–²                  â”‚<br>â”‚         â”‚            â”‚                  â”‚<br>â”‚ <span class="hljs-symbol">:androidLib3</span> <span class="hljs-symbol">com.google.code.gson:</span>gson* â”‚<br>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<br></code></pre></td></tr></table></figure><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">dependencies &#123;<br>    include(project(<span class="hljs-string">&quot;:androidLib1&quot;</span>))<br>    include(project(<span class="hljs-string">&quot;:androidLib2&quot;</span>))<br>    include(<span class="hljs-string">&quot;com.google.code.gson:gson:2.10.1&quot;</span>)<br>    include(files(<span class="hljs-string">&quot;libs/simple-jar-with-A_DoIExist-class.jar&quot;</span>))<br>&#125;<br></code></pre></td></tr></table></figure><p>å®é™…ä¸ŠandroidLib3 æ²¡æœ‰è¢«æ‰“åŒ…ï¼Œå˜æˆäº†ä¸€ä¸ªä¾èµ–fused-library-samples:androidLib3:unspecifiedï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;included&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>    <span class="hljs-string">&quot;project :androidLib1&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-string">&quot;project :androidLib2&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-string">&quot;com.google.code.gson:gson:2.10.1&quot;</span><br>  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;dependencies&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>    <span class="hljs-string">&quot;org.jetbrains.kotlin:kotlin-stdlib:1.9.22&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-string">&quot;org.jetbrains:annotations:13.0&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-string">&quot;fused-library-samples:androidLib3:unspecified&quot;</span><br>  <span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><h3 id="æœ‰ä¸€äº›è¿œç¨‹åŒ…æš‚æ—¶æ‰“åŒ…ä¸äº†"><a href="#æœ‰ä¸€äº›è¿œç¨‹åŒ…æš‚æ—¶æ‰“åŒ…ä¸äº†" class="headerlink" title="æœ‰ä¸€äº›è¿œç¨‹åŒ…æš‚æ—¶æ‰“åŒ…ä¸äº†"></a>æœ‰ä¸€äº›è¿œç¨‹åŒ…æš‚æ—¶æ‰“åŒ…ä¸äº†</h3><p>A failure occurred while executing com.android.build.gradle.tasks.FusedLibraryMergeArtifactTask$FusedLibraryMergeArtifactWorkAction</p><p>   &gt; java.lang.NullPointerException (no error message)</p><h3 id="æš‚ä¸æ”¯æŒæºå¸¦æºç å‘å¸ƒ"><a href="#æš‚ä¸æ”¯æŒæºå¸¦æºç å‘å¸ƒ" class="headerlink" title="æš‚ä¸æ”¯æŒæºå¸¦æºç å‘å¸ƒ"></a>æš‚ä¸æ”¯æŒæºå¸¦æºç å‘å¸ƒ</h3><h3 id="æš‚ä¸èƒ½æ··æ·†"><a href="#æš‚ä¸èƒ½æ··æ·†" class="headerlink" title="æš‚ä¸èƒ½æ··æ·†"></a>æš‚ä¸èƒ½æ··æ·†</h3><h3 id="ä¸æ”¯æŒDatabinding"><a href="#ä¸æ”¯æŒDatabinding" class="headerlink" title="ä¸æ”¯æŒDatabinding"></a>ä¸æ”¯æŒDatabinding</h3><h3 id="æ— æ³•åœ¨å•ä¸ªèåˆåº“ä¸­èåˆå¤šä¸ª-build-ç±»å‹å’Œäº§å“å˜ç§ã€‚éœ€è¦ä¸ºä¸åŒçš„å˜ä½“åˆ›å»ºå•ç‹¬çš„èåˆåº“ã€‚"><a href="#æ— æ³•åœ¨å•ä¸ªèåˆåº“ä¸­èåˆå¤šä¸ª-build-ç±»å‹å’Œäº§å“å˜ç§ã€‚éœ€è¦ä¸ºä¸åŒçš„å˜ä½“åˆ›å»ºå•ç‹¬çš„èåˆåº“ã€‚" class="headerlink" title="æ— æ³•åœ¨å•ä¸ªèåˆåº“ä¸­èåˆå¤šä¸ª build ç±»å‹å’Œäº§å“å˜ç§ã€‚éœ€è¦ä¸ºä¸åŒçš„å˜ä½“åˆ›å»ºå•ç‹¬çš„èåˆåº“ã€‚"></a>æ— æ³•åœ¨å•ä¸ªèåˆåº“ä¸­èåˆå¤šä¸ª build ç±»å‹å’Œäº§å“å˜ç§ã€‚éœ€è¦ä¸ºä¸åŒçš„å˜ä½“åˆ›å»ºå•ç‹¬çš„èåˆåº“ã€‚</h3><h3 id="kotlin-moduleå†²çª"><a href="#kotlin-moduleå†²çª" class="headerlink" title="kotlin_moduleå†²çª"></a>kotlin_moduleå†²çª</h3><p>å¦‚æœæœ‰ä¸¤ä¸ªbaseæ¨¡å—ä¼šäº§ç”Ÿå†²çªï¼Œ base&#x2F;base ï¼Œfeature&#x2F;base</p><p>2 files found with path â€˜META-INF&#x2F;base_release.kotlin_moduleâ€™ from inputs:</p><p>éœ€è¦ä¿®æ”¹ä¸€ä¸‹kotlin_module çš„åå­—</p><p><a href="https://stackoverflow.com/questions/44509608/duplicate-files-copied-in-apk-meta-inf-library-release-kotlin-module">android - Duplicate files copied in APK META-INF&#x2F;library_release.kotlin_module - Stack Overflow</a></p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs groovy">ext &#123;<br>    GROUP_ID = <span class="hljs-string">&#x27;custom.group.id&#x27;</span><br>    ARTIFACT_ID = <span class="hljs-string">&#x27;artifactid&#x27;</span><br>&#125;<br><br>android &#123;<br>    compileSdkVersion <span class="hljs-number">25</span><br>    buildToolsVersion <span class="hljs-string">&quot;25.0.0&quot;</span><br><br>    compileOptions &#123;<br>        kotlinOptions.freeCompilerArgs += [<span class="hljs-string">&#x27;-module-name&#x27;</span>, <span class="hljs-string">&quot;$GROUP_ID.$ARTIFACT_ID&quot;</span>]<br>    &#125;<br><br>    defaultConfig &#123;<br>        ...<br>    &#125;<br>    buildTypes &#123;<br>        ...<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å®˜æ–¹å·²çŸ¥é—®é¢˜"><a href="#å®˜æ–¹å·²çŸ¥é—®é¢˜" class="headerlink" title="å®˜æ–¹å·²çŸ¥é—®é¢˜"></a>å®˜æ–¹å·²çŸ¥é—®é¢˜</h3><p>èåˆåº“æ˜¯ä¸€ä¸ªæ–°æ’ä»¶ï¼Œæˆ‘ä»¬æ­£åœ¨è§£å†³ä¸€äº›å·²çŸ¥é—®é¢˜ï¼Œä»¥å®ç°æ‰€æœ‰ç”¨ä¾‹ã€‚</p><ul><li>åˆå¹¶çš„ AAR ä¸­æœªåŒ…å« <code>lint.jar</code> æ–‡ä»¶</li><li>å‘å…¶ä»– .aar æ–‡ä»¶æ·»åŠ æ–‡ä»¶ä¾èµ–é¡¹</li><li>ä¸æ”¯æŒåˆå¹¶ RenderScript å’Œ Prefab å·¥ä»¶</li></ul><p>æœŸå¾…å®˜æ–¹è¿›ä¸€æ­¥å®Œå–„ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>AppBuild</category>
      
    </categories>
    
    
    <tags>
      
      <tag>gradle</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ‰‹æœºå‚å•†çš„åº”ç”¨åˆ—è¡¨æƒé™ç®¡æ§çœŸçš„èµ·æ•ˆäº†å—</title>
    <link href="/article/e6389157/"/>
    <url>/article/e6389157/</url>
    
    <content type="html"><![CDATA[<p>æ˜¨å¤©ä½¿ç”¨<strong>åšä½ çš„å›¾æ ‡åŒ…</strong>åˆ¶ä½œå›¾æ ‡åŒ…çš„æ—¶å€™å‘ç°æˆ‘å¹¶æ²¡æœ‰æˆäºˆå®ƒè·å–åº”ç”¨åˆ—è¡¨çš„æƒé™ï¼Œä½†æ˜¯ä¾ç„¶å¯ä»¥è·å–åˆ°æˆ‘å®‰è£…çš„åº”ç”¨åˆ—è¡¨ã€‚</p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2025/20250511190040532.jpg" style="zoom:25%;" /><p>ç„¶åå‘ç°å®ƒçš„ targetSDK æ˜¯ 33 å¹¶ç”³è¯·äº†<code>&lt;uses-permission android:name=&quot;android.permission.QUERY_ALL_PACKAGES&quot;/&gt;</code>æƒé™å’Œä½¿ç”¨äº†å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">PackageManager</span> <span class="hljs-variable">packageManager</span> <span class="hljs-operator">=</span> context2.getPackageManager();<br><span class="hljs-type">Intent</span> <span class="hljs-variable">intent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>(<span class="hljs-string">&quot;android.intent.action.MAIN&quot;</span>);<br>intent.addCategory(<span class="hljs-string">&quot;android.intent.category.LAUNCHER&quot;</span>);<br>List&lt;ResolveInfo&gt; queryIntentActivities = packageManager.queryIntentActivities(intent, <span class="hljs-number">0</span>);<br></code></pre></td></tr></table></figure><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2025/20250511190439764.png" alt="image-20250511190439462" style="zoom: 50%;" /><p>æ­£å¸¸æ‹¿åˆ°äº†æˆ‘æ‰‹æœºä¸Šçš„è®¾å¤‡åº”ç”¨å®‰è£…åˆ—è¡¨å¹¶ä¸”æƒé™ç›‘æ§é‡Œé¢æ²¡æœ‰çœ‹åˆ°è®°å½•ã€‚è¿™æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿ</p><h2 id="å®éªŒ"><a href="#å®éªŒ" class="headerlink" title="å®éªŒ"></a>å®éªŒ</h2><p>é€šè¿‡ä¸‹é¢çš„ä»£ç è¿›è¡Œå®éªŒ</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getInstalledPackages</span><span class="hljs-params">(context: <span class="hljs-type">Context</span>)</span></span>: List&lt;String&gt; &#123;<br>        <span class="hljs-keyword">val</span> installedPackageList: MutableList&lt;String&gt; = ArrayList()<br>        <span class="hljs-keyword">val</span> installedPackageInfoList = context.packageManager.getInstalledPackages(PackageManager.MATCH_UNINSTALLED_PACKAGES)<br>        <span class="hljs-keyword">for</span> (packageInfo <span class="hljs-keyword">in</span> installedPackageInfoList) &#123;<br>            installedPackageList.add(packageInfo.packageName)<br>        &#125;<br>        Log.e(TAG, <span class="hljs-string">&quot;getInstalledPackages: sizeï¼š<span class="hljs-subst">$&#123;installedPackageList.size&#125;</span> pkg:<span class="hljs-variable">$installedPackageList</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span> installedPackageList<br>    &#125;<br><br>    <span class="hljs-comment">//è·å–æ‰€æœ‰å¸¦æœ‰æ¡Œé¢å±æ€§çš„APK</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getAllLauncherIconPackages</span><span class="hljs-params">(context: <span class="hljs-type">Context</span>)</span></span>: List&lt;String&gt; &#123;<br>        <span class="hljs-keyword">val</span> launcherIconPackageList: MutableList&lt;String&gt; = ArrayList()<br>        <span class="hljs-keyword">val</span> intent = Intent()<br>        intent.setAction(Intent.ACTION_MAIN)<br>        intent.addCategory(Intent.CATEGORY_LAUNCHER)<br>        <span class="hljs-keyword">val</span> resolveInfos = context.packageManager.queryIntentActivities(intent, PackageManager.MATCH_ALL)<br>        <span class="hljs-keyword">for</span> (info <span class="hljs-keyword">in</span> resolveInfos) &#123;<br>            launcherIconPackageList.add(info.activityInfo.packageName)<br>        &#125;<br>        Log.e(TAG, <span class="hljs-string">&quot;getAllLauncherIconPackages: size:<span class="hljs-subst">$&#123;launcherIconPackageList.size&#125;</span> pkg:<span class="hljs-variable">$launcherIconPackageList</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span> launcherIconPackageList<br>    &#125;<br></code></pre></td></tr></table></figure><h3 id="åœ¨ç¦æ­¢åº”ç”¨åˆ—è¡¨æƒé™æƒ…å†µä¸‹æµ‹è¯•"><a href="#åœ¨ç¦æ­¢åº”ç”¨åˆ—è¡¨æƒé™æƒ…å†µä¸‹æµ‹è¯•" class="headerlink" title="åœ¨ç¦æ­¢åº”ç”¨åˆ—è¡¨æƒé™æƒ…å†µä¸‹æµ‹è¯•"></a>åœ¨ç¦æ­¢åº”ç”¨åˆ—è¡¨æƒé™æƒ…å†µä¸‹æµ‹è¯•</h3><p>Oppo find8u Xiaomi13 éƒ½æ˜¯å®‰å“ 15</p><h4 id="æƒ…å†µ1-ä¸ç”³è¯·QUERY-ALL-PACKAGES"><a href="#æƒ…å†µ1-ä¸ç”³è¯·QUERY-ALL-PACKAGES" class="headerlink" title="æƒ…å†µ1 ä¸ç”³è¯·QUERY_ALL_PACKAGES"></a>æƒ…å†µ1 ä¸ç”³è¯·<code>QUERY_ALL_PACKAGES</code></h4><p>oppo</p><blockquote><p>PermissionInjector: Permission denied: uid: 10445 or pid: 14074 have no permission: com.android.permission.GET_INSTALLED_APPS to access: get_installed</p><p>ApplicationPackageManagerExtImpl: com.example.myapplication in userId&#x3D;0 doesnâ€™t have GET_INSTALLED_APPS perm, return self!</p><p>getInstalledPackages: sizeï¼š1 pkg:[com.example.myapplication]</p><p>getAllLauncherIconPackages: size:8 pkg:[com.android.settings, com.android.vending, com.coloros.gallery3d, com.oplus.camera, com.android.documentsui, com.android.stk, com.android.stk, com.example.myapplication]</p></blockquote><p>xiaomi</p><blockquote><p>MIUILOG- Permission Denied getInstalledPackages. pkg : com.example.myapplication uid : 10236<br>getInstalledPackages: sizeï¼š1 pkg:[com.example.myapplication]<br>getAllLauncherIconPackages: size:13 pkg:[com.android.browser, com.android.camera, com.android.fileexplorer, com.android.settings, com.android.thememanager, com.android.vending, com.miui.miservice, com.xiaomi.market, com.miui.notes, com.miui.securitycenter, com.miui.voiceassist, com.example.myapplication, com.miui.huanji]</p></blockquote><p><code>getInstalledPackages</code> åªèƒ½è·å–åˆ°è‡ªå·±çš„åº”ç”¨ï¼Œä¸”ä¼šè¢«æƒé™ç›‘æ§è®°å½•ï¼Œ<code>queryIntentActivities</code> å¯ä»¥è·å–éƒ¨åˆ†ç³»ç»Ÿåº”ç”¨</p><h4 id="æƒ…å†µ2-ç”³è¯·QUERY-ALL-PACKAGES"><a href="#æƒ…å†µ2-ç”³è¯·QUERY-ALL-PACKAGES" class="headerlink" title="æƒ…å†µ2 ç”³è¯·QUERY_ALL_PACKAGES"></a>æƒ…å†µ2 ç”³è¯·<code>QUERY_ALL_PACKAGES</code></h4><p>oppo</p><blockquote><p>getInstalledPackages: sizeï¼š1 pkg:[com.example.myapplication]</p><p>getAllLauncherIconPackages: size:<strong>155</strong> pkg:[com.android.contactsâ€¦â€¦â€¦â€¦.</p></blockquote><p>xiaomi</p><blockquote><p>getInstalledPackages: sizeï¼š1 pkg:[com.example.myapplication]<br>getAllLauncherIconPackages: size:<strong>279</strong> pkg:[com.android.browser, com.android.camera, com.android.contactsâ€¦â€¦â€¦â€¦</p></blockquote><p><code>getInstalledPackages</code> åªèƒ½è·å–åˆ°è‡ªå·±çš„åº”ç”¨ï¼Œä¸”ä¼šè¢«æƒé™ç›‘æ§è®°å½•ï¼Œ<code>queryIntentActivities</code> å¯ä»¥è·å–æ‰€æœ‰å¸¦æœ‰æ¡Œé¢å±æ€§çš„åº”ç”¨</p><h4 id="æƒ…å†µ3-ä¸ç”³è¯·QUERY-ALL-PACKAGESä½†å£°æ˜queries"><a href="#æƒ…å†µ3-ä¸ç”³è¯·QUERY-ALL-PACKAGESä½†å£°æ˜queries" class="headerlink" title="æƒ…å†µ3 ä¸ç”³è¯·QUERY_ALL_PACKAGESä½†å£°æ˜queries"></a>æƒ…å†µ3 ä¸ç”³è¯·<code>QUERY_ALL_PACKAGES</code>ä½†å£°æ˜queries</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">queries</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">intent</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">&quot;android.intent.action.MAIN&quot;</span> /&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">category</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">&quot;android.intent.category.LAUNCHER&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">intent</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">queries</span>&gt;</span><br></code></pre></td></tr></table></figure><p>oppo</p><blockquote><p>getInstalledPackages: sizeï¼š1 pkg:[com.example.myapplication]</p><p>getAllLauncherIconPackages: size:<strong>155</strong> pkg:[com.android.contacts,â€¦â€¦â€¦â€¦â€¦</p></blockquote><p>xiaomi</p><blockquote><p>getInstalledPackages: sizeï¼š1 pkg:[com.example.myapplication]<br>getAllLauncherIconPackages: size:<strong>279</strong> pkg:[com.android.browserâ€¦â€¦â€¦..</p></blockquote><p><code>getInstalledPackages</code> åªèƒ½è·å–åˆ°è‡ªå·±çš„åº”ç”¨ï¼Œä¸”ä¼šè¢«æƒé™ç›‘æ§è®°å½•ï¼Œ<code>queryIntentActivities</code> å¯ä»¥è·å–æ‰€æœ‰å¸¦æœ‰æ¡Œé¢å±æ€§çš„åº”ç”¨</p><h2 id="ç°çŠ¶"><a href="#ç°çŠ¶" class="headerlink" title="ç°çŠ¶"></a>ç°çŠ¶</h2><p>è¿˜æ˜¯å¾ˆå¤šåº”ç”¨ç”³è¯·äº†QUERY_ALL_PACKAGES æƒé™çš„ï¼Œæ„å‘³ç€å¾ˆå®¹æ˜“æ”¶é›†æ‰‹æœºé‡Œé¢çš„å®‰è£…åˆ—è¡¨ã€‚æˆ–è€…ä¸ç”³è¯·QUERY_ALL_PACKAGESï¼Œç›´æ¥å£°æ˜queriesï¼Œæ¯”å¦‚å¾®ä¿¡å°±æ˜¯è¿™ä¹ˆå¹²çš„ã€‚æ‰€ä»¥å‚å•†çš„è¿™ä¸ªåº”ç”¨åˆ—è¡¨ç®¡æ§èƒ½èµ·åˆ°çš„ä½œç”¨å¯èƒ½ä¸å¤§ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">intent</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">action</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:name</span>=<span class="hljs-string">&quot;android.intent.action.MAIN&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">category</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:name</span>=<span class="hljs-string">&quot;android.intent.category.LAUNCHER&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">intent</span>&gt;</span><br></code></pre></td></tr></table></figure><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2025/20250511204049921.jpg" alt="IMG_20250511_203845" style="zoom:25%;" /><h2 id="åŸå› "><a href="#åŸå› " class="headerlink" title="åŸå› "></a>åŸå› </h2><p>ä¸€èˆ¬æ¥è¯´ï¼Œè¿™äº›æƒé™éƒ½æ˜¯é€šè¿‡ <strong>AppOps</strong>ç®¡æ§çš„ï¼Œå½“åˆå®‰å“ 6 åŠ å…¥è¿è¡Œæ—¶æƒé™æ—¶ï¼Œå¯¹äºé‚£äº›æ²¡æœ‰é€‚é…è¿è¡Œæ—¶æƒé™çš„åº”ç”¨ï¼Œå°±æ˜¯é€šè¿‡<strong>AppOps</strong>ç®¡æ§çš„ã€‚</p><p>oppo</p><blockquote><p>OP5DD3L1:&#x2F; $ appops get com.example.myapplication</p><p>GET_INSTALLED_APPS: ignore</p></blockquote><p>xiaomi</p><blockquote><p>fuxi:&#x2F; $ appops get com.example.myapplication</p><p>MIUIOP(10022): ignore; time&#x3D;+7h1m54s781ms ago; rejectTime&#x3D;+32m9s128ms ago</p></blockquote><p><code>public static final int OP_GET_INSTALLED_APPS = 10022;</code></p><p>ä»–ä»¬éƒ½æ˜¯åªé’ˆå¯¹getInstalledPackages æƒé™åšç®¡æ§ã€‚æœ‰å…´è¶£çš„å¯ä»¥ pull æ‰‹æœºé‡Œé¢çš„ framework å’Œ service jar åŒ…æ¥çœ‹ä¸€ä¸‹ä»–ä»¬çš„æºä»£ç ã€‚</p><h3 id="åŒ…å¯è§æ€§"><a href="#åŒ…å¯è§æ€§" class="headerlink" title="åŒ…å¯è§æ€§"></a>åŒ…å¯è§æ€§</h3><h4 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h4><p>Googleå®˜ç½‘ç‰¹æ€§ä»‹ç»:</p><p><a href="https://developer.android.google.cn/preview/privacy/package-visibility">https://developer.android.google.cn/preview/privacy/package-visibility</a></p><p>Android 11 æ›´æ”¹äº†åº”ç”¨æŸ¥è¯¢ç”¨æˆ·å·²åœ¨è®¾å¤‡ä¸Šå®‰è£…çš„å…¶ä»–åº”ç”¨ä»¥åŠä¸ä¹‹äº¤äº’çš„æ–¹å¼ã€‚ä½¿ç”¨ <queries> å…ƒç´ ï¼Œåº”ç”¨å¯ä»¥å®šä¹‰ä¸€ç»„è‡ªèº«å¯è®¿é—®çš„å…¶ä»–è½¯ä»¶åŒ…ã€‚é€šè¿‡å‘ŠçŸ¥ç³»ç»Ÿåº”å‘æ‚¨çš„åº”ç”¨æ˜¾ç¤ºå“ªäº›å…¶ä»–è½¯ä»¶åŒ…ï¼Œæ­¤å…ƒç´ æœ‰åŠ©äºé¼“åŠ±æœ€å°æƒé™åŸåˆ™ã€‚æ­¤å¤–ï¼Œæ­¤å…ƒç´ è¿˜å¯å¸®åŠ© Google Play ç­‰åº”ç”¨å•†åº—è¯„ä¼°åº”ç”¨ä¸ºç”¨æˆ·æä¾›çš„éšç§æƒå’Œå®‰å…¨æ€§ã€‚</p><p>å¦‚æœæ‚¨çš„åº”ç”¨ä»¥ Android 11 æˆ–æ›´é«˜ç‰ˆæœ¬ä¸ºç›®æ ‡å¹³å°ï¼Œæ‚¨å¯èƒ½éœ€è¦åœ¨åº”ç”¨çš„æ¸…å•æ–‡ä»¶ä¸­æ·»åŠ  <queries> å…ƒç´ ã€‚åœ¨ <queries> å…ƒç´ ä¸­ï¼Œæ‚¨å¯ä»¥æŒ‰è½¯ä»¶åŒ…åç§°ã€intent ç­¾åæˆ–æä¾›ç¨‹åºæˆæƒæŒ‡å®šè½¯ä»¶åŒ…ã€‚</p><h4 id="å…¼å®¹æ€§å½±å“"><a href="#å…¼å®¹æ€§å½±å“" class="headerlink" title="å…¼å®¹æ€§å½±å“"></a>å…¼å®¹æ€§å½±å“</h4><ol><li>SDKæ¥å£è¡Œä¸ºå˜æ›´</li></ol><p>appé»˜è®¤ä¸å†èƒ½é€šè¿‡SDKæ¥å£è·å–å…¶ä»–appçš„ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼š</p><p><code>getPackageInfo(getPackageName(), 0)</code> ä»èƒ½æ­£å¸¸è¿”å›åº”ç”¨è‡ªèº«çš„<code>PackageInfo</code>,ä½†<code>getPackageInfo(â€œcom.another.appâ€,0)</code>å°†æŠ›å‡ºNameNotFoundExceptionï¼Œå³ä½¿<code>com.another.app</code>å·²ç»è¢«å®‰è£…åˆ°è®¾å¤‡ä¸Šã€‚<code>getInstalledPackages(0)</code>ï¼Œåªèƒ½è¿”å›åº”ç”¨è‡ªèº«ï¼Œä»¥åŠå°‘æ•°çš„æ ¸å¿ƒAOSPåº”ç”¨çš„ä¿¡æ¯ã€‚</p><ol start="2"><li>å…¶ä»–å˜æ›´</li></ol><p>appä¸èƒ½æ„ŸçŸ¥<code>/data/data/com.another.app</code>ç­‰ç›®å½•çš„å­˜åœ¨ã€‚å³ä½¿<code>com.another.app</code>å·²ç»è¢«å®‰è£…åˆ°è®¾å¤‡ä¸Šï¼Œappå°è¯•è®¿é—®<code>/data/data/com.another.app</code>ä¹Ÿå°†æç¤ºâ€œFile not foundâ€ï¼Œè€Œä¸æ˜¯â€œPermission deniedâ€ã€‚</p><p>ç±»ä¼¼çš„ç›®å½•è¿˜æœ‰<code>/data/misc/profiles/cur/$&#123;userId&#125;/com.another.app</code>ã€‚æ­¤å˜æ›´ï¼Œå¯ä»¥é˜²æ­¢appé€šè¿‡è®¿é—®ç›®å½•æ–‡ä»¶è¿”å›çš„é”™è¯¯ä¸åŒï¼Œæ¥åˆ¤æ–­ç‰¹å®šappæ˜¯å¦å·²è¢«å®‰è£…ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://developer.android.google.cn/training/package-visibility?hl=zh-cn">Android ä¸Šçš„è½¯ä»¶åŒ…å¯è§æ€§è¿‡æ»¤  |  App architecture  |  Android Developers</a></p><p><a href="https://developer.android.com/training/package-visibility/automatic?hl=zh-cn">äº†è§£è‡ªåŠ¨å¯è§çš„è½¯ä»¶åŒ…  |  App architecture  |  Android Developers</a></p><p><a href="https://developer.android.com/training/package-visibility/declaring?hl=zh-cn">å£°æ˜è½¯ä»¶åŒ…å¯è§æ€§éœ€æ±‚  |  App architecture  |  Android Developers</a></p><p><a href="https://developer.android.com/training/package-visibility/testing?hl=zh-cn">æµ‹è¯•è½¯ä»¶åŒ…å¯è§æ€§è¡Œä¸º  |  App architecture  |  Android Developers</a></p><p><a href="https://dev.mi.com/xiaomihyperos/documentation/detail?pId=1738">åº”ç”¨TargetSdkVersion 30å‡çº§é€‚é…æŒ‡å— | å°ç±³æ¾æ¹ƒOSå¼€å‘è€…å¹³å°</a></p><p><a href="https://open.oppomobile.com/new/developmentDoc/info?id=10724">OPPO å¼€æ”¾å¹³å°-OPPOå¼€å‘è€…æœåŠ¡ä¸­å¿ƒ</a></p><p><a href="https://gddhy.net/2023/android-11-gua-pei-ruan-jian-bao-ke-jian-xing/">Android 11 é€‚é… è½¯ä»¶åŒ…å¯è§æ€§ | Gddhyâ€™s Blog</a></p><p><a href="https://bbs.kanxue.com/thread-280415.htm">ç»•è¿‡ Android11æ–°ç‰¹æ€§ä¹‹ â€œåŒ…çš„å¯è§æ€§â€œ-Androidå®‰å…¨-çœ‹é›ª-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|kanxue.com</a></p><p><a href="https://juejin.cn/post/7353292009086173218">Android11â€œåŒ…å¯è§æ€§â€â€”åŠ¨æ€ä¿®æ”¹queriesæ–¹æ¡ˆAndroid 11å¼•å…¥äº†â€œåŒ…å¯è§æ€§â€é™åˆ¶ï¼Œé»˜è®¤æƒ…å†µä¸‹åº”ç”¨ - æ˜é‡‘</a></p><p><a href="https://www.taf.org.cn/upload/AssociationStandard/TTAF%20108-2022%20%E7%A7%BB%E5%8A%A8%E7%BB%88%E7%AB%AF%E5%BA%94%E7%94%A8%E8%BD%AF%E4%BB%B6%E5%88%97%E8%A1%A8%E6%9D%83%E9%99%90%E5%AE%9E%E6%96%BD%E6%8C%87%E5%8D%97.pdf">ç§»åŠ¨ç»ˆç«¯åº”ç”¨è½¯ä»¶åˆ—è¡¨æƒé™å®æ–½æŒ‡å—</a></p><p><a href="https://github.com/getActivity/XXPermissions/blob/master/library/src/main/java/com/hjq/permissions/Permission.java">XXPermissions&#x2F;library&#x2F;src&#x2F;main&#x2F;java&#x2F;com&#x2F;hjq&#x2F;permissions&#x2F;Permission.java at master Â· getActivity&#x2F;XXPermissions</a></p><p><a href="https://gist.github.com/0awawa0/65bf88e43159750f596da194ed923522">XiaomiUtilities.java</a></p><p><a href="https://cn-sec.com/archives/2255540.html">éšç§åˆè§„ä¹‹MIUIè‡ªå¯åŠ¨çš„ç›‘æ§åŸç†åˆ†æ | CN-SEC ä¸­æ–‡ç½‘</a></p><p><a href="https://juejin.cn/post/7189533089897381944">Android è·å–åº”ç”¨åˆ—è¡¨æ–¹æ³•è®°å½•</a></p>]]></content>
    
    
    <categories>
      
      <category>å®‰å“å®‰å…¨å’Œé€†å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>jadx</tag>
      
      <tag>åç¼–è¯‘</tag>
      
      <tag>å®‰å“æƒé™</tag>
      
      <tag>å®‰å“å®‰å…¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¥½ç”¨è½¯ä»¶æ¨è</title>
    <link href="/article/9e5c606d/"/>
    <url>/article/9e5c606d/</url>
    
    <content type="html"><![CDATA[<h2 id="Universal"><a href="#Universal" class="headerlink" title="Universal"></a>Universal</h2><h3 id="æ—¥å¸¸"><a href="#æ—¥å¸¸" class="headerlink" title="æ—¥å¸¸"></a>æ—¥å¸¸</h3><ul><li><p>æˆªå›¾ï¼š<a href="https://zh.snipaste.com/#">Snipaste - æˆªå›¾ + è´´å›¾</a></p></li><li><p>NAS è§†é¢‘æ’­æ”¾å™¨ï¼š<a href="https://bmh.163.com/">ç½‘æ˜“çˆ†ç±³èŠ±ï¼ˆåŸç½‘æ˜“Filmlyï¼‰ - æ™ºèƒ½åª’ä½“åº“&amp;å…¨èƒ½æ’­æ”¾å™¨</a></p></li><li><p>NAS éŸ³ä¹æ’­æ”¾å™¨ï¼šéŸ³æµï¼Œ<a href="https://github.com/gitbobobo/StreamMusic">gitbobobo&#x2F;StreamMusic: æ”¯æŒ Androidã€iOSã€macOSã€Windows å¹³å°çš„ Subsonic&#x2F;Navidrome&#x2F;Jellyfin&#x2F;Emby&#x2F;AudioStation å®¢æˆ·ç«¯ã€‚</a></p></li><li><p>å½•å±æˆ–è€…ç›´æ’­ï¼š<a href="https://obsproject.com/">Open Broadcaster Software | OBS</a></p></li></ul><h3 id="å¼€å‘"><a href="#å¼€å‘" class="headerlink" title="å¼€å‘"></a>å¼€å‘</h3><ul><li><p>kloggï¼šæ—¥å¿—æŸ¥çœ‹å·¥å…·ï¼Œä¹‹å‰åœ¨ Windows ä¸€ç›´ç”¨notepad++ï¼Œå®ƒå¯ä»¥é«˜äº®æ ‡è®°é€‰ä¸­çš„å­—ç¬¦ä¸²ã€‚ä½†åœ¨ Mac ä¸Šé¢ï¼Œæˆ‘è¯•äº†å¥½å‡ ä¸ªç±»ä¼¼çš„è½¯ä»¶éƒ½æ²¡æœ‰è¯¥åŠŸèƒ½ï¼Œåæ¥ï¼Œæˆ‘å‘ç°äº† kloggï¼ŒåŸºæœ¬æ»¡è¶³äº†æˆ‘çš„éœ€æ±‚ã€‚</p><p>åœ°å€ï¼š<a href="https://github.com/variar/klogg">variar&#x2F;klogg: Really fast log explorer based on glogg project</a></p></li><li><p>NotepadNextï¼š<a href="https://github.com/dail8859/NotepadNext">dail8859&#x2F;NotepadNext: A cross-platform, reimplementation of Notepad++</a>ï¼ˆV0.12 å·²ç»æ”¯æŒé«˜äº®äº†ï¼Œæˆ‘æçš„ issue å¦‚ä¸‹ï¼š<a href="https://github.com/dail8859/NotepadNext/issues/748">hightlight the select text with different color Â· Issue #748 Â· dail8859&#x2F;NotepadNext</a>ï¼‰</p></li><li><p>è¯­é›€ï¼šé«˜ä¸­çš„æ—¶å€™ç”¨æœ‰é“ç¬”è®°è®°å½•çŸ¥è¯†ç‚¹å’Œé”™é¢˜ï¼Œå¤§å­¦çš„æ—¶å€™ç”¨ OneNote æ¥è®°å½•è¯»ä¹¦ç¬”è®°ï¼Œå·¥ä½œååˆšå¼€å§‹ç”¨çš„æ˜¯å°è±¡ç¬”è®°ï¼Œåé¢å°±è½¬å‘è¯­é›€äº†ã€‚ä¸»è¦ç”¨æ¥è®°å½•å®‰å“ç›¸å…³çš„çŸ¥è¯†ç‚¹ã€‚</p><p>åœ°å€ï¼š<a href="https://www.yuque.com/">è¯­é›€ï¼Œä¸ºæ¯ä¸€ä¸ªäººæä¾›ä¼˜ç§€çš„æ–‡æ¡£å’ŒçŸ¥è¯†åº“å·¥å…·</a></p></li><li><p>åç¼–è¯‘å·¥å…·ï¼š<a href="https://github.com/skylot/jadx/releases">Releases Â· skylot&#x2F;jadx</a></p></li></ul><h2 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h2><h3 id="å¼€å‘-1"><a href="#å¼€å‘-1" class="headerlink" title="å¼€å‘"></a>å¼€å‘</h3><h2 id="Mac"><a href="#Mac" class="headerlink" title="Mac"></a>Mac</h2><h3 id="æ—¥å¸¸-1"><a href="#æ—¥å¸¸-1" class="headerlink" title="æ—¥å¸¸"></a>æ—¥å¸¸</h3><ul><li><p>è§†é¢‘æ’­æ”¾ï¼š<a href="https://github.com/iina/iina">iina&#x2F;iina: The modern video player for macOS.</a></p></li><li><p>æ€§èƒ½ç›‘æ§ï¼š<a href="https://github.com/exelban/stats">exelban&#x2F;stats: macOS system monitor in your menu bar</a></p></li><li><p>é¼ æ ‡æ§åˆ¶ï¼šè‡ªå®šä¹‰æ»šè½®æ–¹å‘å’Œè‡ªå®šä¹‰æŒ‰é”®åŠŸèƒ½ <a href="https://github.com/noah-nuebling/mac-mouse-fix/">noah-nuebling&#x2F;mac-mouse-fix: Mac Mouse Fix - Make Your $10 Mouse Better Than an Apple Trackpad!</a></p></li><li><p>æ˜¾ç¤ºå™¨æ§åˆ¶ï¼š<a href="https://github.com/waydabber/BetterDisplay">waydabber&#x2F;BetterDisplay: Unlock your displays on your Mac! Flexible HiDPI scaling, XDR&#x2F;HDR extra brightness, virtual screens, DDC control, extra dimming, PIP&#x2F;streaming, EDID override and lots more!</a></p></li><li><p>moonlightï¼šæ–¹ä¾¿å±€åŸŸç½‘æ§åˆ¶ windows ç”µè„‘ <a href="https://github.com/moonlight-stream/moonlight-qt">moonlight-stream&#x2F;moonlight-qt: GameStream client for PCs (Windows, Mac, Linux, and Steam Link)</a></p></li></ul><h3 id="å¼€å‘-2"><a href="#å¼€å‘-2" class="headerlink" title="å¼€å‘"></a>å¼€å‘</h3><ul><li>iTermï¼šå‘½ä»¤è¡Œç»ˆç«¯å·¥å…· <a href="https://iterm2.com/">iTerm2 - macOS Terminal Replacement</a></li></ul><h2 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h2><h3 id="å¼€å‘-3"><a href="#å¼€å‘-3" class="headerlink" title="å¼€å‘"></a>å¼€å‘</h3>]]></content>
    
    
    <categories>
      
      <category>éæŠ€æœ¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è½¯ä»¶</tag>
      
      <tag>Mac</tag>
      
      <tag>Windows</tag>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å†…å­˜æ€§èƒ½æµ‹è¯•æ–¹æ³•</title>
    <link href="/article/f42b9418/"/>
    <url>/article/f42b9418/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å†™äº 2022 å¹´ 6 æœˆ 24 æ—¥</p></blockquote><h2 id="ddæ–¹æ³•æµ‹è¯•"><a href="#ddæ–¹æ³•æµ‹è¯•" class="headerlink" title="ddæ–¹æ³•æµ‹è¯•"></a>ddæ–¹æ³•æµ‹è¯•</h2><p>cat proc&#x2F;meminfo </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs Shell">console:/ # cat proc/meminfo <br>MemTotal:        3858576 kB<br>MemFree:          675328 kB<br>MemAvailable:    1142452 kB<br>Buffers:           65280 kB<br>Cached:           992252 kB<br>SwapCached:           40 kB<br>Active:          1144480 kB<br>Inactive:         923220 kB<br>Active(anon):     875244 kB<br>Inactive(anon):   667400 kB<br>Active(file):     269236 kB<br>Inactive(file):   255820 kB<br>Unevictable:        4436 kB<br>Mlocked:            4436 kB<br>SwapTotal:        614396 kB<br>SwapFree:         601596 kB<br>Dirty:                 4 kB<br>Writeback:             0 kB<br>AnonPages:       1014744 kB<br>Mapped:           301460 kB<br>Shmem:            530712 kB<br>KReclaimable:      39912 kB<br>Slab:             142104 kB<br>SReclaimable:      39912 kB<br>SUnreclaim:       102192 kB<br>KernelStack:       33088 kB<br>ShadowCallStack:    2078 kB<br>PageTables:        39964 kB<br>NFS_Unstable:          0 kB<br>Bounce:                0 kB<br>WritebackTmp:          0 kB<br>CommitLimit:     2263732 kB<br>Committed_AS:   47064316 kB<br>VmallocTotal:   262930368 kB<br>VmallocUsed:       56632 kB<br>VmallocChunk:          0 kB<br>Percpu:             2768 kB<br>CmaTotal:        1921024 kB<br>CmaFree:          158092 kB<br></code></pre></td></tr></table></figure><p>å‰©1.1Gå·¦å³ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæŒ‚è½½åœ¨å†…å­˜ä¸Šé¢çš„åˆ†åŒºï¼Œå¤§å°ä¸ºå¯ç”¨å†…å­˜çš„ä¸€åŠå·¦å³ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs Shell">mount -o rw,remount /<br>mkdir memtest<br>mount -t tmpfs tmpfs /memtest  -o size=600m<br></code></pre></td></tr></table></figure><h3 id="å†…å­˜å†™æµ‹è¯•"><a href="#å†…å­˜å†™æµ‹è¯•" class="headerlink" title="å†…å­˜å†™æµ‹è¯•"></a>å†…å­˜å†™æµ‹è¯•</h3><p>dd if&#x3D;&#x2F;dev&#x2F;zero of&#x3D;&#x2F;memtest&#x2F;testfile bs&#x3D;1M count&#x3D;500</p><p>dd if&#x3D;&#x2F;dev&#x2F;zero of&#x3D;&#x2F;memtest&#x2F;testfile bs&#x3D;500M count&#x3D;1</p><p>dd if&#x3D;&#x2F;dev&#x2F;zero of&#x3D;&#x2F;memtest&#x2F;testfile bs&#x3D;512K count&#x3D;1000</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs Shell">console:/ # dd if=/dev/zero of=/memtest/testfile bs=1M count=500<br>500+0 records in<br>500+0 records out<br>524288000 bytes (500 M) copied, 0.782312 s, 639 M/s<br>console:/ # dd if=/dev/zero of=/memtest/testfile bs=500M count=1<br>1+0 records in<br>1+0 records out<br>524288000 bytes (500 M) copied, 1.272919 s, 393 M/s<br>console:/ # dd if=/dev/zero of=/memtest/testfile bs=512K count=1000<br>1000+0 records in<br>1000+0 records out<br>524288000 bytes (500 M) copied, 0.794319 s, 629 M/s<br></code></pre></td></tr></table></figure><h3 id="å†…å­˜è¯»æµ‹è¯•"><a href="#å†…å­˜è¯»æµ‹è¯•" class="headerlink" title="å†…å­˜è¯»æµ‹è¯•"></a>å†…å­˜è¯»æµ‹è¯•</h3><p>dd if&#x3D;&#x2F;memtest&#x2F;testfile  of&#x3D;&#x2F;dev&#x2F;null bs&#x3D;1M count&#x3D;500 </p><p>dd if&#x3D;&#x2F;memtest&#x2F;testfile  of&#x3D;&#x2F;dev&#x2F;null bs&#x3D;500M count&#x3D;1       </p><p>dd if&#x3D;&#x2F;memtest&#x2F;testfile  of&#x3D;&#x2F;dev&#x2F;null bs&#x3D;512K count&#x3D;1000      </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs Shell">console:/ # dd if=/memtest/testfile  of=/dev/null bs=1M count=500              <br>500+0 records in<br>500+0 records out<br>524288000 bytes (500 M) copied, 0.340277 s, 1.4 G/s<br>console:/ # dd if=/memtest/testfile  of=/dev/null bs=500M count=1                          &lt;<br>1+0 records in<br>1+0 records out<br>524288000 bytes (500 M) copied, 0.682501 s, 733 M/s<br>console:/ # dd if=/memtest/testfile  of=/dev/null bs=512K count=1000                       &lt;<br>1000+0 records in<br>1000+0 records out<br>524288000 bytes (500 M) copied, 0.226277 s, 2.1 G/s<br></code></pre></td></tr></table></figure><h2 id="Steam-benchmarkï¼ˆæ¨èï¼‰"><a href="#Steam-benchmarkï¼ˆæ¨èï¼‰" class="headerlink" title="Steam benchmarkï¼ˆæ¨èï¼‰"></a>Steam benchmarkï¼ˆæ¨èï¼‰</h2><p><a href="https://github.com/wesley666/source/blob/main/stream_benchmark">source&#x2F;stream_benchmark at main Â· wesley666&#x2F;source</a></p><p>Adb pushåˆ°data&#x2F;local&#x2F;tmpç›®å½•ï¼Œèµ‹äºˆæ‰§è¡Œæƒé™</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs Shell">console:/data/local/tmp # ./stream_benchmark                                   <br>-------------------------------------------------------------<br>STREAM version $Revision: 5.10 $<br>-------------------------------------------------------------<br>This system uses 8 bytes per array element.<br>-------------------------------------------------------------<br>Array size = 10000000 (elements), Offset = 0 (elements)<br>Memory per array = 76.3 MiB (= 0.1 GiB).<br>Total memory required = 228.9 MiB (= 0.2 GiB).<br>Each kernel will be executed 10 times.<br> The *best* time for each kernel (excluding the first iteration)<br> will be used to compute the reported bandwidth.<br>-------------------------------------------------------------<br>Your clock granularity/precision appears to be 1 microseconds.<br>Each test below will take on the order of 21376 microseconds.<br>   (= 21376 clock ticks)<br>Increase the size of the arrays if this shows that<br>you are not getting at least 20 clock ticks per test.<br>-------------------------------------------------------------<br>WARNING -- The above is only a rough guideline.<br>For best results, please be sure you know the<br>precision of your system timer.<br>-------------------------------------------------------------<br>Function    Best Rate MB/s  Avg time     Min time     Max time<br>Copy:           10748.4     0.015937     0.014886     0.017156<br>Scale:           8149.9     0.020030     0.019632     0.020463<br>Add:             9070.6     0.027085     0.026459     0.028024<br>Triad:           8255.9     0.029891     0.029070     0.030490<br>-------------------------------------------------------------<br>Solution Validates: avg error less than 1.000000e-13 on all three arrays<br>-------------------------------------------------------------<br></code></pre></td></tr></table></figure><p>Copyæ“ä½œæœ€ä¸ºç®€å•ï¼Œå®ƒå…ˆè®¿é—®ä¸€ä¸ªå†…å­˜å•å…ƒè¯»å‡ºå…¶ä¸­çš„å€¼ï¼Œå†å°†å€¼å†™å…¥åˆ°å¦ä¸€ä¸ªå†…å­˜å•å…ƒã€‚</p><p>Scaleæ“ä½œå…ˆä»å†…å­˜å•å…ƒè¯»å‡ºå…¶ä¸­çš„å€¼ï¼Œä½œä¸€ä¸ªä¹˜æ³•è¿ç®—ï¼Œå†å°†ç»“æœå†™å…¥åˆ°å¦ä¸€ä¸ªå†…å­˜å•å…ƒã€‚</p><p>Addæ“ä½œå…ˆä»å†…å­˜å•å…ƒè¯»å‡ºä¸¤ä¸ªå€¼ï¼ŒåšåŠ æ³•è¿ç®—ï¼Œ å†å°†ç»“æœå†™å…¥åˆ°å¦ä¸€ä¸ªå†…å­˜å•å…ƒã€‚</p><p>Triadçš„ä¸­æ–‡å«ä¹‰æ˜¯å°†ä¸‰ä¸ªç»„åˆèµ·æ¥ï¼Œåœ¨æœ¬æµ‹è¯•ä¸­è¡¨ç¤ºçš„æ„æ€æ˜¯å°†Copyã€Scaleã€Addä¸‰ç§æ“ä½œç»„åˆèµ·æ¥è¿›è¡Œæµ‹è¯•ã€‚å…·ä½“æ“ä½œæ–¹å¼æ˜¯ï¼šå…ˆä»å†…å­˜å•å…ƒä¸­ä¸­è¯»ä¸¤ä¸ªå€¼aã€bï¼Œå¯¹å…¶è¿›è¡Œä¹˜åŠ æ··åˆè¿ç®—ï¼ˆa + å› å­ * b ï¼‰ ï¼Œå°†è¿ç®—ç»“æœå†™å…¥åˆ°å¦ä¸€ä¸ªå†…å­˜å•å…ƒã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Androidæ€§èƒ½ä¼˜åŒ–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å†…å­˜</tag>
      
      <tag>æ€§èƒ½å·¥å…·</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>EMMCå­˜å‚¨æ€§èƒ½æµ‹è¯•æ–¹æ³•</title>
    <link href="/article/7cf0bd29/"/>
    <url>/article/7cf0bd29/</url>
    
    <content type="html"><![CDATA[<blockquote><p>è®°äº 2022 å¹´ 9 æœˆ 15 æ—¥</p></blockquote><p>å‚è€ƒ<a href="https://qiushao.net/2020/02/12/Android/emmc-performance-test/index.html">Android-emmcæ€§èƒ½æµ‹è¯• | ä¸€å¶çŸ¥ç§‹</a>è¿›è¡Œå®è·µæ“ä½œ</p><h1 id="dd-å‘½ä»¤"><a href="#dd-å‘½ä»¤" class="headerlink" title="dd å‘½ä»¤"></a>dd å‘½ä»¤</h1><h2 id="é¡µé¢ç¼“å­˜"><a href="#é¡µé¢ç¼“å­˜" class="headerlink" title="é¡µé¢ç¼“å­˜"></a>é¡µé¢ç¼“å­˜</h2><p>ä¸ºäº†æµ‹è¯• emmc çš„çœŸå®è¯»å†™æ€§èƒ½ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæŠŠé¡µé¢ç¼“å­˜ç»™æ¸…ç†ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs Shell">echo 1 &gt; /proc/sys/vm/drop_caches<br>console:/ # echo 1 &gt; /proc/sys/vm/drop_caches                                  <br>console:/ # busybox dd if=/dev/block/mmcblk0 of=/dev/null bs=1M count=512                          &lt;<br>512+0 records in<br>512+0 records out<br>536870912 bytes (512.0MB) copied, 2.491718 seconds, 205.5MB/s<br>console:/ # busybox dd if=/dev/block/mmcblk0 of=/dev/null bs=1M count=512                          &lt;<br>512+0 records in<br>512+0 records out<br>536870912 bytes (512.0MB) copied, 0.290948 seconds, 1.7GB/s<br><br>console:/ # echo 1 &gt; /proc/sys/vm/drop_caches <br>console:/ # busybox  dd if=/dev/block/mmcblk0 of=/dev/null bs=1M count=512                          &lt;<br>512+0 records in<br>512+0 records out<br>536870912 bytes (512.0MB) copied, 2.508393 seconds, 204.1MB/s<br>console:/ # <br></code></pre></td></tr></table></figure><p>è¿ç»­æ‰§è¡Œä¸¤æ¬¡ <code>busybox  dd if=/dev/block/mmcblk0 of=/dev/null bs=1M count=512</code> ï¼Œä» &#x2F;dev&#x2F;block&#x2F;mmcblk0 (å³emmc) å—è®¾å¤‡ä¸­è¯»å–å†…å®¹ï¼Œå†™åˆ° <code>/dev/null</code> ã€‚</p><p><code>/dev/null</code> æ˜¯ä¸€ä¸ªè™šæ‹Ÿè®¾å¤‡ï¼Œå†™å…¥è¿™ä¸ªè·¯å¾„å¹¶ä¸ä¼šä¿å­˜æ•°æ®ï¼Œå¯ä»¥è®¤ä¸ºè¿™ä¸ªè®¾å¤‡çš„å†™å…¥é€Ÿåº¦æ— é™å¤§ï¼Œä¹Ÿå°±æ˜¯å†™å…¥é€Ÿåº¦ä¸ä¼šæˆä¸ºè¿™ä¸ªå‘½ä»¤çš„ç“¶é¢ˆï¼Œæˆ‘ä»¬è¿™ä¸ªå‘½ä»¤ä¸»è¦æ˜¯ä¸ºäº†æµ‹è¯• emmc çš„è¯»å–é€Ÿåº¦ã€‚å¯ä»¥çœ‹åˆ°ç¬¬ä¸€æ¬¡æ‰§è¡Œçš„ç»“æœæ˜¯ 205.5MB&#x2F;sï¼Œç¬¬äºŒæ¬¡æ‰§è¡Œçš„ç»“æœæ˜¯ 1.7GB&#x2F;sã€‚ä»è¿™ä¸ªæ•°æ®æ¥çœ‹ï¼Œé¡µé¢ç¼“å­˜æå¤§çš„æé«˜äº†çƒ­ç‚¹æ–‡ä»¶çš„è¯»å–é€Ÿåº¦ã€‚ç„¶åæˆ‘ä»¬ç”¨ <code>echo 1 &gt; /proc/sys/vm/drop_caches</code>å‘½ä»¤æ¸…é™¤ä¸€ä¸‹é¡µé¢ç¼“å­˜ï¼Œå†æ‰§è¡ŒåŒæ ·çš„ <code>dd</code>å‘½ä»¤ï¼Œå‘ç°é€Ÿåº¦è·Ÿç¬¬ä¸€æ¬¡å·®ä¸å¤šäº†ã€‚</p><h2 id="å†™å…¥æ€§èƒ½æµ‹è¯•"><a href="#å†™å…¥æ€§èƒ½æµ‹è¯•" class="headerlink" title="å†™å…¥æ€§èƒ½æµ‹è¯•"></a>å†™å…¥æ€§èƒ½æµ‹è¯•</h2><h3 id="å†™å…¥å—è®¾å¤‡"><a href="#å†™å…¥å—è®¾å¤‡" class="headerlink" title="å†™å…¥å—è®¾å¤‡"></a>å†™å…¥å—è®¾å¤‡</h3><p>cache åˆ†åŒºä¸€èˆ¬æ˜¯ç”¨æ¥å­˜æ”¾ OTA å‡çº§åŒ…çš„ï¼Œæ­£å¸¸çŠ¶æ€ä¸‹æŒ‚è½½å¤±è´¥ä¹Ÿä¸å½±å“ç³»ç»Ÿçš„æ­£å¸¸è¿è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬æ‹¿ cache åˆ†åŒºæ¥ä½œå†™å…¥æµ‹è¯•ï¼Œå…ˆæ‰¾åˆ° cache å¯¹åº”çš„å—è®¾å¤‡æ–‡ä»¶ï¼ˆdf -hå‘½ä»¤æ˜¾ç¤ºå¼‚å¸¸çš„è¯ï¼Œå¯ä»¥æ‰§è¡Œ<code>ls -l /dev/block/platform/*/by-name/cache</code>ï¼‰</p><p><strong>æ³¨æ„ï¼šæœ¬æµ‹è¯•æ–¹æ³•å¯èƒ½ä¼šæŸåcacheåˆ†åŒºå¯¼è‡´otaå¤±è´¥ï¼Œå‡ºç°è¿™ç§æƒ…å†µå»ºè®®æ¢å¤å‡ºå‚è®¾ç½®æˆ–è€…çº¿åˆ·ã€‚</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs Shell">console:/ # df -h<br>Filesystem            Size  Used Avail Use% Mounted on<br>tmpfs                 1.5G  892K  1.5G   1% /dev<br>tmpfs                 1.5G     0  1.5G   0% /mnt<br>/dev/block/mmcblk0p26  14M  168K   14M   2% /metadata<br>/dev/block/dm-1       1.1G  0.9G  199M  84% /<br>/dev/block/mmcblk0p40 379M   24M  356M   7% /wesley<br>/dev/block/mmcblk0p38 379M  154M  226M  41% /factory<br>/dev/block/mmcblk0p39  18M  1.3M   17M   8% /atv<br>/dev/block/mmcblk0p36 9.1M   24K  9.0M   1% /oem<br>/dev/block/dm-2       340M  240M  100M  71% /vendor<br>/dev/block/dm-0       167M   84K  167M   1% /mnt/scratch<br>overlay               167M   84K  167M   1% /system_ext<br>overlay               167M   84K  167M   1% /product<br>overlay               167M   84K  167M   1% /odm<br>tmpfs                 1.5G     0  1.5G   0% /apex<br>tmpfs                 1.5G  248K  1.5G   1% /linkerconfig<br>tmpfs                  20M  1.0M   19M   6% /mnt/vendor/rtdlog<br>tmpfs                  20M  8.0K   20M   1% /tmp<br>/dev/block/mmcblk0p23 1.4G  3.9M  1.4G   1% /cache<br>/dev/block/mmcblk0p31 236M   12M  224M   6% /mnt/vendor/tvconfigs<br>/dev/block/mmcblk0p32  26M   84K   26M   1% /mnt/vendor/tvdata<br>/dev/block/mmcblk0p33  18M   36K   18M   1% /mnt/vendor/impdata<br>/dev/block/mmcblk0p4  976K  228K  748K  24% /mnt/vendor/factory<br>/dev/block/mmcblk0p6  976K   28K  948K   3% /mnt/vendor/factory_ro<br>tmpfs                  20M     0   20M   0% /shm<br>tmpfs                 8.0M     0  8.0M   0% /mnt/EPGdb<br>/dev/block/mmcblk0p42 107G  4.8G  102G   5% /data<br>tmpfs                 1.5G     0  1.5G   0% /data_mirror<br>/dev/fuse             107G  4.8G  102G   5% /mnt/user/0/emulated<br>console:/ # <br></code></pre></td></tr></table></figure><p>cacheåˆ†åŒºçš„å—è®¾å¤‡æ–‡ä»¶ä¸º&#x2F;dev&#x2F;block&#x2F;mmcblk0p23ã€‚</p><p>å†™å…¥æµ‹è¯•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Shell">console:/ #  echo 1 &gt; /proc/sys/vm/drop_caches    <br>console:/ #  busybox dd if=/dev/zero of=/dev/block/mmcblk0p23 bs=1M count=1024 conv=fsync<br>1024+0 records in<br>1024+0 records out<br>1073741824 bytes (1.0GB) copied, 11.371810 seconds, 90.0MB/s<br></code></pre></td></tr></table></figure><p>è¾“å…¥æ–‡ä»¶ä¸º &#x2F;dev&#x2F;zeroï¼Œæ˜¯ä¸€ä¸ªè™šæ‹Ÿè®¾å¤‡ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºè¿™ä¸ªè®¾å¤‡çš„è¯»å–é€Ÿåº¦æ— é™å¤§ï¼Œä¹Ÿå°±æ˜¯è¯»å–é€Ÿåº¦ä¸ä¼šå½±å“åˆ°å†™å…¥çš„é€Ÿåº¦ã€‚</p><p>bs&#x3D;1M : ä¸€æ¬¡å†™å…¥ 1M</p><p>count&#x3D;1024 : å†™å…¥ 1024 æ¬¡ï¼Œä¹Ÿå°±æ˜¯å†™å…¥çš„æ•°æ®æ€»é‡ä¸º 1G</p><p>conv&#x3D;fsync : dd ç»“æŸå‰ï¼ŒæŠŠæ•°æ®åŒæ­¥åˆ° emmcï¼Œå¦‚æœæ²¡åŠ è¿™ä¸ªå‚æ•°çš„è¯ï¼Œæ•°æ®å¯èƒ½è¿˜åœ¨ç¼“å­˜ä¹‹ä¸­ã€‚ä¸ºäº†ç¡®ä¿æ•°æ®å‡†ç¡®ï¼Œä¸€å®šè¦åŠ è¿™ä¸ªå‚æ•°ã€‚</p><p>å¯ä»¥é‡å¤æµ‹è¯•å‡ æ¬¡</p><h3 id="å†™å…¥æ–‡ä»¶"><a href="#å†™å…¥æ–‡ä»¶" class="headerlink" title="å†™å…¥æ–‡ä»¶"></a>å†™å…¥æ–‡ä»¶</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs Shell">console:/ # echo 1 &gt; /proc/sys/vm/drop_caches<br>console:/ # busybox dd if=/dev/zero of=/data/ddtest.bin bs=1M count=1024 conv=fsync                   <br>1024+0 records in<br>1024+0 records out<br>1073741824 bytes (1.0GB) copied, 15.211609 seconds, 67.3MB/s<br>console:/ #<br></code></pre></td></tr></table></figure><p>è¦é‡å¤æµ‹è¯•å‡ æ¬¡ã€‚ç›¸å¯¹ç›´æ¥å†™å—è®¾å¤‡æ–‡ä»¶æ…¢äº† 30M&#x2F;s å·¦å³ã€‚è¿™å¯èƒ½æ˜¯æ–‡ä»¶ç³»ç»Ÿå¸¦æ¥çš„å½±å“ã€‚</p><h2 id="è¯»å–æµ‹è¯•"><a href="#è¯»å–æµ‹è¯•" class="headerlink" title="è¯»å–æµ‹è¯•"></a>è¯»å–æµ‹è¯•</h2><h3 id="è¯»å–å—è®¾å¤‡"><a href="#è¯»å–å—è®¾å¤‡" class="headerlink" title="è¯»å–å—è®¾å¤‡"></a>è¯»å–å—è®¾å¤‡</h3><p>ç›´æ¥ç”¨æˆ‘ä»¬ä¸Šé¢ä»‹ç»æ¸…é™¤ç¼“å­˜çš„ä¾‹å­å°±è¡Œï¼Œè¿™é‡Œå°±ä¸å†é‡å¤äº†ã€‚</p><p>ä»ä¸Šé¢çš„ä¾‹å­å¾—åˆ°çš„æ•°æ®ä¸º 205M&#x2F;s å·¦å³ã€‚</p><h3 id="è¯»å–æ–‡ä»¶"><a href="#è¯»å–æ–‡ä»¶" class="headerlink" title="è¯»å–æ–‡ä»¶"></a>è¯»å–æ–‡ä»¶</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs Shell">console:/ # echo 1 &gt; /proc/sys/vm/drop_caches        <br>console:/ # busybox dd if=/data/ddtest.bin of=/dev/null bs=1M count=1024<br>1024+0 records in<br>1024+0 records out<br>1073741824 bytes (1.0GB) copied, 5.464306 seconds, 187.4MB/s<br>console:/ # <br></code></pre></td></tr></table></figure><p>ç›´æ¥æ‹¿æµ‹è¯•å†™å…¥é€Ÿåº¦æ—¶ç”Ÿæˆçš„æ–‡ä»¶ï¼Œé‡å¤æµ‹è¯•å‡ æ¬¡ï¼Œé€Ÿåº¦åŸºæœ¬ä¸Šåœ¨ 187MB&#x2F;s å·¦å³ã€‚</p><h1 id="iozone"><a href="#iozone" class="headerlink" title="iozone"></a>iozone</h1><p>Android ç³»ç»Ÿæºç ä¸­å¹¶æ²¡æœ‰ iozoneï¼Œæˆ‘ä»¬ä»å®˜ç½‘ä¸Šä¸‹è½½ç¼–è¯‘ï¼Œæˆ‘ä¸‹è½½æ—¶æœ€æ–°ç‰ˆæœ¬ä¸ºiozone3_493ï¼Œè¿™ä¸ªç‰ˆæœ¬å·²ç»æœ‰ Android.mk åœ¨ä»£ç é‡Œé¢äº†ï¼Œå°†æºç æ”¾åˆ° Androidç³»ç»Ÿæºç é‡Œé¢ mm å³å¯ã€‚ä¸‹é¢å·²ç»æ˜¯æˆ‘ç¼–è¯‘å¥½çš„æ–‡ä»¶ã€‚å¯¹åº”ä¸åŒç¡¬ä»¶ä½¿ç”¨å¯¹åº”ç‰ˆæœ¬å³å¯ï¼ŒæŠŠæ–‡ä»¶pushåˆ°&#x2F;data&#x2F;local&#x2F;tmp&#x2F;ï¼Œå¹¶èµ‹äºˆæ‰§è¡Œæƒé™ã€‚</p><p><a href="https://github.com/wesley666/source/blob/main/izone.zip">source&#x2F;izone.zip at main Â· wesley666&#x2F;source</a></p><h2 id="éšæœºè¯»å†™æµ‹è¯•"><a href="#éšæœºè¯»å†™æµ‹è¯•" class="headerlink" title="éšæœºè¯»å†™æµ‹è¯•"></a>éšæœºè¯»å†™æµ‹è¯•</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs Shell">console: echo 1 &gt; /proc/sys/vm/drop_caches                                              &lt;<br>console:/data/local/tmp # ./iozone -azecI -+n -L64 -S32 -r1m -s1024m -i0 -i1 -i2 -w -f /data/iozonetest.bin <br>        Iozone: Performance Test of File I/O<br>                Version $Revision: 3.493 $<br>                Compiled for 32 bit mode.<br>                Build: linux-arm <br><br>        Contributors:William Norcott, Don Capps, Isom Crawford, Kirby Collins<br>                     Al Slater, Scott Rhine, Mike Wisner, Ken Goss<br>                     Steve Landherr, Brad Smith, Mark Kelly, Dr. Alain CYR,<br>                     Randy Dunlap, Mark Montague, Dan Million, Gavin Brebner,<br>                     Jean-Marc Zucconi, Jeff Blomberg, Benny Halevy, Dave Boone,<br>                     Erik Habbinga, Kris Strecker, Walter Wong, Joshua Root,<br>                     Fabrice Bacchella, Zhenghua Xue, Qin Li, Darren Sawyer,<br>                     Vangel Bojaxhi, Ben England, Vikentsi Lapa,<br>                     Alexey Skidanov, Sudhir Kumar.<br><br>        Run began: Fri Jun 10 19:34:04 2022<br><br>        Auto Mode<br>        Cross over of record size disabled.<br>        Include fsync in write timing<br>        Include close in write timing<br>        O_DIRECT feature enabled<br>        No retest option selected<br>        Record Size 1024 kB<br>        File size set to 1048576 kB<br>        Setting no_unlink<br>        Command line used: ./iozone -azecI -+n -L64 -S32 -r1m -s1024m -i0 -i1 -i2 -w -f /data/iozonetest.bin<br>        Output is in kBytes/sec<br>        Time Resolution = 0.000001 seconds.<br>        Processor cache size set to 32 kBytes.<br>        Processor cache line size set to 64 bytes.<br>        File stride size set to 17 * record size.<br>                                                              random    random     bkwd    record    stride                                    <br>              kB  reclen    write  rewrite    read    reread    read     write     read   rewrite      read   fwrite frewrite    fread  freread<br>         1048576    1024   150737        0   210429        0   208681   173348                                                                <br><br>iozone test complete.<br>console:/data/local/tmp # <br></code></pre></td></tr></table></figure><p>ä»ç»“æœæ¥çœ‹ï¼Œå†™é€Ÿåº¦ä¸º150MB&#x2F;sï¼Œè¯»é€Ÿåº¦ä¸º210MB&#x2F;sï¼Œéšæœºè¯»é€Ÿåº¦ä¸º208MB&#x2F;sã€‚ã€€éšæœºå†™é€Ÿåº¦ä¸º 173MB&#x2F;sã€‚</p><p>é‡å¤æµ‹è¯•å‡ æ¬¡ç»“æœå·®ä¸å¤šï¼Œè¯»çš„é€Ÿåº¦åŸºæœ¬è·Ÿ dd çš„ä¸€è‡´ã€‚å†™å…¥æ¯” dd çš„å¿«äº†ä¸€å€å‡ ï¼Œè¿™é‡Œé¢çš„å·®è·å¾…ç ”ç©¶ï¼Œå¯èƒ½è·Ÿå‚æ•°è®¾ç½®æœ‰å…³ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./iozone -azecI -+n -L64 -S32 -r1m -s1024m -i0 -i1 -i2 -w -f /data/iozonetest.bin [-Rb /sdcard/emmc_test.xls] <br></code></pre></td></tr></table></figure><p>å„ä¸ªå‚æ•°å®šä¹‰å¦‚ä¸‹ï¼š</p><p>a: ä½¿ç”¨å…¨è‡ªåŠ¨æ¨¡å¼ã€‚ç”Ÿæˆæ¶µç›–æ‰€æœ‰æµ‹è¯•æ“ä½œçš„è¾“å‡ºï¼Œè®°å½•å¤§å°ä¸º4kåˆ°16Mï¼Œæ–‡ä»¶å¤§å°ä¸º64kåˆ°512Mã€‚</p><p>z: ä¸-aä¸€èµ·ä½¿ç”¨ä»¥æµ‹è¯•æ‰€æœ‰å¯èƒ½çš„è®°å½•å¤§å°ã€‚é€šå¸¸ï¼ŒIozoneåœ¨å…¨è‡ªåŠ¨æ¨¡å¼ä¸‹ä½¿ç”¨æ—¶ä¼šå¿½ç•¥å¯¹éå¸¸å¤§çš„æ–‡ä»¶çš„å°è®°å½•å¤§å°çš„æµ‹è¯•ã€‚æ­¤é€‰é¡¹å¼ºåˆ¶iozoneåœ¨è‡ªåŠ¨æµ‹è¯•ä¸­ä¹ŸåŒ…æ‹¬å°è®°å½•å¤§å°ã€‚</p><p>e: åœ¨æ—¶é—´è®¡ç®—ä¸­åŒ…æ‹¬flushï¼ˆfsyncï¼Œfflushï¼‰</p><p>c: åœ¨è®¡æ—¶è®¡ç®—ä¸­åŒ…æ‹¬closeï¼ˆï¼‰ã€‚ ä»…å½“æ‚¨æ€€ç–‘å½“å‰æ­£åœ¨æµ‹è¯•çš„æ“ä½œç³»ç»Ÿä¸­çš„closeï¼ˆï¼‰è¢«ç ´åæ—¶ï¼Œè¿™æ‰æœ‰ç”¨ã€‚ å®ƒå¯¹äºNFS3æµ‹è¯•ä¹Ÿå¾ˆæœ‰ç”¨ï¼Œå¯ä»¥å¸®åŠ©è¯†åˆ«nfs3_commitæ˜¯å¦è¿è¡Œè‰¯å¥½ã€‚</p><p>I: å¯¹æ‰€æœ‰æ–‡ä»¶æ“ä½œä½¿ç”¨DIRECT I&#x2F;O. å‘Šè¯‰æ–‡ä»¶ç³»ç»Ÿæ‰€æœ‰æ“ä½œéƒ½ç»•è¿‡ç¼“å†²åŒºç¼“å­˜å¹¶ç›´æ¥è½¬åˆ°ç£ç›˜ã€‚ è¿™ä¹Ÿå°†åœ¨VxFSä¸Šä½¿ç”¨VX_DIRECTï¼Œåœ¨Linuxä¸Šä½¿ç”¨O_DIRECTï¼Œåœ¨Solarisä¸Šä½¿ç”¨directioï¼ˆï¼‰ã€‚</p><p>-+n: æ²¡æœ‰é€‰æ‹©é‡æ–°æµ‹è¯•ã€‚ä½¿ç”¨æ­¤é€‰é¡¹å¯é˜²æ­¢é‡æ–°æµ‹è¯•è¿è¡Œã€‚</p><p>L64: Set processor cache line size to 64 Bytes</p><p>S32: Set processor cache size to 32KBytes</p><p>r2m: block size æŒ‡å®šä¸€æ¬¡å†™å…¥&#x2F;è¯»å‡ºçš„å—å¤§å°ï¼š1M</p><p>s1024m: ç”¨äºæŒ‡å®šè¦æµ‹è¯•çš„æ–‡ä»¶çš„å¤§å°ï¼š1024M</p><p>-i N ç”¨æ¥é€‰æ‹©æµ‹è¯•é¡¹, æ¯”å¦‚Read&#x2F;Write&#x2F;Random æ¯”è¾ƒå¸¸ç”¨çš„æ˜¯0 1 2,å¯ä»¥æŒ‡å®šæˆ-i 0 -i 1 -i2.è¿™äº›åˆ«çš„è¯¦ç»†å†…å®¹è¯·æŸ¥man</p><p>  0&#x3D;write&#x2F;rewrite</p><p>  1&#x3D;read&#x2F;re-read</p><p>  2&#x3D;random-read&#x2F;write</p><p>  3&#x3D;Read-backwards</p><p>  4&#x3D;Re-write-record</p><p>  5&#x3D;stride-read</p><p>  6&#x3D;fwrite&#x2F;re-fwrite</p><p>  7&#x3D;fread&#x2F;Re-fread</p><p>  8&#x3D;random mix</p><p>  9&#x3D;pwrite&#x2F;Re-pwrite</p><p>  10&#x3D;pread&#x2F;Re-pread</p><p>  11&#x3D;pwritev&#x2F;Re-pwritev</p><p>  12&#x3D;preadv&#x2F;Re-preadv</p><p>-+b 400000,30000: burst size 400000KBytes,sleep between burst 30000ms</p><p>w: å½“ä¸´æ—¶æ–‡ä»¶ä½¿ç”¨å®Œæ¯•æ—¶ä¸åˆ é™¤å®ƒä»¬ã€‚æŠŠå®ƒä»¬ç•™åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ã€‚</p><p>f: æŒ‡å®šæµ‹è¯•æ–‡ä»¶çš„åå­—(è¿™ä¸ªæ–‡ä»¶å¿…é¡»æŒ‡å®šä½ è¦æµ‹è¯•çš„é‚£ä¸ªç¡¬ä»¶ä¸­)</p><p>å¯é€‰å‚æ•°ï¼š</p><p>R: Generate Excel report</p><p>b: Filename Create Excel worksheet file,emmc_test.xls</p><p>æ³¨æ„ï¼š</p><p>æ ¹æ®æµ‹è¯•æ–‡ä»¶å¤§å°çš„ä¸åŒï¼Œiozone ç£ç›˜è¯»å†™æ€§èƒ½çš„æµ‹è¯•æ–¹æ³•ä¸»è¦åŒ…æ‹¬1å€å†…å­˜æµ‹è¯•å’Œ2å€å†…å­˜æµ‹è¯•ï¼ˆé¿å…ç¼“å­˜çš„å½±å“ï¼‰ã€‚</p><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://qiushao.net/2020/02/12/Android/emmc-performance-test/index.html">Android-emmcæ€§èƒ½æµ‹è¯• | ä¸€å¶çŸ¥ç§‹</a></p><p><a href="https://github.com/axboe/fio">axboe&#x2F;fio: Flexible I&#x2F;O Tester</a></p><p><a href="https://github.com/DevriesL/RaptorMark">DevriesL&#x2F;RaptorMark</a></p><p><a href="https://www.iozone.org/">Iozone Filesystem Benchmark</a></p><p><a href="https://www.iozone.org/src/current/">iozone: Index of &#x2F;src&#x2F;current</a></p>]]></content>
    
    
    <categories>
      
      <category>Androidæ€§èƒ½ä¼˜åŒ–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ€§èƒ½å·¥å…·</tag>
      
      <tag>EMMC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>btrace2.0ä½¿ç”¨æ–¹æ³•</title>
    <link href="/article/788e44fe/"/>
    <url>/article/788e44fe/</url>
    
    <content type="html"><![CDATA[<p>2022 å¹´æˆ‘ç ”ç©¶å®‰å“æ€§èƒ½ä¼˜åŒ–çš„æ—¶å€™ï¼Œå†™è¿‡ä¸€ç¯‡ï¼š<a href="https://iwesley.top/article/69f32e87/">btrace1.0ä½¿ç”¨æ–¹æ³• - Wesleyâ€™s Blog</a>ï¼Œç°åœ¨ brace è¿›åŒ–åˆ° 2.0 äº†ï¼Œè®©æˆ‘ä»¬ä¸€èµ·æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ã€‚</p><p>å…·ä½“çš„æ¥å…¥æµç¨‹å¯ä»¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼š</p><p><a href="https://github.com/bytedance/btrace">bytedance&#x2F;btrace: ğŸ”¥ğŸ”¥ btrace(AKA RheaTrace) is a high performance Android trace tool which is based on Perfetto, it support to define custom events automatically during building apk and using bhook to provider more native events like Render&#x2F;Binder&#x2F;IO etc.</a></p><p>æˆ‘è¿™é‡Œä¸»è¦è®°å½•ä¸€ä¸‹æ¥å…¥çš„ä¸€äº›æŠ¥é”™é—®é¢˜ï¼š</p><p>ç›®å‰æœ€æ–°ç‰ˆæœ¬æ˜¯2.0.3-rc03</p><p>é¡¹ç›®çš„gradleç‰ˆæœ¬æ˜¯7.0.2ï¼Œgradle pluginæ˜¯7.0.0</p><h2 id="ç¼–è¯‘æŠ¥é”™"><a href="#ç¼–è¯‘æŠ¥é”™" class="headerlink" title="ç¼–è¯‘æŠ¥é”™"></a>ç¼–è¯‘æŠ¥é”™</h2><blockquote><p>org.gradle.workers.WorkerExecutionException: There was a failure while executing work items</p><p>â€‹at org.gradle.workers.internal.DefaultWorkerExecutor.workerExecutionException(DefaultWorkerExecutor.java:270)</p><p>â€‹at org.gradle.workers.internal.DefaultWorkerExecutor.await(DefaultWorkerExecutor.java:252)</p><p>â€‹at com.android.build.gradle.internal.tasks.DexArchiveBuilderTaskDelegate.doProcess(DexArchiveBuilderTaskDelegate.kt:227)</p><p>â€‹at com.android.build.gradle.internal.tasks.DexArchiveBuilderTask.doTaskAction(DexArchiveBuilderTask.kt:256)</p><p>â€‹at com.android.build.gradle.internal.tasks.NewIncrementalTask$taskAction$$inlined$recordTaskAction$1.invoke(BaseTask.kt:66)</p><p>â€‹at com.android.build.gradle.internal.tasks.Blocks.recordSpan(Blocks.java:51)</p><p>Caused by: com.android.tools.r8.CompilationFailedException: <strong>Compilation failed to complete</strong>, position: Lcom&#x2F;xxx&#x2F;web&#x2F;CommonHeader;<init>()V, origin: D:\Project\p_dev\app\build\intermediates\transforms\analyticsTrack\Production\release\720.jar:com&#x2F;xxx&#x2F;web&#x2F;CommonHeader.class</p></blockquote><p>éœ€è¦å…³æ³¨<strong>Compilation failed to complete</strong>åé¢çš„ç±»</p><p>å¦‚æœå“ªä¸ªç±»æŠ¥é”™å°±å¯ä»¥åŠ å…¥ä¸‹é¢çš„é…ç½®ï¼Œè·¯å¾„â€${project.rootDir}&#x2F;trace-filter&#x2F;traceFilter.txtâ€</p><p><a href="https://github.com/bytedance/btrace/blob/master/GRADLE_CONFIG.MD">btrace&#x2F;GRADLE_CONFIG.MD at master Â· bytedance&#x2F;btrace</a></p><p>æ³¨æ„ï¼šallowpackageå¿…é¡»å…ˆé…ç½®ï¼Œblockpackageå¿…é¡»åœ¨å…¶å­åŒ…ä¸‹é¢ï¼Œå¯ä»¥æ˜¯ç±»æˆ–è€…åŒ…å</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs yaml">[<span class="hljs-string">package</span>]<br><span class="hljs-string">-allowpackage</span> <span class="hljs-string">com</span><br><span class="hljs-string">-allowpackage</span> <span class="hljs-string">org</span><br><span class="hljs-string">-allowpackage</span> <span class="hljs-string">androidx</span><br><br><span class="hljs-string">-blockpackage</span> <span class="hljs-string">androidx/exifinterface/media</span><br><span class="hljs-string">-blockpackage</span> <span class="hljs-string">com/google/android/exoplayer2/ui</span><br><span class="hljs-string">-blockpackage</span> <span class="hljs-string">com/xxx/web/CommonHeader</span><br><span class="hljs-string">-blockpackage</span> <span class="hljs-string">org/bouncycastle/jcajce/provider/asymmetric/x509</span><br><span class="hljs-string">-blockpackage</span> <span class="hljs-string">org/bouncycastle/jcajce/provider/asymmetric/dh</span><br><span class="hljs-string">-blockpackage</span> <span class="hljs-string">com/nineoldandroids/util</span><br><span class="hljs-string">-blockpackage</span> <span class="hljs-string">org/bouncycastle/jce/provider/JCEDHPublicKey</span><br><span class="hljs-comment"># org/bouncycastle/jce/provider/X509CertificateObject</span><br><span class="hljs-string">-blockpackage</span> <span class="hljs-string">org/bouncycastle/jce/provider</span><br></code></pre></td></tr></table></figure><h3 id="ç‰¹åˆ«æ³¨æ„"><a href="#ç‰¹åˆ«æ³¨æ„" class="headerlink" title="ç‰¹åˆ«æ³¨æ„"></a>ç‰¹åˆ«æ³¨æ„</h3><p>å¦‚æœæ˜¯windowsç”¨æˆ·ï¼ŒtraceFilter.txtæ¢è¡Œç¬¦å¿…é¡»æ”¹ä¸ºLF</p><h4 id="åŸå› "><a href="#åŸå› " class="headerlink" title="åŸå› "></a>åŸå› </h4><p>com&#x2F;bytedance&#x2F;rheatrace&#x2F;plugin&#x2F;compiling&#x2F;filter&#x2F;RheaTraceMethodFilter.kt</p><p>parseTraceFilterFile</p><p>methodKeepStr.trim { it &lt;&#x3D; â€˜ â€˜ }.replace(â€œ&#x2F;â€œ, â€œ.â€).split(â€œ\nâ€).toTypedArray()</p><p>è¿™é‡Œåªæ›¿æ¢äº†\nï¼Œæ²¡æœ‰æ›¿æ¢\rï¼Œä¼šå¯¼è‡´è§£æå‡ºæ¥çš„åŒ…åå¸¦æœ‰\rï¼Œå¯¼è‡´checkPathå¤±è´¥ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">checkPath</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">if</span> (allowPackages.isEmpty()) &#123;<br>        <span class="hljs-keyword">return</span><br>    &#125;<br>    <span class="hljs-keyword">for</span> (blockPath <span class="hljs-keyword">in</span> blockPackages) &#123;<br>        <span class="hljs-keyword">var</span> isContain = <span class="hljs-literal">false</span><br>        <span class="hljs-keyword">for</span> (allowPackage <span class="hljs-keyword">in</span> allowPackages) &#123;<br>            <span class="hljs-keyword">if</span> (blockPath == allowPackage) &#123;<br>                RheaLog.e(TAG, <span class="hljs-string">&quot;blockpackage cannot be equal to allowpackage:%s&quot;</span>, blockPath)<br>            &#125;<br>            <span class="hljs-keyword">if</span> (blockPath.startsWith(allowPackage)) &#123;<br>                isContain = <span class="hljs-literal">true</span><br>                <span class="hljs-keyword">break</span><br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (!isContain) &#123;<br>            <span class="hljs-keyword">throw</span> GradleException(<span class="hljs-string">&quot;allowpackage do not contains <span class="hljs-variable">$blockPath</span>&quot;</span>)<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://juejin.cn/post/7350256387161047077">BTraceå’ŒPerfettoå¦‚ä½•åˆ†ææ€§èƒ½æ‰‹æŠŠæ‰‹æ•™ä½ ä½¿ç”¨BTraceå’ŒPerfettoåˆ†ææ€§èƒ½ é«˜çº§androidå¼€å‘å·¥ - æ˜é‡‘</a></p><p><a href="https://mvnrepository.com/artifact/com.bytedance.btrace/rhea-gradle-plugin">Maven Repository: com.bytedance.btrace Â» rhea-gradle-plugin</a></p>]]></content>
    
    
    <categories>
      
      <category>Androidæ€§èƒ½ä¼˜åŒ–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ€§èƒ½ä¼˜åŒ–</tag>
      
      <tag>btrace</tag>
      
      <tag>systrace</tag>
      
      <tag>perfetto</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>btrace1.0ä½¿ç”¨æ–¹æ³•</title>
    <link href="/article/69f32e87/"/>
    <url>/article/69f32e87/</url>
    
    <content type="html"><![CDATA[<blockquote><p>è®°äº 2022 å¹´ 6 æœˆ 24 æ—¥</p></blockquote><p><strong>æ³¨æ„ï¼šç›®å‰ä»…é™äºmacoså’Œlinuxä½¿ç”¨</strong></p><p><a href="https://github.com/bytedance/btrace/blob/master/README.zh-CN.md">btrace&#x2F;README.zh-CN.md at master Â· bytedance&#x2F;btrace Â· GitHub</a></p><p>btrace(åˆå RheaTrace) æ˜¯ä¸€ä¸ªåŸºäº <a href="https://developer.android.com/topic/performance/tracing">Systrace</a> å®ç°çš„é«˜æ€§èƒ½ Android trace å·¥å…·ï¼Œå®ƒæ”¯æŒåœ¨ App ç¼–è¯‘æœŸé—´è‡ªåŠ¨æ³¨å…¥è‡ªå®šä¹‰äº‹ä»¶ï¼Œå¹¶ä½¿ç”¨ <a href="https://github.com/bytedance/bhook">bhook</a> é¢å¤–æä¾› IO ç­‰ native äº‹ä»¶ã€‚</p><h2 id="å…³é”®ç‰¹å¾"><a href="#å…³é”®ç‰¹å¾" class="headerlink" title="å…³é”®ç‰¹å¾"></a>å…³é”®ç‰¹å¾</h2><p>æ”¯æŒè‡ªåŠ¨æ³¨å…¥è‡ªå®šä¹‰äº‹ä»¶ï¼Œåœ¨ç¼–è¯‘ Apk æœŸé—´ä¸º App æ–¹æ³•è‡ªåŠ¨æ³¨å…¥Trace#beginSection(String) å’Œ Trace#endSection()ã€‚</p><p>æä¾›é¢å¤– IO ç­‰ native äº‹ä»¶ï¼Œæ–¹ä¾¿å®šä½è€—æ—¶åŸå› ã€‚</p><p>æ”¯æŒä»…é‡‡é›†ä¸»çº¿ç¨‹ trace äº‹ä»¶ã€‚</p><p>ä½¿ç”¨ä¾¿æ·ï¼Œç¨³å®šæ€§é«˜ï¼Œæ€§èƒ½ä¼˜äº Systraceã€‚</p><h2 id="å¼€å§‹"><a href="#å¼€å§‹" class="headerlink" title="å¼€å§‹"></a>å¼€å§‹</h2><p><strong>æ³¨æ„ï¼šå­˜å‚¨æƒé™è¦ç”³è¯·</strong></p><p>è‡ªå®šä¹‰çš„applicationå¿…é¡»æœ‰ä»¥ä¸‹ä»£ç ï¼Œå¦åˆ™ä¼šå¯¼è‡´btraceæ’å…¥åˆå§‹åŒ–ä»£ç å¤±è´¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@OverRide</span><br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">attachBaseContext</span><span class="hljs-params">(Context base)</span> &#123;<br>     <span class="hljs-built_in">super</span>.attachBaseContext(base);<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨æ‚¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ build.gradle æ–‡ä»¶ä¸­å¢åŠ  rhea-gradle-plugin ä½œä¸ºä¾èµ–ã€‚</p><p>æ³¨æ„ï¼šbtraceç‰ˆæœ¬å·å¯ä»¥åœ¨è¿™é‡ŒæŸ¥è¯¢ï¼š<a href="https://search.maven.org/">https://search.maven.org/</a> å¦‚æœæ‰“ä¸å¼€å¯ä»¥åœ¨é˜¿é‡Œäº‘æŸ¥è¯¢ï¼š<a href="https://developer.aliyun.com/mvn/search">https://developer.aliyun.com/mvn/search</a></p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2025/20250502163842049.png" alt="image-20250502163841997"></p><p>ç›®å‰ç‰ˆæœ¬å·æ˜¯1.0.2</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs Groovy">buildscript &#123;<br>    repositories &#123;<br>        ...<br>        mavenCentral()<br>        ...<br>    &#125;<br>    dependencies &#123;<br>        classpath <span class="hljs-string">&#x27;com.bytedance.btrace:rhea-gradle-plugin:1.0.2&#x27;</span><br>    &#125;<br>&#125;<br><br>allprojects &#123;<br>    repositories &#123;<br>        ...<br>        mavenCentral()<br>        ...<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ¥ç€åœ¨ app&#x2F;build.gradle æ–‡ä»¶ä¸­åº”ç”¨å¦‚ä¸‹æ‰€ç¤ºæ’ä»¶å’Œä¾èµ–ã€‚</p><h3 id="androidxé¡¹ç›®"><a href="#androidxé¡¹ç›®" class="headerlink" title="androidxé¡¹ç›®"></a>androidxé¡¹ç›®</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs Groovy">dependencies &#123;<br>    <span class="hljs-comment">//rheatrace core lib</span><br>    implementation <span class="hljs-string">&quot;com.bytedance.btrace:rhea-core:1.0.2&quot;</span><br>&#125;<br><br>apply <span class="hljs-attr">plugin:</span> <span class="hljs-string">&#x27;com.bytedance.rhea-trace&#x27;</span><br>rheaTrace &#123;<br><br>   compilation &#123;<br>      <span class="hljs-comment">//ä¸ºå‡å°‘ APK ä½“ç§¯, ä½ å¯ä»¥ä¸º App ä¸­éœ€è¦è·Ÿè¸ªçš„æ–¹æ³•è®¾ç½® id ä»¥æ­¤æ¥è·Ÿè¸ªæ­¤è‡ªå®šä¹‰äº‹ä»¶, é»˜è®¤å€¼ falseã€‚</span><br>      traceWithMethodID = <span class="hljs-literal">false</span> <br>      <span class="hljs-comment">//è¯¥æ–‡ä»¶é…ç½®å†³å®šå“ªäº›æ–¹æ³•æ‚¨ä¸å¸Œæœ›è·Ÿè¸ª, é»˜è®¤å€¼ nullã€‚</span><br>      traceFilterFilePath = <span class="hljs-string">&quot;$&#123;project.rootDir&#125;/rhea-trace/traceFilter.txt&quot;</span><br>      <span class="hljs-comment">//ç”¨ç‰¹æŒ‡å®šæ–¹æ³• id æ¥è®¾ç½®è‡ªå®šä¹‰äº‹ä»¶åç§°, é»˜è®¤å€¼ nullã€‚</span><br>      applyMethodMappingFilePath = <span class="hljs-string">&quot;$&#123;project.rootDir&#125;/rhea-trace/keep-method-id.txt&quot;</span><br>  &#125;<br><br>   runtime &#123;<br>      <span class="hljs-comment">//ä»…åœ¨ä¸»çº¿ç¨‹æŠ“å–è·Ÿè¸ªäº‹ä»¶, é»˜è®¤å€¼ falseã€‚</span><br>      mainThreadOnly <span class="hljs-literal">true</span> <br>      <span class="hljs-comment">//åœ¨ App å¯åŠ¨ä¹‹åˆå¼€å§‹æŠ“å–è·Ÿè¸ªäº‹ä»¶, é»˜è®¤å€¼ trueã€‚</span><br>      startWhenAppLaunch <span class="hljs-literal">true</span><br>      <span class="hljs-comment">//æŒ‡å®šå†…å­˜å­˜å‚¨ atrace æ•°æ® ring buffer çš„å¤§å°ã€‚</span><br>      atraceBufferSize <span class="hljs-string">&quot;500000&quot;</span><br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="android-supporté¡¹ç›®"><a href="#android-supporté¡¹ç›®" class="headerlink" title="android-supporté¡¹ç›®"></a>android-supporté¡¹ç›®</h3><p><strong>æœ¬åœ°éœ€è¦ä¾èµ–çš„æ–‡ä»¶ï¼š</strong> <a href="https://github.com/wesley666/source/blob/main/btrace-Android-support.zip">https://github.com/wesley666/source/blob/main/btrace-Android-support.zip</a></p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs Groovy">dependencies &#123;<br>    <span class="hljs-comment">//rheatrace core lib</span><br>    implementation <span class="hljs-string">&quot;org.jetbrains.kotlin:kotlin-stdlib:1.3.72&quot;</span><br>    implementation files(<span class="hljs-string">&#x27;libs/rhea-common-1.0.2.jar&#x27;</span>)<br>    implementation files(<span class="hljs-string">&#x27;libs/rhea-core-release.aar&#x27;</span>)<br>    implementation files(<span class="hljs-string">&#x27;libs/rhea-atrace-release.aar&#x27;</span>)<br>    implementation <span class="hljs-string">&quot;com.bytedance:bytehook:1.0.3&quot;</span><br>&#125;<br><br>apply <span class="hljs-attr">plugin:</span> <span class="hljs-string">&#x27;com.bytedance.rhea-trace&#x27;</span><br>rheaTrace &#123;<br><br>   compilation &#123;<br>      <span class="hljs-comment">//ä¸ºå‡å°‘ APK ä½“ç§¯, ä½ å¯ä»¥ä¸º App ä¸­éœ€è¦è·Ÿè¸ªçš„æ–¹æ³•è®¾ç½® id ä»¥æ­¤æ¥è·Ÿè¸ªæ­¤è‡ªå®šä¹‰äº‹ä»¶, é»˜è®¤å€¼ falseã€‚</span><br>      traceWithMethodID = <span class="hljs-literal">false</span> <br>      <span class="hljs-comment">//è¯¥æ–‡ä»¶é…ç½®å†³å®šå“ªäº›æ–¹æ³•æ‚¨ä¸å¸Œæœ›è·Ÿè¸ª, é»˜è®¤å€¼ nullã€‚</span><br>      traceFilterFilePath = <span class="hljs-string">&quot;$&#123;project.rootDir&#125;/rhea-trace/traceFilter.txt&quot;</span><br>      <span class="hljs-comment">//ç”¨ç‰¹æŒ‡å®šæ–¹æ³• id æ¥è®¾ç½®è‡ªå®šä¹‰äº‹ä»¶åç§°, é»˜è®¤å€¼ nullã€‚</span><br>      applyMethodMappingFilePath = <span class="hljs-string">&quot;$&#123;project.rootDir&#125;/rhea-trace/keep-method-id.txt&quot;</span><br>  &#125;<br><br>   runtime &#123;<br>      <span class="hljs-comment">//ä»…åœ¨ä¸»çº¿ç¨‹æŠ“å–è·Ÿè¸ªäº‹ä»¶, é»˜è®¤å€¼ falseã€‚</span><br>      mainThreadOnly <span class="hljs-literal">true</span> <br>      <span class="hljs-comment">//åœ¨ App å¯åŠ¨ä¹‹åˆå¼€å§‹æŠ“å–è·Ÿè¸ªäº‹ä»¶, é»˜è®¤å€¼ trueã€‚</span><br>      startWhenAppLaunch <span class="hljs-literal">true</span><br>      <span class="hljs-comment">//æŒ‡å®šå†…å­˜å­˜å‚¨ atrace æ•°æ® ring buffer çš„å¤§å°ã€‚</span><br>      atraceBufferSize <span class="hljs-string">&quot;500000&quot;</span><br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å…³äº <code>rheaTrace </code>ï¼Œä»<a href="https://github.com/bytedance/btrace/blob/master/GRADLE_CONFIG.zh-CN.MD">RheaTrace Gradle Config</a>ä¸­äº†è§£æ›´å¤šä¿¡æ¯ã€‚</p><p>æœ€åï¼Œæ£€æµ‹æ‚¨ç”µè„‘ python ç‰ˆæœ¬ï¼Œç”±äº Systrace çš„å…³ç³» RheaTrace ä»…æ”¯æŒ python 2.7 ç‰ˆæœ¬ï¼Œè¯·å°† systrace ç¯å¢ƒå˜é‡é…ç½®åœ¨ <em>~&#x2F;.bash_profile</em> æ–‡ä»¶ä¸­ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Shell">export PATH=$&#123;PATH&#125;:/Users/$&#123;user_name&#125;/Library/Android/sdk/platform-tools/systrace<br></code></pre></td></tr></table></figure><p>RheaTraceä½¿ç”¨æ–¹æ³•è¯·å‚è€ƒï¼š</p><p><a href="https://github.com/bytedance/btrace/blob/master/README.zh-CN.md">btrace&#x2F;README.zh-CN.md at master Â· bytedance&#x2F;btrace Â· GitHub</a></p>]]></content>
    
    
    <categories>
      
      <category>Androidæ€§èƒ½ä¼˜åŒ–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ€§èƒ½ä¼˜åŒ–</tag>
      
      <tag>btrace</tag>
      
      <tag>systrace</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>éŸ³è§†é¢‘ç¼“å­˜æ•°å­¦æ¨¡å‹</title>
    <link href="/article/36f6f986/"/>
    <url>/article/36f6f986/</url>
    
    <content type="html"><![CDATA[<p class="note note-success">2024å¹´8æœˆçš„ç¬”è®°</p><p>æ’­æ”¾å™¨ä½œä¸ºæ¶ˆè´¹è€…ï¼Œç¼“å­˜ä½œä¸ºç”Ÿäº§è€…ã€‚</p><h2 id="è¿›å…¥ç¼“å†²ä¸€æ¬¡"><a href="#è¿›å…¥ç¼“å†²ä¸€æ¬¡" class="headerlink" title="è¿›å…¥ç¼“å†²ä¸€æ¬¡"></a>è¿›å…¥ç¼“å†²ä¸€æ¬¡</h2><p>è®¾æ¶ˆè´¹è€…é€Ÿç‡ä¸ºv1ï¼Œç”Ÿäº§è€…ä¸ºv2ï¼Œè§†é¢‘é•¿åº¦ä¸ºlï¼Œxä¸ºç”Ÿäº§è€…è‡³å°‘è·ç¦»æ¶ˆè´¹è€…å¤šè¿œæ‰èƒ½ä¿è¯åœ¨æ’­å®Œè§†é¢‘å‰ä¸¤è€…é‡åˆã€‚å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªè¿½åŠé—®é¢˜ã€‚</p><p>v1<em>t &#x3D; v2</em>t + xï¼Œå³ l &#x3D; v2*l&#x2F;v1 + xï¼Œå› ä¸ºæ’­æ”¾å™¨é€Ÿåº¦æ˜¯1ï¼Œç»§ç»­ç®€åŒ–å¾— x &#x3D; l(1 - v2)</p><p>å¦‚æœv2å¤§äº1ï¼Œå³æ»¡è¶³æ¶ˆè´¹è€…éœ€æ±‚æ—¶ï¼Œå¯ä»¥æµç•…æ’­æ”¾ã€‚</p><p>è®¾læ˜¯ä¸€éƒ¨45åˆ†é’Ÿçš„ç”µè§†å‰§ï¼Œå³x &#x3D; 45<em>60</em>(1 - v2)</p><p>å¦‚æœv2æ˜¯1ï¼Œå³1så¯ä»¥ç¼“å­˜1sæ—¶é•¿è§†é¢‘ï¼Œåˆ™x &#x3D; 0</p><p>v2æ˜¯0.9ï¼Œå³1så¯ä»¥ç¼“å­˜0.9sæ—¶é•¿è§†é¢‘ï¼Œåˆ™ x &#x3D; 270ï¼Œæ„å‘³ç€è¦æå‰ç¼“å­˜270sçš„è§†é¢‘æ‰å¯ä»¥åç»­ä¸è¿›å…¥ç¼“å†²çŠ¶æ€ã€‚</p><p>åŒç†ï¼Œv2&#x3D;0.8ï¼Œx&#x3D; 540</p><p>â€¦â€¦â€¦â€¦.</p><p>v2 &#x3D; 0.1ï¼Œx&#x3D;2430</p><p>æ–œç‡æ˜¯-2700ï¼Œæ„å‘³ç€æ¯å˜åŒ–ç™¾åˆ†ä¹‹0.1ï¼Œç¼“å­˜é•¿åº¦éƒ½è¦å¢åŠ 270sã€‚</p><p>æ‹¿v2&#x3D;0.9ï¼Œx&#x3D; 270ä½œä¸ºä¾‹å­ï¼Œè¦æå‰ç¼“å­˜270sï¼Œéœ€è¦èŠ±è´¹çš„æ—¶é—´æ˜¯t&#x3D;270&#x2F;0.9&#x3D;300s</p><p>åŒç†ï¼Œv2&#x3D;0.8ï¼Œx&#x3D; 540ï¼Œt&#x3D;540&#x2F;0.8&#x3D;675s</p><p>â€¦â€¦..</p><p>v2 &#x3D; 0.1ï¼Œx&#x3D;2430,t&#x3D;2430&#x2F;0.1&#x3D;24300s&#x3D;405åˆ†é’Ÿ</p><h2 id="è¿›å…¥ç¼“å†²å¤šæ¬¡"><a href="#è¿›å…¥ç¼“å†²å¤šæ¬¡" class="headerlink" title="è¿›å…¥ç¼“å†²å¤šæ¬¡"></a>è¿›å…¥ç¼“å†²å¤šæ¬¡</h2><p>å®é™…ä¸Šï¼Œç”¨æˆ·æ˜¯ä¸èƒ½å®¹å¿ç­‰è¿™ä¹ˆä¹…çš„ï¼Œæ‰€ä»¥æ„å‘³ç€æ’­æ”¾å¼€å§‹åä¼šåå¤è¿›å…¥ç¼“å†²çŠ¶æ€ã€‚</p><p>å‡è®¾ç¼“å­˜1sæ’­1sï¼Œ</p><p>v2&#x3D;1ï¼Œæ˜¯å¯ä»¥æ­£å¸¸æ’­æ”¾</p><p>v2&#x3D;0.9ï¼Œåˆ™ç”¨æˆ·è¦ç­‰å¾…æ—¶é•¿ä¸º 1&#x2F;0.9&#x3D;1.1111sï¼Œå…ˆç¼“å­˜1sï¼Œåˆ™å¹³å‡1&#x2F;ï¼ˆ1-0.9ï¼‰&#x3D;10sè¿›å…¥ç¼“å†²çŠ¶æ€ï¼Œæ¯æ¬¡1.1111s</p><p>v2&#x3D;0.8ï¼Œåˆ™ç”¨æˆ·è¦ç­‰å¾…æ—¶é•¿ä¸º 1&#x2F;0.8&#x3D;1.25sï¼Œå…ˆç¼“å­˜1sï¼Œåˆ™å¹³å‡1&#x2F;ï¼ˆ1-0.8ï¼‰&#x3D;5sè¿›å…¥ç¼“å†²çŠ¶æ€ï¼Œæ¯æ¬¡1.25s</p><p>â€¦â€¦.</p><p>v2&#x3D;0.1ï¼Œåˆ™ç”¨æˆ·è¦ç­‰å¾…æ—¶é•¿ä¸º 1&#x2F;0.1&#x3D;10sï¼Œå…ˆç¼“å­˜1sï¼Œåˆ™å¹³å‡1&#x2F;ï¼ˆ1-0.1ï¼‰&#x3D;1.1111sè¿›å…¥ç¼“å†²çŠ¶æ€ï¼Œæ¯æ¬¡10s</p><p>åŒç†æ¯æ¬¡ç¼“å­˜å¤š1så†æ’­æ”¾ï¼Œéƒ½ä¼šå¢åŠ ä¸€å€è¿›å…¥ç¼“å†²çš„æ—¶é—´å’Œç­‰å¾…æ—¶é—´ã€‚</p><p>æ„å‘³ç€ï¼Œå¦‚æœé€šè¿‡å¤šçº¿ç¨‹ä¸èƒ½æ˜¾è‘—æé«˜v2é€Ÿåº¦è¶…è¿‡1ï¼Œå¯¹ç”¨æˆ·æ¥è¯´éƒ½æ˜¯å¡é¡¿ï¼Œæ— æ³•å¿å—çš„ã€‚</p><p>å½“ç„¶ï¼Œä¸Šé¢åªæ˜¯ä¸€ä¸ªç†è®ºæ¨¡å‹ï¼Œå®é™…ä¸Šè¦å¤æ‚ä¸€äº›ï¼Œå› ä¸ºæ¯ä¸ªtsåŒ…å«çš„æ’­æ”¾æ—¶é—´æ˜¯ä¸ä¸€æ ·çš„ã€‚</p><h2 id="æƒ…å†µåˆ†æ"><a href="#æƒ…å†µåˆ†æ" class="headerlink" title="æƒ…å†µåˆ†æ"></a>æƒ…å†µåˆ†æ</h2><p>è‹¥å¸¦å®½å°äºCDNé€Ÿåº¦ï¼Œå³v2æ€»æ˜¯å°äºv1ï¼Œè¿™æ ·æ— è®ºæ€ä¹ˆä¼˜åŒ–éƒ½ä¼šå¡é¡¿ã€‚</p><p>è‹¥å¸¦å®½å¤§äºCDNé€Ÿåº¦ï¼Œè‹¥v2å¤§äºv1åˆ™å¯ä»¥æ­£å¸¸æ’­æ”¾ï¼›è‹¥å•çº¿ç¨‹ä¸èƒ½æ»¡è¶³v2å¤§äºv1ï¼Œå¤šçº¿ç¨‹æ—¶v2å¤§äºv1ï¼Œä¹Ÿå¯ä»¥æ­£å¸¸æ’­æ”¾ã€‚</p><h2 id="ç¼“å­˜ç­–ç•¥"><a href="#ç¼“å­˜ç­–ç•¥" class="headerlink" title="ç¼“å­˜ç­–ç•¥"></a>ç¼“å­˜ç­–ç•¥</h2><p>å¯¹äºä¸‹è½½æ—¶é—´å°äºtsæ–‡ä»¶æ—¶é•¿çš„ï¼Œåˆ™ä¸²è¡Œä¸‹è½½ï¼Œä¸éœ€è¦å¹¶å‘ã€‚</p><p>ä»¥ä¸‹æ˜¯é’ˆå¯¹CDNé€Ÿåº¦å°äºç½‘ç»œå¸¦å®½çš„ï¼š</p><h3 id="1-åˆå§‹ä¸‹è½½è®¾ç½®"><a href="#1-åˆå§‹ä¸‹è½½è®¾ç½®" class="headerlink" title="1. åˆå§‹ä¸‹è½½è®¾ç½®"></a>1. <strong>åˆå§‹ä¸‹è½½è®¾ç½®</strong></h3><ul><li><strong>åˆå§‹å¹¶å‘æ•°</strong>ï¼šä»1ä¸ªæ–‡ä»¶å¼€å§‹ä¸‹è½½ã€‚</li><li><strong>ç›‘æ§ä¸‹è½½é€Ÿåº¦</strong>ï¼šç›‘æ§ä¸‹è½½é€Ÿåº¦å’Œè®°å½•æœ€å¤§ä¸‹è½½é€Ÿåº¦ã€‚</li></ul><h3 id="2-é€æ­¥å¢åŠ å¹¶å‘"><a href="#2-é€æ­¥å¢åŠ å¹¶å‘" class="headerlink" title="2. é€æ­¥å¢åŠ å¹¶å‘"></a>2. é€æ­¥å¢åŠ å¹¶å‘</h3><ul><li><strong>é€æ­¥å¢åŠ </strong>ï¼šä¸‹è½½æˆåŠŸåï¼Œå¢åŠ ä¸€ä¸ªå¹¶å‘ä¸‹è½½ä»»åŠ¡ã€‚</li><li><strong>ç›‘æ§å˜åŒ–</strong>ï¼šæ¯æ¬¡å¢åŠ å¹¶å‘åï¼Œè§‚å¯Ÿå•ä¸ªæ–‡ä»¶çš„ä¸‹è½½é€Ÿåº¦å˜åŒ–ã€‚</li></ul><h3 id="3-æ£€æµ‹ç“¶é¢ˆ"><a href="#3-æ£€æµ‹ç“¶é¢ˆ" class="headerlink" title="3. æ£€æµ‹ç“¶é¢ˆ"></a>3. <strong>æ£€æµ‹ç“¶é¢ˆ</strong></h3><ul><li><strong>è§‚å¯Ÿé™é€Ÿ</strong>ï¼šå½“ä¸‹è½½é€Ÿåº¦è¾¾åˆ°æŸä¸ªç¨³å®šå€¼ï¼ˆå’Œæœ€å¤§ä¸‹è½½é€Ÿåº¦ç›¸æ¯”ä¸è¶…è¿‡ç™¾åˆ†ä¹‹åï¼‰ï¼Œæˆ–è€…å•ä¸ªæ–‡ä»¶ä¸‹è½½é€Ÿåº¦æ˜¾è‘—ä¸‹é™æ—¶ï¼Œè¯´æ˜å¯èƒ½è§¦æ‘¸åˆ°äº†å¸¦å®½ä¸Šé™æˆ–æœåŠ¡å™¨é™é€Ÿã€‚</li><li><strong>å›é€€ä¼˜åŒ–</strong>ï¼šå¦‚æœå‘ç°å¹¶å‘æ•°å¢åŠ åè€Œå¯¼è‡´ä¸‹è½½é€Ÿåº¦ä¸‹é™ï¼Œè¦å‡å°‘å¹¶å‘æ•°ï¼Œæ‰¾åˆ°ä¸€ä¸ªæœ€ä½³çš„ä¸‹è½½é‡ã€‚</li></ul>]]></content>
    
    
    <categories>
      
      <category>éŸ³è§†é¢‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>éŸ³è§†é¢‘</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®‰å“å±ä¿è°ƒè¯•</title>
    <link href="/article/98c55340/"/>
    <url>/article/98c55340/</url>
    
    <content type="html"><![CDATA[<p>å…ˆçœ‹ä¸€ä¸‹åœ¨è®¾ç½®ç‚¹å‡»å±ä¿é¢„è§ˆåçš„è°ƒç”¨é“¾ï¼ˆAndroid 14ï¼‰</p><pre><code class=" mermaid">sequenceDiagram    participant User    participant MaterialButton    participant View    participant DreamSettings    participant DreamBackend    User-&gt;&gt;MaterialButton: ç‚¹å‡»æŒ‰é’®ï¼ˆ performClick()ï¼‰    MaterialButton-&gt;&gt;View: performClick()    View-&gt;&gt;DreamSettings: è§¦å‘ onClick() (lambda è¡¨è¾¾å¼)    DreamSettings-&gt;&gt;DreamBackend: è°ƒç”¨ preview()</code></pre><p>DreamControllerçš„æ‰“å°ä¿¡æ¯</p><blockquote><p>Starting dream: name&#x3D;ComponentInfo{com.google.android.apps.tv.dreamx&#x2F;com.google.android.apps.tv.dreamx.service.Backdrop}, <strong>isPreviewMode&#x3D;true</strong>, canDoze&#x3D;false, userId&#x3D;0, reason&#x3D;â€™test dreamâ€™</p></blockquote><p>DreamActivityæ˜¯ä¸€ä¸ªä¸éœ€è¦æ³¨å†Œçš„Activityï¼Œè¿è¡Œåœ¨å„ä¸ªå±ä¿è¿›ç¨‹ã€‚</p><p>å±ä¿åº”ç”¨å®ç°DreamServiceå³å¯ã€‚</p><p>å±ä¿çŠ¶æ€æ—¶ï¼Œåå°èµ·åº”ç”¨ä¼šè¿›å…¥ onStop çŠ¶æ€ï¼ˆè¯¥ä¾‹å­ onStop é‡Œé¢è°ƒç”¨äº† finishï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2025/20250315143803024.png" alt="img"></p><h2 id="é€€å‡ºå±ä¿çš„æ–¹æ³•"><a href="#é€€å‡ºå±ä¿çš„æ–¹æ³•" class="headerlink" title="é€€å‡ºå±ä¿çš„æ–¹æ³•"></a>é€€å‡ºå±ä¿çš„æ–¹æ³•</h2><h3 id="1ã€æœ‰è§¦æ‘¸æˆ–è€…æŒ‰é”®è¾“å…¥"><a href="#1ã€æœ‰è§¦æ‘¸æˆ–è€…æŒ‰é”®è¾“å…¥" class="headerlink" title="1ã€æœ‰è§¦æ‘¸æˆ–è€…æŒ‰é”®è¾“å…¥"></a>1ã€æœ‰è§¦æ‘¸æˆ–è€…æŒ‰é”®è¾“å…¥</h3><h3 id="2ã€é…ç½®config-dismissDreamOnActivityStart-ä¸º-true-åˆ™ä¼šåœ¨æ–°-activity-èµ·æ¥åé€€å‡ºå±ä¿"><a href="#2ã€é…ç½®config-dismissDreamOnActivityStart-ä¸º-true-åˆ™ä¼šåœ¨æ–°-activity-èµ·æ¥åé€€å‡ºå±ä¿" class="headerlink" title="2ã€é…ç½®config_dismissDreamOnActivityStart ä¸º true åˆ™ä¼šåœ¨æ–° activity èµ·æ¥åé€€å‡ºå±ä¿"></a>2ã€é…ç½®config_dismissDreamOnActivityStart ä¸º true åˆ™ä¼šåœ¨æ–° activity èµ·æ¥åé€€å‡ºå±ä¿</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"> <span class="hljs-comment">&lt;!-- Whether to dismiss the active dream when an activity is started. Doesn&#x27;t apply to</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">          assistant activities (ACTIVITY_TYPE_ASSISTANT) --&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">bool</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;config_dismissDreamOnActivityStart&quot;</span>&gt;</span>false<span class="hljs-tag">&lt;/<span class="hljs-name">bool</span>&gt;</span><br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2025/20250315143803153.png" alt="img"></p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2025/20250315143803189.png" alt="img"></p><h3 id="3ã€è·¨è¿›ç¨‹è°ƒç”¨DreamManagerService-çš„awakenï¼ˆéœ€è¦ç³»ç»Ÿç­¾åï¼‰"><a href="#3ã€è·¨è¿›ç¨‹è°ƒç”¨DreamManagerService-çš„awakenï¼ˆéœ€è¦ç³»ç»Ÿç­¾åï¼‰" class="headerlink" title="3ã€è·¨è¿›ç¨‹è°ƒç”¨DreamManagerService çš„awakenï¼ˆéœ€è¦ç³»ç»Ÿç­¾åï¼‰"></a>3ã€è·¨è¿›ç¨‹è°ƒç”¨DreamManagerService çš„awakenï¼ˆéœ€è¦ç³»ç»Ÿç­¾åï¼‰</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> android.os.IBinder<br><span class="hljs-keyword">import</span> androidx.annotation.RequiresPermission<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">DreamManager</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">val</span> <span class="hljs-variable">TAG</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;DreamManager&quot;</span><br>    <span class="hljs-comment">//private var mDreamManager: Any? = context.getSystemService(&quot;dream&quot;)</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> mDreamManager: Any? = <span class="hljs-literal">null</span><br><br>    init &#123;<br>        mDreamManager = <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">val</span> <span class="hljs-variable">dream</span> <span class="hljs-operator">=</span> Reflector.on(<span class="hljs-string">&quot;android.os.ServiceManager&quot;</span>).method(<span class="hljs-string">&quot;getService&quot;</span>, String::class.java).call&lt;Any&gt;(<span class="hljs-string">&quot;dreams&quot;</span>)<br>            Reflector.on(<span class="hljs-string">&quot;android.service.dreams.IDreamManager\$Stub&quot;</span>).method(<span class="hljs-string">&quot;asInterface&quot;</span>, IBinder::class.java).call&lt;Any&gt;(dream)<br>        &#125; <span class="hljs-keyword">catch</span> (e: Exception) &#123;<br>            <span class="hljs-literal">null</span><br>        &#125;<br>    &#125;<br><br>    <span class="hljs-meta">@RequiresPermission(&quot;android.permission.READ_DREAM_STATE&quot;)</span><br>    fun <span class="hljs-title function_">isDreaming</span><span class="hljs-params">()</span>: Boolean &#123;<br>        <span class="hljs-keyword">if</span> (mDreamManager == <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">try</span> &#123;<br>            Reflector.with(mDreamManager!!).method(<span class="hljs-string">&quot;isDreaming&quot;</span>).call()<br>        &#125; <span class="hljs-keyword">catch</span> (e: Exception) &#123;<br>            <span class="hljs-literal">false</span><br>        &#125;<br>    &#125;<br><br>    <span class="hljs-meta">@RequiresPermission(&quot;android.permission.WRITE_DREAM_STATE&quot;)</span><br>    fun <span class="hljs-title function_">stopDream</span><span class="hljs-params">()</span> &#123;<br>        mDreamManager?.let &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                Reflector.with(it).method(<span class="hljs-string">&quot;awaken&quot;</span>).call&lt;Unit&gt;()<br>            &#125; <span class="hljs-keyword">catch</span> (e: Exception) &#123;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å±ä¿è°ƒè¯•å‘½ä»¤ï¼šcmd-dreams"><a href="#å±ä¿è°ƒè¯•å‘½ä»¤ï¼šcmd-dreams" class="headerlink" title="å±ä¿è°ƒè¯•å‘½ä»¤ï¼šcmd dreams"></a>å±ä¿è°ƒè¯•å‘½ä»¤ï¼šcmd dreams</h2><blockquote><p>roc_rk3588s_pc:&#x2F; # cmd dreams -h</p><p>Dream manager (dreams) commands:</p><p>  help</p><p>â€‹      Print this help text.</p><p>  start-dreaming</p><p>â€‹      Start the currently configured dream.</p><p>  stop-dreaming</p><p>â€‹      Stops any active dream</p></blockquote><p>cmd dreams start-dreaming</p><p>cmd dreams stop-dreaming</p>]]></content>
    
    
    <categories>
      
      <category>AndroidFrameworkFeature</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DreamManagerService</tag>
      
      <tag>Framework</tag>
      
      <tag>å±ä¿</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®‰å“å†…å­˜æ³„éœ²ä¹‹DMA-BUFå¼‚å¸¸å¢é•¿:Android Studioé•œåƒå¼•èµ·DMAå†…å­˜æ³„éœ²</title>
    <link href="/article/f148a913/"/>
    <url>/article/f148a913/</url>
    
    <content type="html"><![CDATA[<p>ä»Šå¤©ç”¨ç€å®‰å“ 14 çš„æ¿å­çš„æ—¶å€™çªç„¶ç³»ç»Ÿå¡æ­»ã€‚</p><p>æŸ¥çœ‹æ—¥å¿—å‘ç°launcheréƒ½è¢«å¹²æ‰äº†</p><blockquote><p>03-04 06:13:35.544 7872 8479 I ActivityManager: vis BFGS 18740: com.android.launcher3 (pid 8407) service</p><p>03-04 06:13:35.544 7872 8479 I ActivityManager: com.android.launcher3&#x2F;com.android.quickstep.TouchInteractionService&lt;&#x3D;Proc{8077:com.android.systemui&#x2F;u0a70}</p><p>03-04 06:13:36.155 277 277 I lowmemorykiller: Kill â€˜com.android.launcher3â€™ (8407), uid 10071, oom_score_adj 100 to free 39504kB rss, 46224kB swap; reason: device is low on swap (91200kB &lt; 199552kB) and thrashing (200%)</p></blockquote><p>çœ‹<code>dumpsys meminfo</code>å‘ç°DMA-BUFå äº†3Gå¤šï¼ˆ4Gè®¾å¤‡ï¼‰ï¼Œåº”ç”¨free ramåŸºæœ¬æ²¡äº†ã€‚</p><p>åˆšå¼€å§‹ä»¥ä¸ºæ˜¯scrcpyçš„é—®é¢˜ã€‚åæ¥ç»è°ƒæŸ¥å‘ç°æ˜¯android studioçš„å±å¹•é•œåƒé—®é¢˜ã€‚</p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>å¼€æœºä¸€æ®µæ—¶é—´å</p><blockquote><p>Total RAM: 3,991,080K (status normal)</p><p>Free RAM: 1,166,810K (  124,454K cached pss +   623,088K cached kernel +   419,268K free)</p><p><strong>DMA-BUF: 1,477,628K (      876K mapped + 1,476,752K unmapped)</strong></p><p>DMA-BUF Heaps: 1,477,628K</p><p>DMA-BUF Heaps pool:   249,088K</p><p>â€‹      GPU:   202,320K</p><p> Used RAM: 2,763,593K (1,036,373K used pss + 1,727,220K kernel)</p><p> Lost RAM:   195,490K</p><p>â€‹     ZRAM:    72,700K physical used for   215,296K in swap (1,995,536K total swap)</p><p>   Tuning: 192 (large 512), oom   322,560K, restore limit   107,520K (high-end-gfx)</p></blockquote><p><code>cat /sys/kernel/dmabuf/buffers/*/size</code>ï¼Œå‘ç°æœ‰å¥½å¤š483328å­—èŠ‚çš„ inode</p><p><code>cat /sys/kernel/dmabuf/buffers/*/size  | grep 483328 | wc -l</code></p><p>æœ‰2957ä¸ªï¼Œè®¡ç®—ï¼š2957*483328&#x3D;1429200896&#x3D;1.4Gï¼Œå’Œä¸Šé¢çš„ç»“æœå·®ä¸å¤šã€‚</p><p>éšä¾¿æŸ¥çœ‹ä¸€ä¸ªinode</p><blockquote><p>roc_rk3588s_pc:&#x2F; # lsof | grep -w 7248</p><p><a href="mailto:&#x63;&#x32;&#x40;&#x31;&#46;&#x31;&#45;&#x73;&#101;&#114;&#118;&#x69;&#x63;&#x65;">&#x63;&#x32;&#x40;&#x31;&#46;&#x31;&#45;&#x73;&#101;&#114;&#118;&#x69;&#x63;&#x65;</a>   543 mediacodec 2553u     0000                0,8       0t0       7248 &#x2F;dmabuf:system</p><p>main       4146       root 5088u     0000                0,8       0t0       7248 &#x2F;dmabuf:system</p><p>main       4146       root 5089u     0000                0,8       0t0       7248 &#x2F;dmabuf:system</p></blockquote><p><code>lsof | grep &quot;4146&quot; | grep dmabuf  | wc -l</code></p><p>æœ‰2958æ¡è¿™æ ·çš„æ¡ç›®</p><p><code>main       4146       root 5973u     0000                0,8       0t0       7690 /dmabuf:system</code></p><p>å’Œä¸Šé¢çš„æ•°ç›®ä¸€ä¸€å¯¹åº”</p><p>æŸ¥çœ‹æ˜¯å“ªä¸€ä¸ªç¨‹åº</p><blockquote><p>roc_rk3588s_pc:&#x2F; # cat &#x2F;proc&#x2F;543&#x2F;cmdline</p><p>&#x2F;vendor&#x2F;bin&#x2F;hw&#x2F;<a href="mailto:&#97;&#x6e;&#100;&#114;&#111;&#x69;&#100;&#46;&#x68;&#97;&#x72;&#100;&#119;&#97;&#x72;&#101;&#x2e;&#x6d;&#x65;&#x64;&#105;&#x61;&#x2e;&#x63;&#50;&#x40;&#x31;&#x2e;&#x31;&#x2d;&#115;&#101;&#x72;&#118;&#105;&#99;&#x65;">&#97;&#x6e;&#100;&#114;&#111;&#x69;&#100;&#46;&#x68;&#97;&#x72;&#100;&#119;&#97;&#x72;&#101;&#x2e;&#x6d;&#x65;&#x64;&#105;&#x61;&#x2e;&#x63;&#50;&#x40;&#x31;&#x2e;&#x31;&#x2d;&#115;&#101;&#x72;&#118;&#105;&#99;&#x65;</a></p><p>roc_rk3588s_pc:&#x2F; # cat &#x2F;proc&#x2F;4146&#x2F;cmdline</p><p>app_process&#x2F;data&#x2F;local&#x2F;tmp&#x2F;.studiocom.android.tools.screensharing.Mainâ€“socket&#x3D;screen-sharing-agent-8055â€“flags&#x3D;16</p></blockquote><p>å‘ç°æ˜¯android studioé•œåƒå¯¼è‡´çš„ï¼šåº”è¯¥æ˜¯å› ä¸ºä¸€ç›´é»‘å±å¯¼è‡´åå¤ç”³è¯·å†…å­˜å¯¼è‡´DMA-BUFæ³„éœ²ã€‚</p><p>å…³é—­Android Studioçš„Device MirroringåŠŸèƒ½åï¼Œåé¢ä½¿ç”¨è®¾å¤‡å°±æ­£å¸¸äº†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2025/20250304211421729.png" alt="img"></p><h2 id="dmabuf-dump"><a href="#dmabuf-dump" class="headerlink" title="dmabuf_dump"></a>dmabuf_dump</h2><p>é€šè¿‡dmabuf_dumpå‘½ä»¤å¯ä»¥æ›´å¿«åœ°æŸ¥çœ‹å¼‚å¸¸ç¨‹åº</p><blockquote><p>roc_rk3588s_pc:&#x2F; # dmabuf_dump -h</p><p>Usage: dmabuf_dump [-abh] [per-process&#x2F;per-buffer stats]</p><p>-a       show all dma buffers (ion) in big table, [buffer x process] grid</p><p>-b       show DMA-BUF per-buffer, per-exporter and per-device statistics</p><p>-h       show this help</p><p>â€‹         If PID is supplied, the dmabuf information for that process is shown.</p><p>â€‹         Per-buffer DMA-BUF stats do not take an argument.</p></blockquote><p>é€šè¿‡<code>dmabuf_dump</code>å°±å¯ä»¥æŸ¥çœ‹å„ä¸ªç¨‹åºDMA-BUFçš„å ç”¨æƒ…å†µï¼ˆåŒ…å«ç¨‹åºåå­—ã€pidã€inodeç­‰ç­‰ï¼‰æˆ–è€…åŠ å…¶ä»–å‚æ•°è¾“å‡ºä¸åŒç»“æœã€‚</p><blockquote><p>roc_rk3588s_pc:&#x2F; # dmabuf_dump 4146</p><p>â€‹            main:4146</p><p>â€‹                  Name              Rss              Pss         nr_procs            Inode</p><p>â€‹                system           472 kB           472 kB                1             4735</p><p>â€‹                system           472 kB           472 kB                1             4736</p><p>â€‹                system           472 kB           472 kB                1             4737</p><p>â€‹               </p><p>â€‹               â€”â€”â€”â€”â€”â€”ï¼ˆçœç•¥å‡ åƒè¡Œï¼‰â€”â€”â€”â€”â€”-</p><p>â€‹          </p><p>â€‹                system           472 kB           472 kB                1             7688</p><p>â€‹                system           472 kB           472 kB                1             7689</p><p>â€‹                system           472 kB           472 kB                1             7690</p><p>â€‹         PROCESS TOTAL       1395232 kB       1395232 kB</p><p>-â€”â€”â€”â€”â€”â€”â€”</p><p>dmabuf total: 1477628 kB kernel_rss: 82396 kB userspace_rss: 1395232 kB userspace_pss: 1395232 kB</p></blockquote><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://source.android.com/docs/core/graphics/implement-dma-buf-gpu-mem">Implement DMABUF and GPU memory accounting in Android 12  |  Android Open Source Project</a></p>]]></content>
    
    
    <categories>
      
      <category>Androidæ€§èƒ½ä¼˜åŒ–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å†…å­˜</tag>
      
      <tag>æ€§èƒ½ä¼˜åŒ–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®‰å“ç»„ä»¶åŒ–ä¹‹åŠ¨æ€ä¾èµ–åŠŸèƒ½æ¨¡å—</title>
    <link href="/article/67ca89d4/"/>
    <url>/article/67ca89d4/</url>
    
    <content type="html"><![CDATA[<p>å¯¹äºæ‹¥æœ‰ä¸åŒæ¸ é“çš„ APP æ¥è¯´ï¼Œå¯èƒ½éœ€è¦é›†æˆä¸åŒçš„åŠŸèƒ½æ¨¡å—ï¼Œä¹Ÿå¯èƒ½åŒä¸€ä¸ªåŠŸèƒ½æœ‰ä¸åŒå®ç°ã€‚æœ€ç®€å•çš„æ–¹æ³•å¯èƒ½æ˜¯é€šè¿‡æ¥å£ã€å·¥å‚æ¨¡å¼ã€ flavorImplement å’Œæ¸ é“è‡ªå®šä¹‰ä»£ç çš„æ–¹æ³•æ¥å®ç°äº†ã€‚ä½†æ˜¯ï¼Œå¦‚æœä¸æƒ³å»ºé‚£ä¹ˆå¤šæ¸ é“ä»£ç ç›®å½•ï¼Œéœ€è¦é€šè¿‡ä¸€å¥—ä»£ç æ¥åˆå§‹åŒ–æ¨¡å—ï¼Œé‚£ä¹ˆä¸Šè¿°æ–¹æ³•å°±ä¸è¡Œäº†ã€‚</p><p>é‚£ä¹ˆå¦‚ä½•åœ¨ä¸ä¾èµ–æ¨¡å—çš„å‰æä¸‹åŠ¨æ€è°ƒç”¨å…¶åŠŸèƒ½å‘¢ï¼Ÿ</p><p>æœ‰å‡ ç§æ–¹æ³•ï¼š</p><p>1ã€åå°„ã€æ¥å£éš”ç¦»å’Œå·¥å‚æ¨¡å¼</p><p>2ã€åŠ¨æ€åŠŸèƒ½æ¨¡å—ï¼ˆDynamic Feature Moduleï¼‰ï¼Œå›½å†…ä¸é€‚ç”¨ã€‚</p><p>3ã€åˆ©ç”¨ Java çš„ <code>ServiceLoader</code> æœºåˆ¶ï¼Œé€šè¿‡é…ç½®æ–‡ä»¶å£°æ˜æ¥å£å®ç°ç±»ã€‚</p><p>ç»¼åˆè€ƒè™‘åå†³å®šé‡‡ç”¨åå°„ã€æ¥å£éš”ç¦»å’Œå·¥å‚æ¨¡å¼ã€‚</p><h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><p>ç¯å¢ƒï¼šagp 8.7.0ï¼Œgradeï¼š8.10.2</p><h3 id="gradleï¼šå®ç°æ¨¡å—åŠ¨æ€åŠ è½½"><a href="#gradleï¼šå®ç°æ¨¡å—åŠ¨æ€åŠ è½½" class="headerlink" title="gradleï¼šå®ç°æ¨¡å—åŠ¨æ€åŠ è½½"></a>gradleï¼šå®ç°æ¨¡å—åŠ¨æ€åŠ è½½</h3><p>é‡‡ç”¨yamlæ–‡ä»¶è¿›è¡ŒåŠŸèƒ½é…ç½®</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment">#åŠŸèƒ½å®šä¹‰</span><br><span class="hljs-attr">features:</span><br>  <span class="hljs-attr">featureA:</span><br>    <span class="hljs-comment">#é»˜è®¤é…ç½®</span><br>    <span class="hljs-attr">enable:</span> <span class="hljs-literal">false</span><br>    <span class="hljs-attr">name:</span> <span class="hljs-string">&#x27;:feature:featureA&#x27;</span> <span class="hljs-comment">#æ¨¡å—åå­—</span><br>    <span class="hljs-comment">#ä¸¤ä¸ªåˆ—è¡¨ä¼˜å…ˆçº§æœ€é«˜ï¼Œä½†ä¸èƒ½åŒæ—¶åŒ…å«ä¸€æ ·çš„flavor</span><br>    <span class="hljs-comment">#å¦‚æœenableä¸ºtrueï¼Œåˆ™å»ºè®®ä½¿ç”¨disableFlavorsListã€‚åä¹‹ï¼Œäº¦ç„¶ã€‚</span><br>    <span class="hljs-attr">enableFlavorsList:</span> [<span class="hljs-string">demo</span>, <span class="hljs-string">companyA</span>, <span class="hljs-string">companyB</span>]<br>    <span class="hljs-attr">disableFlavorsList:</span> []<br></code></pre></td></tr></table></figure><p>libs.versions.toml</p><figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs toml"><span class="hljs-attr">snakeyaml</span> = <span class="hljs-string">&quot;1.33&quot;</span><br><span class="hljs-attr">snakeyaml</span> = &#123; module = <span class="hljs-string">&quot;org.yaml:snakeyaml&quot;</span>, version.ref = <span class="hljs-string">&quot;snakeyaml&quot;</span> &#125;<br></code></pre></td></tr></table></figure><p>æ ¹build.gradle</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">// Top-level build file where you can add configuration options common to all sub-projects/modules.</span><br>buildscript &#123;<br>    <span class="hljs-comment">// è‡ªå®šä¹‰ gradle æ’ä»¶</span><br>    dependencies &#123;<br>        <span class="hljs-comment">//classpath(libs.plugin)</span><br>        classpath libs.snakeyaml <span class="hljs-comment">// æ·»åŠ  YAML è§£æåº“</span><br>    &#125;<br>&#125;<br><br>plugins &#123;<br>    alias(libs.plugins.android.application) apply <span class="hljs-literal">false</span><br>    alias(libs.plugins.kotlin.android) apply <span class="hljs-literal">false</span><br>    alias(libs.plugins.android.library) apply <span class="hljs-literal">false</span><br>&#125;<br></code></pre></td></tr></table></figure><p>app build.gradle ï¼ˆæ ¹æ®é…ç½®åŠ¨æ€ä¾èµ–æ¨¡å—å®ç°ï¼‰</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//Yamlæ”¾åœ¨å…¶ä»–xxx.gradle importä¼šæŠ¥æ‰¾ä¸åˆ°</span><br><span class="hljs-keyword">import</span> org.yaml.snakeyaml.Yaml<br>ext &#123;<br>    loadYamlConfig = &#123; String fileName -&gt;<br>        <span class="hljs-keyword">def</span> configFile = file(fileName)<br>        <span class="hljs-keyword">if</span> (!configFile.exists()) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> GradleException(<span class="hljs-string">&quot;YAML config file not found: $&#123;configFile.absolutePath&#125;&quot;</span>)<br>        &#125;<br>        <span class="hljs-keyword">def</span> yaml = <span class="hljs-keyword">new</span> Yaml()<br>        <span class="hljs-keyword">def</span> config<br>        <span class="hljs-keyword">try</span> &#123;<br>            configFile.withReader &#123; reader -&gt;<br>                config = yaml.load(reader)<br>            &#125;<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> GradleException(<span class="hljs-string">&quot;Failed to parse YAML file: $&#123;configFile.name&#125;&quot;</span>, e)<br>        &#125;<br>        <span class="hljs-keyword">return</span> config.asImmutable()<br>    &#125;<br>&#125;<br><br><br><span class="hljs-keyword">def</span> printlnRed(String msg) &#123;<br>    <span class="hljs-keyword">def</span> ANSI_RESET = <span class="hljs-string">&quot;\u001B[0m&quot;</span><br>    <span class="hljs-keyword">def</span> ANSI_RED = <span class="hljs-string">&quot;\u001B[31m&quot;</span><br>    println(<span class="hljs-string">&quot;$&#123;ANSI_RED&#125;$&#123;msg&#125;$&#123;ANSI_RESET&#125;&quot;</span>)<br>&#125;<br><br><span class="hljs-keyword">def</span> featureConfig = loadYamlConfig(<span class="hljs-string">&quot;feature_config.yaml&quot;</span>)<br>println(<span class="hljs-string">&quot;featureConfig: $&#123;featureConfig&#125;&quot;</span>)<br>afterEvaluate &#123;<br>    android.applicationVariants.configureEach &#123; variant -&gt;<br>        <span class="hljs-keyword">def</span> flavorCompanyName = variant.productFlavors.find &#123; it.dimension == <span class="hljs-string">&quot;COMPANY&quot;</span> &#125;?.name<br>        if (!flavorCompanyName) &#123;<br>            throw new GradleException(<span class="hljs-string">&quot;Variant $&#123;variant.name&#125; has no COMPANY flavor!&quot;</span>)<br>        &#125;<br>        println(<span class="hljs-string">&quot;variant.name:$&#123;variant.name&#125; variant.flavorName:$&#123;variant.flavorName&#125;&quot;</span>)<br>        featureConfig.features.each &#123; featureKey, defaultConfig  -&gt;<br>            def featureName = defaultConfig.name<br>            boolean isEnabled = defaultConfig.enable<br>            def enableFlavorsList = defaultConfig.enableFlavorsList<br>            def disableFlavorsList = defaultConfig.disableFlavorsList<br>            boolean hasFound = false<br>            for (flavor in enableFlavorsList) &#123;<br>                if (flavor == flavorCompanyName) &#123;<br>                    isEnabled = true<br>                    println(<span class="hljs-string">&quot;enable in enableFlavorsList&quot;</span>)<br>                    hasFound = true<br>                    break<br>                &#125;<br>            &#125;<br>            for (flavor in disableFlavorsList) &#123;<br>                if (flavor == flavorCompanyName) &#123;<br>                    if (hasFound) &#123;<br>                        throw new GradleException(<span class="hljs-string">&quot;Feature $featureKey in flavor $flavorCompanyName must not be in both enableFlavorsList and disableFlavorsList!&quot;</span>)<br>                    &#125;<br>                    isEnabled = false<br>                    printlnRed(<span class="hljs-string">&quot;disable in disableFlavorsList&quot;</span>)<br>                    break<br>                &#125;<br>            &#125;<br>            if (isEnabled) &#123;<br>                println(<span class="hljs-string">&quot;$&#123;flavorCompanyName&#125;Implementation $&#123;featureName&#125;&quot;</span>)<br>                <span class="hljs-comment">//åŠ¨æ€ä¾èµ–æ¨¡å—</span><br>                dependencies.add(<span class="hljs-string">&quot;$&#123;flavorCompanyName&#125;Implementation&quot;</span>, project(featureName))<br>            &#125; else &#123;<br>                printlnRed(<span class="hljs-string">&quot;$&#123;variant.name&#125; $&#123;flavorCompanyName&#125; Not Implementation $&#123;featureName&#125;&quot;</span>)<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æ¨¡å—å®ç°"><a href="#æ¨¡å—å®ç°" class="headerlink" title="æ¨¡å—å®ç°"></a>æ¨¡å—å®ç°</h3><h4 id="å…¬å…±æ¨¡å—"><a href="#å…¬å…±æ¨¡å—" class="headerlink" title="å…¬å…±æ¨¡å—"></a>å…¬å…±æ¨¡å—</h4><p>å®šä¹‰æ¥å£</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">IFeature</span> &#123;<br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">doSomething</span><span class="hljs-params">()</span></span><br>&#125;<br></code></pre></td></tr></table></figure><p>å®šä¹‰ä¸€ä¸ª Helper</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">object</span> FeatureHelper : IFeature &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> mFeature: IFeature? = <span class="hljs-literal">null</span><br>    <br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">setFeatureImpl</span><span class="hljs-params">(feature: <span class="hljs-type">IFeature</span>?)</span></span> &#123;<br>        mFeature = feature<br>    &#125;<br>    <br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">doSomething</span><span class="hljs-params">()</span></span> &#123;<br>        mFeature?.doSomething()<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="åŠŸèƒ½æ¨¡å—"><a href="#åŠŸèƒ½æ¨¡å—" class="headerlink" title="åŠŸèƒ½æ¨¡å—"></a>åŠŸèƒ½æ¨¡å—</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Module</span> &#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">       é‡‡ç”¨javaç±» æ–¹ä¾¿ä½¿ç”¨ java çš„æ–¹å¼è¿›è¡Œåå°„</span><br><span class="hljs-comment">     * æ³¨æ„ï¼šåŒ…åå’Œç±»åã€æ–¹æ³•åå’Œå‚æ•°ä¸èƒ½éšæ„ä¿®æ”¹ï¼Œå¦åˆ™åå°„ä¼šæ‰¾ä¸åˆ°</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> context Context</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> IFeature</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> IFeature <span class="hljs-title function_">load</span><span class="hljs-params">(Context context)</span> &#123;<br>        <span class="hljs-comment">//FeatureManagerå®ç°IFeatureæ¥å£</span><br>        <span class="hljs-type">FeatureManager</span> <span class="hljs-variable">manager</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FeatureManager</span>(context);<br>        manager.init();<br>        <span class="hljs-keyword">return</span> manager;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="app-æ¨¡å—"><a href="#app-æ¨¡å—" class="headerlink" title="app æ¨¡å—"></a>app æ¨¡å—</h4><p><a href="https://iwesley.top/article/ba67228f/">Javaåå°„çš„ä¼˜é›…ä½¿ç”¨ - Wesleyâ€™s Blog</a></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadFeatureModule</span><span class="hljs-params">(application: <span class="hljs-type">Application</span>)</span></span>: IFeature? &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">try</span> &#123;<br>        Reflector.on(<span class="hljs-string">&quot;com.wesley.feature.Module&quot;</span>)<br>            .method(<span class="hljs-string">&quot;load&quot;</span>, Context::<span class="hljs-keyword">class</span>.java).call&lt;IFeature&gt;(application)<br>    &#125; <span class="hljs-keyword">catch</span> (e: Exception) &#123;<br>        <span class="hljs-literal">null</span> <span class="hljs-comment">// æ¨¡å—æœªå¯ç”¨æˆ–æœªå®ç°</span><br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">initModules</span><span class="hljs-params">(application: <span class="hljs-type">Application</span>)</span></span> &#123;<br>  FeatureHelper.setFeatureImpl(loadFeatureModule(application))<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://zhuanlan.zhihu.com/p/97498337">Android æ¨¡å—è§£è€¦å’Œçš„å®è·µ</a></p><p><a href="https://blog.csdn.net/fesdgasdgasdg/article/details/106888077">Android ä¸­ä½¿ç”¨ ServiceLoaderã€AutoService æ‘”å‘è®°å½•</a></p>]]></content>
    
    
    <categories>
      
      <category>AndroidAPPæ¶æ„</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>gradle</tag>
      
      <tag>ç»„ä»¶åŒ–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DLNAåº“Platinumæ–°å¢å®‰å“64ä½soç¼–è¯‘æ–¹æ³•</title>
    <link href="/article/4339b418/"/>
    <url>/article/4339b418/</url>
    
    <content type="html"><![CDATA[<p>ä¸‹è½½ä»£ç ï¼ˆè¯¥ä»“åº“æˆ‘å·²ç»ä¿®æ”¹ç›¸å…³ç¼–è¯‘é”™è¯¯å’Œæ”¯æŒå®‰å“ 64 ä½ so ç¼–è¯‘ï¼‰</p><p><code>git clone https://github.com/wesley666/Platinum -b master</code></p><p>ä¸‹è½½Neptune</p><p><code>git submodule update --init</code></p><p>ä¸‹è½½ ndk15ï¼š</p><p><a href="https://dl.google.com/android/repository/android-ndk-r15c-linux-x86_64.zip">https://dl.google.com/android/repository/android-ndk-r15c-linux-x86_64.zip</a></p><p>å»ºè®®å®‰è£… conda ç¯å¢ƒæ¥è¿›è¡Œç¼–è¯‘</p><p><a href="https://www.anaconda.com/download/success">https://www.anaconda.com/download/success</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">conda create -n dlna  python=2.7<br><br>pip install scons<br><br>conda activate dlna<br></code></pre></td></tr></table></figure><p>ç¼–è¯‘</p> <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">ä»¥ä½ çš„è·¯å¾„ä¸ºå‡†ï¼Œå¦‚æœå‡ºç°è·¯å¾„é”™è¯¯ï¼Œå¯ä»¥æ”¹æˆç»å¯¹è·¯å¾„</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-built_in">export</span> ANDROID_NDK_ROOT=/home/wesley/ndk/android-ndk-r15c/</span> <br>export ANDROID_NDK_ROOT=~/ndk/android-ndk-r15c/ <br>scons -c target=arm-android-linux build_config=Release<br>scons target=arm-android-linux build_config=Release<br>scons -c target=arm64-android-linux build_config=Release<br>scons target=arm64-android-linux build_config=Release<br>cd Source/Platform/Android/module/platinum<br>~/ndk/android-ndk-r15c/ndk-build clean<br>~/ndk/android-ndk-r15c/ndk-build NDK_DEBUG=0<br></code></pre></td></tr></table></figure><blockquote><p>(dlna) wesley@Wesley:~&#x2F;Project&#x2F;Platinum&#x2F;Source&#x2F;Platform&#x2F;Android&#x2F;module&#x2F;platinum$ ~&#x2F;ndk&#x2F;android-ndk-r15c&#x2F;ndk-build<br>Android NDK: Found platform level in .&#x2F;project.properties. Setting APP_PLATFORM to android-14.<br>jni&#x2F;Android.mk:5: â€œTARGET_ARCH_ABI:armeabiâ€<br>jni&#x2F;Android.mk:5: â€œTARGET_ARCH_ABI:armeabi-v7aâ€<br>jni&#x2F;Android.mk:5: â€œTARGET_ARCH_ABI:arm64-v8aâ€<br>jni&#x2F;Android.mk:15: â€œbuild arm64â€<br>[armeabi] Compile++ thumb: platinum-jni &lt;&#x3D; platinum-jni.cpp<br>[armeabi] StaticLibrary  : libstdc++.a<br>[armeabi] SharedLibrary  : libplatinum-jni.so<br>[armeabi] Install        : libplatinum-jni.so &#x3D;&gt; libs&#x2F;armeabi&#x2F;libplatinum-jni.so<br>[armeabi-v7a] Compile++ thumb: platinum-jni &lt;&#x3D; platinum-jni.cpp<br>[armeabi-v7a] StaticLibrary  : libstdc++.a<br>[armeabi-v7a] SharedLibrary  : libplatinum-jni.so<br>[armeabi-v7a] Install        : libplatinum-jni.so &#x3D;&gt; libs&#x2F;armeabi-v7a&#x2F;libplatinum-jni.so<br>[arm64-v8a] Compile++      : platinum-jni &lt;&#x3D; platinum-jni.cpp<br>[arm64-v8a] StaticLibrary  : libstdc++.a<br>[arm64-v8a] SharedLibrary  : libplatinum-jni.so<br>[arm64-v8a] Install        : libplatinum-jni.so &#x3D;&gt; libs&#x2F;arm64-v8a&#x2F;libplatinum-jni.so</p></blockquote><p>objå’Œ libsç›®å½•åŒºåˆ«ï¼šä¸€ä¸ªç”¨äºè¿½æº¯å’Œè°ƒè¯•ï¼Œä¸€ä¸ªç”¨äºæ­£å¼ç‰ˆå‘å¸ƒã€‚</p><blockquote><p>(dlna) wesley@Wesley:~&#x2F;Project&#x2F;Platinum&#x2F;Source&#x2F;Platform&#x2F;Android&#x2F;module&#x2F;platinum$ file libs&#x2F;arm64-v8a&#x2F;libplatinum-jni.so<br>libs&#x2F;arm64-v8a&#x2F;libplatinum-jni.so: ELF 64-bit LSB shared object, ARM aarch64, version 1 (SYSV), dynamically linked, BuildID[sha1]&#x3D;a8cdaa3a1288bd98c13556fbd4a1499e31005091, <strong>stripped</strong></p><p>(dlna) wesley@Wesley:~&#x2F;Project&#x2F;Platinum&#x2F;Source&#x2F;Platform&#x2F;Android&#x2F;module&#x2F;platinum$ file obj&#x2F;local&#x2F;arm64-v8a&#x2F;libplatinum-jni.so<br>obj&#x2F;local&#x2F;arm64-v8a&#x2F;libplatinum-jni.so: ELF 64-bit LSB shared object, ARM aarch64, version 1 (SYSV), dynamically linked, BuildID[sha1]&#x3D;a8cdaa3a1288bd98c13556fbd4a1499e31005091, <strong>with debug_info, not stripped</strong></p></blockquote>]]></content>
    
    
    <categories>
      
      <category>æŠ•å±</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æŠ•å±</tag>
      
      <tag>DLNA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®‰å“Activityæ‰§è¡ŒfinishåonNewIntentä¹Ÿæ‰§è¡Œäº†</title>
    <link href="/article/88a54bc8/"/>
    <url>/article/88a54bc8/</url>
    
    <content type="html"><![CDATA[<p>æµ‹è¯•ååº”æŠ•å±æ—¶ä¸‹ä¸€é›†å¯èƒ½æ’­æ”¾ä¸æˆåŠŸã€‚</p><p>é¦–å…ˆçœ‹ä¸€ä¸‹æ—¥å¿—ï¼š</p><blockquote><p>onCompletion<br>onCast<br>handlerMessage: 2<br>finish: PlayerActivity@abc7fdc<br>onPause: PlayerActivity@abc7fdc<br>onNewIntent: PlayerActivity@abc7fdc<br>onResume: PlayerActivity@abc7fdc<br>onPause: PlayerActivity@abc7fdc<br>onResume: HomeActivity@71ec50a<br>onstop: PlayerActivity@abc7fdc<br>onDestroy:PlayerActivity@abc7fdc</p></blockquote><p>çœ‹åˆ°æ—¥å¿—æ—¶å¾ˆè¿·æƒ‘ï¼Œä¸ºä»€ä¹ˆ finish äº†ï¼Œå®‰å“è¿˜ä¼šæ‰§è¡ŒonNewIntentï¼Œä¸åº”è¯¥æ˜¯æ–°å»ºä¸€ä¸ª activity å—ï¼Ÿ</p><p>å…ˆæ¥çœ‹ä¸€ä¸‹åœºæ™¯æè¿°ï¼š</p><p>è§†é¢‘æ’­å®Œåä¼šå‘é€ä¸€ä¸ª finish ä¿¡æ¯ï¼Œå¦‚æœ 3s å†…æ²¡æœ‰ä¸‹ä¸€ä¸ªè§†é¢‘è¿›æ¥å°±ä¼šæ‰§è¡Œ finishï¼Œæœ‰è§†é¢‘è¿›æ¥å°±ä¼šåœ¨ onNewIntent ä¸­ remove æ‰è¿™æ¡ä¿¡æ¯ã€‚</p><p>ç»è¿‡å®éªŒå’Œè¯¦ç»†åˆ†æåï¼Œç»ˆäºæ‰¾åˆ°äº†é—®é¢˜åŸå› ï¼š</p><p>é¦–å…ˆå› ä¸ºè§†é¢‘æ’­æ”¾ç»“æŸå‘äº†ä¸€æ¡finishæ¶ˆæ¯ï¼Œfinishæ¶ˆæ¯æ²¡æœ‰æ‰§è¡Œæ—¶çªç„¶æ¥äº†ä¸‹ä¸€é›†çš„æ¶ˆæ¯ï¼Œè¿™æ—¶å€™æ‰§è¡ŒstartActivtyä¼šæ’å…¥ä¸€æ¡onNewIntentæ¶ˆæ¯ã€‚ç»“æœï¼Œè¿™æ—¶å€™finishå› ä¸ºæ—¶é—´åˆ°äº†ï¼Œè¯¥æ‰§è¡Œäº†ã€‚ç„¶å finish æ‰§è¡Œå®Œåï¼ŒonNewIntent ä¹Ÿè¯¥æ‰§è¡Œäº†ã€‚æ‰§è¡Œå®Œåå› ä¸º finish çš„åŸå› ï¼Œ onDestroyä¹Ÿæ‰§è¡Œäº†ã€‚ç»“æœå°±æ˜¯ä¸‹ä¸€é›†æ²¡æ’­å®Œå°±é€€å‡ºæ¥äº†ã€‚</p><p>è§£å†³åŠæ³•ï¼šåœ¨startActivityå‰removeæ‰finishæ¶ˆæ¯ï¼Œæ¯”onNewIntent çš„æ—¶é—´èŠ‚ç‚¹è¿˜è¦æå‰ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>é¢è¯•å¿…å¤‡ï¼šAndroidï¼ˆ9.0ï¼‰Activityå¯åŠ¨æµç¨‹(ä¸€) : <a href="https://juejin.cn/post/6844903959581163528">https://juejin.cn/post/6844903959581163528</a></p><p>é¢è¯•å¿…å¤‡ï¼šAndroidï¼ˆ9.0ï¼‰Activityå¯åŠ¨æµç¨‹(äºŒ) : <a href="https://juejin.cn/post/6844903959589552142">https://juejin.cn/post/6844903959589552142</a></p><p><a href="https://stackoverflow.com/questions/24639272/onnewintent-called-after-finish-executed">android - onNewIntent called after finish() executed - Stack Overflow</a></p>]]></content>
    
    
    <categories>
      
      <category>AndroidBugFix</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>AndroidActivity</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®‰å“åº”ç”¨4å­—èŠ‚ä¸å¯¹é½å¯¼è‡´soåŠ è½½å¤±è´¥</title>
    <link href="/article/18f59983/"/>
    <url>/article/18f59983/</url>
    
    <content type="html"><![CDATA[<p>ä»Šå¤©æŠŠä¸€ä¸ªapkç»™å‚å•†ç­¾ååç›´æ¥pushåˆ°æœºå™¨çš„&#x2F;system&#x2F;app,ç»“æœè¿è¡Œappæ—¶æ˜¾ç¤ºsoæ‰¾ä¸åˆ°ã€‚æŠ¥é”™ï¼š</p><blockquote><p> java stacktrace:<br>java.lang.UnsatisfiedLinkError: Library mmkv not found; tried [&#x2F;system&#x2F;lib&#x2F;libmmkv.so, &#x2F;product&#x2F;lib&#x2F;libmmkv.so]<br>at java.lang.Runtime.loadLibrary0(Runtime.java:1101)<br>at java.lang.System.loadLibrary(System.java:1669)<br>at com.tencent.mmkv.MMKV.doInitialize(MMKV.java:226)<br>at com.tencent.mmkv.MMKV.initialize(MMKV.java:208)<br>at com.tencent.mmkv.MMKV.initialize(MMKV.java:94)<br>at com.wesley.CustomApplication.onCreate(CustomApplication.kt:14)<br>at android.app.Instrumentation.callApplicationOnCreate(Instrumentation.java:1154)<br>at android.app.ActivityThread.handleBindApplication(ActivityThread.java:5871)<br>at android.app.ActivityThread.access$1100(ActivityThread.java:199)<br>at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1650)<br>at android.os.Handler.dispatchMessage(Handler.java:106)<br>at android.os.Looper.loop(Looper.java:193)<br>at android.app.ActivityThread.main(ActivityThread.java:6669)<br>at java.lang.reflect.Method.invoke(Native Method)<br>at com.android.internal.os.RuntimeInit$MethodAndArgsCaller.run(RuntimeInit.java:493)<br>at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:922)  </p></blockquote><p>æ—¥å¿—ï¼ˆxcrash è‡ªå·±æœ‰soå¼‚å¸¸æ•è·ï¼Œæ‰€ä»¥ç›´åˆ°åŠ è½½ mmkv æ‰æŠ›å‡ºå¼‚å¸¸ï¼‰</p><blockquote><p> 12-27 14:58:04.840  9717  9717 E System  : ##loadLibrary0## &#x2F;system&#x2F;app&#x2F;demo&#x2F;demo_V1.0.0(2412261921)-release-signed.apk!&#x2F;lib&#x2F;armeabi-v7a&#x2F;libxcrash.so error: dlopen failed: library â€œ&#x2F;system&#x2F;app&#x2F;demo&#x2F;demo_V1.0.0(2412261921)-release-signed.apk!&#x2F;lib&#x2F;armeabi-v7a&#x2F;libxcrash.soâ€ not found, and try to find so file from the lib path<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper: xcrash: NativeHandler System.loadLibrary failed<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper: java.lang.UnsatisfiedLinkError: Library xcrash not found; tried [&#x2F;system&#x2F;lib&#x2F;libxcrash.so, &#x2F;product&#x2F;lib&#x2F;libxcrash.so]<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at java.lang.Runtime.loadLibrary0(Runtime.java:1101)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at java.lang.System.loadLibrary(System.java:1669)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at xcrash.NativeHandler.initialize(NativeHandler.java:89)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at xcrash.XCrash.init(XCrash.java:189)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at com.wesley.base.apm.XCrashWrapper.<init>(XCrashWrapper.kt:131)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at com.wesley.base.apm.XCrashWrapper.<init>(XCrashWrapper.kt:17)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at com.wesley.CastApplication.attachBaseContext(CastApplication.kt:43)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at android.app.Application.attach(Application.java:212)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at android.app.Instrumentation.newApplication(Instrumentation.java:1121)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at android.app.LoadedApk.makeApplication(LoadedApk.java:1065)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at android.app.ActivityThread.handleBindApplication(ActivityThread.java:5842)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at android.app.ActivityThread.access$1100(ActivityThread.java:199)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1650)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at android.os.Handler.dispatchMessage(Handler.java:106)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at android.os.Looper.loop(Looper.java:193)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at android.app.ActivityThread.main(ActivityThread.java:6669)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at java.lang.reflect.Method.invoke(Native Method)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at com.android.internal.os.RuntimeInit$MethodAndArgsCaller.run(RuntimeInit.java:493)<br>12-27 14:58:04.843  9717  9717 E demo-XCrashWrapper:     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:922)  </p></blockquote><p>å› ä¸ºå®‰å“6å¼€å§‹æ”¯æŒç›´æ¥åŠ è½½apkå†…éƒ¨soï¼Œå¦‚æœç¼–è¯‘åçš„ apk å†…éƒ¨ so æ˜¯ä¸å‹ç¼©çš„ï¼Œé‚£ä¹ˆå°±ä¸éœ€è¦é‡Šæ”¾åˆ°ç›®å½•äº†ã€‚æ‰€ä»¥æ’é™¤æ˜¯å› ä¸ºä¸è§£å‹ so åˆ°&#x2F;system&#x2F;app&#x2F;demo&#x2F;lib&#x2F;arm å¼•èµ·çš„é—®é¢˜ï¼Œè™½ç„¶è¿™æ ·ä¹Ÿå¯ä»¥è§£å†³é—®é¢˜ã€‚</p><blockquote><p>å¦‚æœapkçš„minSdkVersion &gt;&#x3D; 23 å¹¶ä¸” Android Gradle plugin &gt;&#x3D; 3.6.0æƒ…å†µä¸‹ï¼Œæ‰“åŒ…æ—¶android:extractNativeLibs&#x3D;falseï¼Œapkçš„soé»˜è®¤æ˜¯ä¸å‹ç¼©çš„ã€‚</p><p>åœ¨minSdkVersion &lt; 23 æˆ– Android Gradle plugin &lt; 3.6.0æƒ…å†µä¸‹ï¼Œæ‰“åŒ…æ—¶ android:extractNativeLibs&#x3D;trueï¼Œapkçš„soé»˜è®¤æ˜¯å‹ç¼©çš„ã€‚</p></blockquote><p>ç„¶åï¼Œæˆ‘å°è¯•pushæ²¡æœ‰ç»™å‚å•†ç­¾åå‰çš„ç‰ˆæœ¬ apk åˆ°æœºå™¨ä¸Šæ˜¯æ­£å¸¸çš„ï¼Œé‚£ä¹ˆåº”è¯¥æ˜¯å‚å•†ç­¾åå¯¼è‡´ apk å‘ç”Ÿäº†å˜åŒ–ã€‚åˆšå¥½å‰å‡ å¤©ç¢°åˆ°å®‰å“ç­¾åé—®é¢˜<a href="https://iwesley.top/article/133f2b7a/">å®‰å“15é¢„ç½®ç¬¬ä¸‰æ–¹apkæ—¶ç­¾åæŠ¥é”™é—®é¢˜è§£å†³ - Wesleyâ€™s Blog</a>ã€‚ç„¶åæˆ‘å°±ç”¨å‘½ä»¤çœ‹äº†ä¸€ä¸‹ï¼š<code>zipalign -c -v  4 demo_sign.apk</code></p><p><a href="https://developer.android.com/tools/zipalign">zipalign  | Android Studio  | Android Developers</a></p><p>æ˜¾ç¤ºï¼š<code>Verification FAILED</code>ï¼Œé‚£å°±æ˜¯ 4 å­—èŠ‚æ²¡æœ‰å¯¹é½ã€‚</p><p>æŸ¥çœ‹ç­¾åç‰ˆæœ¬<code>apksigner verify -v demo_sign.apk | grep Verified</code></p><p>åªæœ‰v1ç­¾å</p><blockquote><p>~&#x2F;Project$ apksigner verify -v demo_sign.apk | grep Verified</p><p>Verified using v1 scheme (JAR signing): true</p><p>Verified using v2 scheme (APK Signature Scheme v2): false</p><p>Verified using v3 scheme (APK Signature Scheme v3): false</p><p>Verified using v3.1 scheme (APK Signature Scheme v3.1): false</p><p>Verified using v4 scheme (APK Signature Scheme v4): false</p><p>Verified for SourceStamp: false</p></blockquote><p>å› ä¸ºæ˜¯v1ç­¾åï¼Œæ‰§è¡Œ<code>zipalign -v -p 4 demo_sign.apk  demo_sign_align.apk</code>å¯¹é½4 å­—èŠ‚ä¸ä¼šç ´åå‚å•†çš„ç­¾åä¿¡æ¯ï¼Œç„¶åpushè¿›å»æœç„¶å¥½äº†ã€‚</p><p>ç„¶åæˆ‘åˆè¯•ç€å®‰è£…æ²¡æœ‰å¯¹é½å‰çš„ï¼Œç»“æœç›´æ¥æŠ¥é”™äº†ï¼š</p><blockquote><p>PS C:\Users\Wesley&gt; adb  install Y:\Project\demo_sign.apk</p><p>Performing Streamed Install</p><p>adb: failed to install Y:\Project\demo_sign.apk: Failure [INSTALL_FAILED_INVALID_APK: Failed to extract native libraries, res&#x3D;-2]</p></blockquote><p>ä½†æ˜¯ç³»ç»Ÿæ‰«æå®‰è£…å´æ˜¯å¯ä»¥é€šè¿‡çš„ï¼Œæ‰€ä»¥å¾ˆéš¾å‘ç°æ˜¯å­—èŠ‚ä¸å¯¹é½å¼•èµ·çš„ã€‚</p><h2 id="æ·±ç©¶"><a href="#æ·±ç©¶" class="headerlink" title="æ·±ç©¶"></a>æ·±ç©¶</h2><p>ä¹‹å‰ç›´æ¥æœç´¢å®‰å“java.lang.UnsatisfiedLinkErroræ˜¯å¾ˆéš¾æ‰¾åˆ°é’ˆå¯¹è¿™ç§é—®é¢˜çš„è§£å†³æ–¹æ³•çš„ã€‚å› ä¸ºç°åœ¨æœ‰äº†è§£å†³åŠæ³•ï¼Œæ‰€ä»¥æ¢æˆUnsatisfiedLinkError zipalignè¿›è¡Œè°·æ­Œæœç´¢ã€‚ç»“æœå°±å‡ºæ¥äº†ï¼š</p><p><a href="https://stackoverflow.com/questions/72544099/java-lang-unsatisfiedlinkerror-when-installing-as-system-app">android - java.lang.UnsatisfiedLinkError when installing as system app - Stack Overflow</a></p><p><a href="https://ask.seowhy.com/question/175285">zipflingerå¯¼è‡´çš„UnsatisfiedLinkErroråˆ†æ - æœå¤–SEOé—®ç­”</a></p><p><a href="https://blog.51cto.com/u_15075514/3336070">zipflingerå¯¼è‡´çš„UnsatisfiedLinkErroråˆ†æ_mb5ff2f24b42377çš„æŠ€æœ¯åšå®¢_51CTOåšå®¢</a></p><p>ç”¨ AIå¤§æ¨¡å‹æ€»ç»“ä¸€ä¸‹ï¼š</p><blockquote><p>è¿™ç¯‡æ–‡ç« ä¸»è¦åˆ†æäº†åœ¨Androidå¼€å‘ä¸­ï¼Œç”±äºå‡çº§Android Gradle Plugin (AGP) ç‰ˆæœ¬å¯¼è‡´çš„UnsatisfiedLinkErroré—®é¢˜ï¼Œå¹¶æä¾›äº†ç›¸åº”çš„è§£å†³æ–¹æ¡ˆã€‚ä»¥ä¸‹æ˜¯æ–‡ç« çš„ä¸»è¦å†…å®¹æ€»ç»“ï¼š</p><h3 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h3><ul><li><strong>é—®é¢˜ç°è±¡</strong>ï¼šåœ¨Android 9.0ç¯å¢ƒä¸‹ï¼Œå°†AGPä»3.6.1å‡çº§åˆ°4.1.0åï¼Œé¢„è£…åœ¨&#x2F;system&#x2F;priv-appä¸‹çš„APPå‡ºç°äº†UnsatisfiedLinkErrorå´©æºƒã€‚</li><li><strong>é—®é¢˜åŸå› </strong>ï¼šå‡çº§AGPåï¼Œç³»ç»Ÿåœ¨åŠ è½½soæ–‡ä»¶æ—¶å¤±è´¥ï¼Œå…·ä½“è¡¨ç°ä¸ºsoæ–‡ä»¶åœ¨APKä¸­çš„å¯¹é½æ–¹å¼æœ‰é—®é¢˜ã€‚</li></ul><h3 id="é—®é¢˜åˆ†æ"><a href="#é—®é¢˜åˆ†æ" class="headerlink" title="é—®é¢˜åˆ†æ"></a>é—®é¢˜åˆ†æ</h3><ul><li><strong>soæ–‡ä»¶åŠ è½½æµç¨‹</strong>ï¼šç³»ç»Ÿä½¿ç”¨â€œ!&#x2F;â€åˆ†éš”ç¬¦æ¥å®šä½soæ–‡ä»¶è·¯å¾„ï¼Œå¹¶åœ¨APKä¸­æŸ¥æ‰¾å¯¹åº”çš„entryã€‚é—®é¢˜å‡ºåœ¨zipalignå¤„ç†ä¸Šï¼Œå¯¼è‡´soæ–‡ä»¶çš„å¯¹é½ä¸æ­£ç¡®ã€‚</li><li><strong>zipalignçš„ä½œç”¨</strong>ï¼šç¡®ä¿APKä¸­æ‰€æœ‰æœªå‹ç¼©æ•°æ®åœ¨4å­—èŠ‚è¾¹ç•Œä¸Šå¯¹é½ï¼Œä»¥ä¾¿ä½¿ç”¨mmap()ç›´æ¥è®¿é—®ï¼Œå‡å°‘RAMæ¶ˆè€—ã€‚</li><li><strong>ç³»ç»Ÿç¼–è¯‘å¤„ç†</strong>ï¼šAndroidç³»ç»Ÿåœ¨ç¼–è¯‘æ—¶ä¼šå¯¹privileged appæ‰§è¡Œuncompress-dexsæ“ä½œï¼Œå°†å‹ç¼©å­˜å‚¨çš„dexæ–‡ä»¶å˜ä¸ºä¸å‹ç¼©å­˜å‚¨ã€‚ä¹‹åè¿˜ä¼šè¿›è¡Œalign-packageæ“ä½œã€‚</li></ul><h3 id="é—®é¢˜åŸå› "><a href="#é—®é¢˜åŸå› " class="headerlink" title="é—®é¢˜åŸå› "></a>é—®é¢˜åŸå› </h3><ul><li><strong>zipflingerå·¥å…·</strong>ï¼šä»AGP 4.1å¼€å§‹ï¼Œé»˜è®¤åœ¨æ„å»ºreleaseç‰ˆæœ¬æ—¶å¯ç”¨zipflingerå·¥å…·è¿›è¡Œæ‰“åŒ…ã€‚zipflingeræ”¹å˜äº†APKçš„æ‰“åŒ…æ–¹å¼ï¼Œå¯¼è‡´uncompress-dexsæ“ä½œåzipalignå‡ºç°é—®é¢˜ã€‚</li></ul><h3 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><ul><li><strong>ç¦ç”¨zipflinger</strong>ï¼šåœ¨appå·¥ç¨‹çš„gradle.propertiesä¸­åŠ å…¥é…ç½®ä»¥ç¦ç”¨zipflingerã€‚</li><li><strong>ä¸è§£å‹ dex</strong>ï¼šDONT_UNCOMPRESS_PRIV_APPS_DEXS :&#x3D; trueï¼Œå¯èƒ½ä¼šé™ä½ dex åŠ è½½é€Ÿåº¦ã€‚</li><li><strong>ä½¿ç”¨zip2zipå·¥å…·</strong>ï¼šåœ¨æœ€æ–°çš„AOSPæºç ä¸­ï¼Œä½¿ç”¨zip2zipå·¥å…·æ¥å¤„ç†dexæ–‡ä»¶çš„è§£å‹ç¼©ï¼Œä»¥é€‚é…zipflingeræ‰“åŒ…çš„APKã€‚</li><li><strong>å…¶ä»–æ–¹æ³•</strong>ï¼šåŒ…æ‹¬å›é€€AGPç‰ˆæœ¬ã€ä¿®æ”¹ç³»ç»Ÿç¼–è¯‘è„šæœ¬ç­‰ï¼Œä½†è¿™äº›æ–¹æ³•å„æœ‰ä¼˜ç¼ºç‚¹ã€‚</li></ul></blockquote><p>è™½ç„¶å¼•èµ·é—®é¢˜çš„åŸå› ä¸ä¸€æ ·ï¼Œä½†éƒ½æ˜¯å› ä¸ºå­—èŠ‚ä¸å¯¹é½å¼•èµ·çš„ so æ‰¾ä¸åˆ°ã€‚</p><p>ä¸‹é¢æ¥åˆ†æä¸€ä¸‹å…·ä½“åŸå› ï¼š</p><p>soåŠ è½½è°ƒç”¨æ ˆ</p><blockquote><p>ojluni&#x2F;src&#x2F;main&#x2F;java&#x2F;java&#x2F;lang&#x2F;System.java  â€“&gt; System.loadLibrary</p><p>ojluni&#x2F;src&#x2F;main&#x2F;java&#x2F;java&#x2F;lang&#x2F;Runtime.java  â€“&gt; Runtime.loadLibrary0 -&gt; nativeLoad</p><p>ojluni&#x2F;src&#x2F;main&#x2F;native&#x2F;Runtime.c  â€“&gt; Runtime_nativeLoad</p><p>art&#x2F;openjdkjvm&#x2F;OpenjdkJvm.cc  â€“&gt; JVM_NativeLoad</p><p>art&#x2F;runtime&#x2F;java_vm_ext.cc â€“&gt; JavaVMExt::LoadNativeLibrary</p><p>system&#x2F;core&#x2F;libnativeloader&#x2F;native_loader.cpp â€“&gt; OpenNativeLibrary</p><p>bionic&#x2F;libdl&#x2F;libdl.cpp â€“&gt; android_dlopen_ext</p><p>bionic&#x2F;linker&#x2F;dlfcn.cpp â€“&gt; __loader_android_dlopen_ext</p><p>bionic&#x2F;linker&#x2F;dlfcn.cpp â€“&gt; dlopen_ext</p><p>bionic&#x2F;linker&#x2F;linker.cpp â€“&gt; do_dlopen</p><p>bionic&#x2F;linker&#x2F;linker.cpp â€“&gt; find_library</p><p>bionic&#x2F;linker&#x2F;linker.cpp â€“&gt; find_libraries</p><p>bionic&#x2F;linker&#x2F;linker.cpp â€“&gt; find_library_internal</p><p>bionic&#x2F;linker&#x2F;linker.cpp â€“&gt; load_library</p><p>bionic&#x2F;linker&#x2F;linker.cpp â€“&gt; open_library</p><p>bionic&#x2F;linker&#x2F;linker.cpp â€“&gt; open_library_in_zipfile</p></blockquote><p>é‡ç‚¹çœ‹ <code>bionic/linker/linker.cpp --&gt; open_library_in_zipfile</code> è¿™ä¸ªå‡½æ•°ï¼Œå¯¼è‡´åŠ è½½å¤±è´¥çš„æ˜¯ä»¥ä¸‹æ¡ä»¶ <code>entry.offset % PAGE_SIZE != 0</code></p><p><a href="http://xrefandroid.com/android-9.0.0_r61/xref/bionic/linker/linker.cpp#992">http://xrefandroid.com/android-9.0.0_r61/xref/bionic/linker/linker.cpp#992</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">if</span> (entry.method != kCompressStored || (entry.offset % PAGE_SIZE) != <span class="hljs-number">0</span>) &#123;<br>    <span class="hljs-built_in">close</span>(fd);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ€»ç»“æ¥è¯´ï¼Œå°±æ˜¯ç­¾åçš„æ—¶å€™ç ´åäº†4å­—èŠ‚å¯¹é½ï¼Œå¯¼è‡´ so åŠ è½½å¤±è´¥ã€‚æ‰€ä»¥ï¼Œä»¥åç¢°åˆ°æ­¤ç±»é—®é¢˜æ—¶ï¼Œå¯ä»¥æ‰§è¡Œ<code>zipalign -c -v  4 xxx.apk</code>å…ˆçœ‹ä¸€ä¸‹æ˜¯å¦4å­—èŠ‚å¯¹é½ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Android Build System</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>aospç¼–è¯‘</tag>
      
      <tag>Android.mk</tag>
      
      <tag>Android.bp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®‰å“å¤šæ¸ é“apké…ç½®ä¸åŒç­¾å</title>
    <link href="/article/611fb416/"/>
    <url>/article/611fb416/</url>
    
    <content type="html"><![CDATA[<p>ä¸€èˆ¬ç­¾åéƒ½æ˜¯æ”¾åœ¨buildTypesé‡Œé¢ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs groovy">...<br>android &#123;<br>    ...<br>    defaultConfig &#123;...&#125;<br>    signingConfigs &#123;<br>        release &#123;<br>            storeFile file(<span class="hljs-string">&quot;myreleasekey.keystore&quot;</span>)<br>            storePassword <span class="hljs-string">&quot;password&quot;</span><br>            keyAlias <span class="hljs-string">&quot;MyReleaseKey&quot;</span><br>            keyPassword <span class="hljs-string">&quot;password&quot;</span><br>        &#125;<br>    &#125;<br>    buildTypes &#123;<br>        release &#123;<br>            ...<br>            signingConfig signingConfigs.release<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯å¤šæ¸ é“æ—¶ï¼Œä½¿ç”¨é…ç½®çš„ä¼˜å…ˆçº§ä»é«˜åˆ°ä½åˆ†åˆ«æ˜¯buildTypesã€productFlavorã€defaultConfigï¼Œå¦‚æœæŒ‰ä¸Šé¢é…ç½®çš„è¯ï¼Œæ ¹æœ¬ä¿®æ”¹ä¸äº†ç­¾åã€‚æ‰€ä»¥ä¿®æ”¹æˆä»¥ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs groovy">android &#123;<br>    ...<br>    signingConfigs &#123;<br>        release &#123;<br>            storeFile file(<span class="hljs-string">&quot;myreleasekey.keystore&quot;</span>)<br>            storePassword <span class="hljs-string">&quot;password&quot;</span><br>            keyAlias <span class="hljs-string">&quot;MyReleaseKey&quot;</span><br>            keyPassword <span class="hljs-string">&quot;password&quot;</span><br>        &#125;<br>        demo &#123;<br>            storeFile file(<span class="hljs-string">&quot;myreleasekey.keystore&quot;</span>)<br>            storePassword <span class="hljs-string">&quot;password&quot;</span><br>            keyAlias <span class="hljs-string">&quot;MyReleaseKey&quot;</span><br>            keyPassword <span class="hljs-string">&quot;password&quot;</span><br>        &#125;<br>    &#125;<br>    defaultConfig &#123;<br>        signingConfig signingConfigs.release <span class="hljs-comment">//é»˜è®¤ç­¾å</span><br>    &#125;<br>    buildTypes &#123;<br>        debug&#123;<br>            signingConfig <span class="hljs-literal">null</span> <span class="hljs-comment">//è¿™é‡Œä¸€å®šè¦ç½®nullï¼Œå¦åˆ™graldeä¼šæ’å…¥é»˜è®¤ç­¾å</span><br>        &#125;<br>        release&#123;...&#125;<br>    &#125;<br>    <span class="hljs-comment">// Specifies one flavor dimension.</span><br>    flavorDimensions <span class="hljs-string">&quot;version&quot;</span><br>    productFlavors &#123;<br>        demo &#123;<br>            dimension <span class="hljs-string">&quot;version&quot;</span><br>            applicationIdSuffix <span class="hljs-string">&quot;.demo&quot;</span><br>            versionNameSuffix <span class="hljs-string">&quot;-demo&quot;</span><br>            signingConfig signingConfigs.demo <span class="hljs-comment">//æ¸ é“ç­¾å</span><br>        &#125;<br>        full &#123;<br>            dimension <span class="hljs-string">&quot;version&quot;</span><br>            applicationIdSuffix <span class="hljs-string">&quot;.full&quot;</span><br>            versionNameSuffix <span class="hljs-string">&quot;-full&quot;</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æŒ‰ä¸Šé¢é…ç½®å®Œåï¼Œæ¸ é“å¯ä»¥æŒ‰ç…§è‡ªå·±éœ€æ±‚æ›¿æ¢ç­¾åäº†ã€‚ç‰¹åˆ«æ³¨æ„debugç±»å‹é‚£é‡Œè¦ç½®<code>signingConfig null</code>ï¼Œå¦åˆ™ç¼–è¯‘debugç‰ˆæœ¬æ—¶ç­¾åä¼šä¸ç”Ÿæ•ˆï¼Œå› ä¸ºgradleä¼šæ’å…¥é»˜è®¤ç­¾åï¼Œæ›¿æ¢æ‰æ¸ é“çš„ç­¾åã€‚</p>]]></content>
    
    
    <categories>
      
      <category>AppBuild</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Androidå¤šæ¸ é“</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®‰å“15é¢„ç½®ç¬¬ä¸‰æ–¹apkæ—¶ç­¾åæŠ¥é”™é—®é¢˜è§£å†³</title>
    <link href="/article/133f2b7a/"/>
    <url>/article/133f2b7a/</url>
    
    <content type="html"><![CDATA[<p>æœ‰åŒäº‹åé¦ˆé›†æˆapkæ—¶å®‰è£…å¤±è´¥</p><blockquote><p>PackageManager: Failed to scan &#x2F;product&#x2F;app&#x2F;test: No APK Signature Scheme v2 signature in package &#x2F;product&#x2F;app&#x2F;test&#x2F;test.apk</p></blockquote><p>æŸ¥çœ‹ç¼–è¯‘åçš„apkç­¾åä¿¡æ¯</p><blockquote><p>DOES NOT VERIFY</p><p>ERROR: JAR signer CERT.RSA: JAR signature META-INF&#x2F;CERT.SF indicates the APK is signed using APK Signature Scheme v2 but no such signature was found. Signature stripped?</p></blockquote><p>ä½†æ˜¯ç”¨å‘½ä»¤æŸ¥çœ‹æˆ‘çš„apkæ˜¯æ­£å¸¸çš„<code>apksigner  verify -v  test.apk  | grep Verified</code></p><blockquote><p>Verified using v1 scheme (JAR signing): true</p><p>Verified using v2 scheme (APK Signature Scheme v2): true</p><p>Verified using v3 scheme (APK Signature Scheme v3): false</p><p>Verified using v3.1 scheme (APK Signature Scheme v3.1): false</p><p>Verified using v4 scheme (APK Signature Scheme v4): false</p><p>Verified for SourceStamp: false</p></blockquote><p>é‚£ä¹ˆåº”è¯¥æ˜¯ç¼–è¯‘è¿‡ç¨‹åšäº†æŸäº›å˜åŠ¨ã€‚</p><h1 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•"></a>è§£å†³åŠæ³•</h1><h2 id="é€šè¿‡é¢„ç¼–è¯‘çš„æ–¹æ³•"><a href="#é€šè¿‡é¢„ç¼–è¯‘çš„æ–¹æ³•" class="headerlink" title="é€šè¿‡é¢„ç¼–è¯‘çš„æ–¹æ³•"></a>é€šè¿‡é¢„ç¼–è¯‘çš„æ–¹æ³•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java">android_app_import &#123;<br>    name: <span class="hljs-string">&quot;test&quot;</span>,<br>    apk: <span class="hljs-string">&quot;test.apk&quot;</span>,<br>    <span class="hljs-comment">// ä¿ç•™apkè‡ªå·±çš„ç­¾å</span><br>    presigned: <span class="hljs-literal">true</span>,<br>    preprocessed: <span class="hljs-literal">true</span>,<br>    <span class="hljs-comment">// æ‰“å¼€å°†æ”¾åˆ°å¯¹åº”åˆ†åŒºç›®å½•çš„priv-appæ–‡ä»¶å¤¹ä¸‹</span><br>    <span class="hljs-comment">// privileged: true,</span><br>    <span class="hljs-comment">// æ‰“å¼€å°†æ”¾åˆ°system_extåˆ†åŒº</span><br>    <span class="hljs-comment">// system_ext_specific: true,</span><br>    <span class="hljs-comment">// æ‰“å¼€å°†æ”¾åˆ°productåˆ†åŒº</span><br>    <span class="hljs-comment">// product_specific: true,</span><br>    <span class="hljs-comment">// æ‰“å¼€å°†æ”¾åˆ°vendoråˆ†åŒº</span><br>    <span class="hljs-comment">// proprietary: true,</span><br>    <span class="hljs-comment">// odmåˆ†åŒº</span><br>    <span class="hljs-comment">// device_specific: true</span><br>    <span class="hljs-comment">// apkä¼˜åŒ–ï¼Œå†…ç½®ä¸‰æ–¹apkæ—¶å»ºè®®å…³é—­</span><br>    dex_preopt: &#123;<br>        enabled: <span class="hljs-literal">false</span>,<br>    &#125;,<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨å®‰å“15ä¸Šæ–°å¢äº†<a href="http://xrefandroid.com/android-15.0.0_r1/xref/build/soong/java/app_import.go#376">app_import.go - OpenGrok cross reference for &#x2F;build&#x2F;soong&#x2F;java&#x2F;app_import.go</a></p><p>validatePresignedApkæ£€æµ‹</p><p>å¦‚æœåŠ äº†presignedï¼Œä½†ä¸åŠ preprocessedï¼ŒåŒæ—¶targetSdkå¤§äºç­‰äº30å°±ä¼šç¼–è¯‘æŠ¥é”™ï¼Œæ›´åŠ æ–¹ä¾¿å¼€å‘è€…å®šä½é—®é¢˜ï¼š</p><blockquote><p>[100% 5&#x2F;5 0s remaining] Check presigned apkFAILED: out&#x2F;soong&#x2F;.intermediates&#x2F;packages&#x2F;test&#x2F;test&#x2F;android_common&#x2F;validated-prebuilt&#x2F;check.stampbuild&#x2F;soong&#x2F;scripts&#x2F;check_prebuilt_presigned_apk.py â€“aapt2 out&#x2F;host&#x2F;linux-x86&#x2F;bin&#x2F;aapt2 â€“zipalign out&#x2F;host&#x2F;linux-x86&#x2F;bin&#x2F;zipalign packages&#x2F;test&#x2F;test.apk out&#x2F;soong&#x2F;.intermediates&#x2F;packages&#x2F;test&#x2F;test&#x2F;android_common&#x2F;validated-prebuilt&#x2F;check.stamppackages&#x2F;test&#x2F;test.apk: Prebuilt, presigned apks with targetSdkVersion &gt;&#x3D; 30 (or a codename targetSdkVersion) must set <strong>preprocessed: true</strong> in the Android.bp definition (because they must be signed with signature v2, and the build system would wreck that signature otherwise)</p></blockquote><p>å¦å¤–apké‡Œé¢çš„soä¸èƒ½å‹ç¼©ï¼Œå¦åˆ™ä¼šæŠ¥é”™</p><blockquote><p>FAILED: out&#x2F;soong&#x2F;.intermediates&#x2F;packages&#x2F;test&#x2F;test&#x2F;android_common&#x2F;validated-prebuilt&#x2F;check.stamp</p><p>build&#x2F;soong&#x2F;scripts&#x2F;check_prebuilt_presigned_apk.py â€“aapt2 out&#x2F;host&#x2F;linux-x86&#x2F;bin&#x2F;aapt2 â€“zipalign out&#x2F;host&#x2F;linux-x86&#x2F;bin&#x2F;zipalign â€“preprocessed packages&#x2F;test&#x2F;test.apk out&#x2F;soong&#x2F;.intermediates&#x2F;packages&#x2F;test&#x2F;test&#x2F;android_common&#x2F;validated-prebuilt&#x2F;check.stamp</p><p>packages&#x2F;test&#x2F;test.apk: <strong>Contains compressed JNI libraries</strong></p></blockquote><p>å› ä¸ºå®‰å“6å¼€å§‹æ”¯æŒç›´æ¥åŠ è½½apké‡Œé¢çš„soï¼Œå¦‚æœå‹ç¼©çš„è¯ï¼Œé¢„ç¼–è¯‘ä¼šåœ¨apkå†…éƒ¨è¿›è¡Œè§£å‹ï¼Œé‚£ä¹ˆå°±ä¼šç ´åapkç­¾åã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2023/202412242117760.png" alt="img"></p><p>å…¶å®ï¼Œå¦‚æœapkçš„minSdkVersion &gt;&#x3D; 23 å¹¶ä¸” Android Gradle plugin &gt;&#x3D; 3.6.0æƒ…å†µä¸‹ï¼Œæ‰“åŒ…æ—¶android:extractNativeLibs&#x3D;falseï¼Œapkçš„soé»˜è®¤æ˜¯ä¸å‹ç¼©çš„ã€‚</p><p>åœ¨minSdkVersion &lt; 23 æˆ– Android Gradle plugin &lt; 3.6.0æƒ…å†µä¸‹ï¼Œæ‰“åŒ…æ—¶ android:extractNativeLibs&#x3D;trueï¼Œapkçš„soé»˜è®¤æ˜¯å‹ç¼©çš„ã€‚</p><p>å‚è€ƒï¼š<a href="https://juejin.cn/post/6943920550125420558">https://juejin.cn/post/6943920550125420558</a></p><p><a href="https://blog.csdn.net/yzyeilin/article/details/139968840">Android13è§£å†³android_app_importå†…ç½®ç¬¬ä¸‰æ–¹APKå®‰è£…å¤±è´¥é—®é¢˜_but no such signature was found. signature strippe-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/chuyouyinghe/article/details/131001532">æµ…è°ˆextractNativeLibs</a></p><h2 id="é€šè¿‡ç›´æ¥æ‹·è´çš„æ–¹æ³•"><a href="#é€šè¿‡ç›´æ¥æ‹·è´çš„æ–¹æ³•" class="headerlink" title="é€šè¿‡ç›´æ¥æ‹·è´çš„æ–¹æ³•"></a>é€šè¿‡ç›´æ¥æ‹·è´çš„æ–¹æ³•</h2><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/wangwei6227/article/details/123727372">https://blog.csdn.net/wangwei6227/article/details/123727372</a></p><p>åŒæ ·è¦æ³¨æ„apk soçš„å‹ç¼©é—®é¢˜ï¼Œå¦‚æœæ˜¯å‹ç¼©è¿‡çš„ï¼Œå¿…é¡»æå–å‡ºæ¥ï¼Œå¹¶æ‹·è´åˆ°apkæœºå™¨ç›®å½•ã€‚</p><h2 id="å¯èƒ½é‡åˆ°çš„selinuxæƒé™é—®é¢˜"><a href="#å¯èƒ½é‡åˆ°çš„selinuxæƒé™é—®é¢˜" class="headerlink" title="å¯èƒ½é‡åˆ°çš„selinuxæƒé™é—®é¢˜"></a>å¯èƒ½é‡åˆ°çš„selinuxæƒé™é—®é¢˜</h2><blockquote><p>01-01 12:00:39.520000  5326  5326 W om.skype.raider: type&#x3D;1400 audit(0.0:64): avc: denied { read } for name&#x3D;â€libSkypeAndroid.soâ€ dev&#x3D;â€mmcblk0p22â€ ino&#x3D;770074 scontext&#x3D;u:r:untrusted_app:s0:c512,c768 tcontext&#x3D;u:object_r:system_data_file:s0 tclass&#x3D;file permissive&#x3D;0</p></blockquote><p>#&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; untrusted_app.te &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</p><p>allow untrusted_app system_data_file:file r_file_perms;</p><p>å‚è€ƒï¼š<a href="https://www.codeleading.com/article/6471686269/">é‡‡ç”¨Signature Scheme v2ç­¾åæ–¹å¼çš„APKé¢„ç½®å¤±è´¥ </a></p>]]></content>
    
    
    <categories>
      
      <category>Android Build System</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>aospç¼–è¯‘</tag>
      
      <tag>Android.mk</tag>
      
      <tag>Android.bp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å’ªå’•è§†é¢‘DLNAæŠ•å±è·³é›†é—®é¢˜åˆ†æ</title>
    <link href="/article/73728aea/"/>
    <url>/article/73728aea/</url>
    
    <content type="html"><![CDATA[<p>QAåœ¨æµ‹è¯•å…¬å¸æŠ•å±åº”ç”¨æ—¶ï¼Œå‘ç°å’ªå’•è§†é¢‘DLNAæŠ•å‰§é›†æ—¶æœ‰æ—¶å€™ä¼šè·³è¿‡ä¸€é›†ç›´æ¥æ’­ä¸‹ä¸€é›†çš„é—®é¢˜ã€‚</p><p>å°è¯•è‡ªè¡Œåˆ†æè§£å†³ä¸äº†åï¼Œæˆ‘å†³å®šåˆ†æä¸€ä¸‹ç«å“åº”ç”¨ï¼šå½“è´æŠ•å±ï¼Œç»“æœå‘ç°å®ƒæ˜¯æ­£å¸¸çš„ã€‚ç”±äºå½“è´æŠ•å±æ˜¯ä¸ªé»‘ç›’å­ï¼Œæ‰€ä»¥å†³å®šæŠ“åŒ…çœ‹ä¸€ä¸‹ã€‚</p><p><a href="https://www.androidtcpdump.com/android-tcpdump/downloads">Android tcpdump</a></p><p><code>tcpdump tcp -i any -p -s 0 -w /sdcard/capture.pcap</code></p><h2 id="å½“è´æŠ•å±æŠ“åŒ…åˆ†æ"><a href="#å½“è´æŠ•å±æŠ“åŒ…åˆ†æ" class="headerlink" title="å½“è´æŠ•å±æŠ“åŒ…åˆ†æ"></a>å½“è´æŠ•å±æŠ“åŒ…åˆ†æ</h2><p>è¿è¡Œå‘½ä»¤åå¼€å§‹æŠ•å‰§é›†åˆ°å½“è´æŠ•å±å¹¶é€šè¿‡è¿›åº¦æ¡æ“ä½œè§¦å‘åˆ‡é›†ï¼ŒæŠŠæŠ“åŒ…æ–‡ä»¶adb pullå‡ºæ¥æ”¾åˆ°WireSharkå»åˆ†æã€‚</p><p>ç”±äºDLNAå»ºè¿åçš„å‘½ä»¤äº¤äº’æ˜¯é€šè¿‡httpçš„ï¼Œæ‰€ä»¥è¿™é‡Œåªæ˜¾ç¤ºhttpåè®®ï¼Œå¹¶é€šè¿‡æœç´¢SetAVTransportURIå®šä½åˆ°æŠ•å±æ—¶é—´ç‚¹ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2023/202412082026499-wireshark.jpg" alt="img_v3_02h8_65bf3dab-7966-48b1-bdaa-8343bca7898g"></p><p>é¦–å…ˆçœ‹ä¸€ä¸‹å³å°†åˆ‡é›†å‰æ‰‹æœºç«¯è·å–åˆ°çš„ä¿¡æ¯ï¼š</p><p>å¯ä»¥çœ‹åˆ°å½±ç‰‡çš„æ—¶é•¿å’Œè¿›åº¦éƒ½æœ‰å€¼ï¼Œå¿«æ’­å®Œäº†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2023/202412082039758-wireshark.jpg" alt="img_v3_02h8_fe3604f0-5242-41b8-b950-fab2c62663dg"></p><p>åˆ‡é›†æ—¶ï¼š</p><p>æ‰‹æœºç«¯è·å–åˆ°çš„æ’­æ”¾çŠ¶æ€æ˜¯stoppedï¼Œå½±ç‰‡æ—¶é•¿å’Œè¿›åº¦éƒ½æ˜¯0</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2023/202412082042875.jpg" alt="img_v3_02h8_954cb5c2-08c9-47ec-8d47-0c14b51b600g"></p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2023/202412082041740.jpg" alt="img_v3_02h8_613904b8-aa1e-4128-b904-164ff238ed3g"></p><p>åˆ‡é›†åï¼š</p><p>æ‰‹æœºç«¯è·å–çš„ä¿¡æ¯æ­£å¸¸</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2023/202412082044535.jpg" alt="img_v3_02h8_f8a5dc01-ae9d-47d8-9abc-0a395a68bd8g"></p><h2 id="æˆ‘å¸æŠ•å±æŠ“åŒ…åˆ†æ"><a href="#æˆ‘å¸æŠ•å±æŠ“åŒ…åˆ†æ" class="headerlink" title="æˆ‘å¸æŠ•å±æŠ“åŒ…åˆ†æ"></a>æˆ‘å¸æŠ•å±æŠ“åŒ…åˆ†æ</h2><p>åˆ‡é›†å‰ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2023/202412082045162.jpg" alt="img_v3_02h8_ef543816-16f1-4e55-a74b-e703ef21e46g"></p><p>åˆ‡é›†åï¼š</p><p>è·å–åˆ°çš„å½±ç‰‡è¿›åº¦å’Œæ—¶é•¿éƒ½æ˜¯ä¸Šä¸ªè§†é¢‘çš„ä¿¡æ¯ï¼Œå¯¼è‡´å’ªå’•äº§ç”Ÿäº†è¯¯åˆ¤æ–­ï¼Œè®¤ä¸ºè¿™ä¸€é›†ä¹Ÿæ’­å®Œäº†ï¼Œé€ æˆè·³é›†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2023/202412082045275.jpg" alt="img_v3_02h8_dac2eede-52f2-4137-8b42-18b7081eaaeg"></p><h2 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h2><p>æ”¶åˆ°æ‰‹æœºç«¯çš„stopæŒ‡ä»¤åï¼Œç«‹å³å°†æ’­æ”¾çŠ¶æ€ç½®stoppedï¼ŒåŒæ—¶å°†å½±ç‰‡æ—¶é•¿å’Œè¿›åº¦ä¹Ÿç½®0ã€‚æ­¤å¤–ï¼Œè¿˜è¦æ‹¦æˆªæ’­æ”¾å™¨åˆ°æ‰‹æœºç«¯çš„çŠ¶æ€åŒæ­¥ç›´åˆ°æ–°çš„è§†é¢‘èµ·æ’­ã€‚</p><p>å¦å¤–è¿˜è¦æ³¨æ„å¤„ç†çº¿ç¨‹è°ƒåº¦å»¶è¿Ÿçš„é—®é¢˜ï¼Œå¦‚æœstopæŒ‡ä»¤å’ŒsetUriæŒ‡ä»¤å‘é€æ—¶é—´æ¯”è¾ƒæ¥è¿‘ï¼Œè™½ç„¶çœ‹èµ·æ¥æ˜¯stopåœ¨å‰ï¼ŒsetUriåœ¨åï¼Œä½†å¦‚æœæ˜¯åœ¨ä¸åŒçº¿ç¨‹å›è°ƒä¸Šæ¥çš„ï¼Œå¯èƒ½å­˜åœ¨setUriå…ˆæ‰§è¡Œçš„æƒ…å†µï¼Œè¦æ³¨æ„å¤„ç†è¿™ç§æƒ…å†µï¼Œé¿å…è¯¯é€€å‡ºã€‚</p>]]></content>
    
    
    <categories>
      
      <category>æŠ•å±</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æŠ•å±</tag>
      
      <tag>DLNA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Android.mkåŸºç¡€çŸ¥è¯†</title>
    <link href="/article/eaba12cd/"/>
    <url>/article/eaba12cd/</url>
    
    <content type="html"><![CDATA[<p>Android æµ…åº¦è§£æï¼šmké¢„ç½®AARã€SOæ–‡ä»¶ã€APPåŒ…å’Œç­¾å-é˜¿é‡Œäº‘å¼€å‘è€…ç¤¾åŒº: <a href="https://developer.aliyun.com/article/1488469">https://developer.aliyun.com/article/1488469</a></p><p>androidç³»ç»Ÿæ·»åŠ é¢„ç½®APPï¼ˆsoåº“è‡ªåŠ¨é‡Šæ”¾) - åºšæ‹“å¤©ä¸‹ - åšå®¢å›­: <a href="https://www.cnblogs.com/genggeng/p/10563585.html">https://www.cnblogs.com/genggeng/p/10563585.html</a></p><p>ä½¿ç”¨@ç¬¦å·å’Œä¸ä½¿ç”¨@ç¬¦å·çš„åŒºåˆ«<br>åœ¨Android.mkä¸­ï¼Œä½¿ç”¨@ç¬¦å·å’Œä¸ä½¿ç”¨@ç¬¦å·æœ‰ä¸€äº›åŒºåˆ«ï¼š<br>? ä½¿ç”¨@ç¬¦å·å¯ä»¥æé«˜æ€§èƒ½ï¼Œå› ä¸ºä¸éœ€è¦è§£å‹å’Œæ‹·è´SOæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥èŠ‚çœç©ºé—´ï¼Œå› ä¸ºä¸éœ€è¦å­˜å‚¨å¤šä½™çš„SOæ–‡ä»¶ã€‚<br>? ä¸ä½¿ç”¨@ç¬¦å·å¯ä»¥æé«˜å…¼å®¹æ€§ï¼Œå› ä¸ºå¯ä»¥é’ˆå¯¹ä¸åŒçš„å¹³å°æä¾›ç›¸åº”çš„SOæ–‡ä»¶ï¼Œè€Œä¸éœ€è¦è€ƒè™‘APKä¸­æ˜¯å¦æœ‰å¯¹åº”å¹³å°çš„SOæ–‡ä»¶ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Android Build System</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å®‰å“Makefile</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Android APP drawableä¸åŒæ–‡ä»¶å¤¹çš„ç”¨æ³•</title>
    <link href="/article/b1dcee32/"/>
    <url>/article/b1dcee32/</url>
    
    <content type="html"><![CDATA[<p>Screen compatibility: <a href="https://developer.android.com/guide/practices/screens_support.html">https://developer.android.com/guide/practices/screens_support.html</a></p><p>App resources: <a href="https://developer.android.com/guide/topics/resources/providing-resources.html#AlternativeResources">https://developer.android.com/guide/topics/resources/providing-resources.html#AlternativeResources</a></p><p>Support different pixel densities: <a href="https://developer.android.com/training/multiscreen/screendensities">https://developer.android.com/training/multiscreen/screendensities</a></p><p>Drawable resources : <a href="https://developer.android.com/guide/topics/resources/drawable-resource">https://developer.android.com/guide/topics/resources/drawable-resource</a></p><p>res&#x2F;drawable&#x2F; is a legacy synonym for res&#x2F;drawable-mdpi&#x2F;, indicating that the drawables in that directory are set for mdpi density. If the device is running another density, those images will be downsampled (to ldpi) or upsampled (to anything else) to match the device density.</p><p>res&#x2F;drawable-nodpi&#x2F; says â€œthese drawables should not be resampled for any density, but instead should be used as-is on all densitiesâ€.</p><p>drawable-nodpi will bypass scaling and drawable will use the default scaling:</p><p>mdpi &#x3D; 1x<br>hdpi &#x3D; 1.5x<br>xhdpi &#x3D; 2x<br>xxhdpi &#x3D; 3x<br>xxxhdpi &#x3D; 4x<br>drawable-nodpi is efficient if your code will be doing its own scaling (or no scaling) and you donâ€™t want the image pre-scaled by Android.</p><p>There is also drawable-anydpi, just to make things more confusing.</p><p>drawable with no specifications will be used if an exact match on density and screen specifications does not exist. drawable-nodpi will be used after drawable.</p><p>UPDATE If you have both drawable and drawble-nodpi, the select order is either a more complex rule not documented or Android is broken. Through experimentation I confirmed that devices with screen density &lt; xhdpi will correctly select the drawable image. Devices with screen density &gt;&#x3D; xhdpi will select the drawable-nodpi.</p><p>Selection rule: 1. Pick match to screen density, one of these:</p><p>drawable-ldpi<br>drawable-mdpi<br>drawable-hdpi<br>drawable-xhdpi<br>drawable-xxhdpi<br>drawable-xxxhdpi<br>If no match on density, then select one of these<br>drawable (automatic scaling mdpi&#x3D;noneâ€¦ xxxhdpi&#x3D;4x)<br>drawable-nodpi (no scaling)<br>drawable-tvdpi<br>drawable-anydpi (no scaling)</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>android - Will a density qualified drawable folder or drawable-nodpi take precedence? - Stack Overflow: <a href="https://stackoverflow.com/questions/24682094/will-a-density-qualified-drawable-folder-or-drawable-nodpi-take-precedence">https://stackoverflow.com/questions/24682094/will-a-density-qualified-drawable-folder-or-drawable-nodpi-take-precedence</a></p><p>android - What is the difference between putting images in drawable and drawable-nodpi folder? - Stack Overflow: <a href="https://stackoverflow.com/questions/33631995/what-is-the-difference-between-putting-images-in-drawable-and-drawable-nodpi-fol">https://stackoverflow.com/questions/33631995/what-is-the-difference-between-putting-images-in-drawable-and-drawable-nodpi-fol</a></p><p>ç©è½¬Android drawableå›¾ç‰‡é€‚é… - æ¼«æ€ - åšå®¢å›­: <a href="https://www.cnblogs.com/sexintercourse/p/17020569.html">https://www.cnblogs.com/sexintercourse/p/17020569.html</a></p><p>Android é€‚é…ï¼ˆdrawableæ–‡ä»¶å¤¹ï¼‰å›¾ç‰‡é€‚é…ï¼ˆäºŒï¼‰ - å¼ äºšæ¥  - åšå®¢å›­: <a href="https://www.cnblogs.com/huihuizhang/p/9473698.html">https://www.cnblogs.com/huihuizhang/p/9473698.html</a></p><p>androidï¼ˆdrawableæ–‡ä»¶å¤¹ï¼‰å›¾ç‰‡é€‚é…_drawableæ˜¯ä»€ä¹ˆæ–‡ä»¶-CSDNåšå®¢: <a href="https://blog.csdn.net/xuaho0907/article/details/72848520#:~:text=%E5%A6%82%E6%9E%9C%E5%9B%BE%E7%89%87%E6%89%80%E5%9C%A8%E7%9B%AE%E5%BD%95%E4%B8%BA,%E5%9B%BE%E7%89%87%E5%A4%A7%E5%B0%8F%EF%BC%8C%E4%B8%8D%E8%BF%9B%E8%A1%8C%E7%BC%A9%E6%94%BE%E3%80%82&text=drawable%2Dnodpi%E6%96%87%E4%BB%B6%E5%A4%B9%EF%BC%8C%E8%BF%99%E4%B8%AA,%E5%B0%B1%E4%BC%9A%E5%AE%9E%E9%99%85%E5%B1%95%E7%A4%BA%E5%A4%9A%E5%A4%A7%E3%80%82">https://blog.csdn.net/xuaho0907/article/details/72848520#:~:text=%E5%A6%82%E6%9E%9C%E5%9B%BE%E7%89%87%E6%89%80%E5%9C%A8%E7%9B%AE%E5%BD%95%E4%B8%BA,%E5%9B%BE%E7%89%87%E5%A4%A7%E5%B0%8F%EF%BC%8C%E4%B8%8D%E8%BF%9B%E8%A1%8C%E7%BC%A9%E6%94%BE%E3%80%82&amp;text=drawable%2Dnodpi%E6%96%87%E4%BB%B6%E5%A4%B9%EF%BC%8C%E8%BF%99%E4%B8%AA,%E5%B0%B1%E4%BC%9A%E5%AE%9E%E9%99%85%E5%B1%95%E7%A4%BA%E5%A4%9A%E5%A4%A7%E3%80%82</a></p><p>AndroidçŸ¥è¯†ä½“ç³»ä¹‹drawableæ–‡ä»¶å¤¹é¡ºåº - ä½œä¸šéƒ¨è½ Cmd Markdown ç¼–è¾‘é˜…è¯»å™¨: <a href="https://www.zybuluo.com/TryLoveCatch/note/590965">https://www.zybuluo.com/TryLoveCatch/note/590965</a></p><p>Android drawableæ–‡ä»¶å¤¹é‚£äº›äº‹_å®‰å“drawableæ–‡ä»¶å¤¹çš„ä½œç”¨-CSDNåšå®¢: <a href="https://blog.csdn.net/qq_34341338/article/details/86706751">https://blog.csdn.net/qq_34341338/article/details/86706751</a></p>]]></content>
    
    
    <categories>
      
      <category>å®‰å“APP</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>AndroidAPPUI</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Android ADB å¸¸ç”¨å‘½ä»¤</title>
    <link href="/article/dfa112ac/"/>
    <url>/article/dfa112ac/</url>
    
    <content type="html"><![CDATA[<h2 id="toyboxå’Œbusybox"><a href="#toyboxå’Œbusybox" class="headerlink" title="toyboxå’Œbusybox"></a>toyboxå’Œbusybox</h2><p><a href="https://blog.csdn.net/weixin_44311012/article/details/130203207">toybox å’Œ busybox çš„ä½œç”¨</a></p><p>am monitor  å¯ä»¥æŒç»­ç›‘æ§Appçš„åŒ…åï¼Œå½“åˆ‡æ¢åº”ç”¨æ—¶ï¼Œå¦‚æœåŒ…åæœ‰å˜åŒ–ï¼Œå°±ä¼šåœ¨ç»ˆç«¯è¾“å‡º</p><h2 id="Audio"><a href="#Audio" class="headerlink" title="Audio"></a>Audio</h2><p>æŸ¥çœ‹audioçš„å…¨éƒ¨ä¿¡æ¯ï¼ˆå„éŸ³é¢‘æµéŸ³é‡ï¼Œç„¦ç‚¹ï¼Œç­–ç•¥ç­‰ï¼‰</p><p>dumpsys audio</p><h3 id="éŸ³é‡"><a href="#éŸ³é‡" class="headerlink" title="éŸ³é‡"></a>éŸ³é‡</h3><h4 id="æŒ‰é”®æ–¹å¼"><a href="#æŒ‰é”®æ–¹å¼" class="headerlink" title="æŒ‰é”®æ–¹å¼"></a>æŒ‰é”®æ–¹å¼</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">å¢åŠ </span><br>input keyevent 24<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">å‡å°‘</span><br>input keyevent 25<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">é™éŸ³</span><br>input keyevent 164<br></code></pre></td></tr></table></figure><h4 id="mediaå‘½ä»¤"><a href="#mediaå‘½ä»¤" class="headerlink" title="mediaå‘½ä»¤"></a>mediaå‘½ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">è®¾ç½®éŸ³é‡å¹¶ä¸”æ˜¾ç¤ºéŸ³é‡UI</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">3 ä»£è¡¨STREAM_SYSTEM</span><br>media volume --show --stream 3 --set 11 <br>media volume --show --stream 3 --adj raise<br>media volume --show --stream 0 --adj lower<br>media volume --show --stream 3 --get<br><span class="hljs-meta prompt_">#</span><span class="language-bash">æ§åˆ¶æ’­æ”¾æš‚åœ</span><br>media dispatch play<br>media dispatch pause<br></code></pre></td></tr></table></figure><p>å®‰å“ 11 å¼€å§‹ media å‘½ä»¤æ²¡æœ‰äº†ï¼Œä½¿ç”¨<code>cmd media_session</code> </p><p><code>cmd media_session  volume  --stream 3 --get</code></p><p><code>cmd media_session  volume --show --stream 3 --set 11</code></p><h4 id="å…¶ä»–æ–¹æ³•"><a href="#å…¶ä»–æ–¹æ³•" class="headerlink" title="å…¶ä»–æ–¹æ³•"></a>å…¶ä»–æ–¹æ³•</h4><p><code>service call audio</code></p><p><code>adb shell service call audio 9 i32 &lt;ç¼–å·&gt; i32 &lt;ç±»å‹&gt; i32 1</code></p><p>ä½¿ç”¨ADBè°ƒæ•´Androidè®¾å¤‡éŸ³é‡åŠè§£å†³å¸¸è§é—®é¢˜-CSDNåšå®¢: <a href="https://blog.csdn.net/run068/article/details/122824920">https://blog.csdn.net/run068/article/details/122824920</a></p>]]></content>
    
    
    <categories>
      
      <category>Androidè°ƒè¯•ç›¸å…³</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Android APPç»„ä»¶åŒ–</title>
    <link href="/article/69eef408/"/>
    <url>/article/69eef408/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰å¯¼çŸ¥è¯†"><a href="#å‰å¯¼çŸ¥è¯†" class="headerlink" title="å‰å¯¼çŸ¥è¯†"></a>å‰å¯¼çŸ¥è¯†</h2><p>é…ç½® build å˜ä½“ ?|? Android Studio ?|? Android Developers: <a href="https://developer.android.com/build/build-variants?hl=zh-cn#groovy">https://developer.android.com/build/build-variants?hl=zh-cn#groovy</a></p><p>Androidæ¨¡å—åŒ–ä¹‹MicroModuleï¼ˆå¾®ä¿¡Pinså·¥ç¨‹ï¼‰ç›¸ä¿¡ä½ çœ‹è¿‡å¾®ä¿¡å…³äºæ¨¡å—åŒ–çš„åˆ†äº«ã€Šå¾®ä¿¡Androidæ¨¡å—åŒ– - æ˜é‡‘: <a href="https://juejin.cn/post/6844903647956959246?from=search-suggest">https://juejin.cn/post/6844903647956959246?from=search-suggest</a></p><p>æ€ä¹ˆå®ç°å¾®ä¿¡Android Pinså·¥ç¨‹ç»“æ„ï¼ŸPinså·¥ç¨‹ç»“æ„æ˜¯ä»€ä¹ˆï¼Ÿ å¦‚ä½•åšä»£ç è¾¹ç•Œæ£€æŸ¥ï¼Ÿ - æ˜é‡‘: <a href="https://juejin.cn/post/6844903602645893128">https://juejin.cn/post/6844903602645893128</a></p><p>å¾®ä¿¡Androidæ¨¡å—åŒ–æ¶æ„é‡æ„å®è·µ: <a href="https://mp.weixin.qq.com/s/6Q818XA5FaHd7jJMFBG60w">https://mp.weixin.qq.com/s/6Q818XA5FaHd7jJMFBG60w</a></p><p>ç¾å›¢å¤–å–Androidå¹³å°åŒ–æ¶æ„æ¼”è¿›å®è·µ - ç¾å›¢æŠ€æœ¯å›¢é˜Ÿ: <a href="https://tech.meituan.com/2018/03/16/meituan-food-delivery-android-architecture-evolution.html">https://tech.meituan.com/2018/03/16/meituan-food-delivery-android-architecture-evolution.html</a></p><p>Androidæ¶ˆæ¯æ€»çº¿çš„æ¼”è¿›ä¹‹è·¯ï¼šç”¨LiveDataBusæ›¿ä»£RxBusã€EventBus - ç¾å›¢æŠ€æœ¯å›¢é˜Ÿ: <a href="https://tech.meituan.com/2018/07/26/android-livedatabus.html">https://tech.meituan.com/2018/07/26/android-livedatabus.html</a></p><p>Androidç»„ä»¶åŒ–æ–¹æ¡ˆåŠç»„ä»¶æ¶ˆæ¯æ€»çº¿modular-eventå®æˆ˜ - ç¾å›¢æŠ€æœ¯å›¢é˜Ÿ: <a href="https://tech.meituan.com/2018/12/20/modular-event.html">https://tech.meituan.com/2018/12/20/modular-event.html</a></p><p>åˆ›å»º Android åº“ ?|? Android Studio ?|? Android Developers: <a href="https://developer.android.com/studio/projects/android-library?hl=zh-cn">https://developer.android.com/studio/projects/android-library?hl=zh-cn</a></p><p>æ·»åŠ  build ä¾èµ–é¡¹ ?|? Android Studio ?|? Android Developers: <a href="https://developer.android.com/build/dependencies?hl=zh-cn">https://developer.android.com/build/dependencies?hl=zh-cn</a></p><p>é«˜çº§æµ‹è¯•è®¾ç½® ?|? Android Studio ?|? Android Developers: <a href="https://developer.android.com/studio/test/advanced-test-setup?hl=zh-cn#create-instrumented-test-for-build-variant">https://developer.android.com/studio/test/advanced-test-setup?hl=zh-cn#create-instrumented-test-for-build-variant</a></p><p>Andriod å¤šæ¸ é“åˆ†åŒ…ï¼Œå®ç”¨çš„moduleåˆ†å±‚ï¼Œå¼€å‘ä»£ç æ··æ·†è§„Andriod studio 3.0 æœ‰å¿…è¦é‡æ–°å­¦ä¹ æ›´ - æ˜é‡‘: <a href="https://juejin.cn/post/6844903518411702286">https://juejin.cn/post/6844903518411702286</a> ï¼ˆæ··æ·†è§„åˆ™ï¼‰</p><h2 id="èµ„æºå†²çª"><a href="#èµ„æºå†²çª" class="headerlink" title="èµ„æºå†²çª"></a>èµ„æºå†²çª</h2><p>Android ç»„ä»¶èµ„æºè¦†ç›–å†²çªè§£å†³æ–¹æ¡ˆåœ¨ Android çš„æ—¥å¸¸å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨åˆ°å¤§é‡çš„ç¬¬ä¸‰æ–¹åº“æˆ–è€…è‡ªå·±ç¼–å†™çš„ç»„ä»¶åº“ - æ˜é‡‘: <a href="https://juejin.cn/post/6844903993894780942">https://juejin.cn/post/6844903993894780942</a></p><p><a href="https://github.com/hust201010701/CheckResourceConflict">https://github.com/hust201010701/CheckResourceConflict</a></p><p>Android Gradle Plugin 3.3 ç‰ˆæœ¬åŠå…¶ä»¥ä¸Šï¼Œæä¾›äº†ä¸€ä¸ª API å¯ä»¥è·å–ç¼–è¯‘æ‰€æœ‰çš„èµ„æºæ–‡ä»¶ã€‚</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs groovy">variants.forEach &#123; variant -&gt;<br>    variant <span class="hljs-keyword">as</span> BaseVariantImpl<br>    <span class="hljs-comment">// files å³å¯¹åº”æ‰€æœ‰çš„ç¼–è¯‘èµ„æº</span><br>    <span class="hljs-keyword">def</span> files = variant.allRawAndroidResources.files<br><br></code></pre></td></tr></table></figure><p>ç»ˆäºç†è§£ï½Android æ¨¡å—åŒ–é‡Œçš„èµ„æºå†²çª? å‰è¨€ ä½œä¸º Android å¼€å‘è€…ï¼Œæˆ‘ä»¬å¸¸å¸¸éœ€è¦å»ç®¡ç†éå¸¸å¤šä¸åŒçš„èµ„æºæ–‡ - æ˜é‡‘: <a href="https://juejin.cn/post/7170562275374268447">https://juejin.cn/post/7170562275374268447</a></p><p>åˆ©ç”¨Android Gradleè¿›è¡Œè‡ªåŠ¨åŒ–è®¾ç½®èµ„æºåå‘½åè§„åˆ™ä¸€ã€èƒŒæ™¯æè¿°ï¼š ????å…¬å¸å†ä¸æ–­æ¨è¿›ç»„ä»¶åŒ–ï¼Œå¤šä¸ªModul - æ˜é‡‘: <a href="https://juejin.cn/post/7065889116780494855">https://juejin.cn/post/7065889116780494855</a></p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs groovy">android &#123;  <br>  <br>  flavorDimensions <span class="hljs-string">&quot;versionCode&quot;</span>  <br>  <br>  productFlavors &#123;  <br>      productFlavors.all &#123;<span class="hljs-comment">//éå†productFlavorså¤šæ¸ é“ï¼Œè®¾ç½®æ¸ é“å·ï¼ˆxiaomi ã€huaweiï¼‰  </span><br>          flavor -&gt; flavor.manifestPlaceholders.put(<span class="hljs-string">&quot;CHANNEL&quot;</span>, name)  <br>      &#125;<br>  &#125;<br>  applicationVariants.all &#123; variant -&gt;  <br>      <span class="hljs-comment">// æ‰“åŒ…å®Œæˆåè¾“å‡ºè·¯å¾„</span><br>      <span class="hljs-keyword">def</span> name = ((project.name != <span class="hljs-string">&quot;app&quot;</span>) ? project.name : rootProject.name.replace(<span class="hljs-string">&quot; &quot;</span>, <span class="hljs-string">&quot;&quot;</span>)) + <br>      <span class="hljs-string">&quot;_&quot;</span> + variant.flavorName + <br>      <span class="hljs-string">&quot;_&quot;</span> + variant.buildType.name + <br>      <span class="hljs-string">&quot;_&quot;</span> + variant.versionName + <br>      <span class="hljs-string">&quot;_&quot;</span> + <span class="hljs-keyword">new</span> Date().format(<span class="hljs-string">&#x27;yyyyMMddhhmm&#x27;</span>) + <span class="hljs-string">&quot;.apk&quot;</span>  <br>      <span class="hljs-comment">//ç›¸å¯¹è·¯å¾„app/build/outputs/apk/huawei/release/</span><br>      <span class="hljs-keyword">def</span> path = <span class="hljs-string">&quot;../../../../../apk/&quot;</span> <span class="hljs-comment">//ç›¸å½“äºè·¯å¾„ app/apk/</span><br>      variant.outputs.each &#123; output -&gt;<br>          <span class="hljs-keyword">def</span> outputFile = output.outputFile<br>          <span class="hljs-keyword">if</span> (outputFile != <span class="hljs-literal">null</span> &amp;&amp; outputFile.name.endsWith(<span class="hljs-string">&#x27;.apk&#x27;</span>)) &#123;<br>               <span class="hljs-comment">//æŒ‡å®šè·¯å¾„è¾“å‡º</span><br>               output.outputFileName = <span class="hljs-keyword">new</span> File(path, name)<br>          &#125;<br>      &#125; <br>      <span class="hljs-comment">// åœ¨æ‰“åŒ…å®Œæˆåè¿˜å¯ä»¥åšä¸€äº›åˆ«çš„æ“ä½œï¼Œå¯ä»¥å¤åˆ¶åˆ°æŒ‡å®šç›®å½•ï¼Œæˆ–è€…ç§»åŠ¨æ–‡ä»¶åˆ°æŒ‡å®šç›®å½•</span><br>      variant.assemble.doLast &#123;  <br>          File out = <span class="hljs-keyword">new</span> File(â€œ$&#123;project.rootDir&#125;/apkâ€)  <br>          variant.outputs.forEach &#123; file -&gt;  <br>            <span class="hljs-comment">//å¤åˆ¶apkåˆ°æŒ‡å®šæ–‡ä»¶å¤¹</span><br>            <span class="hljs-comment">//copy &#123;  </span><br>            <span class="hljs-comment">//  from file.outputFile  </span><br>            <span class="hljs-comment">//  into out  </span><br>            <span class="hljs-comment">//&#125;</span><br>         <span class="hljs-comment">//æŠŠæ–‡ä»¶ç§»åŠ¨åˆ°æŒ‡å®šæ–‡ä»¶å¤¹  </span><br>          ant.move <span class="hljs-attr">file:</span> file.outputFile,  <br>                 <span class="hljs-symbol">todir:</span> <span class="hljs-string">&quot;$&#123;project.rootDir&#125;/apk&quot;</span><br>        &#125;  <br>      &#125; <br>  &#125;<br><span class="hljs-comment">//å¤šæ¸ é“ç­¾åçš„é…ç½®</span><br>  signingConfigs &#123;<br>     test &#123;<br>        storeFile file(<span class="hljs-string">&quot;../test.keystore&quot;</span>)<br>        storePassword <span class="hljs-string">&#x27;test&#x27;</span><br>        keyAlias <span class="hljs-string">&#x27;test&#x27;</span><br>        keyPassword <span class="hljs-string">&#x27;test&#x27;</span><br>        v1SigningEnabled <span class="hljs-literal">true</span><br>        v2SigningEnabled <span class="hljs-literal">true</span><br>     &#125;<br>     xiaomi &#123;<br>        storeFile file(<span class="hljs-string">&quot;../xiaomi.keystore&quot;</span>)<br>        storePassword <span class="hljs-string">&#x27;xiaomi&#x27;</span><br>        keyAlias <span class="hljs-string">&#x27;xiaomi&#x27;</span><br>        keyPassword <span class="hljs-string">&#x27;xiaomi&#x27;</span><br>        v1SigningEnabled <span class="hljs-literal">true</span><br>        v2SigningEnabled <span class="hljs-literal">true</span><br>     &#125;<br>  &#125;<br>  buildTypes &#123;<br>       debug &#123;<br><span class="hljs-comment">//        debugè¿™é‡Œè®¾ç½®ä¸èµ·ä½œç”¨ï¼Œå¯èƒ½æ˜¯ç¼–è¯‘å™¨çš„é—®é¢˜ï¼Ÿ</span><br><span class="hljs-comment">//         productFlavors.xiaomi.signingConfig signingConfigs.test</span><br><span class="hljs-comment">//         productFlavors.huawei.signingConfig signingConfigs.test</span><br>       &#125;<br>       release &#123;<br>           productFlavors.xiaomi.signingConfig signingConfigs.xiaomi<br>           productFlavors.huawei.signingConfig signingConfigs.huawei<br>       &#125;<br>  &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs groovy">android &#123;<br>    variantFilter &#123; variant -&gt;<br>        <span class="hljs-keyword">if</span> (variant.buildType.name.equals(<span class="hljs-string">&#x27;debug&#x27;</span>)) &#123;<br>            variant.setIgnore(<span class="hljs-literal">true</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//æ‰§è¡Œlintæ£€æŸ¥ï¼Œæœ‰ä»»ä½•çš„é”™è¯¯æˆ–è€…è­¦å‘Šæç¤ºï¼Œéƒ½ä¼šç»ˆæ­¢æ„å»ºï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶å…³æ‰ã€‚</span><br>    lintOptions &#123;<br>        checkReleaseBuilds <span class="hljs-literal">false</span><br>        abortOnError <span class="hljs-literal">false</span><br>        <span class="hljs-comment">// é˜²æ­¢åœ¨å‘å¸ƒçš„æ—¶å€™å‡ºç°å› MissingTranslationå¯¼è‡´Build Failed!</span><br>        disable <span class="hljs-string">&#x27;MissingTranslation&#x27;</span><br>    &#125;<br> <br>    dexOptions &#123;<br>        incremental <span class="hljs-literal">true</span><br>        javaMaxHeapSize <span class="hljs-string">&quot;8g&quot;</span><br>        jumboMode = <span class="hljs-literal">true</span><br>        preDexLibraries = <span class="hljs-literal">false</span><br>        threadCount =<span class="hljs-string">&quot;8&quot;</span><br>    &#125;<br><br></code></pre></td></tr></table></figure><p>missingDimensionStrategy </p><p>é…ç½®äº§å“å˜ç§productFlavors matchingFallbacks missingDimensionStrategy - ç®€ä¹¦: <a href="https://www.jianshu.com/p/4b311bd9840d">https://www.jianshu.com/p/4b311bd9840d</a></p><p>gradle - Android buildTypes vs. productFlavors error - Stack Overflow: <a href="https://stackoverflow.com/questions/64758477/android-buildtypes-vs-productflavors-error">https://stackoverflow.com/questions/64758477/android-buildtypes-vs-productflavors-error</a></p><p>ProductFlavorå¤šæ¸ é“çš„ç¥å™¨ - ç®€ä¹¦: <a href="https://www.jianshu.com/p/00ceb35b090b">https://www.jianshu.com/p/00ceb35b090b</a></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>Android å¤šæ¸ é“æ‰“åŒ…å¤šæ¸ é“é…ç½®ï¼ˆ2 ç§æ–¹å¼ï¼‰ 1ã€å¯å†™åœ¨ä¸»æ¨¡å—ï¼ˆappï¼‰çš„ build.gradle ä¸‹ 2ã€åœ¨é¡¹ - æ˜é‡‘: <a href="https://juejin.cn/post/7023661293781385247">https://juejin.cn/post/7023661293781385247</a></p><p>Gradleå¤šæ¸ é“æ‰“åŒ…(åŠ¨æ€è®¾å®šAppåç§°ï¼Œåº”ç”¨å›¾æ ‡ï¼Œæ›¿æ¢å¸¸é‡ï¼Œæ›´æ”¹åŒ…åï¼Œå˜æ›´æ¸ é“) - ç®€ä¹¦: <a href="https://www.jianshu.com/p/533240d222d3">https://www.jianshu.com/p/533240d222d3</a></p><p>Android å®˜æ–¹æ¨¡å—åŒ–æ–¹æ¡ˆè§£è¯»å¿«é€Ÿäº†è§£ Android å®˜æ–¹æ¨¡å—åŒ–æ–¹æ¡ˆã€‚è¿˜æœ‰ä¸€äº›ä½ å¯èƒ½ä¸çŸ¥é“çš„å®ç”¨å°æŠ€å·§ã€‚è¿˜æœ‰å®˜æ–¹æ¨¡ - æ˜é‡‘: <a href="https://juejin.cn/post/7142884855091560479">https://juejin.cn/post/7142884855091560479</a></p>]]></content>
    
    
    <categories>
      
      <category>AndroidAPPæ¶æ„</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>AndroidAPP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Tencent mars Xlogç¼–è¯‘åŠä½¿ç”¨æ–¹æ³•</title>
    <link href="/article/ca471381/"/>
    <url>/article/ca471381/</url>
    
    <content type="html"><![CDATA[<p>Window11ç¼–è¯‘</p><blockquote><p>å¦‚æœå·²ç»å®‰è£…äº†cygwinï¼Œä¸éœ€è¦å¸è½½é‡è£…ï¼Œåªéœ€è¦å†æ¬¡è¿è¡Œå®‰è£…æ–‡ä»¶setup-x86_64.exeå°±å¯ä»¥ä¸‹è½½æˆ–è€…å¸è½½åŒ…ã€‚</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>AndroidThirdPartSDK</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>AndroidThirdPartySDK</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>gitå¸¸è§é—®é¢˜</title>
    <link href="/article/ca7dd2f8/"/>
    <url>/article/ca7dd2f8/</url>
    
    <content type="html"><![CDATA[<p>gerrit draft and topic |: <a href="https://breezetemple.github.io/2019/08/30/gerrit-draft-and-topic/">https://breezetemple.github.io/2019/08/30/gerrit-draft-and-topic/</a></p><p>Gerritç›¸å¯¹Gitæä¾›äº†ä¸€ä¸ªç‰¹æœ‰çš„å‘½åç©ºé—´refs&#x2F;for&#x2F;ç”¨æ¥å®šä¹‰æˆ‘ä»¬çš„æäº¤ä¸Šä¼ åˆ°å“ªä¸ªbranchï¼Œä¸”å¯ä»¥ç”¨æ¥åŒºåˆ†æˆ‘ä»¬çš„commitæ˜¯æäº¤åˆ°Gerritè¿›è¡Œå®¡æ ¸è¿˜æ˜¯ç›´æ¥æäº¤åˆ°Gitä»“åº“ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š</p><p>refs&#x2F;for&#x2F;<target-branch></p><p>Push ä¸€ä¸ª Commit åˆ° Gerrit: git push origin HEAD:refs&#x2F;for&#x2F;master<br>ç›´æ¥ Push ä¸€ä¸ª commit åˆ° Git ä»“åº“ï¼šï¼ˆé»˜è®¤é…ç½®æˆä¸å…è®¸ï¼‰ git push origin HEAD:master<br>å½“commit Pushåˆ°Gerritç­‰å¾…reviewæ—¶ï¼ŒGerritä¼šå°†æ­¤commitä¿å­˜åœ¨ä¸€ä¸ªåä¸ºrefs&#x2F;changes&#x2F;xx&#x2F;yy&#x2F;zzçš„ä¸€ä¸ªæš‚å­˜branchä¸­ã€‚</p><p>zzä¸ºè¿™ä¸ªcommitçš„patch setå·<br>yyæ˜¯changeå·<br>xxæ˜¯changeå·çš„åä¸¤ä½</p><p>Draft<br>refs&#x2F;drafts&#x2F;<target branch></p><p>$ git push origin HEAD:refs&#x2F;drafts&#x2F;xxx<br>åœ¨Gerritä¸­ç‚¹å‡»PublishæŒ‰é’®è½¬æ¢ä¸ºæ­£å¼Change</p><p>Topic<br>refs&#x2F;for&#x2F;<target branch><br>refs&#x2F;for&#x2F;<target branch>&#x2F;<topic name></p><p>$ git push origin HEAD:refs&#x2F;for&#x2F;xxx%topic&#x3D;123<br>$ git push origin HEAD:refs&#x2F;for&#x2F;xxx&#x2F;123<br>Topicç”¨äºå½’ç±»ç›¸å…³çš„æäº¤ï¼Œå¯ä»¥ç”¨ä¸Šè¿°çš„å‘½ä»¤ï¼ŒåŒæ—¶å¯ä»¥åœ¨Gerritä¸­ç¼–è¾‘Topic</p><h2 id="ä»£ç†"><a href="#ä»£ç†" class="headerlink" title="ä»£ç†"></a>ä»£ç†</h2><p>ä¸º http è®¾ç½®ä»£ç†</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">ä¸€æ¬¡æ€§ä»£ç†</span><br>git clone -c http.proxy=&quot;http://127.0.0.1:1087&quot; https://github.com/<br><span class="hljs-meta prompt_"># </span><span class="language-bash">å…¨å±€è®¾ç½®ä»£ç†</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">ä»…ä¸ºgithub.comè®¾ç½®socks5ä»£ç†</span><br>git config --global http.https://github.com.proxy socks5://127.0.0.1:1086<br><br>git config --global https.proxy http://127.0.0.1:1080<br><br>git config --global https.proxy https://127.0.0.1:1080<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">å–æ¶ˆ</span><br><br>git config --global --unset http.proxy<br><br>git config --global --unset https.proxy<br></code></pre></td></tr></table></figure><p>ä¸º ssh åè®®è®¾ç½®ä»£ç†</p><blockquote><p>ä¸‹æ–‡é…ç½®å…¶ä¸­çš„ipå’Œç«¯å£ä¿®æ”¹æˆä½ è‡ªå·±ä»£ç†çš„å‚æ•°</p></blockquote><p>windows</p><p>ä¿®æ”¹C:\Users${your username}.sshç›®å½•ä¸‹çš„configæ–‡ä»¶ï¼Œè‹¥æ²¡æœ‰åˆ™æ–°å»º</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">Host github.com                                                <br>    Hostname ssh.github.com                                    <br>    Port 443                                                  <br>    User git<br>    ProxyCommand connect -S 127.0.0.1:7890 %h %p<br></code></pre></td></tr></table></figure><p>Linuxã€MacOS</p><p>ä¿®æ”¹~&#x2F;.sshç›®å½•ä¸‹çš„configæ–‡ä»¶ï¼Œè‹¥æ²¡æœ‰åˆ™æ–°å»º</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">Host github.com<br>        Hostname ssh.github.com<br>        Port 443<br>        User git<br>        ProxyCommand nc -v -x 172.28.208.1:7890 %h %p<br></code></pre></td></tr></table></figure><p>éªŒè¯</p><p><code>ssh -T git@github.com</code></p><p>è‹¥å‡ºç°é”™è¯¯ï¼Œåˆ™åˆ é™¤.sshç›®å½•ä¸­known_hostsæ–‡ä»¶é‡è¯•</p><p><a href="https://seepine.com/git/ssh-proxy/">Git ä¸º ssh åè®®è®¾ç½®ä»£ç† - Seepineâ€™s Blog</a></p>]]></content>
    
    
    <categories>
      
      <category>git</category>
      
    </categories>
    
    
    <tags>
      
      <tag>git</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Android Activityå¸¸è§é—®é¢˜</title>
    <link href="/article/a218b21a/"/>
    <url>/article/a218b21a/</url>
    
    <content type="html"><![CDATA[<p>android finishAffinity()-CSDNåšå®¢: <a href="https://blog.csdn.net/mr_orange_klj/article/details/43244603">https://blog.csdn.net/mr_orange_klj/article/details/43244603</a></p><p>è°ƒç”¨activityå¯¹è±¡çš„finishiAffinity()æ–¹æ³•ï¼Œå¯ä»¥å…³é—­å½“å‰activityæ‰€å±çš„activityæ ˆä¸­æ‰€æœ‰çš„activityã€‚å¦‚æœæ‰€æœ‰activityéƒ½ä¿å­˜åœ¨é»˜è®¤æ ˆä¸­ï¼Œåˆ™ä½¿ç”¨è¯¥æ–¹æ³•ä¼šç›´æ¥é€€å‡ºç¨‹åºã€‚å¦‚æœè¦å›åˆ°ç¨‹åºçš„ä¸»ç•Œé¢ï¼Œåˆ™å¯ä»¥åœ¨manifestæ–‡ä»¶ä¸­å°†ä¸»ç•Œé¢çš„activityè®¾ç½®ä¸ºå•ç‹¬çš„æ ˆä¿å­˜ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"> <span class="hljs-tag">&lt;<span class="hljs-name">activity</span></span><br><span class="hljs-tag">            <span class="hljs-attr">android:name</span>=<span class="hljs-string">&quot;com.weishi.UserMain&quot;</span></span><br><span class="hljs-tag">            <span class="hljs-attr">android:taskAffinity</span>=<span class="hljs-string">&quot;:finish&quot;</span>//<span class="hljs-attr">è¯¥å¥ç”¨æ¥æŒ‡å®šæ ˆ</span></span><br><span class="hljs-tag">            <span class="hljs-attr">android:label</span>=<span class="hljs-string">&quot;@string/title_activity_user_main&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">activity</span>&gt;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>AndroidActivity</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®‰å“å¸¸ç”¨å·¥å…·æ–¹æ³•</title>
    <link href="/article/bf556c88/"/>
    <url>/article/bf556c88/</url>
    
    <content type="html"><![CDATA[<p>è·å–è¿›ç¨‹åå­—</p><p>ã€Androidã€‘è·å–å½“å‰è¿›ç¨‹åçš„å››ç§æ–¹æ³•åŠæ•ˆç‡å¯¹æ¯”_androidè·å–å½“å‰è¿›ç¨‹å-CSDNåšå®¢: <a href="https://blog.csdn.net/qq_23049111/article/details/126097443">https://blog.csdn.net/qq_23049111/article/details/126097443</a></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getAppProcessName</span><span class="hljs-params">()</span></span>: String &#123;<br>    <span class="hljs-keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.P) &#123;<br>        <span class="hljs-keyword">return</span> Application.getProcessName()<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.JELLY_BEAN_MR2) &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">val</span> processName =<br>                Reflector.on(<span class="hljs-string">&quot;android.app.ActivityThread&quot;</span>).method(<span class="hljs-string">&quot;currentProcessName&quot;</span>)<br>                    .call&lt;String&gt;()<br>            Log.d(TAG, <span class="hljs-string">&quot;getAppProcessName: <span class="hljs-variable">$processName</span>&quot;</span>)<br>            <span class="hljs-keyword">return</span> processName<br>        &#125; <span class="hljs-keyword">catch</span> (e: Exception) &#123;<br>            Log.e(TAG, <span class="hljs-string">&quot;getAppProcessName error&quot;</span>, e)<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span><br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//å®‰å“4.2çš„çš„currentPackageNameå®é™…ä¸Šå°±æ˜¯currentProcessName</span><br>            <span class="hljs-comment">//http://xrefandroid.com/android-4.2.2_r1/xref/frameworks/base/core/java/android/app/ActivityThread.java</span><br>            <span class="hljs-keyword">val</span> processName =<br>                Reflector.on(<span class="hljs-string">&quot;android.app.ActivityThread&quot;</span>).method(<span class="hljs-string">&quot;currentPackageName&quot;</span>)<br>                    .call&lt;String&gt;()<br>            Log.d(TAG, <span class="hljs-string">&quot;getAppProcessName: <span class="hljs-variable">$processName</span>&quot;</span>)<br>            <span class="hljs-keyword">return</span> processName<br>        &#125; <span class="hljs-keyword">catch</span> (e: Exception) &#123;<br>            Log.e(TAG, <span class="hljs-string">&quot;getAppProcessName error&quot;</span>, e)<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è·å–åº”ç”¨åç§°</p><p>Android è·å–åº”ç”¨çš„iconã€åå­—ã€ç‰ˆæœ¬å·_æŸ¥çœ‹å®‰å“appç±»å-CSDNåšå®¢: <a href="https://blog.csdn.net/LoveDou0816/article/details/78135201">https://blog.csdn.net/LoveDou0816/article/details/78135201</a></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> Context.<span class="hljs-title">getAppName</span><span class="hljs-params">(pkgName: <span class="hljs-type">String</span>)</span></span>: String &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">val</span> info: PackageInfo = packageManager.getPackageInfo(pkgName, <span class="hljs-number">0</span>)<br>        <span class="hljs-comment">//resources.getString(info.applicationInfo.labelRes)</span><br>        info.applicationInfo.loadLabel(packageManager).toString() <span class="hljs-comment">//å…¼å®¹android:label=&quot;$&#123;APP_NAME&#125;&quot;</span><br>    &#125; <span class="hljs-keyword">catch</span> (e: PackageManager.NameNotFoundException) &#123;<br>        Log.e(TAG, <span class="hljs-string">&quot;getAppName error&quot;</span>, e)<br>        <span class="hljs-string">&quot;&quot;</span><br>    &#125; <span class="hljs-keyword">catch</span> (e: Resources.NotFoundException) &#123;<br>        Log.e(TAG, <span class="hljs-string">&quot;getAppName error&quot;</span>, e)<br>        <span class="hljs-string">&quot;&quot;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>AndroidUtils</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>gradleå¸¸è§é—®é¢˜</title>
    <link href="/article/a7bee58f/"/>
    <url>/article/a7bee58f/</url>
    
    <content type="html"><![CDATA[<h1 id="aarç›¸å…³"><a href="#aarç›¸å…³" class="headerlink" title="aarç›¸å…³"></a>aarç›¸å…³</h1><h2 id="æ·»åŠ aaråŒ…ä¾èµ–"><a href="#æ·»åŠ aaråŒ…ä¾èµ–" class="headerlink" title="æ·»åŠ aaråŒ…ä¾èµ–"></a>æ·»åŠ aaråŒ…ä¾èµ–</h2><p>gradle - How to include different .aar depending on the android build variant - Stack Overflow: <a href="https://stackoverflow.com/questions/41373333/how-to-include-different-aar-depending-on-the-android-build-variant">https://stackoverflow.com/questions/41373333/how-to-include-different-aar-depending-on-the-android-build-variant</a></p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs groovy">configurations.maybeCreate(<span class="hljs-string">&quot;default&quot;</span>)<br>artifacts.add(<span class="hljs-string">&quot;default&quot;</span>, file(<span class="hljs-string">&#x27;xyz.aar&#x27;</span>))<br></code></pre></td></tr></table></figure><blockquote><p>åŒ…è£…æœ¬åœ° aar çš„æ¨¡å—ä¸­ç¦æ­¢åŒ…å«ä»»ä½•ä»£ç å’Œèµ„æºæ–‡ä»¶ï¼ŒåŒ…æ‹¬åº“æˆ– AndroidManifestã€‚å³ä½¿åŒ…å«ï¼Œä¹Ÿæ— æ³•ç”Ÿæ•ˆï¼›å¦‚æœæœ‰å¤šä¸ªæœ¬åœ°çš„aaréœ€è¦å¼•ç”¨ï¼Œéœ€è¦åˆ†åˆ«åˆ›å»ºå·¥ç¨‹ç›®å½•åŠbuild.gradleæ–‡ä»¶ã€‚</p></blockquote><p>AndroidStudioæ ¹æ®ç¯å¢ƒæ‰“åŒ…ä¸åŒçš„aaræ–‡ä»¶ - ç®€ä¹¦: <a href="https://www.jianshu.com/p/bc61ed8dcce3">https://www.jianshu.com/p/bc61ed8dcce3</a></p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs groovy">configurations.maybeCreate(<span class="hljs-string">&quot;default&quot;</span>)<br>artifacts.add(<span class="hljs-string">&quot;default&quot;</span>, file(<span class="hljs-string">&#x27;demolib_release.aar&#x27;</span>))<br>configurations.maybeCreate(<span class="hljs-string">&quot;debug&quot;</span>)<br>artifacts.add(<span class="hljs-string">&quot;debug&quot;</span>, file(<span class="hljs-string">&#x27;demolib_debug.aar&#x27;</span>))<br></code></pre></td></tr></table></figure><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs groovy">dependencies &#123;<br>    implementation project(<span class="hljs-string">&#x27;:demolib&#x27;</span>)<br>    debugImplementation project(<span class="hljs-attr">path:</span> <span class="hljs-string">&#x27;:demolib&#x27;</span>, <span class="hljs-attr">configuration:</span> <span class="hljs-string">&#x27;debug&#x27;</span>)<br>&#125;<br></code></pre></td></tr></table></figure><p>ã€Androidã€‘å¦‚ä½•å¼•å…¥æœ¬åœ° aarï¼Ÿ åŸç”Ÿé›†æˆå¸¸è§é—®é¢˜ - å¼€å‘æŒ‡å— - å¼€å‘æ–‡æ¡£ - é£ä¹¦å¼€æ”¾å¹³å°: <a href="https://open.feishu.cn/document/uAjLw4CM/ukzMukzMukzM/native-integration/native-integration-qa">https://open.feishu.cn/document/uAjLw4CM/ukzMukzMukzM/native-integration/native-integration-qa</a></p><h2 id="ç¼–è¯‘æˆappåaaré‡Œé¢çš„èµ„æºæ‰¾ä¸åˆ°ï¼Œå®é™…ä¸Šaaré‡Œé¢æœ‰"><a href="#ç¼–è¯‘æˆappåaaré‡Œé¢çš„èµ„æºæ‰¾ä¸åˆ°ï¼Œå®é™…ä¸Šaaré‡Œé¢æœ‰" class="headerlink" title="ç¼–è¯‘æˆappåaaré‡Œé¢çš„èµ„æºæ‰¾ä¸åˆ°ï¼Œå®é™…ä¸Šaaré‡Œé¢æœ‰"></a>ç¼–è¯‘æˆappåaaré‡Œé¢çš„èµ„æºæ‰¾ä¸åˆ°ï¼Œå®é™…ä¸Šaaré‡Œé¢æœ‰</h2><p>æŠŠapkæ”¾åˆ°android studio æŸ¥çœ‹é‡Œé¢çš„èµ„æºæƒ…å†µï¼Œä¸€èˆ¬æ˜¯ç”±äºèµ„æºå†²çªè¢«å…¶ä»–moduleèµ„æºæ›¿æ¢äº†</p>]]></content>
    
    
    <categories>
      
      <category>AppBuild</category>
      
    </categories>
    
    
    <tags>
      
      <tag>gradle</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®‰å“ç›¸å…³çŸ¥è¯†ç‚¹ç½‘ç«™</title>
    <link href="/article/ed7f9345/"/>
    <url>/article/ed7f9345/</url>
    
    <content type="html"><![CDATA[<h1 id="å¼€å‘è€…æ–‡æ¡£"><a href="#å¼€å‘è€…æ–‡æ¡£" class="headerlink" title="å¼€å‘è€…æ–‡æ¡£"></a>å¼€å‘è€…æ–‡æ¡£</h1><p>OPPO å¼€æ”¾å¹³å°-OPPOå¼€å‘è€…æœåŠ¡ä¸­å¿ƒ: <a href="https://open.oppomobile.com/new/wiki">https://open.oppomobile.com/new/wiki</a></p><p>OPPO å¼€æ”¾å¹³å°-å®‰å“ç‰ˆæœ¬é€‚é…: <a href="https://open.oppomobile.com/new/developmentDoc/info?id=10960">https://open.oppomobile.com/new/developmentDoc/info?id=10960</a></p><p>Javaæ•™ç¨‹ - å»–é›ªå³°çš„å®˜æ–¹ç½‘ç«™: <a href="https://liaoxuefeng.com/books/java/introduction/index.html">https://liaoxuefeng.com/books/java/introduction/index.html</a></p><p>æŸ¥çœ‹å„ç‰ˆæœ¬è¡Œä¸ºå˜æ›´: <a href="https://developer.android.com/about/versions">https://developer.android.com/about/versions</a></p><h1 id="Android-APP"><a href="#Android-APP" class="headerlink" title="Android APP"></a>Android APP</h1><h2 id="Gradle"><a href="#Gradle" class="headerlink" title="Gradle"></a>Gradle</h2><p><a href="https://developer.android.com/build/configure-apk-splits?hl=zh-cn">æ„å»ºå¤šä¸ª APK ?|? Android Studio ?|? Android Developers</a></p><p>è¿ç§»åˆ° Gradle 7.x ä½¿ç”¨ Version Catalogs ç®¡ç†ä¾èµ– - SharpCJ - åšå®¢å›­: <a href="https://www.cnblogs.com/joy99/p/17397989.html">https://www.cnblogs.com/joy99/p/17397989.html</a></p><p>Android Studioå¼€å‘ç¯å¢ƒå…¼å®¹æ€§æ¢³ç†ï¼ˆAGPã€KGPã€Gradleï¼‰æœ¬æ–‡ä¸»è¦ä»‹ç»äº†Android Studio - æ˜é‡‘: <a href="https://juejin.cn/post/7362924623825403919">https://juejin.cn/post/7362924623825403919</a></p><p>AweiLoveAndroid&#x2F;The-pit-of-the-Android-Studio: :octocat: :+1: :clap: :star2: :star: Everything about the Android Studio and Intellij IDEAfor example:Install,common problems and solutions,each libraries for android and androidx library,code and peoject templates,etc.å…¨é¢æ€»ç»“Android Studioä»¥åŠIntellij IDEAçš„å¡«å‘æŒ‡å—ï¼Œè¯¦è§£ASç‰ˆæœ¬å·ã€Gradleç‰ˆæœ¬ã€BuildToolsä¸‰è€…çš„å¯¹ç…§å…³ç³»ï¼ŒASæ¨¡æ¿é…ç½®,gradleæ’ä»¶,Androidè‡ªå¸¦æ³¨è§£åº“è¯¦è§£ï¼Œsupportè¯¦è§£ç­‰å¹²è´§ã€‚: <a href="https://github.com/AweiLoveAndroid/The-pit-of-the-Android-Studio">https://github.com/AweiLoveAndroid/The-pit-of-the-Android-Studio</a></p><p>è¿‡å¾€çš„ Android Gradle æ’ä»¶ç‰ˆæœ¬ ?|? Android Studio ?|? Android Developers: <a href="https://developer.android.com/build/releases/past-releases?hl=zh-cn">https://developer.android.com/build/releases/past-releases?hl=zh-cn</a></p><p>ç¾å›¢å¤–å–Android Lintä»£ç æ£€æŸ¥å®è·µ - ç¾å›¢æŠ€æœ¯å›¢é˜Ÿ: <a href="https://tech.meituan.com/2018/04/13/waimai-android-lint.html">https://tech.meituan.com/2018/04/13/waimai-android-lint.html</a></p><h3 id="å­—èŠ‚ç "><a href="#å­—èŠ‚ç " class="headerlink" title="å­—èŠ‚ç "></a>å­—èŠ‚ç </h3><p>åˆ©ç”¨ASMå®Œæˆç¬¬ä¸‰æ–¹SDKå®‰å…¨æ•´æ”¹åˆ©ç”¨ASMå®Œæˆç¬¬ä¸‰æ–¹SDKå®‰å…¨æ•´æ”¹: ä½¿ç”¨è‡ªå®šä¹‰Gradleæ’ä»¶ã€Transformã€ - æ˜é‡‘: <a href="https://juejin.cn/post/7293122002724945955">https://juejin.cn/post/7293122002724945955</a></p><p>Blogs&#x2F;Androidç¼–è¯‘æ—¶ä¿®æ”¹å­—èŠ‚ç â€”â€”ä»¥Logcatè‡ªåŠ¨æ‰“TAGä¸ºä¾‹.md at master Â· hqzxzwb&#x2F;Blogs: <a href="https://github.com/hqzxzwb/Blogs/blob/master/Android%E7%BC%96%E8%AF%91%E6%97%B6%E4%BF%AE%E6%94%B9%E5%AD%97%E8%8A%82%E7%A0%81%E2%80%94%E2%80%94%E4%BB%A5Logcat%E8%87%AA%E5%8A%A8%E6%89%93TAG%E4%B8%BA%E4%BE%8B.md">https://github.com/hqzxzwb/Blogs/blob/master/Android%E7%BC%96%E8%AF%91%E6%97%B6%E4%BF%AE%E6%94%B9%E5%AD%97%E8%8A%82%E7%A0%81%E2%80%94%E2%80%94%E4%BB%A5Logcat%E8%87%AA%E5%8A%A8%E6%89%93TAG%E4%B8%BA%E4%BE%8B.md</a></p><p>æŸ¥è¯¢æƒé™çš„å®šä¹‰ Manifest.permission ?|? Android Developers: <a href="https://developer.android.com/reference/android/Manifest.permission">https://developer.android.com/reference/android/Manifest.permission</a></p><p>Android ä¸­çš„æƒé™ ?|? Android Developers: <a href="https://developer.android.com/guide/topics/permissions/overview?hl=zh-cn#runtime">https://developer.android.com/guide/topics/permissions/overview?hl=zh-cn#runtime</a></p><p>guolindev&#x2F;PermissionX: An open source Android library that makes handling runtime permissions extremely easy.: <a href="https://github.com/guolindev/PermissionX?tab=readme-ov-file">https://github.com/guolindev/PermissionX?tab=readme-ov-file</a></p><p>Android FBE - é­…æ—å†…æ ¸å›¢é˜Ÿ: <a href="https://kernel.meizu.com/2018/07/12//android-p-fbe.html/">https://kernel.meizu.com/2018/07/12//android-p-fbe.html/</a></p><p>å±•è®¯å¹³å°AndroidPè¿ç§»æŒ‡å¯¼æ–‡æ¡£â€”â€”FBE-ä¸€ç‰›ç½‘è®ºå›: <a href="https://bbs.16rd.com/thread-586509-1-1.html">https://bbs.16rd.com/thread-586509-1-1.html</a></p><p>Support Direct Boot mode ?|? Security ?|? Android Developers: <a href="https://developer.android.com/privacy-and-security/direct-boot">https://developer.android.com/privacy-and-security/direct-boot</a></p><p>directBootAware å’Œ defaultToDeviceProtectedStorage - äº¦å¹» - åšå®¢å›­: <a href="https://www.cnblogs.com/Bolia/p/18361343">https://www.cnblogs.com/Bolia/p/18361343</a></p><p>UserDataPrepareåˆ›å»ºç³»ç»Ÿä»¥åŠåº”ç”¨APPçš„ceå’Œdeç›®å½•çš„æµç¨‹_prepareuserdatali-CSDNåšå®¢: <a href="https://blog.csdn.net/CHALLENG_EVERYTHING/article/details/84654184">https://blog.csdn.net/CHALLENG_EVERYTHING/article/details/84654184</a></p><p>æ•°æ®ç»‘å®šåº“ ?|? Android Developers: <a href="https://developer.android.google.cn/topic/libraries/data-binding?hl=zh-cn">https://developer.android.google.cn/topic/libraries/data-binding?hl=zh-cn</a></p><h2 id="å…¼å®¹æ€§å˜æ›´"><a href="#å…¼å®¹æ€§å˜æ›´" class="headerlink" title="å…¼å®¹æ€§å˜æ›´"></a>å…¼å®¹æ€§å˜æ›´</h2><p>Android Appå…¼å®¹8.0å’Œ9.0_å…¼å®¹åˆ°android 8 android å¼€å‘-CSDNåšå®¢: <a href="https://blog.csdn.net/wxz1179503422/article/details/83031724">https://blog.csdn.net/wxz1179503422/article/details/83031724</a></p><p>è¿™å¯èƒ½æ˜¯æœ€å¥½çš„ Android&#x2F;Kotlinæ—¥å¿—è¾“å‡ºæ–¹æ³• - æŠ€æœ¯å°é»‘å±‹: <a href="https://droidyue.com/blog/2019/11/24/smart-log-in-android-slash-kotlin/">https://droidyue.com/blog/2019/11/24/smart-log-in-android-slash-kotlin/</a></p><p>åˆ¤æ–­æŸAppä½äºå‰å°è¿˜æ˜¯åå°çš„6ç§æ–¹æ³•_åˆ¤æ–­åº”ç”¨æ˜¯å¦åœ¨å‰å°-CSDNåšå®¢: <a href="https://blog.csdn.net/yzwfeng/article/details/124584900">https://blog.csdn.net/yzwfeng/article/details/124584900</a></p><p>Android Appå¦‚ä½•å±è”½ä¸‰æ–¹SDKï¼ˆæ— æ³•ä¿®æ”¹æºç ï¼‰ä¸­Activityçš„è¿”å›äº‹ä»¶ï¼ŸAndroid ä¸­å¦‚ä½•å±è”½ç¬¬ä¸‰æ–¹S - æ˜é‡‘: <a href="https://juejin.cn/post/7387094749931618358">https://juejin.cn/post/7387094749931618358</a></p><h2 id="æ¶æ„"><a href="#æ¶æ„" class="headerlink" title="æ¶æ„"></a>æ¶æ„</h2><p>AndroidNote&#x2F;AdavancedPart&#x2F;Androidå¼€å‘ä¸­çš„MVPæ¨¡å¼è¯¦è§£.md at master Â· CharonChui&#x2F;AndroidNote: <a href="https://github.com/CharonChui/AndroidNote/blob/master/AdavancedPart/Android%E5%BC%80%E5%8F%91%E4%B8%AD%E7%9A%84MVP%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3.md">https://github.com/CharonChui/AndroidNote/blob/master/AdavancedPart/Android%E5%BC%80%E5%8F%91%E4%B8%AD%E7%9A%84MVP%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3.md</a></p><p>[æœ€å…¨]Androidå®‰å“æ¶æ„MVCã€MVPã€MVVMä¹‹é—´çš„åŒºåˆ«å’Œè”ç³»(å›¾è§£+æ¡ˆä¾‹+æºç )_mvcæ¡†æ¶ä¸android-CSDNåšå®¢: <a href="https://blog.csdn.net/wq6ylg08/article/details/105023009">https://blog.csdn.net/wq6ylg08/article/details/105023009</a></p><h2 id="APP"><a href="#APP" class="headerlink" title="APP"></a>APP</h2><p>ä¸€ç§Androidåº”ç”¨å†…å…¨å±€è·å–Contextå®ä¾‹çš„è£…ç½® - ä¸­äºŒç—…ä¹Ÿè¦å¼€å‘ANDROID - SegmentFault æ€å¦: <a href="https://segmentfault.com/a/1190000009015732">https://segmentfault.com/a/1190000009015732</a></p><p>Gsonçš„TypeTokenä¸æ³›å‹æ“¦é™¤é—®é¢˜ åœ¨Javaçš„jsonæ¡†æ¶ä¸­ï¼ŒGsonæ˜¯ä½¿ç”¨å¾—æ¯”è¾ƒå¹¿æ³›çš„ä¸€ä¸ªï¼Œå…¶Gsonç±»æä¾› - æ˜é‡‘: <a href="https://juejin.cn/post/7139889375923585038">https://juejin.cn/post/7139889375923585038</a></p><p>[åŸåˆ›]ä¸€ Android ELFç³»åˆ—:ELFæ–‡ä»¶æ ¼å¼ç®€æåˆ°linkerçš„é“¾æ¥soæ–‡ä»¶åŸç†åˆ†æ-Androidå®‰å…¨-çœ‹é›ª-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|kanxue.com: <a href="https://bbs.kanxue.com/thread-249589-1.htm">https://bbs.kanxue.com/thread-249589-1.htm</a></p><p>ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¥è°ˆè°ˆOkHttp å’Œ Androidå¹³å°æä¾›çš„ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹ .. æ¶ˆè´¹è€… ç”Ÿæˆè€… äº§å“ Andro - æ˜é‡‘: <a href="https://juejin.cn/post/6969193786098483237">https://juejin.cn/post/6969193786098483237</a></p><p>Viewçš„onAttachedToWindowå’ŒonDetachedFromWindowçš„è°ƒç”¨æ—¶æœºåˆ†æ - ç®€ä¹¦: <a href="https://www.jianshu.com/p/e7b6fa788ae6">https://www.jianshu.com/p/e7b6fa788ae6</a></p><p>AndroidUtilCode&#x2F;lib&#x2F;subutil&#x2F;README-CN.md at master Â· Blankj&#x2F;AndroidUtilCode: <a href="https://github.com/Blankj/AndroidUtilCode/blob/master/lib/subutil/README-CN.md">https://github.com/Blankj/AndroidUtilCode/blob/master/lib/subutil/README-CN.md</a></p><p>Android è·å–è®¾å¤‡çš„CPUå‹å·å’Œè®¾å¤‡å‹å· - Stars-one - åšå®¢å›­: <a href="https://www.cnblogs.com/stars-one/p/18066008">https://www.cnblogs.com/stars-one/p/18066008</a></p><p>Android ä¸‹é«˜æ•ˆå¤åˆ¶æ–‡ä»¶çš„æ–¹æ³•-åƒå¤å…«æ–¹çš„åšå®¢: <a href="https://rangotec.com/blog/61.html">https://rangotec.com/blog/61.html</a></p><p>Java implementation of a Disk-based LRU cache which specifically targets Android compatibility(okhttpã€glide): <a href="https://github.com/JakeWharton/DiskLruCache">https://github.com/JakeWharton/DiskLruCache</a></p><p>Androidç¼“å­˜æœºåˆ¶-LRU cacheåŸç†ä¸ç”¨æ³•åœ¨ä½¿ç”¨Androidå›¾ç‰‡åŠ è½½æ¡†æ¶æ—¶ï¼Œç»å¸¸ä¼šæåˆ°ä¸‰çº§ç¼“å­˜ï¼Œå…¶ä¸­ä¸»è¦çš„æ˜¯ - æ˜é‡‘: <a href="https://juejin.cn/post/6844903678474715143">https://juejin.cn/post/6844903678474715143</a></p><p>å…ˆå…¥å…ˆå‡º-FIFOCache | Hutool: <a href="https://doc.hutool.cn/pages/FIFOCache/#%E4%BB%8B%E7%BB%8D">https://doc.hutool.cn/pages/FIFOCache/#%E4%BB%8B%E7%BB%8D</a></p><p>Android å†…å­˜ç¼“å­˜æ¡†æ¶ LruCache çš„å®ç°åŸç†ï¼Œæ‰‹å†™è¯•è¯•ï¼Ÿ - å½­æ—­é” - åšå®¢å›­: <a href="https://www.cnblogs.com/pengxurui/p/16948336.html">https://www.cnblogs.com/pengxurui/p/16948336.html</a></p><h2 id="UI"><a href="#UI" class="headerlink" title="UI"></a>UI</h2><p>Androidäº”å¤§å¸¸ç”¨å¸ƒå±€ï¼šFrameLayoutã€LinearLayoutã€ConstraintLayout ã€TableLayoutå’ŒRelativeLayout - subeiLY - åšå®¢å›­: <a href="https://www.cnblogs.com/gh110/p/12489701.html#RelativeLayout%EF%BC%88%E7%9B%B8%E5%AF%B9%E5%B8%83%E5%B1%80%EF%BC%89">https://www.cnblogs.com/gh110/p/12489701.html#RelativeLayout%EF%BC%88%E7%9B%B8%E5%AF%B9%E5%B8%83%E5%B1%80%EF%BC%89</a></p><p>Android Viewçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°æ€»ç»“_android springanimation æ”¾å¤§viewç”Ÿå‘½å‘¨æœŸ-CSDNåšå®¢: <a href="https://blog.csdn.net/nihaomabmt/article/details/109777372">https://blog.csdn.net/nihaomabmt/article/details/109777372</a></p><p>Android ç®€å•çš„ Dialog é˜Ÿåˆ— | aitsuki: <a href="https://aitsuki.com/blog/android-dialog-queue/">https://aitsuki.com/blog/android-dialog-queue/</a></p><p>Android åŒæ­¥çš„ Dialog | aitsuki: <a href="https://aitsuki.com/blog/android-synchronous-dialog/">https://aitsuki.com/blog/android-synchronous-dialog/</a></p><p>Android å¼€å‘ç»•ä¸è¿‡çš„å‘ï¼šä½ çš„ Bitmap ç©¶ç«Ÿå å¤šå¤§å†…å­˜ï¼Ÿ: <a href="https://mp.weixin.qq.com/s?__biz=MzA3NTYzODYzMg==&mid=403263974&idx=1&sn=b0315addbc47f3c38e65d9c633a12cd6&scene=0#wechat_redirect">https://mp.weixin.qq.com/s?__biz=MzA3NTYzODYzMg==&amp;mid=403263974&amp;idx=1&amp;sn=b0315addbc47f3c38e65d9c633a12cd6&amp;scene=0#wechat_redirect</a></p><p>æ”¯æŒä¸åŒçš„åƒç´ å¯†åº¦ ?|? Android Developers: <a href="https://developer.android.com/training/multiscreen/screendensities?hl=zh-cn">https://developer.android.com/training/multiscreen/screendensities?hl=zh-cn</a></p><p>Android mipmapä¸­çš„å›¾æ ‡icon å¯¹åº”çš„å°ºå¯¸å¤§å°_android mipmap å¤§å°-CSDNåšå®¢: <a href="https://blog.csdn.net/qq_32227681/article/details/122232039">https://blog.csdn.net/qq_32227681/article/details/122232039</a></p><p>android res èµ„æºåŒ¹é…ç›®å½• ã€ drawableä¸ mipmapçš„åŒºåˆ« - ç®€ä¹¦: <a href="https://www.jianshu.com/p/6743f4303321">https://www.jianshu.com/p/6743f4303321</a></p><h2 id="hook"><a href="#hook" class="headerlink" title="hook"></a>hook</h2><p>Android æ€§èƒ½ä¼˜åŒ–ä¹‹é»‘ç§‘æŠ€å¼€é“ï¼ˆä¸€ï¼‰ç”µè§†ç³»ç»ŸåŸæœ¬å‰©ä½™çš„å¯ç”¨èµ„æºå°±å°‘ï¼Œè€Œéšç€ 9.0 åŠŸèƒ½çš„è¿›ä¸€æ­¥å¢å¤šï¼Œç‰¹åˆ«æ˜¯é—¨é“ƒã€ - æ˜é‡‘: <a href="https://juejin.cn/post/7353442647765991435">https://juejin.cn/post/7353442647765991435</a></p><p>canyie&#x2F;pine: Dynamic java method hook framework on ART. Allowing you to change almost all java methodsâ€™ behavior dynamically.: <a href="https://github.com/canyie/pine">https://github.com/canyie/pine</a></p><p>sanfengAndroid&#x2F;fake-linker: Modify Android linker to provide loading module and hook function: <a href="https://github.com/sanfengAndroid/fake-linker">https://github.com/sanfengAndroid/fake-linker</a></p><p>[åŸåˆ›]ä¸€ç§é€šç”¨è¶…ç®€å•çš„Android Java Nativeæ–¹æ³•Hookï¼Œæ— éœ€ä¾èµ–Hookæ¡†æ¶-Androidå®‰å…¨-çœ‹é›ª-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|kanxue.com: <a href="https://bbs.kanxue.com/thread-266238.htm">https://bbs.kanxue.com/thread-266238.htm</a></p><h2 id="å¼€æºåº“"><a href="#å¼€æºåº“" class="headerlink" title="å¼€æºåº“"></a>å¼€æºåº“</h2><p>Tencent&#x2F;mars: Mars is a cross-platform network component developed by WeChat.: <a href="https://github.com/Tencent/mars">https://github.com/Tencent/mars</a></p><h4 id="xlog"><a href="#xlog" class="headerlink" title="xlog"></a>xlog</h4><p>Home Â· Tencent&#x2F;mars Wiki: <a href="https://github.com/Tencent/mars/wiki">https://github.com/Tencent/mars/wiki</a></p><p>Mars Android æ¥å…¥æŒ‡å— Â· Tencent&#x2F;mars Wiki: <a href="https://github.com/Tencent/mars/wiki/Mars-Android-%E6%8E%A5%E5%85%A5%E6%8C%87%E5%8D%97">https://github.com/Tencent/mars/wiki/Mars-Android-%E6%8E%A5%E5%85%A5%E6%8C%87%E5%8D%97</a></p><p>è…¾è®¯ Xlog ä¸Šæ‰‹æŒ‡å—_com.tencent.mars:mars-xlog-CSDNåšå®¢: <a href="https://blog.csdn.net/qian520ao/article/details/88047573">https://blog.csdn.net/qian520ao/article/details/88047573</a></p><p>Mars Android æ¥å£è¯¦ç»†è¯´æ˜ Â· Tencent&#x2F;mars Wiki: <a href="https://github.com/Tencent/mars/wiki/Mars-Android-%E6%8E%A5%E5%8F%A3%E8%AF%A6%E7%BB%86%E8%AF%B4%E6%98%8E">https://github.com/Tencent/mars/wiki/Mars-Android-%E6%8E%A5%E5%8F%A3%E8%AF%A6%E7%BB%86%E8%AF%B4%E6%98%8E</a></p><p>AndroidåŸºäºå¾®ä¿¡ xlog å¼€æº æ—¥å¿—æ¡†æ¶ - IM Geekå¼€å‘è€…ç¤¾åŒº-ç§»åŠ¨å¼€å‘è€…ç¤¾åŒº-å¼€æºç¤¾åŒº-IM Geekå®˜ç½‘: <a href="https://www.imgeek.net/article/825357157">https://www.imgeek.net/article/825357157</a></p><p>win10ä¸‹è…¾è®¯ marsä¸‹xlogç¼–è¯‘è¯¦è§£ - ç®€ä¹¦: <a href="https://www.jianshu.com/p/61b9ffc1d688">https://www.jianshu.com/p/61b9ffc1d688</a></p><p>Windowsä¸‹å®‰è£…cygwin_cygwin win ä¸‹è½½-CSDNåšå®¢: <a href="https://blog.csdn.net/EthanCo/article/details/104375839">https://blog.csdn.net/EthanCo/article/details/104375839</a></p><p>Android Mars XLogçš„ç¼–è¯‘-CSDNåšå®¢: <a href="https://blog.csdn.net/EthanCo/article/details/104375215">https://blog.csdn.net/EthanCo/article/details/104375215</a></p><p>ä»Marsçš„Xlogç»„ä»¶å­¦ä¹ æ—¥å¿—ç³»ç»Ÿ - ç®€ä¹¦: <a href="https://www.jianshu.com/p/f53b4575d3ae">https://www.jianshu.com/p/f53b4575d3ae</a></p><p>è…¾è®¯mars xlogæºç è§£æ_è…¾è®¯ mars-CSDNåšå®¢: <a href="https://blog.csdn.net/qq372848728/article/details/89215295">https://blog.csdn.net/qq372848728/article/details/89215295</a></p><p>Tencent Mars æºç è§£æ | Edgarâ€™s Blog: <a href="https://tbfungeek.github.io/2019/12/05/Tencent-Mars-%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">https://tbfungeek.github.io/2019/12/05/Tencent-Mars-%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</a></p><p>Add python 3 support to decode_mars_nocrypt_log_file.py by ChaseChoi Â· Pull Request #1048 Â· Tencent&#x2F;mars: <a href="https://github.com/Tencent/mars/pull/1048">https://github.com/Tencent/mars/pull/1048</a></p><p>ChaseChoi&#x2F;mars: Mars is a cross-platform network component developed by WeChat.: <a href="https://github.com/ChaseChoi/mars">https://github.com/ChaseChoi/mars</a> ï¼ˆè§£æxlog pythonï¼‰</p><p>Android Mars XLog è‡ªå®šä¹‰å­˜å‚¨æ ¼å¼_android xlog-CSDNåšå®¢: <a href="https://blog.csdn.net/EthanCo/article/details/104378841">https://blog.csdn.net/EthanCo/article/details/104378841</a></p><p>xLogæ—¥å¿—æ–‡ä»¶å†™å…¥æ”¹æˆ24å°æ—¶åˆ¶_xlogæ—¶é—´-CSDNåšå®¢: <a href="https://blog.csdn.net/qq_35662742/article/details/78830895">https://blog.csdn.net/qq_35662742/article/details/78830895</a></p><p>æ—¥å¿—ä¸¢å¤±é—®é¢˜ã€‚ Â· Issue #1109 Â· Tencent&#x2F;mars: <a href="https://github.com/Tencent/mars/issues/1109">https://github.com/Tencent/mars/issues/1109</a></p><p>æ¥å…¥ Mars XLog çš„åå·å†ç¨‹: <a href="https://kentl.dev/post/mars-xlog/">https://kentl.dev/post/mars-xlog/</a></p><p>ä¿®æ”¹mars-xlog æºç å¹¶ç¼–è¯‘æˆsoæ–‡ä»¶ï¼ˆå…¨ç¨‹è®°å½•ï¼‰-å°ç‹åŒå­¦: <a href="https://amarantos-blog.cn/archives/modify-and-compile-xlog">https://amarantos-blog.cn/archives/modify-and-compile-xlog</a></p><p>xlogä½¿ç”¨-CSDNåšå®¢: <a href="https://blog.csdn.net/ming54ming/article/details/122528580">https://blog.csdn.net/ming54ming/article/details/122528580</a></p><p>XLogæ—¥å¿—ç»„ä»¶çš„å­¦ä¹ å’Œä½¿ç”¨é¦–å…ˆç®€ç®€å•å•ä»‹ç»ä¸€ä¸‹XLogå§ï¼Œå› ä¸ºæˆ‘ä¸ªäººä¹Ÿä¸æ˜¯ç‰¹åˆ«äº†è§£ï¼Œæ‰€ä»¥å°±ç®€ç®€å•å•è¯´ä¸€ä¸‹ï¼Œä½œä¸ºå¾®ä¿¡å¼€æº - æ˜é‡‘: <a href="https://juejin.cn/post/6855454731716952078">https://juejin.cn/post/6855454731716952078</a></p><p>marsçš„xlogæ—¥å¿—æ–‡ä»¶è§£æä»¥åŠæ—¥å¿—æŸ¥çœ‹å·¥å…·ä»‹ç» - ç®€ä¹¦: <a href="https://www.jianshu.com/p/21eab5b59676">https://www.jianshu.com/p/21eab5b59676</a></p><p>Android å¾®ä¿¡é«˜æ€§èƒ½æ—¥å¿—å­˜å‚¨åº“Xlogçš„ä½¿ç”¨-CSDNåšå®¢: <a href="https://blog.csdn.net/EthanCo/article/details/104374108">https://blog.csdn.net/EthanCo/article/details/104374108</a></p><p>luojilab&#x2F;DataTransHub: è·¨å¹³å°Android&#x2F;iOSæµ·é‡æ•°æ®ä¸ŠæŠ¥ç»„ä»¶ï¼ŒåŸºäºXlogå®Œå–„ï¼Œè§£å†³Xlogç—›ç‚¹é—®é¢˜ã€‚: <a href="https://github.com/luojilab/DataTransHub">https://github.com/luojilab/DataTransHub</a></p><p>å¼€æºç³»åˆ— | åŸºäºå¾®ä¿¡XLogçš„æ—¥å¿—æ¡†æ¶&amp;&amp;å¯¹äºXLogçš„åˆ†æä¹‹å‰å†™è¿‡ä¸€ä¸ª æ—¥å¿—æ¡†æ¶LogHelper ,æ˜¯åŸºäº Lo - æ˜é‡‘: <a href="https://juejin.cn/post/6850418121279438855">https://juejin.cn/post/6850418121279438855</a></p><h2 id="APM"><a href="#APM" class="headerlink" title="APM"></a>APM</h2><p>Android Native å¼‚å¸¸æ•è·åº“Android Native å¼‚å¸¸æ•è·åº“ åŸºäºgoogle&#x2F;breakpa, è®© - æ˜é‡‘: <a href="https://juejin.cn/post/7067052595331727390">https://juejin.cn/post/7067052595331727390</a></p><h2 id="æŠ•å±"><a href="#æŠ•å±" class="headerlink" title="æŠ•å±"></a>æŠ•å±</h2><h3 id="DLNA"><a href="#DLNA" class="headerlink" title="DLNA"></a>DLNA</h3><p>AndroidNote&#x2F;VideoDevelopment&#x2F;AndroidéŸ³è§†é¢‘å¼€å‘&#x2F;DLNAç®€ä»‹.md at master Â· CharonChui&#x2F;AndroidNote: <a href="https://github.com/CharonChui/AndroidNote/blob/master/VideoDevelopment/Android%E9%9F%B3%E8%A7%86%E9%A2%91%E5%BC%80%E5%8F%91/DLNA%E7%AE%80%E4%BB%8B.md">https://github.com/CharonChui/AndroidNote/blob/master/VideoDevelopment/Android%E9%9F%B3%E8%A7%86%E9%A2%91%E5%BC%80%E5%8F%91/DLNA%E7%AE%80%E4%BB%8B.md</a></p><p>lebosdk&#x2F;LelinkSource-android: <a href="https://github.com/lebosdk/LelinkSource-android">https://github.com/lebosdk/LelinkSource-android</a></p><h2 id="è°ƒè¯•å‘½ä»¤"><a href="#è°ƒè¯•å‘½ä»¤" class="headerlink" title="è°ƒè¯•å‘½ä»¤"></a>è°ƒè¯•å‘½ä»¤</h2><h1 id="å®‰å…¨"><a href="#å®‰å…¨" class="headerlink" title="å®‰å…¨"></a>å®‰å…¨</h1><p>Android SoåŠ¨æ€åŠ è½½åŸç†åˆ†æä¸ä¼˜é›…å®ç° - AndroidSummary: <a href="https://androidsummary.gitbook.io/androidsummary/manpin/xiaoshuointroduction/sodynamicload">https://androidsummary.gitbook.io/androidsummary/manpin/xiaoshuointroduction/sodynamicload</a></p><p>androidç­¾åè¯ä¹¦æ–‡ä»¶çš„è§£æå’Œç­¾åæ ¡éªŒçš„åŠ å¼º - liwugang: <a href="https://liwugang.github.io/2016/02/21/android_verify_apk.html">https://liwugang.github.io/2016/02/21/android_verify_apk.html</a></p><p>æŒ‚è½½å‘½åç©ºé—´ ä¸ å…±äº«å­æ ‘ åœ¨ Android ä¸­çš„åº”ç”¨ - LibXZR çš„å°æœ¬æœ¬: <a href="https://blog.xzr.moe/archives/194/">https://blog.xzr.moe/archives/194/</a></p><p>Android ä¹‹ ä¸€ç§ä»¥ç‰¹å®šåº”ç”¨èº«ä»½æ‰§è¡Œæ“ä½œçš„æ–¹å¼ - LibXZR çš„å°æœ¬æœ¬: <a href="https://blog.xzr.moe/archives/195/">https://blog.xzr.moe/archives/195/</a></p><p>sepolicyè¿›é˜¶å°è®° - LibXZR çš„å°æœ¬æœ¬: <a href="https://blog.xzr.moe/archives/111/">https://blog.xzr.moe/archives/111/</a></p><p>selinux contexts å®‰å…¨ä¸Šä¸‹æ–‡çš„ä¸´æ—¶æ›´æ”¹ - è¡Œèµ°çš„æ€æƒ³ - åšå®¢å›­: <a href="https://www.cnblogs.com/onelikeone/p/14978651.html">https://www.cnblogs.com/onelikeone/p/14978651.html</a></p><p>ã€androidã€‘ ä½¿ç”¨vpnå®ç°æŠ“åŒ… | iTimeTraveler: <a href="https://itimetraveler.github.io/2019/07/25/%E3%80%90Android%E3%80%91%E4%BD%BF%E7%94%A8VPN%E5%AE%9E%E7%8E%B0%E6%8A%93%E5%8C%85/?hmsr=joyk.com&utm_source=joyk.com&utm_medium=referral">https://itimetraveler.github.io/2019/07/25/%E3%80%90Android%E3%80%91%E4%BD%BF%E7%94%A8VPN%E5%AE%9E%E7%8E%B0%E6%8A%93%E5%8C%85/?hmsr=joyk.com&amp;utm_source=joyk.com&amp;utm_medium=referral</a></p><p>Gptå‘Šè¯‰ä½ å¦‚ä½•é€šè¿‡ä»£ç è·å–å®‰å“rootæƒé™å¹¶åˆ›å»ºè™šæ‹Ÿç½‘å¡ - æ–¹ä¸œä¿¡ - åšå®¢å›­: <a href="https://www.cnblogs.com/cfas/p/17253314.html">https://www.cnblogs.com/cfas/p/17253314.html</a></p><h2 id="æƒé™"><a href="#æƒé™" class="headerlink" title="æƒé™"></a>æƒé™</h2><p>Androidï¼ˆ6-13ï¼‰é€‚é…Android?6 1ã€è¿è¡Œæ—¶æƒé™ android6.0ä»¥å‰ï¼Œæˆ‘ä»¬æŠŠappéœ€è¦ç”¨åˆ°çš„æƒé™å…¨ - æ˜é‡‘: <a href="https://juejin.cn/post/7203310104011456573">https://juejin.cn/post/7203310104011456573</a></p><h1 id="é€†å‘"><a href="#é€†å‘" class="headerlink" title="é€†å‘"></a>é€†å‘</h1><p>[åŸåˆ›]dvmæ¢è®¨ä¹‹odexç»•è¿‡-Androidå®‰å…¨-çœ‹é›ª-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|kanxue.com: <a href="https://bbs.kanxue.com/thread-209631.htm">https://bbs.kanxue.com/thread-209631.htm</a></p><p>Linux ä¸‹å¦‚ä½•éšè—è‡ªå·±ä¸è¢«å‘ç°ï¼Ÿ - liwugang: <a href="https://liwugang.github.io/2020/03/22/hide_process.html">https://liwugang.github.io/2020/03/22/hide_process.html</a></p><p>Androidä¸­è¿›ç¨‹æ³¨å…¥(ä¸€) - ç®€ä¹¦: <a href="https://www.jianshu.com/p/0f8e999344af">https://www.jianshu.com/p/0f8e999344af</a></p><p>Androidç³»ç»Ÿç¯‡ä¹‹â€”-Hookç³»ç»Ÿçš„AMSæœåŠ¡å®ç°åº”ç”¨å¯åŠ¨çš„æ‹¦æˆªåŠŸèƒ½ | å°¼å¤æ‹‰æ–¯.èµµå››: <a href="http://www.520monkey.com/archives/870">http://www.520monkey.com/archives/870</a></p><p>Android å… root å®ç° hook ç³»ç»ŸæœåŠ¡æ‹¦æˆªæ–¹æ³• | Agehua: <a href="https://conorlee.top/2017/07/12/android-noroot-hook/">https://conorlee.top/2017/07/12/android-noroot-hook/</a></p><h2 id="ebpf"><a href="#ebpf" class="headerlink" title="ebpf"></a>ebpf</h2><p>åœ¨ Android ä¸­ä½¿ç”¨ eBPFï¼šå¼€ç¯‡ | Weishuâ€™s Notes: <a href="https://weishu.me/2022/06/12/eBPF-on-Android/">https://weishu.me/2022/06/12/eBPF-on-Android/</a></p><p>60ç§’å­¦ä¼šç”¨eBPF-BCC hookç³»ç»Ÿè°ƒç”¨ hookå®‰å“æ‰€æœ‰syscall - ç½‘å®‰ - ä¸“ä¸šçš„ç½‘ç»œå®‰å…¨äº§ä¸šã€ç¤¾åŒºã€çŸ¥è¯†å¹³å°: <a href="https://www.wangan.com/p/11v6c44b6a74cb70">https://www.wangan.com/p/11v6c44b6a74cb70</a></p><p>Android-eBPFç›‘æ§æ‰€æœ‰ç³»ç»Ÿè°ƒç”¨ | Shocker: <a href="https://pshocker.github.io/2022/06/18/Android-eBPF%E7%9B%91%E6%8E%A7%E6%89%80%E6%9C%89%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8/">https://pshocker.github.io/2022/06/18/Android-eBPF%E7%9B%91%E6%8E%A7%E6%89%80%E6%9C%89%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8/</a></p><h1 id="Android-TV"><a href="#Android-TV" class="headerlink" title="Android TV"></a>Android TV</h1><p>Android Pixel Calculator: <a href="https://angrytools.com/android/pixelcalc/">https://angrytools.com/android/pixelcalc/</a></p><p>åƒç´ è®¡ç®—å™¨: <a href="https://www.zelyo.cn/tools/Pixelcal/Pixelcal.html">https://www.zelyo.cn/tools/Pixelcal/Pixelcal.html</a></p><p>Androidå±å¹•é€‚é…æ€»ç»“å¥½ä¹…ä¹‹å‰å°±æƒ³å†™ä¸€ç¯‡è·Ÿå±å¹•é€‚é…ç›¸å…³çš„æ–‡ç« ä¸€ç›´æ²¡æœ‰åŠ¨ç¬”ï¼Œè¿™æ¬¡ä¸‹å†³å¿ƒæŠ½å‘¨æœ«çš„æ—¶é—´ç»“åˆæˆ‘åœ¨å®é™…é¡¹ç›®ä¸­æ‰€ - æ˜é‡‘: <a href="https://juejin.cn/post/6844904064392626189">https://juejin.cn/post/6844904064392626189</a></p><p>Android TV å±å¹•é€‚é…_androidtvå±å¹•é€‚é…-CSDNåšå®¢: <a href="https://blog.csdn.net/newairzhang/article/details/62062020">https://blog.csdn.net/newairzhang/article/details/62062020</a></p><p>Android TVå¼€å‘æ€»ç»“ã€é€‚é…ã€‘-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘: <a href="https://cloud.tencent.com/developer/article/1385737">https://cloud.tencent.com/developer/article/1385737</a></p><p>Android TVå¼€å‘æ€»ç»“ï¼ˆäº”ï¼‰TVä¸Šå±å¹•é€‚é…æ€»ç»“_android två±å¹•é€‚é…-CSDNåšå®¢: <a href="https://blog.csdn.net/hejjunlin/article/details/52886107">https://blog.csdn.net/hejjunlin/article/details/52886107</a></p><p>mlabalabala&#x2F;box: TVBoxçš„ä¸€ä¸ªå¯ä»¥å¤„ç†å¤šæºçš„ç‰ˆæœ¬ï¼Œæ”¯æŒå®‰å“4.4: <a href="https://github.com/mlabalabala/box">https://github.com/mlabalabala/box</a></p><p>Androidç”µè§†é…ç½®é¥æ§å™¨æˆ–è€…ä¿®æ”¹é¥æ§å™¨æŒ‰é”® - ç®€ä¹¦: <a href="https://www.jianshu.com/p/5a4b97d9b963">https://www.jianshu.com/p/5a4b97d9b963</a></p><p>Android ç³»ç»Ÿé¥æ§å™¨åŒ¹é…klæ–‡ä»¶_é¥æ§å™¨klæ–‡ä»¶çœ‹ä¸åˆ°-CSDNåšå®¢: <a href="https://blog.csdn.net/angelsmiling/article/details/105306388#:~:text=%E6%88%91%E4%BB%AC%E5%9C%A8%E8%BE%93%E5%85%A5getevent%20-l%20%E5%91%BD%E4%BB%A4%E7%9A%84%E6%97%B6%E5%80%99%E5%86%8D%E6%8C%89%E9%81%A5%E6%8E%A7%E5%99%A8%E9%94%AE%E5%80%BC%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8C%E5%B0%B1%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0%E6%96%B0%E5%A2%9E%E4%BA%86%E4%BB%A5%2Fdev%2Finput%2Fevent0%E5%BC%80%E5%A4%B4%E7%9A%84%E4%B8%A4%E5%88%97%E6%95%B0%E6%8D%AE%EF%BC%8C%E8%80%8Cevent0%E5%AF%B9%E5%BA%94%E7%9A%84%E6%98%AF%E4%BB%A5ce_keypad%E5%90%8D%E5%AD%97%E7%9A%84%E8%AE%BE%E5%A4%87%EF%BC%8C%E7%84%B6%E5%90%8E%E6%88%91%E4%BB%AC%E5%86%8D%E5%8E%BB%E7%AC%AC%E4%B8%80%E6%AD%A5%E4%B8%AD%E6%89%BE%EF%BC%8C%E5%B0%B1%E5%8F%AF%E4%BB%A5%E7%A1%AE%E5%AE%9A%E9%81%A5%E6%8E%A7%E5%99%A8%E7%9A%84kl%E6%96%87%E4%BB%B6%E7%9A%84Vendor%3D0001,Product%3D0001%20Version%3D0100%E4%BA%86%EF%BC%8C%E6%9C%80%E7%BB%88%E5%8F%AF%E4%BB%A5%E7%A1%AE%E5%AE%9A%E5%8C%B9%E9%85%8D%E7%9A%84kl%E6%96%87%E4%BB%B6%E4%B8%BA%EF%BC%9AVendor_0001_Product_0001%20%28_Version_0100%29.kl%E3%80%82">https://blog.csdn.net/angelsmiling/article/details/105306388#:~:text=%E6%88%91%E4%BB%AC%E5%9C%A8%E8%BE%93%E5%85%A5getevent%20-l%20%E5%91%BD%E4%BB%A4%E7%9A%84%E6%97%B6%E5%80%99%E5%86%8D%E6%8C%89%E9%81%A5%E6%8E%A7%E5%99%A8%E9%94%AE%E5%80%BC%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8C%E5%B0%B1%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0%E6%96%B0%E5%A2%9E%E4%BA%86%E4%BB%A5%2Fdev%2Finput%2Fevent0%E5%BC%80%E5%A4%B4%E7%9A%84%E4%B8%A4%E5%88%97%E6%95%B0%E6%8D%AE%EF%BC%8C%E8%80%8Cevent0%E5%AF%B9%E5%BA%94%E7%9A%84%E6%98%AF%E4%BB%A5ce_keypad%E5%90%8D%E5%AD%97%E7%9A%84%E8%AE%BE%E5%A4%87%EF%BC%8C%E7%84%B6%E5%90%8E%E6%88%91%E4%BB%AC%E5%86%8D%E5%8E%BB%E7%AC%AC%E4%B8%80%E6%AD%A5%E4%B8%AD%E6%89%BE%EF%BC%8C%E5%B0%B1%E5%8F%AF%E4%BB%A5%E7%A1%AE%E5%AE%9A%E9%81%A5%E6%8E%A7%E5%99%A8%E7%9A%84kl%E6%96%87%E4%BB%B6%E7%9A%84Vendor%3D0001,Product%3D0001%20Version%3D0100%E4%BA%86%EF%BC%8C%E6%9C%80%E7%BB%88%E5%8F%AF%E4%BB%A5%E7%A1%AE%E5%AE%9A%E5%8C%B9%E9%85%8D%E7%9A%84kl%E6%96%87%E4%BB%B6%E4%B8%BA%EF%BC%9AVendor_0001_Product_0001%20%28_Version_0100%29.kl%E3%80%82</a></p><p>Android10 ï¼ˆ.klï¼‰æŒ‰é”®å¸ƒå±€æ–‡ä»¶çš„è§£æè¿‡ç¨‹åˆ†æ_generic.kl-CSDNåšå®¢: <a href="https://blog.csdn.net/weixin_44904296/article/details/112566710">https://blog.csdn.net/weixin_44904296/article/details/112566710</a></p><p>Androidæºç è§£æï¼ˆäºŒåä¹ï¼‰â€“&gt;åº”ç”¨ç¨‹åºè¿”å›æŒ‰é”®æ‰§è¡Œæµç¨‹_androidåº”ç”¨è¿”å›å¤„ç†æµç¨‹-CSDNåšå®¢: <a href="https://blog.csdn.net/qq_23547831/article/details/51513771">https://blog.csdn.net/qq_23547831/article/details/51513771</a></p><h1 id="NDK"><a href="#NDK" class="headerlink" title="NDK"></a>NDK</h1><p>å®‰å“soç‰ˆæœ¬ndkç‰ˆæœ¬æŸ¥çœ‹ä»¥åŠstripå‘½ä»¤çš„ä½¿ç”¨_so strip-CSDNåšå®¢: <a href="https://blog.csdn.net/lzz137/article/details/114830319">https://blog.csdn.net/lzz137/article/details/114830319</a></p><p>Cè¯­è¨€è°ƒç”¨soåŠ¨æ€åº“çš„ä¸¤ç§æ–¹å¼_cè¯­è¨€åŠ è½½so-CSDNåšå®¢: <a href="https://blog.csdn.net/shaosunrise/article/details/81161064">https://blog.csdn.net/shaosunrise/article/details/81161064</a></p><p>Android Cmake å¢åŠ ç¬¬ä¸‰æ–¹åº“çš„ä¾èµ–_libmarsxlog.so-CSDNåšå®¢: <a href="https://blog.csdn.net/ImTryCatchException/article/details/134306328">https://blog.csdn.net/ImTryCatchException/article/details/134306328</a></p><p>è°ƒè¯•å’Œå‡å°‘å†…å­˜é”™è¯¯ ?|? Android NDK ?|? Android Developers: <a href="https://developer.android.com/ndk/guides/memory-debug?hl=zh-cn">https://developer.android.com/ndk/guides/memory-debug?hl=zh-cn</a></p><p>JNIå¸¸è§ç±»å‹ä¼ å‚_jni jobject ä¼ å‚-CSDNåšå®¢: <a href="https://blog.csdn.net/duanchuadnong/article/details/116655308">https://blog.csdn.net/duanchuadnong/article/details/116655308</a></p><p>JNIä¸C++çš„æ•°æ®ç±»å‹è½¬æ¢_jboolean-CSDNåšå®¢: <a href="https://blog.csdn.net/u014300915/article/details/52916086">https://blog.csdn.net/u014300915/article/details/52916086</a></p><p>snprintf å‡½æ•°ç”¨æ³•è¯¦è§£-CSDNåšå®¢: <a href="https://blog.csdn.net/m0_50668851/article/details/110000520">https://blog.csdn.net/m0_50668851/article/details/110000520</a></p><p>ã€Cmakeã€‘åˆ©ç”¨NDKè¿›è¡ŒAndroidçš„äº¤å‰ç¼–è¯‘ï¼ˆé™„å®ä¾‹ï¼‰_android ndk äº¤å‰ç¼–è¯‘-CSDNåšå®¢: <a href="https://blog.csdn.net/qq_38410730/article/details/103622813">https://blog.csdn.net/qq_38410730/article/details/103622813</a></p><p>NDK ä¿®è®¢å†å²è®°å½• ?|? Android NDK ?|? Android Developers: <a href="https://developer.android.com/ndk/downloads/revision_history?hl=zh-cn">https://developer.android.com/ndk/downloads/revision_history?hl=zh-cn</a> (æ¯ä¸ªNDKç‰ˆæœ¬æ‰€æ”¯æŒAPIçº§åˆ«å¯ä»¥é€šè¿‡NDKè§£å‹ç¼©åŒ…ä¸­platformsç›®å½•æŸ¥çœ‹)</p><p>Android-NDKå¼€å‘ä¹‹æ¦‚è¿° | è‹è€³çš„åšå®¢: <a href="https://ljd1996.github.io/2021/06/01/Android-NDK%E5%BC%80%E5%8F%91%E4%B9%8B%E6%A6%82%E8%BF%B0/">https://ljd1996.github.io/2021/06/01/Android-NDK%E5%BC%80%E5%8F%91%E4%B9%8B%E6%A6%82%E8%BF%B0/</a></p><p>Android-NDKå¼€å‘ä¹‹JNI | è‹è€³çš„åšå®¢: <a href="https://ljd1996.github.io/2021/06/01/Android-NDK%E5%BC%80%E5%8F%91%E4%B9%8BJNI/">https://ljd1996.github.io/2021/06/01/Android-NDK%E5%BC%80%E5%8F%91%E4%B9%8BJNI/</a></p><p>Android JNIæ‰‹å†Œâ€”â€”Java&#x2F;Kotlinä¸Nativeå±‚çš„ç›¸äº’è°ƒç”¨_kotlin external fun-CSDNåšå®¢: <a href="https://blog.csdn.net/ma598214297/article/details/106456535">https://blog.csdn.net/ma598214297/article/details/106456535</a></p><p>Android Gradle æ’ä»¶å¯ä»¥ä½¿ç”¨çš„åŸç”Ÿä¾èµ–é¡¹ ?|? Android Studio ?|? Android Developers: <a href="https://developer.android.com/build/native-dependencies?hl=zh-cn&agpversion=4.0">https://developer.android.com/build/native-dependencies?hl=zh-cn&amp;agpversion=4.0</a></p><p>Android Cmake å¢åŠ ç¬¬ä¸‰æ–¹åº“çš„ä¾èµ–_libmarsxlog.so-CSDNåšå®¢: <a href="https://blog.csdn.net/ImTryCatchException/article/details/134306328">https://blog.csdn.net/ImTryCatchException/article/details/134306328</a></p><p>Kotlin å’Œ Java ä¸­å†…éƒ¨ç±»ä¸­çš„ static native æ–¹æ³•ï¼ˆJNI å‡½æ•°ï¼‰-CSDNåšå®¢: <a href="https://blog.csdn.net/u013553529/article/details/124478522">https://blog.csdn.net/u013553529/article/details/124478522</a></p><p>JNIå†…å­˜æ–¹é¢è¯´æ˜ä»¥åŠç›¸å…³ç±»å‹æ‰‹åŠ¨é‡Šæ”¾å†…å­˜-é˜¿é‡Œäº‘å¼€å‘è€…ç¤¾åŒº: <a href="https://developer.aliyun.com/article/1112357">https://developer.aliyun.com/article/1112357</a></p><p>7.JNI å†…å­˜æ³„æ¼ å¤„ç† æ–¹æ³•æ€»ç»“_jni string è¿”å›å€¼ä¼šå¯¼è‡´å†…å­˜æ³„æ¼å—-CSDNåšå®¢: <a href="https://blog.csdn.net/a2241076850/article/details/81092211">https://blog.csdn.net/a2241076850/article/details/81092211</a></p><p>Link Gradle to your native library ?|? Android Studio ?|? Android Developers: <a href="https://developer.android.com/studio/projects/gradle-external-native-builds">https://developer.android.com/studio/projects/gradle-external-native-builds</a></p><h1 id="Android-OS"><a href="#Android-OS" class="headerlink" title="Android OS"></a>Android OS</h1><p>AOSPæºç å®šåˆ¶-soæ³¨å…¥å¹¶é›†æˆhookæ¡†æ¶ - gakkkkkkiii: <a href="https://www.c0bra.xyz/2023/12/28/AOSP%E6%BA%90%E7%A0%81%E5%AE%9A%E5%88%B6-so%E6%B3%A8%E5%85%A5%E5%B9%B6%E9%9B%86%E6%88%90hook%E6%A1%86%E6%9E%B6/">https://www.c0bra.xyz/2023/12/28/AOSP%E6%BA%90%E7%A0%81%E5%AE%9A%E5%88%B6-so%E6%B3%A8%E5%85%A5%E5%B9%B6%E9%9B%86%E6%88%90hook%E6%A1%86%E6%9E%B6/</a></p><p>androidä½¿ç”¨logwrapperè¿›è¡Œlogé‡å®šå‘_android logwrapper-CSDNåšå®¢: <a href="https://blog.csdn.net/rikeyone/article/details/80307975">https://blog.csdn.net/rikeyone/article/details/80307975</a></p><p>Android HookæŠ€æœ¯é˜²èŒƒæ¼«è°ˆ - ç¾å›¢æŠ€æœ¯å›¢é˜Ÿ: <a href="https://tech.meituan.com/2018/02/02/android-anti-hooking.html">https://tech.meituan.com/2018/02/02/android-anti-hooking.html</a></p><p>jmpews&#x2F;Dobby: a lightweight, multi-platform, multi-architecture hook framework.: <a href="https://github.com/jmpews/Dobby">https://github.com/jmpews/Dobby</a></p><p>Android å¯¹ so è¿›è¡Œç®€å• hook - Androidç¤¾åŒº - <a href="https://www.androidos.net.cn/">https://www.androidos.net.cn/</a>: <a href="https://www.androidos.net.cn/doc/2023/76146513.html">https://www.androidos.net.cn/doc/2023/76146513.html</a></p><p>Matrix-IOCanaryè§£æ - Yorekâ€™s Blog: <a href="https://blog.yorek.xyz/android/3rd-library/matrix-io/#4-android-p">https://blog.yorek.xyz/android/3rd-library/matrix-io/#4-android-p</a></p><p>æœ€å¸¸ç”¨çš„PLT Hookæ¡†æ¶ï¼šxHook - Yorekâ€™s Blog: <a href="https://blog.yorek.xyz/android/3rd-library/xhook/#41-xhook">https://blog.yorek.xyz/android/3rd-library/xhook/#41-xhook</a></p><p>Android Logå†™æ—¥å¿—æµç¨‹åˆ†æ - Billèªçš„åšå®¢ | Billâ€™s Blog: <a href="http://www.cjcbill.com/2019/01/12/android-log-api/">http://www.cjcbill.com/2019/01/12/android-log-api/</a></p><p>Android æ—¥å¿—ç³»ç»Ÿâ€“03ï¼šlogdã€logcatæºç åˆ†æ1.æ¦‚è¿° ??ä¸Šä¸€èŠ‚æˆ‘ä»¬çœ‹äº†Androidæ—¥å¿—ç³»ç»Ÿçš„æ¶æ„ - æ˜é‡‘: <a href="https://juejin.cn/post/7424902549256175652">https://juejin.cn/post/7424902549256175652</a></p><p>Androidä¹‹è¿›ç¨‹ crashç›‘å¬ - ç®€ä¹¦: <a href="https://www.jianshu.com/p/b1d03d464f62">https://www.jianshu.com/p/b1d03d464f62</a></p><p>Android Native crashè§¦å‘åŸç†åŠå¤„ç†-CSDNåšå®¢: <a href="https://blog.csdn.net/youthcowboy/article/details/135505161">https://blog.csdn.net/youthcowboy/article/details/135505161</a></p><p>Android App Crashä¹‹åå¦‚ä½•ç¦æ­¢Activityé‡å¯ - ç®€ä¹¦: <a href="https://www.jianshu.com/p/636edca24443">https://www.jianshu.com/p/636edca24443</a></p><p>Androidå®ç°APPå¯åŠ¨ç›‘å¬å’Œæ‹¦æˆª_androidç›‘å¬æŸä¸ªåº”ç”¨æ‰“å¼€äº†æ²¡æœ‰ï¼ˆActivityController ï¼‰: <a href="https://blog.csdn.net/lontano_0406/article/details/129611053">https://blog.csdn.net/lontano_0406/article/details/129611053</a></p><p>RK3288 Android 7.1 dumpsys meminfo æ— æ³•è·å–å†…å­˜ä¿¡æ¯é—®é¢˜-é˜¿é‡Œäº‘å¼€å‘è€…ç¤¾åŒº: <a href="https://developer.aliyun.com/article/1158680">https://developer.aliyun.com/article/1158680</a></p><p>androidå¦‚ä½•åˆ†æè¿›ç¨‹è¢«æ€é—®é¢˜_has died: fg top-CSDNåšå®¢: <a href="https://blog.csdn.net/qq_28852011/article/details/123569047">https://blog.csdn.net/qq_28852011/article/details/123569047</a></p><p>æˆªå›¾æ¡†æ¶ä»£ç åŸç† android 11 - ç®€ä¹¦: <a href="https://www.jianshu.com/p/90571763c3d3">https://www.jianshu.com/p/90571763c3d3</a></p><p>WMSå¸¸è§é—®é¢˜ä¸€ï¼ˆActivity displayedå»¶è¿Ÿï¼‰_wms event log-CSDNåšå®¢: <a href="https://blog.csdn.net/kc58236582/article/details/60134836">https://blog.csdn.net/kc58236582/article/details/60134836</a></p><p>android é™æ€å’ŒåŠ¨æ€è®¾ç½® Receiverçš„ android:enabledå€¼ - å¯¸è‰ä¹‹å¿ƒ - åšå®¢å›­: <a href="https://www.cnblogs.com/LuLei1990/p/4484798.html">https://www.cnblogs.com/LuLei1990/p/4484798.html</a></p><p>Android10 ç³»ç»Ÿå‘é€å¼€æœºå¹¿æ’­æ—¶æœº_performenablescreen-CSDNåšå®¢: <a href="https://blog.csdn.net/tangedegushi/article/details/120512883">https://blog.csdn.net/tangedegushi/article/details/120512883</a></p><p>android-new-features&#x2F;android11&#x2F;æ–°åŠŸèƒ½&#x2F;ADBå¢é‡APKå®‰è£….md at master Â· lacuz&#x2F;android-new-features: <a href="https://github.com/lacuz/android-new-features/blob/master/android11/%E6%96%B0%E5%8A%9F%E8%83%BD/ADB%E5%A2%9E%E9%87%8FAPK%E5%AE%89%E8%A3%85.md">https://github.com/lacuz/android-new-features/blob/master/android11/%E6%96%B0%E5%8A%9F%E8%83%BD/ADB%E5%A2%9E%E9%87%8FAPK%E5%AE%89%E8%A3%85.md</a></p><p>Androidå¢é‡æ›´æ–°åŸç†å’Œå®è·µ - ç®€ä¹¦: <a href="https://www.jianshu.com/p/9b0c10270759">https://www.jianshu.com/p/9b0c10270759</a></p><p>blog&#x2F;source&#x2F;_posts&#x2F;Androidå„ç‰ˆæœ¬å”¤èµ·appå®‰è£…è§£å†³æ–¹æ¡ˆ.md at master Â· halfcupCn&#x2F;blog: <a href="https://github.com/halfcupCn/blog/blob/master/source/_posts/Android%E5%90%84%E7%89%88%E6%9C%AC%E5%94%A4%E8%B5%B7app%E5%AE%89%E8%A3%85%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88.md">https://github.com/halfcupCn/blog/blob/master/source/_posts/Android%E5%90%84%E7%89%88%E6%9C%AC%E5%94%A4%E8%B5%B7app%E5%AE%89%E8%A3%85%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88.md</a></p><p>Android ä¹‹ ViewTreeObserver å…¨é¢è§£æ - ç®€ä¹¦: <a href="https://www.jianshu.com/p/59d636695d42">https://www.jianshu.com/p/59d636695d42</a></p><p>AOSP çš„è¿›ç¨‹ç®¡ç† | Caturraâ€™s Blog: <a href="https://www.bluepuni.com/archives/aosp-process-management/">https://www.bluepuni.com/archives/aosp-process-management/</a></p><p>Androidï¼šä¿®æ”¹è¿æ¥åˆ°APç«¯æ˜¾ç¤ºçš„è®¾å¤‡å - sheldon_blogs - åšå®¢å›­: <a href="https://www.cnblogs.com/blogs-of-lxl/p/11742031.html">https://www.cnblogs.com/blogs-of-lxl/p/11742031.html</a></p><p>å®‰å“é«˜çº§ç”¨æˆ·çš„ç¦éŸ³ Android 12æ‰©å±•æ”¯æŒmDNSå¯ä»¥ä½¿ç”¨.localè®¿é—®æœ¬åœ°è®¾å¤‡ â€“ è“ç‚¹ç½‘: <a href="https://www.landiannews.com/archives/94395.html">https://www.landiannews.com/archives/94395.html</a></p><p>å¦‚ä½•æ ¹æ®TCPè¿æ¥çš„æºç«¯å£ç´¢å¼•æ¥æºAPPï¼ˆå³UIDï¼‰ï¼ŸNotes&#x2F;AclInProxy.md at master Â· daBisNewBee&#x2F;Notes: <a href="https://github.com/daBisNewBee/Notes/blob/master/AclInProxy.md">https://github.com/daBisNewBee/Notes/blob/master/AclInProxy.md</a><br>Go è¯­è¨€å®ç°ç®€æ˜“ç‰ˆ netstat å‘½ä»¤-51CTO.COM: <a href="https://www.51cto.com/article/671735.html">https://www.51cto.com/article/671735.html</a></p><p>androidå¦‚ä½•é€šè¿‡ä»£ç æ¥è·å–æ¯ä¸ªåº”ç”¨è®¿é—®è¿‡çš„ipå’Œç«¯å£_å®‰å“æºç å¦‚ä½•æŸ¥çœ‹è°ƒç”¨äº†å“ªäº›æ¥å£åœ°å€-CSDNåšå®¢: <a href="https://blog.csdn.net/zhao007z5/article/details/79977630">https://blog.csdn.net/zhao007z5/article/details/79977630</a></p><h2 id="AMS"><a href="#AMS" class="headerlink" title="AMS"></a>AMS</h2><p>onNewIntent()æ–¹æ³•ä»‹ç»Â·This is called for activities that set lau - æ˜é‡‘: <a href="https://juejin.cn/post/6844904007085850631">https://juejin.cn/post/6844904007085850631</a></p><p>Activityå¯åŠ¨æ¨¡å¼äºŒä¸Šç¯‡æ–‡ç« Activityå¯åŠ¨æ¨¡å¼ä¸€ä¸»è¦ä»‹ç»äº†Activityçš„å››ç§å¯åŠ¨æ¨¡å¼ï¼Œè¿™äº›å¯åŠ¨æ¨¡å¼éƒ½æ˜¯åœ¨ - æ˜é‡‘: <a href="https://juejin.cn/post/6844903974269648903#heading-10">https://juejin.cn/post/6844903974269648903#heading-10</a></p><p>android - onNewIntent called after finish() executed - Stack Overflow: <a href="https://stackoverflow.com/questions/24639272/onnewintent-called-after-finish-executed">https://stackoverflow.com/questions/24639272/onnewintent-called-after-finish-executed</a></p><p>é¢è¯•å®˜ï¼šä¸ºä»€ä¹ˆ Activity.finish() ä¹‹å 10s æ‰ onDestroy ï¼Ÿäº¤æµç¾¤é‡Œç¢°åˆ°ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„é—® - æ˜é‡‘: <a href="https://juejin.cn/post/6898588053451833351">https://juejin.cn/post/6898588053451833351</a></p><p>åœ¨è°ƒç”¨finish()ä¹‹åï¼Œå¯ä»¥ä¿è¯è°ƒç”¨å“ªäº›androidç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Ÿ-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘: <a href="https://cloud.tencent.com/developer/ask/sof/106897129">https://cloud.tencent.com/developer/ask/sof/106897129</a></p><p>Tasks and the back stack ?|? Android Developers: <a href="https://developer.android.google.cn/guide/components/activities/tasks-and-back-stack">https://developer.android.google.cn/guide/components/activities/tasks-and-back-stack</a></p><p>ï¼ˆä¼šè¿”å›delayï¼‰</p><p>æ˜ä¿®â€æ ˆâ€é“â€”â€”è¶Šè¿‡Androidå¯åŠ¨æ ˆé™·é˜±æœ¬æ–‡ä»ä¸€ä¾‹ä¸šåŠ¡ä¸­é‡åˆ°çš„é—®é¢˜å‡ºå‘ï¼Œä»¥FLAG_ACTIVITY_NEW_TAS - æ˜é‡‘: <a href="https://juejin.cn/post/7223175468621774907#heading-11">https://juejin.cn/post/7223175468621774907#heading-11</a> </p><p>æ·±å…¥æ’æŸ¥ FLAG å¯¼è‡´çš„ Activity æ— æ³•æ­£å¸¸å¯åŠ¨ - è„‰è„‰: <a href="https://maimai.cn/article/detail?fid=1693592616&efid=5YwMmIAys4HBa0yIzYKTFQ">https://maimai.cn/article/detail?fid=1693592616&amp;efid=5YwMmIAys4HBa0yIzYKTFQ</a></p><p>å¯åŠ¨æ¨¡å¼â€singleTaskâ€å’ŒFLAG_ACTIVITY_NEW_TASKå…·æœ‰ä¸åŒçš„è¡Œä¸ºï¼-CSDNåšå®¢: <a href="https://blog.csdn.net/lincyang/article/details/6802017">https://blog.csdn.net/lincyang/article/details/6802017</a></p><p>Android Intent.FLAG_ACTIVITY_NEW_TASKçš„ä¸ªäººç†è§£-CSDNåšå®¢: <a href="https://blog.csdn.net/u010389391/article/details/78558475">https://blog.csdn.net/u010389391/article/details/78558475</a></p><p>å¯¹ FLAG_ACTIVITY_NEW_TASK | FLAG_ACTIVITY_CLEAR_TOP çš„å®è·µå¯¹ FLAG - æ˜é‡‘: <a href="https://juejin.cn/post/7222897518501347383?from=search-suggest">https://juejin.cn/post/7222897518501347383?from=search-suggest</a></p><p>Activityçš„åŠ è½½æ¨¡å¼ï¼Œä»¥åŠsingleTaskçš„å‘ - ç®€ä¹¦: <a href="https://www.jianshu.com/p/841cfe3fcbc6">https://www.jianshu.com/p/841cfe3fcbc6</a></p><p>Androidçš„å¯åŠ¨æ¨¡å¼ï¼šsingleTaskä¸singleTopçš„ä½¿ç”¨ - ç®€ä¹¦: <a href="https://www.jianshu.com/p/f32b40db6141">https://www.jianshu.com/p/f32b40db6141</a></p><p>Activityå¯åŠ¨æ¨¡å¼singleTaskçš„ç†è§£-CSDNåšå®¢: <a href="https://blog.csdn.net/fxjzzyo/article/details/109293098">https://blog.csdn.net/fxjzzyo/article/details/109293098</a></p><p>Android-Interview&#x2F;Activity&#x2F;æ·±åˆ»å‰–æactivityå¯åŠ¨æ¨¡å¼-3.md at master Â· JackChan1999&#x2F;Android-Interview: <a href="https://github.com/JackChan1999/Android-Interview/blob/master/Activity/%E6%B7%B1%E5%88%BB%E5%89%96%E6%9E%90activity%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F-3.md">https://github.com/JackChan1999/Android-Interview/blob/master/Activity/%E6%B7%B1%E5%88%BB%E5%89%96%E6%9E%90activity%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F-3.md</a></p><p>android 10 åå°æ— æ³• startActivity åŸç†åˆ†æ_abort background activity starts from-CSDNåšå®¢: <a href="https://blog.csdn.net/int_65536/article/details/120476839">https://blog.csdn.net/int_65536/article/details/120476839</a></p><h2 id="WMS"><a href="#WMS" class="headerlink" title="WMS"></a>WMS</h2><h2 id="PMS"><a href="#PMS" class="headerlink" title="PMS"></a>PMS</h2><h2 id="IMS"><a href="#IMS" class="headerlink" title="IMS"></a>IMS</h2><p>Android-TVå¼€å‘æŒ‰é”®ä¸ç„¦ç‚¹æ·±å…¥åˆ†æï¼ˆä¸€ï¼‰â€“KeyEventçš„åˆ†å‘ | chenxinâ€™s blog: <a href="https://msisuzney.github.io/2020/08/24/Android-TV%E5%BC%80%E5%8F%91%E6%8C%89%E9%94%AE%E4%B8%8E%E7%84%A6%E7%82%B9%E6%B7%B1%E5%85%A5%E5%88%86%E6%9E%90%EF%BC%88%E4%B8%80%EF%BC%89-KeyEvent%E7%9A%84%E5%88%86%E5%8F%91/">https://msisuzney.github.io/2020/08/24/Android-TV%E5%BC%80%E5%8F%91%E6%8C%89%E9%94%AE%E4%B8%8E%E7%84%A6%E7%82%B9%E6%B7%B1%E5%85%A5%E5%88%86%E6%9E%90%EF%BC%88%E4%B8%80%EF%BC%89-KeyEvent%E7%9A%84%E5%88%86%E5%8F%91/</a></p><p>Android KeyEventåˆ†å‘ä¸ç„¦ç‚¹åˆ‡æ¢. 2016å¹´å¹´åº•çš„æ—¶å€™ï¼Œç»™ä¸€ä¸ªAppé€‚é…äº†D-padï¼ŒD-padå°±æ˜¯ä¸‹å›¾çº¢æ¡†é‡Œçš„ä¸œâ€¦ | by Wan Xiao | Medium: <a href="https://medium.com/@wanxiao1994/android-keyevent%E5%88%86%E5%8F%91%E4%B8%8E%E7%84%A6%E7%82%B9%E5%88%87%E6%8D%A2-a72eebc0ea92">https://medium.com/@wanxiao1994/android-keyevent%E5%88%86%E5%8F%91%E4%B8%8E%E7%84%A6%E7%82%B9%E5%88%87%E6%8D%A2-a72eebc0ea92</a></p><h2 id="ART"><a href="#ART" class="headerlink" title="ART"></a>ART</h2><h2 id="IPC"><a href="#IPC" class="headerlink" title="IPC"></a>IPC</h2><p>Androidå¼‚æ­¥é€šä¿¡ï¼šè¯¦è§£ Handler å†…å­˜æ³„éœ²çš„åŸå›  - ç®€ä¹¦: <a href="https://www.jianshu.com/p/ed9e15eff47a">https://www.jianshu.com/p/ed9e15eff47a</a></p><h3 id="Binder"><a href="#Binder" class="headerlink" title="Binder"></a>Binder</h3><p>Binder ä¸ºä»€ä¹ˆåªéœ€è¦æ‹·è´ä¸€æ¬¡ Â· Android é¢è¯•æ–‡æ¡£ Â· çœ‹äº‘: <a href="https://www.kancloud.cn/smartsean/android/1123813">https://www.kancloud.cn/smartsean/android/1123813</a></p><p>guardian&#x2F;toolargetool: A tool to help you debug TransactionTooLargeExceptions on Android 7+: <a href="https://github.com/guardian/toolargetool">https://github.com/guardian/toolargetool</a></p><h2 id="app-process"><a href="#app-process" class="headerlink" title="app_process"></a>app_process</h2><p>[æ±‚åŠ©]åœ¨rootä¸‹app_processå¯åŠ¨çš„javaè¿›ç¨‹æ€ä¹ˆè·å–context-Androidå®‰å…¨-çœ‹é›ª-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|kanxue.com: <a href="https://bbs.kanxue.com/thread-276469.htm">https://bbs.kanxue.com/thread-276469.htm</a></p><p>topjohnwu&#x2F;libsu: A complete solution for apps using root permissions: <a href="https://github.com/topjohnwu/libsu?utm_source=ld246.com">https://github.com/topjohnwu/libsu?utm_source=ld246.com</a></p><p>è·¨è¿›ç¨‹rootè¯»å†™å†…å­˜åŸç†(JNIRootæ–¹æ¡ˆ)-CSDNåšå®¢: <a href="https://blog.csdn.net/qq_38944721/article/details/114363535#:~:text=libsu%E5%8C%85%E5%90%AB%E4%B8%A4%E4%B8%AA%E4%B8%BB%E8%A6%81%E7%BB%84%E4%BB%B6%EF%BC%9A%20core%E6%A8%A1%E5%9D%97%E6%8F%90%E4%BE%9B%E4%BA%86%E4%B8%80%E4%B8%AA%E5%81%A5%E5%A3%AE%E7%9A%84API%E4%B8%8EUni%E2%80%8B%E2%80%8Bx%20shell%E8%BF%9B%E8%A1%8C%E4%BA%A4%E4%BA%92%EF%BC%9B%20service%E6%A8%A1%E5%9D%97%E5%85%81%E8%AE%B8%E6%82%A8%E5%88%9B%E5%BB%BA%E6%A0%B9%E6%9C%8D%E5%8A%A1%E4%BB%A5%E8%BF%90%E8%A1%8CJava%20%2F%20Kotlin%E5%92%8C%E6%9C%AC%E6%9C%BAC%20%2F,C%20%2B%2B%E4%BB%A3%E7%A0%81%EF%BC%88%E9%80%9A%E8%BF%87JNI%EF%BC%89%E3%80%82%20%E8%AF%A5%E5%BA%93%E4%B8%BA%E6%82%A8%E5%A4%84%E7%90%86Shell%20%E8%BF%9B%E7%A8%8B%20%E7%9A%84%E5%88%9B%E5%BB%BA%EF%BC%8C%E5%85%B7%E6%9C%89%E6%A0%87%E5%87%86%E6%B5%81%E7%9A%84I%20%2F%20O%EF%BC%8C%E5%A4%9A%E7%BA%BF%E7%A8%8B%EF%BC%8C%E5%B9%B6%E5%8F%91%E9%97%AE%E9%A2%98%E4%BB%A5%E5%8F%8A%E5%AF%B9%E8%BF%9C%E7%A8%8B%E6%A0%B9%E6%9C%8D%E5%8A%A1%E7%9A%84%E7%AE%A1%E7%90%86%E3%80%82">https://blog.csdn.net/qq_38944721/article/details/114363535#:~:text=libsu%E5%8C%85%E5%90%AB%E4%B8%A4%E4%B8%AA%E4%B8%BB%E8%A6%81%E7%BB%84%E4%BB%B6%EF%BC%9A%20core%E6%A8%A1%E5%9D%97%E6%8F%90%E4%BE%9B%E4%BA%86%E4%B8%80%E4%B8%AA%E5%81%A5%E5%A3%AE%E7%9A%84API%E4%B8%8EUni%E2%80%8B%E2%80%8Bx%20shell%E8%BF%9B%E8%A1%8C%E4%BA%A4%E4%BA%92%EF%BC%9B%20service%E6%A8%A1%E5%9D%97%E5%85%81%E8%AE%B8%E6%82%A8%E5%88%9B%E5%BB%BA%E6%A0%B9%E6%9C%8D%E5%8A%A1%E4%BB%A5%E8%BF%90%E8%A1%8CJava%20%2F%20Kotlin%E5%92%8C%E6%9C%AC%E6%9C%BAC%20%2F,C%20%2B%2B%E4%BB%A3%E7%A0%81%EF%BC%88%E9%80%9A%E8%BF%87JNI%EF%BC%89%E3%80%82%20%E8%AF%A5%E5%BA%93%E4%B8%BA%E6%82%A8%E5%A4%84%E7%90%86Shell%20%E8%BF%9B%E7%A8%8B%20%E7%9A%84%E5%88%9B%E5%BB%BA%EF%BC%8C%E5%85%B7%E6%9C%89%E6%A0%87%E5%87%86%E6%B5%81%E7%9A%84I%20%2F%20O%EF%BC%8C%E5%A4%9A%E7%BA%BF%E7%A8%8B%EF%BC%8C%E5%B9%B6%E5%8F%91%E9%97%AE%E9%A2%98%E4%BB%A5%E5%8F%8A%E5%AF%B9%E8%BF%9C%E7%A8%8B%E6%A0%B9%E6%9C%8D%E5%8A%A1%E7%9A%84%E7%AE%A1%E7%90%86%E3%80%82</a></p><h2 id="Native"><a href="#Native" class="headerlink" title="Native"></a>Native</h2><h1 id="Androidæ€§èƒ½ä¼˜åŒ–"><a href="#Androidæ€§èƒ½ä¼˜åŒ–" class="headerlink" title="Androidæ€§èƒ½ä¼˜åŒ–"></a>Androidæ€§èƒ½ä¼˜åŒ–</h1><p>adb shell cat &#x2F;proc&#x2F;self&#x2F;cgroup</p><p>Linux zram å¼€å¯ | myfreax: <a href="https://www.myfreax.com/linux-zram-enabled/">https://www.myfreax.com/linux-zram-enabled/</a></p><p>android ä¸´æ—¶å…³é—­ZRAM_android å…³é—­zram-CSDNåšå®¢: <a href="https://blog.csdn.net/zyfzhangyafei/article/details/106362038">https://blog.csdn.net/zyfzhangyafei/article/details/106362038</a></p><p>ä¿®æ”¹å®‰å“çš„zramå¤§å° - T^3 Blog: <a href="https://blog.virt.ltd/archives/88/">https://blog.virt.ltd/archives/88/</a></p><p>â€œæš‚åœæ‰§è¡Œå·²ç¼“å­˜çš„åº”ç”¨â€ æ˜¯å¦‚ä½•å·¥ä½œçš„ - LibXZR çš„å°æœ¬æœ¬: <a href="https://blog.xzr.moe/archives/190/">https://blog.xzr.moe/archives/190/</a></p><p>Androidå¼€å‘é«˜æ‰‹è¯¾NOTE - æ¢¦å’Œè¿œæ–¹ - åšå®¢å›­: <a href="https://www.cnblogs.com/sixrain/p/11777135.html">https://www.cnblogs.com/sixrain/p/11777135.html</a></p><p>ä¸ºä½•é«˜å¸§ç‡å¯¹äºç”µç«æ¯”èµ›ååˆ†é‡è¦ï¼Ÿ | GeForce æ–°é—» | NVIDIA: <a href="https://www.nvidia.cn/geforce/news/what-is-fps-and-how-it-helps-you-win-games/">https://www.nvidia.cn/geforce/news/what-is-fps-and-how-it-helps-you-win-games/</a></p><p>ç¼“å­˜çš„åº”ç”¨å†»ç»“å™¨ ?|? Android Open Source Project: <a href="https://source.android.google.cn/docs/core/perf/cached-apps-freezer?hl=zh-cn">https://source.android.google.cn/docs/core/perf/cached-apps-freezer?hl=zh-cn</a></p><p>Android13å†»ç»“è¿›ç¨‹åˆ†æï¼šå¦‚ä½•æé«˜è®¾å¤‡æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒ | 10cl: <a href="https://www.toscl.com/android_freezer/#%E5%86%BB%E7%BB%93%E8%BF%9B%E7%A8%8B%E7%9A%84%E4%BD%9C%E7%94%A8">https://www.toscl.com/android_freezer/#%E5%86%BB%E7%BB%93%E8%BF%9B%E7%A8%8B%E7%9A%84%E4%BD%9C%E7%94%A8</a></p><p>è¯†åˆ«ä¸è´Ÿè½½èƒ½åŠ›ç›¸å…³çš„å¡é¡¿ ?|? Android Open Source Project: <a href="https://source.android.com/docs/core/tests/debug/jank_capacity?hl=zh-cn">https://source.android.com/docs/core/tests/debug/jank_capacity?hl=zh-cn</a></p><p>Androidæ€§èƒ½ä¼˜åŒ–ï¼šå®šæ€§å’Œå®šä½Androidå›¾å½¢æ€§èƒ½é—®é¢˜â€”â€”ä»¥åå°å½•å±è¿›ç¨‹ä¸ºä¾‹Androidæ€§èƒ½ä¼˜åŒ–ã€‚å€ŸåŠ©æ€§èƒ½å·¥å…·çš„ - æ˜é‡‘: <a href="https://juejin.cn/post/7096288511053004830">https://juejin.cn/post/7096288511053004830</a></p><h2 id="cpu"><a href="#cpu" class="headerlink" title="cpu"></a>cpu</h2><p>Android Framework å¸¸è§è§£å†³æ–¹æ¡ˆï¼ˆ25-1ï¼‰å®šåˆ¶CPUSETè§£å†³æ–¹æ¡ˆ-frameworkéƒ¨åˆ†ä¿®æ”¹_android cpuset-CSDNåšå®¢: <a href="https://blog.csdn.net/vviccc/article/details/135487983">https://blog.csdn.net/vviccc/article/details/135487983</a></p><p>Android Framework å¸¸è§è§£å†³æ–¹æ¡ˆï¼ˆ25-2ï¼‰å®šåˆ¶CPUSETè§£å†³æ–¹æ¡ˆ-systemä¿®æ”¹åŠç¼–è¯‘éƒ¨åˆ†è°ƒæ•´_audio-app cpuset-CSDNåšå®¢: <a href="https://blog.csdn.net/vviccc/article/details/135486191">https://blog.csdn.net/vviccc/article/details/135486191</a></p><p>Android Framework å¸¸è§è§£å†³æ–¹æ¡ˆï¼ˆ25-1ï¼‰å®šåˆ¶CPUSETè§£å†³æ–¹æ¡ˆ-frameworkéƒ¨åˆ†ä¿®æ”¹ - æœåŠ¡å™¨æ‰˜ç®¡|åŒ—äº¬æœåŠ¡å™¨ç§Ÿç”¨|æœºæˆ¿æ‰˜ç®¡ç§Ÿç”¨|IDCæ‰˜ç®¡ç§Ÿç”¨|æœºæˆ¿æœºæŸœå¸¦å®½ç§Ÿç”¨-ä»·æ ¼åŠè´¹ç”¨å’¨è¯¢: <a href="https://www.fwqtg.net/android-framework-%E5%B8%B8%E8%A7%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%EF%BC%8825-1%EF%BC%89%E5%AE%9A%E5%88%B6cpuset%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88-framework%E9%83%A8%E5%88%86%E4%BF%AE%E6%94%B9.html">https://www.fwqtg.net/android-framework-%E5%B8%B8%E8%A7%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%EF%BC%8825-1%EF%BC%89%E5%AE%9A%E5%88%B6cpuset%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88-framework%E9%83%A8%E5%88%86%E4%BF%AE%E6%94%B9.html</a></p><p>Android Framework å¸¸è§è§£å†³æ–¹æ¡ˆï¼ˆ25-2ï¼‰å®šåˆ¶CPUSETè§£å†³æ–¹æ¡ˆ-systemä¿®æ”¹åŠç¼–è¯‘éƒ¨åˆ†è°ƒæ•´: <a href="http://www.coreui.cn/news/281462.html">http://www.coreui.cn/news/281462.html</a></p><p>androidæ ¸ç»‘å®šcpuseté…ç½®ä¸æ£€æµ‹è¿›ç¨‹æ‰€åœ¨æ ¸cpusetæ–¹æ³•_cpuset top-app-CSDNåšå®¢: <a href="https://blog.csdn.net/suixin______/article/details/132358622">https://blog.csdn.net/suixin______/article/details/132358622</a></p><p>Androidä¸­å…³äºcpu&#x2F;cpuset&#x2F;schedtuneçš„åº”ç”¨ - ArnoldLu - åšå®¢å›­: <a href="https://www.cnblogs.com/arnoldlu/p/6221608.html">https://www.cnblogs.com/arnoldlu/p/6221608.html</a></p><p>Android&#x2F;Linux EASä¼˜åŒ–-Cpuset_cpusetå¦‚ä½•è®¾ç½®è¿›ç¨‹ç‹¬å cpuæ ¸-CSDNåšå®¢: <a href="https://blog.csdn.net/liaochaoyun/article/details/122112026">https://blog.csdn.net/liaochaoyun/article/details/122112026</a></p><p>åœ¨ Android åº•ä¸‹ä½¿ç”¨ CGROUP â€“ Cash Chouâ€™s Blog: <a href="https://cashchou.com/2014/07/20/%E5%9C%A8-android-%E5%BA%95%E4%B8%8B%E4%BD%BF%E7%94%A8-cgroup/">https://cashchou.com/2014/07/20/%E5%9C%A8-android-%E5%BA%95%E4%B8%8B%E4%BD%BF%E7%94%A8-cgroup/</a></p><p>é«˜é€šéªé¾™ CPU ç»‘æ ¸æ“ä½œ - SeanHHX ç‚¹ç‚¹æ»´æ»´: <a href="https://seanhhx.cn/post/%E9%AB%98%E9%80%9A%E9%AA%81%E9%BE%99-cpu-%E7%BB%91%E6%A0%B8%E6%93%8D%E4%BD%9C/">https://seanhhx.cn/post/%E9%AB%98%E9%80%9A%E9%AA%81%E9%BE%99-cpu-%E7%BB%91%E6%A0%B8%E6%93%8D%E4%BD%9C/</a></p><p>android app cpuæ ¸å¿ƒé™åˆ¶å°è¯• | mjblog: <a href="https://mjblog.github.io/2021/02/26/android_core_limit/">https://mjblog.github.io/2021/02/26/android_core_limit/</a></p><p>Androidè¿›ç¨‹çº¿ç¨‹è°ƒåº¦ä¹‹cgroups - æŠ€æœ¯å°é»‘å±‹: <a href="https://droidyue.com/blog/2015/09/17/android-process-and-thread-schedule-cgroups/">https://droidyue.com/blog/2015/09/17/android-process-and-thread-schedule-cgroups/</a></p><p>Android Framework å¸¸è§è§£å†³æ–¹æ¡ˆï¼ˆ25-1ï¼‰å®šåˆ¶CPUSETè§£å†³æ–¹æ¡ˆ-frameworkéƒ¨åˆ†ä¿®æ”¹ - æœåŠ¡å™¨æ‰˜ç®¡|åŒ—äº¬æœåŠ¡å™¨ç§Ÿç”¨|æœºæˆ¿æ‰˜ç®¡ç§Ÿç”¨|IDCæ‰˜ç®¡ç§Ÿç”¨|æœºæˆ¿æœºæŸœå¸¦å®½ç§Ÿç”¨-ä»·æ ¼åŠè´¹ç”¨å’¨è¯¢: <a href="https://www.fwqtg.net/android-framework-%E5%B8%B8%E8%A7%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%EF%BC%8825-1%EF%BC%89%E5%AE%9A%E5%88%B6cpuset%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88-framework%E9%83%A8%E5%88%86%E4%BF%AE%E6%94%B9.html">https://www.fwqtg.net/android-framework-%E5%B8%B8%E8%A7%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%EF%BC%8825-1%EF%BC%89%E5%AE%9A%E5%88%B6cpuset%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88-framework%E9%83%A8%E5%88%86%E4%BF%AE%E6%94%B9.html</a></p><p>ä½ æƒ³è¦çš„Androidæ€§èƒ½ä¼˜åŒ–ç³»åˆ—ï¼šå¯åŠ¨ä¼˜åŒ– ï¼æ‰‹æœºæ¡Œé¢ç‚¹å‡»ä¸€ä¸ªåº”ç”¨ï¼Œç”¨æˆ·å¸Œæœ›åº”ç”¨èƒ½ åŠæ—¶å“åº”ã€å¿«é€ŸåŠ è½½ã€‚å¯åŠ¨æ—¶é—´è¿‡é•¿çš„ - æ˜é‡‘: <a href="https://juejin.cn/post/6854573215474253838">https://juejin.cn/post/6854573215474253838</a></p><p>Android-bugreport-åˆ†ææ–¹æ³•####Android bugreport æ¦‚è¿° bugreport æ˜¯An - æ˜é‡‘: <a href="https://juejin.cn/post/7201091178488840250">https://juejin.cn/post/7201091178488840250</a></p><p>zRAMå†…å­˜å‹ç¼©æŠ€æœ¯åŸç†ä¸åº”ç”¨: <a href="http://www.wowotech.net/memory_management/zram.html">http://www.wowotech.net/memory_management/zram.html</a></p><h1 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h1><h2 id="è‡ªåŠ¨åŒ–æµ‹è¯•"><a href="#è‡ªåŠ¨åŒ–æµ‹è¯•" class="headerlink" title="è‡ªåŠ¨åŒ–æµ‹è¯•"></a>è‡ªåŠ¨åŒ–æµ‹è¯•</h2><p>Androidä¸­æ¨¡æ‹Ÿç‚¹å‡»ç±»è½¯ä»¶å®ç°åŸç†æ¢ç©¶ - çŸ¥ä¹: <a href="https://zhuanlan.zhihu.com/p/37672098">https://zhuanlan.zhihu.com/p/37672098</a></p><p>minitouchç‚¹å‡»åŸç†-CSDNåšå®¢: <a href="https://blog.csdn.net/aaajj/article/details/125836403">https://blog.csdn.net/aaajj/article/details/125836403</a></p><p>libevdev(3): <a href="https://man.freebsd.org/cgi/man.cgi?query=libevdev&sektion=3&manpath=FreeBSD+13.1-RELEASE+and+Ports">https://man.freebsd.org/cgi/man.cgi?query=libevdev&amp;sektion=3&amp;manpath=FreeBSD+13.1-RELEASE+and+Ports</a></p><p>Python+scrcpy+pyminitouchå®ç°è‡ªåŠ¨åŒ–ï¼ˆä¸€ï¼‰â€”â€”scrcpyçš„å®‰è£…_python scrcpy-CSDNåšå®¢: <a href="https://blog.csdn.net/Alkaid2000/article/details/123034871?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-1-123034871-blog-123411963.235%5Ev40%5Epc_relevant_3m_sort_dl_base1&spm=1001.2101.3001.4242.2&utm_relevant_index=4">https://blog.csdn.net/Alkaid2000/article/details/123034871?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-1-123034871-blog-123411963.235^v40^pc_relevant_3m_sort_dl_base1&amp;spm=1001.2101.3001.4242.2&amp;utm_relevant_index=4</a></p><p>UiAutomator2+Pytest+Allure+POæ¨¡å‹å®ç°Androidè‡ªåŠ¨åŒ–æµ‹è¯•_atx-agent poæ¨¡å¼-CSDNåšå®¢: <a href="https://blog.csdn.net/Q0717168/article/details/122272374">https://blog.csdn.net/Q0717168/article/details/122272374</a></p><p>ä½¿ç”¨adb screenrecordå‘½ä»¤é€šè¿‡USBå°†AndroidæŠ•å±åˆ°PC - KirimaSharoâ€™s Blog | Syaroæœ€å¯çˆ±äº†: <a href="https://kirimasharo.com/archives/455.html">https://kirimasharo.com/archives/455.html</a></p><p>DeviceFarmer&#x2F;minicap: Stream real-time screen capture data out of Android devices.: <a href="https://github.com/DeviceFarmer/minicap">https://github.com/DeviceFarmer/minicap</a></p><h1 id="Kernel"><a href="#Kernel" class="headerlink" title="Kernel"></a>Kernel</h1><p>ä»æ ¹ä¸Šç†è§£ç”¨æˆ·æ€ä¸å†…æ ¸æ€æ¬¢è¿æ¥åˆ°æ“ä½œç³»ç»Ÿç³»åˆ—ï¼Œé‡‡ç”¨å›¾è§£ + å¤§ç™½è¯çš„å½¢å¼æ¥è®²è§£ï¼Œè®©å°ç™½ä¹Ÿèƒ½çœ‹æ‡‚ï¼Œå¸®åŠ©å¤§å®¶å¿«é€Ÿç§‘æ™®å…¥é—¨ã€‚ - æ˜é‡‘: <a href="https://juejin.cn/post/6923863670132850701">https://juejin.cn/post/6923863670132850701</a></p><p>Android8æ·»åŠ arm64ç³»ç»Ÿè°ƒç”¨_arm64 unistd32.h-CSDNåšå®¢: <a href="https://blog.csdn.net/m0_37340681/article/details/98734047">https://blog.csdn.net/m0_37340681/article/details/98734047</a></p><p>ARM64å†…æ ¸ç³»ç»Ÿè°ƒç”¨æ·»åŠ æ–¹æ³•ï¼ˆåŸºäºkernel-4.9ï¼‰_arm64æ·»åŠ ç³»ç»Ÿè°ƒç”¨å¦‚ä½•åœ¨åº”ç”¨å±‚ä½¿ç”¨å‡½æ•°-CSDNåšå®¢: <a href="https://blog.csdn.net/rikeyone/article/details/79929032">https://blog.csdn.net/rikeyone/article/details/79929032</a></p><p>Androidæ·»åŠ å†…æ ¸ç³»ç»Ÿè°ƒç”¨_rwprocmem33-CSDNåšå®¢: <a href="https://blog.csdn.net/m0_37340681/article/details/89704825">https://blog.csdn.net/m0_37340681/article/details/89704825</a></p><p>ä¸‰ã€Androidç³»ç»Ÿå†…æ ¸ç¼–è¯‘åŠåˆ·æœºå®æˆ˜ ï¼ˆä¿®æ”¹åè°ƒè¯•æ ‡å¿—ä½ï¼‰_bootimg-tools-CSDNåšå®¢: <a href="https://blog.csdn.net/u012417380/article/details/73353670">https://blog.csdn.net/u012417380/article/details/73353670</a></p><p>android Bionic æ·»åŠ ç³»ç»Ÿè°ƒç”¨_android bionic æ·»åŠ æŒ‡ä»¤-CSDNåšå®¢: <a href="https://blog.csdn.net/zhbpd/article/details/80988421">https://blog.csdn.net/zhbpd/article/details/80988421</a></p><p>ã€ä»æºç è¿‡åè°ƒè¯•ã€‘ç»™å®‰å“12å†…æ ¸å¢åŠ ä¸ªsyscall - çŸ¥ä¹: <a href="https://zhuanlan.zhihu.com/p/597784829">https://zhuanlan.zhihu.com/p/597784829</a></p><p>ã€ä»æºç è¿‡åè°ƒè¯•ã€‘ç»™å®‰å“12å†…æ ¸å¢åŠ ä¸ªsyscall - çŸ¥ä¹: <a href="https://zhuanlan.zhihu.com/p/597784829">https://zhuanlan.zhihu.com/p/597784829</a></p><h1 id="ç¼–ç¨‹è¯­è¨€"><a href="#ç¼–ç¨‹è¯­è¨€" class="headerlink" title="ç¼–ç¨‹è¯­è¨€"></a>ç¼–ç¨‹è¯­è¨€</h1><h2 id="Kotlin"><a href="#Kotlin" class="headerlink" title="Kotlin"></a>Kotlin</h2><p>Kotlin å®˜æ–¹æ–‡æ¡£ ä¸­æ–‡ç‰ˆ: <a href="https://book.kotlincn.net/">https://book.kotlincn.net/</a></p><p>View Binding ä¸Kotlinå§”æ‰˜å±æ€§çš„å·§å¦™ç»“åˆï¼Œå‘Šåˆ«åƒåœ¾ä»£ç ï¼ViewBinding æ˜¯Android St - æ˜é‡‘: <a href="https://juejin.cn/post/6844904157808164878">https://juejin.cn/post/6844904157808164878</a></p><p>Kotlin | åˆ©ç”¨byå§”æ‰˜æœºåˆ¶å°è£…SharedPreferenceå†™åœ¨å‰é¢ Kotlin ä¸­çš„å§”æ‰˜æœºåˆ¶æ˜¯ä¸€ç§éå¸¸çµæ´» - æ˜é‡‘: <a href="https://juejin.cn/post/7254581070876000293">https://juejin.cn/post/7254581070876000293</a></p><p>databindingè®¾ç½®Viewçš„layout_widthå’Œlayout_heightå±æ€§You must supply a layout_width attributeé”™è¯¯_databindingè®¾ç½®æ§ä»¶é«˜åº¦-CSDNåšå®¢: <a href="https://blog.csdn.net/zhuhai__yizhi/article/details/52921374">https://blog.csdn.net/zhuhai__yizhi/article/details/52921374</a></p><h2 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h2><p>Java LinkedHashMap å®ç°åŸç† - RustFisher å®‰å“|Java|è®¾è®¡æ¨¡å¼|WebRTC|Python|NestJS|PyQt: <a href="https://www.an.rustfisher.com/java/container/map/Java-LinkedHashMap-code/">https://www.an.rustfisher.com/java/container/map/Java-LinkedHashMap-code/</a></p><p>Javaé›†åˆåˆ†æä¹‹Map-è¿™ä¸ªMapæœ‰é¡ºåºï¼ˆLinkedHashMap &amp; TreeMapï¼‰? å‰æ–‡å·²ç»åˆ†æäº† Hash - æ˜é‡‘: <a href="https://juejin.cn/post/6844903581884088327#heading-12">https://juejin.cn/post/6844903581884088327#heading-12</a></p><p>Android-Interview&#x2F;Java&#x2F;JavaConcurrent&#x2F;å¤šçº¿ç¨‹ä¸‹ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜çš„äº”ç§åŒæ­¥æ–¹æ³•å®ç°.md at master Â· LuckyTerry&#x2F;Android-Interview: <a href="https://github.com/LuckyTerry/Android-Interview/blob/master/Java/JavaConcurrent/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8B%E7%94%9F%E4%BA%A7%E8%80%85%E6%B6%88%E8%B4%B9%E8%80%85%E9%97%AE%E9%A2%98%E7%9A%84%E4%BA%94%E7%A7%8D%E5%90%8C%E6%AD%A5%E6%96%B9%E6%B3%95%E5%AE%9E%E7%8E%B0.md">https://github.com/LuckyTerry/Android-Interview/blob/master/Java/JavaConcurrent/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8B%E7%94%9F%E4%BA%A7%E8%80%85%E6%B6%88%E8%B4%B9%E8%80%85%E9%97%AE%E9%A2%98%E7%9A%84%E4%BA%94%E7%A7%8D%E5%90%8C%E6%AD%A5%E6%96%B9%E6%B3%95%E5%AE%9E%E7%8E%B0.md</a></p><p>Javaå¹¶å‘ç¼–ç¨‹ä¹‹é—­é”ä¸æ …æ é—­é”ä¸æ …æ æ˜¯åœ¨å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­çš„æ¦‚å¿µï¼Œå› ä¸ºåœ¨å¤šçº¿ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¸èƒ½æ§åˆ¶çº¿ç¨‹çš„æ‰§è¡ŒçŠ¶æ€ï¼Œæ‰€ä»¥ç»™çº¿ç¨‹åŠ é” - æ˜é‡‘: <a href="https://juejin.cn/post/6854573208130027533">https://juejin.cn/post/6854573208130027533</a></p><p>Androidï¼ˆJavaï¼‰â€”ä½ çŸ¥é“å—ï¼ŸJavaåŒ¿åå†…éƒ¨ç±»å…¶å®æ˜¯æœ‰â€œåå­—â€å’Œæ„é€ æ–¹æ³•çš„ï¼##è¦ç‚¹ åŒ¿åç±»çš„æ¦‚å¿µå’Œç”¨æ³• - æ˜é‡‘: <a href="https://juejin.cn/post/7241385639504527397">https://juejin.cn/post/7241385639504527397</a></p><p>çº¿ç¨‹ä¸­æ–­ï¼šThreadç±»ä¸­interruptï¼ˆï¼‰ã€interruptedï¼ˆï¼‰å’Œ isInterruptedï¼ˆï¼‰æ–¹æ³•è¯¦è§£ - myseries - åšå®¢å›­: <a href="https://www.cnblogs.com/myseries/p/11107432.html">https://www.cnblogs.com/myseries/p/11107432.html</a></p><p>æ·±å…¥äº†è§£â€“çº¿ç¨‹ä¸­æ–­ â€œinterrupt()â€,â€isInterrupted()â€å’Œâ€interrupted()â€-è¶…è¯¦ç»†ä»‹ç» - æ˜é‡‘: <a href="https://juejin.cn/post/6905205099648417800">https://juejin.cn/post/6905205099648417800</a></p><p>Threadç±»ä¸­çš„interrupt()ï¼Œinterrupted()ä»¥åŠisInterrupted()åŒºåˆ«_thread interrupt interrupted-CSDNåšå®¢: <a href="https://blog.csdn.net/yytree123/article/details/108896876">https://blog.csdn.net/yytree123/article/details/108896876</a></p><p>ä¸ºä»€ä¹ˆè°ƒç”¨äº† interrupt() åï¼ŒisInterrupted() è¿”å›çš„ä¸­æ–­æ ‡è¯†ä»ä¸º false_åœ¨sleepçŠ¶æ€ä¸‹è¢«interrupt,interrupted çŠ¶æ€ä¼šè¢«æ“¦é™¤,è¿”å›false-CSDNåšå®¢: <a href="https://blog.csdn.net/m0_51928480/article/details/129421747?spm=1001.2101.3001.6650.1&utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~Rate-1-129421747-blog-78913911.235%5Ev43%5Epc_blog_bottom_relevance_base1&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~Rate-1-129421747-blog-78913911.235%5Ev43%5Epc_blog_bottom_relevance_base1&utm_relevant_index=2">https://blog.csdn.net/m0_51928480/article/details/129421747?spm=1001.2101.3001.6650.1&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-1-129421747-blog-78913911.235%5Ev43%5Epc_blog_bottom_relevance_base1&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-1-129421747-blog-78913911.235%5Ev43%5Epc_blog_bottom_relevance_base1&amp;utm_relevant_index=2</a></p><p>å…¨ç½‘æœ€è¯¦ç»†çš„çº¿ç¨‹æ±  ThreadPoolExecutor è¯¦è§£ï¼Œå»ºè®®æ”¶è—ï¼ - JavaæŠ€æœ¯æ ˆ - åšå®¢å›­: <a href="https://www.cnblogs.com/javastack/p/17958522">https://www.cnblogs.com/javastack/p/17958522</a></p><h2 id="è§„èŒƒ"><a href="#è§„èŒƒ" class="headerlink" title="è§„èŒƒ"></a>è§„èŒƒ</h2><ol start="7"><li>å‘½åçº¦å®š â€” Google å¼€æºé¡¹ç›®é£æ ¼æŒ‡å—: <a href="https://zh-google-styleguide.readthedocs.io/en/latest/google-cpp-styleguide/naming.html">https://zh-google-styleguide.readthedocs.io/en/latest/google-cpp-styleguide/naming.html</a></li><li>zh-cn&#x2F;contribute&#x2F;OpenHarmony-c-coding-style-guide.md Â· OpenHarmony&#x2F;docs - Gitee.com: <a href="https://gitee.com/openharmony/docs/blob/master/zh-cn/contribute/OpenHarmony-c-coding-style-guide.md#%E5%BB%BA%E8%AE%AE13-%E5%87%BD%E6%95%B0%E7%9A%84%E5%91%BD%E5%90%8D%E9%81%B5%E5%BE%AA%E9%98%85%E8%AF%BB%E4%B9%A0%E6%83%AF">https://gitee.com/openharmony/docs/blob/master/zh-cn/contribute/OpenHarmony-c-coding-style-guide.md#%E5%BB%BA%E8%AE%AE13-%E5%87%BD%E6%95%B0%E7%9A%84%E5%91%BD%E5%90%8D%E9%81%B5%E5%BE%AA%E9%98%85%E8%AF%BB%E4%B9%A0%E6%83%AF</a></li></ol><h1 id="ç®—æ³•ä¸è®¾è®¡æ¨¡å¼"><a href="#ç®—æ³•ä¸è®¾è®¡æ¨¡å¼" class="headerlink" title="ç®—æ³•ä¸è®¾è®¡æ¨¡å¼"></a>ç®—æ³•ä¸è®¾è®¡æ¨¡å¼</h1><h2 id="è®¾è®¡æ¨¡å¼"><a href="#è®¾è®¡æ¨¡å¼" class="headerlink" title="è®¾è®¡æ¨¡å¼"></a>è®¾è®¡æ¨¡å¼</h2><p>è¯¦è§£è´£ä»»é“¾æ¨¡å¼ä»¥åŠAndroidäº‹ä»¶åˆ†å‘ç®€ä»‹ è´£ä»»é“¾æ¨¡å¼ï¼Œæ˜¯è¡Œä¸ºå‹è®¾è®¡æ¨¡å¼ä¹‹ä¸€ã€‚æˆ‘ä»¬å°†å¤šä¸ªèŠ‚ç‚¹é¦–å°¾ç›¸è¿æ‰€æ„æˆçš„æ¨¡å‹ç§°ä¹‹ä¸º - æ˜é‡‘: <a href="https://juejin.cn/post/7001323545909264420">https://juejin.cn/post/7001323545909264420</a></p><p>Nice-Knowledge-System&#x2F;è®¡ç®—æœºåŸºç¡€&#x2F;è®¾è®¡æ¨¡å¼&#x2F;è´£ä»»é“¾æ¨¡å¼(Iterator-chain)&#x2F;è´£ä»»é“¾æ¨¡å¼.md at master Â· maoqitian&#x2F;Nice-Knowledge-System: <a href="https://github.com/maoqitian/Nice-Knowledge-System/blob/master/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F(Iterator-chain)/%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F.md">https://github.com/maoqitian/Nice-Knowledge-System/blob/master/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F(Iterator-chain)/%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F.md</a></p><h2 id="ç®—æ³•"><a href="#ç®—æ³•" class="headerlink" title="ç®—æ³•"></a>ç®—æ³•</h2><p>ç¬¬ 7 ç«  ? æ ‘ - Hello ç®—æ³•: <a href="https://www.hello-algo.com/chapter_tree/#_1">https://www.hello-algo.com/chapter_tree/#_1</a></p><p>krahets&#x2F;LeetCode-Book: ã€Šå‰‘æŒ‡ Offerã€‹ Python, Java, C++ è§£é¢˜ä»£ç ï¼ŒLeetBookã€Šå›¾è§£ç®—æ³•æ•°æ®ç»“æ„ã€‹é…å¥—ä»£ç ä»“: <a href="https://github.com/krahets/LeetCode-Book">https://github.com/krahets/LeetCode-Book</a></p><h1 id="éŸ³è§†é¢‘"><a href="#éŸ³è§†é¢‘" class="headerlink" title="éŸ³è§†é¢‘"></a>éŸ³è§†é¢‘</h1><p>IjkPlayer æ’­æ”¾éŸ³é¢‘ã€å®Œæ•´ä»£ç ï¼›_ijkæ’­æ”¾å™¨ setaudioattributes-CSDNåšå®¢: <a href="https://blog.csdn.net/BirdEatBug/article/details/116715193">https://blog.csdn.net/BirdEatBug/article/details/116715193</a></p><p>leavesCZY&#x2F;ijkplayer-so-extend: è‡ªå®šä¹‰ç¼–è¯‘ ijkplayer so åº“ä»¥ä¾¿æ”¯æŒæ— æŸéŸ³ä¹ï¼Œæ”¯æŒ apeï¼Œwavï¼Œflacç­‰æ ¼å¼: <a href="https://github.com/leavesCZY/ijkplayer-so-extend">https://github.com/leavesCZY/ijkplayer-so-extend</a></p><p>æ’­æ”¾å™¨æ€§èƒ½ä¼˜åŒ–ä¹‹è·¯ä¸‹é¢æ˜¯æ’­æ”¾çš„å®Œæ•´æµç¨‹ï¼šæ’­æ”¾å™¨åŠ è½½ä¸€ä¸ªç½‘ç»œurlï¼Œé¦–å…ˆè¦è¿›è¡Œç½‘ç»œè¯·æ±‚ï¼Œç½‘ç»œå¦‚ä½•ä¼˜åŒ–ï¼Œæ¶‰åŠåˆ°ç½‘ç»œä¼˜åŒ–çš„æ–¹æ–¹ - æ˜é‡‘: <a href="https://juejin.cn/post/6898867991161602061#heading-12">https://juejin.cn/post/6898867991161602061#heading-12</a></p><p>Androidä½¿ç”¨ExoPlayer(PlayerView)æ’­æ”¾ç½‘ç»œè§†é¢‘ å‰è¨€ æœ€è¿‘æœ‰ä¸ªé¡¹ç›®éœ€è¦æ›´æ–°ï¼Œå‘ç°ijkplay - æ˜é‡‘: <a href="https://juejin.cn/post/7384636994980921382">https://juejin.cn/post/7384636994980921382</a></p><p>åŸç”ŸVideoViewä½¿ç”¨æ€»ç»“ | Jianqiuâ€™s blog: <a href="https://niorgai.github.io/2016/11/02/Android-VideoView-tips/">https://niorgai.github.io/2016/11/02/Android-VideoView-tips/</a></p><p>æ”¯æŒçš„åª’ä½“æ ¼å¼ ?|? Android media ?|? Android Developers: <a href="https://developer.android.com/media/platform/supported-formats?hl=zh-cn">https://developer.android.com/media/platform/supported-formats?hl=zh-cn</a></p><p>Androidä¿®è¡Œæ‰‹å†Œ - VideoViewå…¨è§£-ä¸Š??å…³äºä½œè€… ??å‰æ è¿™æ˜¯å°ç©ºåšæŒå†™çš„Androidæ–°æ‰‹å‘ç³»åˆ—ï¼Œ - æ˜é‡‘: <a href="https://juejin.cn/post/7101672387078258701">https://juejin.cn/post/7101672387078258701</a></p><p>Androidä¿®è¡Œæ‰‹å†Œ - VideoViewå…¨è§£-ä¸‹??å…³äºä½œè€… ??å‰æ è¿™æ˜¯å°ç©ºåšæŒå†™çš„Androidæ–°æ‰‹å‘ç³»åˆ—ï¼Œ - æ˜é‡‘: <a href="https://juejin.cn/post/7101838355700121613">https://juejin.cn/post/7101838355700121613</a></p><p>å¥½çœ‹è§†é¢‘Androidé‡æ„â€”â€”å›´ç»•äºæ’­æ”¾å™¨çš„é‡æ„å®è·µ_51CTOåšå®¢_androidè§†é¢‘æ’­æ”¾å™¨çš„åˆ¶ä½œ: <a href="https://blog.51cto.com/u_15082365/3992395">https://blog.51cto.com/u_15082365/3992395</a></p><p>04.è§†é¢‘æ’­æ”¾å™¨é€šç”¨æ¶æ„å®è·µå¯¹äºè§†å›¾çŠ¶æ€åˆ‡æ¢å’ŒåæœŸç»´æŠ¤æ‹“å±•ï¼Œé¿å…åŠŸèƒ½å’Œä¸šåŠ¡å‡ºç°è€¦åˆã€‚æ¯”å¦‚éœ€è¦æ”¯æŒæ’­æ”¾å™¨UIé«˜åº¦å®šåˆ¶ï¼Œè€Œä¸ - æ˜é‡‘: <a href="https://juejin.cn/post/6884170166863986695">https://juejin.cn/post/6884170166863986695</a></p><p>ä¸€ä¸ªè¢«æ ‡è®°ä¸ºå›¾ç‰‡çš„â€œè§†é¢‘â€å¯ä»¥æ’­æ”¾å—è§†é¢‘ç«Ÿç„¶è¢«è¯†åˆ«ä¸ºpngï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ’­æ”¾å®ƒå—ï¼Ÿæœ¬æ–‡ä¸ºäº†å‘ˆç°ä¸€ä¸ªpngè§†é¢‘æ–‡ä»¶å¦‚ä½•è¢«æ’­æ”¾å‡º - æ˜é‡‘: <a href="https://juejin.cn/post/6964241629720887327#heading-5">https://juejin.cn/post/6964241629720887327#heading-5</a></p><p>Android ç³»ç»Ÿæ’­æ”¾å™¨çš„ä¸€äº›ä½¿ç”¨æ³¨æ„äº‹é¡¹ - ç®€ä¹¦: <a href="https://www.jianshu.com/p/d27f79119691">https://www.jianshu.com/p/d27f79119691</a></p><p>AndroidéŸ³è§†é¢‘å¼€å‘ç³»åˆ—-VideoViewä½¿ç”¨ä¸€èµ·å…»æˆå†™ä½œä¹ æƒ¯ï¼è¿™æ˜¯æˆ‘å‚ä¸ã€Œæ˜é‡‘æ—¥æ–°è®¡åˆ’ Â· 4 æœˆæ›´æ–‡æŒ‘æˆ˜ã€çš„ç¬¬ - æ˜é‡‘: <a href="https://juejin.cn/post/7085243234523283464">https://juejin.cn/post/7085243234523283464</a></p><p>jiajunhui&#x2F;PlayerBase: The basic library of Android player will process complex business components. The access is simpleã€‚Androidæ’­æ”¾å™¨åŸºç¡€åº“ï¼Œä¸“æ³¨äºæ’­æ”¾è§†å›¾ç»„ä»¶çš„é«˜å¤ç”¨æ€§å’Œç»„ä»¶é—´çš„ä½è€¦åˆï¼Œè½»æ¾å¤„ç†å¤æ‚ä¸šåŠ¡ã€‚: <a href="https://github.com/jiajunhui/PlayerBase">https://github.com/jiajunhui/PlayerBase</a></p><p>æ¢ç´¢ç§»åŠ¨ç«¯éŸ³è§†é¢‘ä¸GSYVideoPlayerä¹‹æ—… ï½œ Agora Talkä»Šå¤©å°†ç»™ä½ æ¶è¡¥å„ç§å¹³æ—¶å¯èƒ½ä½ ä¸ä¼šåœ¨æ„çš„éŸ³è§†é¢‘ - æ˜é‡‘: <a href="https://juejin.cn/post/7057132141875822622">https://juejin.cn/post/7057132141875822622</a></p><p>ç§»åŠ¨å¼€å‘è€…çš„å¿…çŸ¥éŸ³è§†é¢‘åŸºç¡€çŸ¥è¯†ä½œä¸ºç§»åŠ¨å¼€å‘è€…ï¼Œå¤§å¤šæ•°æ—¶å€™ä¼šéœ€è¦æ¥è§¦åˆ°éŸ³è§†é¢‘ç›¸å…³çš„å¼€å‘ï¼Œè€Œå…¶å®ä¸¥æ ¼æ„ä¹‰ä¸Šæˆ‘ä¹Ÿå¹¶ä¸æ˜¯ä¸“èŒçš„éŸ³ - æ˜é‡‘: <a href="https://juejin.cn/post/6844904039503626247">https://juejin.cn/post/6844904039503626247</a></p><p>06.æ’­æ”¾å™¨UIæŠ½å–å°è£…å¯¹äºè§†å›¾çŠ¶æ€åˆ‡æ¢å’ŒåæœŸç»´æŠ¤æ‹“å±•ï¼Œé¿å…åŠŸèƒ½å’Œä¸šåŠ¡å‡ºç°è€¦åˆã€‚æ¯”å¦‚éœ€è¦æ”¯æŒæ’­æ”¾å™¨UIé«˜åº¦å®šåˆ¶ï¼Œè€Œä¸æ˜¯è¯¥ - æ˜é‡‘: <a href="https://juejin.cn/post/6884028627697500167#heading-2">https://juejin.cn/post/6884028627697500167#heading-2</a></p><p>01.è§†é¢‘æ’­æ”¾å™¨æ¡†æ¶ä»‹ç»å¯¹äºè§†å›¾çŠ¶æ€åˆ‡æ¢å’ŒåæœŸç»´æŠ¤æ‹“å±•ï¼Œé¿å…åŠŸèƒ½å’Œä¸šåŠ¡å‡ºç°è€¦åˆã€‚æ¯”å¦‚éœ€è¦æ”¯æŒæ’­æ”¾å™¨UIé«˜åº¦å®šåˆ¶ï¼Œè€Œä¸æ˜¯è¯¥ - æ˜é‡‘: <a href="https://juejin.cn/post/6883457444752654343">https://juejin.cn/post/6883457444752654343</a></p><p>pili-engineering&#x2F;QPlayer2-Android: <a href="https://github.com/pili-engineering/QPlayer2-Android">https://github.com/pili-engineering/QPlayer2-Android</a></p><p>åŸºç¡€åŠŸèƒ½â€“è§†é¢‘ç›´æ’­-ç«å±±å¼•æ“: <a href="https://www.volcengine.com/docs/6469/95393">https://www.volcengine.com/docs/6469/95393</a> ï¼ˆæ¥å£è®¾è®¡ï¼‰</p><p>æœ€æ–°æœ‰æ•ˆm3u8æ ¼å¼ç›´æ’­åœ°å€(äº²æµ‹æœ‰æ•ˆé•¿æœŸç»´æŠ¤)_m3u8ç›´æ’­æº-CSDNåšå®¢: <a href="https://blog.csdn.net/u014696856/article/details/134442845">https://blog.csdn.net/u014696856/article/details/134442845</a></p><p>M3U8æ’­æ”¾å™¨|M3U8è§†é¢‘|M3U8 Player|ç›´æ’­æº|è§£æå™¨|ä¸‹è½½å™¨|è½¬æ¢å™¨|APP|Windows|ä¸‹è½½ - m3u8play.com: <a href="https://m3u8play.com/">https://m3u8play.com/</a></p><p>Androidä¸­æ’­æ”¾éŸ³ä¹çš„å‡ ç§æ–¹å¼_å®‰å“å¼€å‘æ’­æ”¾éŸ³ä¹-CSDNåšå®¢: <a href="https://blog.csdn.net/u013366008/article/details/76577372">https://blog.csdn.net/u013366008/article/details/76577372</a></p><h2 id="IJK"><a href="#IJK" class="headerlink" title="IJK"></a>IJK</h2><p>ijkæ’­æ”¾å™¨ç¼“å†²æœºåˆ¶_ijkç¼“å­˜-CSDNåšå®¢: <a href="https://blog.csdn.net/m0_37624402/article/details/127768229">https://blog.csdn.net/m0_37624402/article/details/127768229</a></p><p>IjkPlayeræ’­æ”¾å™¨ç§’å¼€ä¼˜åŒ–ä»¥åŠå¸¸ç”¨Optionè®¾ç½® - ç®€ä¹¦: <a href="https://www.jianshu.com/p/843c86a9e9ad">https://www.jianshu.com/p/843c86a9e9ad</a></p><p>è¯·é—®ijkhttphookå¦‚ä½•è®¾ç½®ï¼Ÿ Â· Issue #3508 Â· bilibili&#x2F;ijkplayer: <a href="https://github.com/Bilibili/ijkplayer/issues/3508">https://github.com/Bilibili/ijkplayer/issues/3508</a></p><p>ijkplayer-hookåè®®å®ç°åˆ†æ_ijkmediaplayer.onnativeinvokelistener-CSDNåšå®¢: <a href="https://blog.csdn.net/u010029439/article/details/106940633">https://blog.csdn.net/u010029439/article/details/106940633</a></p><p>android ijkplayer ä¸­é‡åˆ°çš„é—®é¢˜_ijk 4kå¡é¡¿-CSDNåšå®¢: <a href="https://blog.csdn.net/Zophar_Development/article/details/105681351">https://blog.csdn.net/Zophar_Development/article/details/105681351</a></p><p>ijkplayerç›´æ’­æ’­æ”¾å™¨ä½¿ç”¨ç»éªŒä¹‹è°ˆâ€”â€”å¡é¡¿ä¼˜åŒ–å’Œç§’å¼€å®ç°_libijkplayer æ’­æ”¾ç›´æ’­æµå¡é¡¿-CSDNåšå®¢: <a href="https://blog.csdn.net/cmshao/article/details/80149176">https://blog.csdn.net/cmshao/article/details/80149176</a></p><p>ijkplayer æ–­çº¿é‡è¿é—®é¢˜_ç§»åŠ¨å¼€å‘-CSDNé—®ç­”: <a href="https://ask.csdn.net/questions/7462194">https://ask.csdn.net/questions/7462194</a></p><p>éŸ³é¢‘å¼€å‘ijkplayerå°ç»“ android-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘: <a href="https://cloud.tencent.com/developer/article/1141278">https://cloud.tencent.com/developer/article/1141278</a></p><p>ijkplayeréŸ³é¢‘æ’­æ”¾åˆ†æ_ijkplayer æ’­æ”¾éŸ³é¢‘-CSDNåšå®¢: <a href="https://blog.csdn.net/sjdjdjdjahd/article/details/125656367">https://blog.csdn.net/sjdjdjdjahd/article/details/125656367</a></p><p>ijkplayerä¸­é‡åˆ°çš„é—®é¢˜æ±‡æ€»åœ¨åšéŸ³é¢‘æ’­æ”¾çš„æ—¶å€™ï¼Œå¾ˆå¤šå…¬å¸ä½¿ç”¨çš„æ˜¯å¼€æºçš„ijkplayeræ’­æ”¾å™¨ï¼Œijkplayer - æ˜é‡‘: <a href="https://juejin.cn/post/6844904101717737486">https://juejin.cn/post/6844904101717737486</a></p><h2 id="æœ¬åœ°ä»£ç†ï¼ˆç¼“å­˜ï¼‰"><a href="#æœ¬åœ°ä»£ç†ï¼ˆç¼“å­˜ï¼‰" class="headerlink" title="æœ¬åœ°ä»£ç†ï¼ˆç¼“å­˜ï¼‰"></a>æœ¬åœ°ä»£ç†ï¼ˆç¼“å­˜ï¼‰</h2><p>åæ€ | Android éŸ³è§†é¢‘ç¼“å­˜æœºåˆ¶çš„ç³»ç»Ÿæ€§è®¾è®¡æœ¬æ–‡å°†é’ˆå¯¹ Android éŸ³è§†é¢‘ç¼“å­˜è§£å†³æ–¹æ¡ˆä¸­ï¼Œå…ˆé©±çº§åˆ«çš„ And - æ˜é‡‘: <a href="https://juejin.cn/post/7011881370968408071">https://juejin.cn/post/7011881370968408071</a></p><p>Robin-jiangyufeng&#x2F;LazyCacheForAndroid: androidç¼“å­˜åº“,å…·æœ‰äºŒçº§ç¼“å­˜åŠŸèƒ½,å¯ä»¥è‡ªå·±å®šå®ç°ä¸‰çº§ç¼“å­˜;å¯æ‰©å±•æ€§é«˜: <a href="https://github.com/Robin-jiangyufeng/LazyCacheForAndroid">https://github.com/Robin-jiangyufeng/LazyCacheForAndroid</a></p><p>Android çš„äºŒçº§ç¼“å­˜å¦‚æ­¤ç®€å• - ç®€ä¹¦: <a href="https://www.jianshu.com/p/6146de689e2a">https://www.jianshu.com/p/6146de689e2a</a></p><p>Android è¾¹æ’­æ”¾è¾¹ç¼“å­˜è§†é¢‘æ¡†æ¶AndroidVideoCacheç®€æ - ä¸ªäººæ–‡ç«  - SegmentFault æ€å¦: <a href="https://segmentfault.com/a/1190000042342132">https://segmentfault.com/a/1190000042342132</a></p><p>Androidè¿›é˜¶ä¹‹è·¯ - VideoViewä»å…¥é—¨åˆ°å®è·µ_android videoview-CSDNåšå®¢: <a href="https://blog.csdn.net/qq_20451879/article/details/118151866">https://blog.csdn.net/qq_20451879/article/details/118151866</a></p><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="å¾®ä¿¡å°ç¨‹åº"><a href="#å¾®ä¿¡å°ç¨‹åº" class="headerlink" title="å¾®ä¿¡å°ç¨‹åº"></a>å¾®ä¿¡å°ç¨‹åº</h2><p>åŸºç¡€èƒ½åŠ› &#x2F; ç½‘ç»œ &#x2F; å±€åŸŸç½‘é€šä¿¡: <a href="https://developers.weixin.qq.com/miniprogram/dev/framework/ability/mDNS.html">https://developers.weixin.qq.com/miniprogram/dev/framework/ability/mDNS.html</a><br>å°ç¨‹åºæœ‰æ²¡æœ‰èƒ½å®ç°dlnaæŠ•å±åŠŸèƒ½çš„æ–¹æ³•ï¼Ÿ | å¾®ä¿¡å¼€æ”¾ç¤¾åŒº: <a href="https://developers.weixin.qq.com/community/develop/doc/0000ca60784748677d7f569b65d000?highLine=dlna">https://developers.weixin.qq.com/community/develop/doc/0000ca60784748677d7f569b65d000?highLine=dlna</a></p><p>åª’ä½“ &#x2F; è§†é¢‘ &#x2F; VideoContext: <a href="https://developers.weixin.qq.com/miniprogram/dev/api/media/video/VideoContext.html">https://developers.weixin.qq.com/miniprogram/dev/api/media/video/VideoContext.html</a></p><p>ä»æ–‡æ¡£å‡ºå‘ï¼Œæ¥èŠä¸€èŠå°ç¨‹åºçš„æœåŠ¡ç«¯å¼€å‘ | å¾®ä¿¡å¼€æ”¾ç¤¾åŒº: <a href="https://developers.weixin.qq.com/community/develop/article/doc/0004ce700c8350866929e10515b413">https://developers.weixin.qq.com/community/develop/article/doc/0004ce700c8350866929e10515b413</a></p><p>mDNS å±€åŸŸç½‘é€šä¿¡ | å¾®ä¿¡å¼€æ”¾ç¤¾åŒº: <a href="https://developers.weixin.qq.com/community/develop/doc/0004ac496908a0e6fe97d103851000?highLine=dlna">https://developers.weixin.qq.com/community/develop/doc/0004ac496908a0e6fe97d103851000?highLine=dlna</a></p><p>ä½¿ç”¨å°ç¨‹åºUDP APIåŠŸèƒ½ï¼Œå®ç°è°ƒè¯•æœ¬åœ°UDPæœåŠ¡ | å¾®ä¿¡å¼€æ”¾ç¤¾åŒº: <a href="https://developers.weixin.qq.com/community/develop/article/doc/000c8ad4ec8338dc754178f9666813">https://developers.weixin.qq.com/community/develop/article/doc/000c8ad4ec8338dc754178f9666813</a></p><h1 id="ä¸“åˆ©"><a href="#ä¸“åˆ©" class="headerlink" title="ä¸“åˆ©"></a>ä¸“åˆ©</h1><p>CN108595214A - å®‰å“userç‰ˆæœ¬åœ¨SELinuxå¼ºåˆ¶æ¨¡å¼ä¸‹è·å–rootç‰¹æƒçš„æ–¹æ³•åŠç³»ç»Ÿ - Google Patents: <a href="https://patents.google.com/patent/CN108595214A/zh">https://patents.google.com/patent/CN108595214A/zh</a></p><p>CN105607921A - ä¸€ç§åŸºäºAndroidç³»ç»Ÿçš„ç³»ç»ŸæœåŠ¡å¯åŠ¨æ–¹æ³•åŠç³»ç»Ÿ - Google Patents: <a href="https://patents.google.com/patent/CN105607921A/zh">https://patents.google.com/patent/CN105607921A/zh</a></p><p>CN111382425A - å¤šç­¾åæœºåˆ¶ä¸‹çš„åº”ç”¨å®‰è£…ç®¡ç†æ–¹æ³•ã€æ™ºèƒ½ç»ˆç«¯åŠå­˜å‚¨ä»‹è´¨ - Google Patents: <a href="https://patents.google.com/patent/CN111382425A/zh">https://patents.google.com/patent/CN111382425A/zh</a></p><p>CN102662870A - åŸºäºvfså±‚æ‹¦æˆªè¯»å†™è¯·æ±‚çš„å®‰å“æ“ä½œç³»ç»Ÿä¿æŠ¤æ–¹æ³• - Google Patents: <a href="https://patents.google.com/patent/CN102662870A/zh">https://patents.google.com/patent/CN102662870A/zh</a></p><p>CN103455416A - ä¸€ç§åŸºäºå ç”¨Androidç³»ç»Ÿæ™ºèƒ½è®¾å¤‡å†…å­˜å’ŒCPUçš„å‹åŠ›æµ‹è¯•æ–¹æ³• - Google Patents: <a href="https://patents.google.com/patent/CN103455416A/zh">https://patents.google.com/patent/CN103455416A/zh</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ä¸€äº›æœ‰æ•ˆçš„å·¥ä½œæ–¹æ³•</title>
    <link href="/article/b6e36186/"/>
    <url>/article/b6e36186/</url>
    
    <content type="html"><![CDATA[<p>å®‰å“ç¬¬ä¸‰æ–¹åº“é€‰æ‹©ï¼šè¦è€ƒè™‘å…¼å®¹æ€§ã€å¯ç»´æŠ¤æ€§ã€æ€§èƒ½æ¯”è¾ƒ</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>android IPC: å®‰å“è¿›ç¨‹é—´é€šè®¯çš„å‡ ç§æ–¹å¼</title>
    <link href="/article/7bbe7ac8/"/>
    <url>/article/7bbe7ac8/</url>
    
    <content type="html"><![CDATA[<p>Androidä¸­ç›®å‰å­˜åœ¨å¤šç§IPCæ–¹å¼ï¼Œåˆ†åˆ«ä¸ºï¼š</p><ul><li><p>Bundle</p></li><li><p>æ–‡ä»¶å…±äº«</p></li><li><p>Messenger</p></li><li><p>AIDL</p></li><li><p>ContentProvider</p></li><li><p>Socket</p></li><li><h3 id="IPCæ–¹å¼çš„ä¼˜ç¼ºç‚¹å’Œé€‚ç”¨åœºæ™¯"><a href="#IPCæ–¹å¼çš„ä¼˜ç¼ºç‚¹å’Œé€‚ç”¨åœºæ™¯" class="headerlink" title="IPCæ–¹å¼çš„ä¼˜ç¼ºç‚¹å’Œé€‚ç”¨åœºæ™¯"></a>IPCæ–¹å¼çš„ä¼˜ç¼ºç‚¹å’Œé€‚ç”¨åœºæ™¯</h3><table><thead><tr><th>æ–¹å¼</th><th>èƒ½åŠ›</th><th>ç‰¹ç‚¹</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>AIDL</td><td>æ”¯æŒä¸€å¯¹å¤šå¹¶å‘é€šä¿¡ã€æ”¯æŒå®æ—¶é€šä¿¡ã€æ”¯æŒè·¨è¿›ç¨‹å‡½æ•°è°ƒç”¨</td><td>éœ€è¦ç‹¬ç«‹å®šä¹‰.aidlè§„èŒƒã€éœ€è¦æ·»åŠ .aidlæ–‡ä»¶ã€ä½¿ç”¨è¾ƒå¤æ‚</td><td>ä¸€å¯¹å¤šå³æ—¶é€šä¿¡ï¼Œæœ‰RPCéœ€æ±‚</td></tr><tr><td>Messenger</td><td>æ”¯æŒä¸€å¯¹å¤šä¸²è¡Œé€šä¿¡ã€æ”¯æŒå®æ—¶é€šä¿¡ã€æ”¯æŒBundleä¼ é€’</td><td>æ— éœ€ç‹¬ç«‹å®šä¹‰.aidlè§„èŒƒã€æ— éœ€æ·»åŠ .aidlæ–‡ä»¶ã€ä½¿ç”¨è¾ƒç®€æ´</td><td>ä½å¹¶å‘çš„ä¸€å¯¹å¤šå³æ—¶é€šä¿¡ï¼Œæ— è¿”å›ç»“æœçš„RPCéœ€æ±‚</td></tr></tbody></table></li></ul><p><a href="https://segmentfault.com/a/1190000040558520">ã€ŒAndroidã€åŸºäºè½»é‡çº§Messengerçš„è¿›ç¨‹é€šä¿¡ - ä¸ªäººæ–‡ç«  - SegmentFault æ€å¦</a></p>]]></content>
    
    
    <categories>
      
      <category>Android IPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>android ipc</tag>
      
      <tag>android rpc</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®‰å“æºç ç¯å¢ƒ:Android.mkå¦‚ä½•ç¼–è¯‘aaråŒ…?</title>
    <link href="/article/797e1cc1/"/>
    <url>/article/797e1cc1/</url>
    
    <content type="html"><![CDATA[<p>åœ¨å®‰å“æºç topç›®å½•æ‰§è¡Œç¼–è¯‘å‘½ä»¤ï¼šï¼ˆæ³¨æ„ï¼šä¸‹é¢çš„Android.mkè¦è¢«includeè¿›å»ï¼‰</p><p><code>make test_aar out/target/common/obj/JAVA_LIBRARIES/test_aar_intermediates/javalib.aar</code></p><p>é€šç”¨æ ¼å¼ï¼š<code>make &lt;module-name&gt; out/target/common/obj/JAVA_LIBRARIES/&lt;module-name&gt;_intermediates/javalib.aar</code></p><p>æŠŠ<module-name>æ›¿æ¢æˆLOCAL_MODULEçš„åå­—ã€‚</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs makefile">LOCAL_PATH := <span class="hljs-variable">$(<span class="hljs-built_in">call</span> my-<span class="hljs-built_in">dir</span>)</span><br><span class="hljs-keyword">include</span> <span class="hljs-variable">$(CLEAR_VARS)</span><br><br>LOCAL_MODULE_TAGS := optional<br><br>LOCAL_MODULE := test_aar<br><br>LOCAL_STATIC_JAVA_LIBRARIES :=android-common \<br>    android-support-v4 \<br><br><span class="hljs-comment"># LOCAL_STATIC_JAVA_AAR_LIBRARIES:= abc</span><br><br>LOCAL_SRC_FILES := <span class="hljs-variable">$(<span class="hljs-built_in">call</span> all-java-files-under, java)</span><br><br>res_dirs := res \<br><br>LOCAL_RESOURCE_DIR := <span class="hljs-variable">$(<span class="hljs-built_in">addprefix</span> <span class="hljs-variable">$(LOCAL_PATH)</span>/, <span class="hljs-variable">$(res_dirs)</span>)</span> \<br>    prebuilts/sdk/current/support/v7/cardview/res \<br>    prebuilts/sdk/current/support/v7/appcompat/res \<br>    prebuilts/sdk/current/support/design/res \<br><br>LOCAL_AAPT_FLAGS := \<br>    --auto-add-overlay \<br>    --extra-packages android.support.v7.cardview \<br>    --extra-packages android.support.v7.appcompat \<br>    --extra-packages android.support.design \<br>    --extra-packages com.abc.abc<br><br><br>LOCAL_JACK_ENABLED := disabled <br>LOCAL_PROGUARD_ENABLED := disabled <br><br><span class="hljs-keyword">include</span> <span class="hljs-variable">$(BUILD_STATIC_JAVA_LIBRARY)</span><br></code></pre></td></tr></table></figure><p><a href="https://android.googlesource.com/platform/build/+/master/core/static_java_library.mk#133">https://android.googlesource.com/platform/build/+/master/core/static_java_library.mk#133</a></p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-comment"># Rule to build AAR, archive including classes.jar, resource, etc.</span><br>built_aar := $(intermediates.COMMON)/javalib.aar<br><span class="hljs-variable">$(built_aar)</span>: PRIVATE_MODULE := <span class="hljs-variable">$(LOCAL_MODULE)</span><br><span class="hljs-variable">$(built_aar)</span>: PRIVATE_ANDROID_MANIFEST := <span class="hljs-variable">$(full_android_manifest)</span><br><span class="hljs-variable">$(built_aar)</span>: PRIVATE_CLASSES_JAR := <span class="hljs-variable">$(aar_classes_jar)</span><br><span class="hljs-variable">$(built_aar)</span>: PRIVATE_RESOURCE_DIR := <span class="hljs-variable">$(LOCAL_RESOURCE_DIR)</span><br><span class="hljs-variable">$(built_aar)</span>: PRIVATE_R_TXT := $(intermediates.COMMON)/R.txt<br><span class="hljs-variable">$(built_aar)</span>: <span class="hljs-variable">$(JAR_ARGS)</span><br><span class="hljs-variable">$(built_aar)</span> : <span class="hljs-variable">$(aar_classes_jar)</span> <span class="hljs-variable">$(full_android_manifest)</span> $(intermediates.COMMON)/R.txt<br>@echo <span class="hljs-string">&quot;target AAR:  <span class="hljs-variable">$(PRIVATE_MODULE)</span> (<span class="hljs-variable">$@</span>)&quot;</span><br><span class="hljs-variable">$(hide)</span> rm -rf <span class="hljs-variable">$(<span class="hljs-built_in">dir</span> <span class="hljs-variable">$@</span>)</span>aar &amp;&amp; mkdir -p <span class="hljs-variable">$(<span class="hljs-built_in">dir</span> <span class="hljs-variable">$@</span>)</span>aar/res<br><span class="hljs-variable">$(hide)</span> cp <span class="hljs-variable">$(PRIVATE_ANDROID_MANIFEST)</span> <span class="hljs-variable">$(<span class="hljs-built_in">dir</span> <span class="hljs-variable">$@</span>)</span>aar/AndroidManifest.xml<br><span class="hljs-variable">$(hide)</span> cp <span class="hljs-variable">$(PRIVATE_CLASSES_JAR)</span> <span class="hljs-variable">$(<span class="hljs-built_in">dir</span> <span class="hljs-variable">$@</span>)</span>aar/classes.jar<br><span class="hljs-comment"># Note: Use &quot;cp -n&quot; to honor the resource overlay rules, if multiple res dirs exist.</span><br><span class="hljs-variable">$(hide)</span> <span class="hljs-variable">$(<span class="hljs-built_in">foreach</span> res,<span class="hljs-variable">$(PRIVATE_RESOURCE_DIR)</span>,cp -Rfn <span class="hljs-variable">$(res)</span>/* $(<span class="hljs-built_in">dir</span> <span class="hljs-variable">$@</span>)</span>aar/res;)<br><span class="hljs-variable">$(hide)</span> cp <span class="hljs-variable">$(PRIVATE_R_TXT)</span> <span class="hljs-variable">$(<span class="hljs-built_in">dir</span> <span class="hljs-variable">$@</span>)</span>aar/R.txt<br><span class="hljs-variable">$(hide)</span> <span class="hljs-variable">$(JAR)</span> -cMf <span class="hljs-variable">$@</span> \<br>  <span class="hljs-variable">$(<span class="hljs-built_in">call</span> jar-args-sorted-files-in-directory,$(<span class="hljs-built_in">dir</span> <span class="hljs-variable">$@</span>)</span>aar)<br><br></code></pre></td></tr></table></figure><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p>how to create AAR archive file from Android.mk - Stack Overflow: <a href="https://stackoverflow.com/questions/42070123/how-to-create-aar-archive-file-from-android-mk">https://stackoverflow.com/questions/42070123/how-to-create-aar-archive-file-from-android-mk</a></p><p>Build AAR package as part of AOSP build: <a href="https://groups.google.com/g/android-building/c/htNXz9Lkq7E?pli=1">https://groups.google.com/g/android-building/c/htNXz9Lkq7E?pli=1</a></p>]]></content>
    
    
    <categories>
      
      <category>Android Build System</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>aospç¼–è¯‘</tag>
      
      <tag>Android.mk</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>jadxå†…å­˜ä¸è¶³å’Œåç¼–è¯‘å¤±è´¥å®˜æ–¹è§£å†³åŠæ³•</title>
    <link href="/article/5ee2a33b/"/>
    <url>/article/5ee2a33b/</url>
    
    <content type="html"><![CDATA[<p>å¦‚æœæœç´¢å¼•æ“æœç´¢äº†å¥½ä¹…éƒ½è§£å†³ä¸äº†é—®é¢˜ï¼Œå»ºè®®åˆ°å®˜æ–¹æ–‡æ¡£çœ‹ä¸€ä¸‹ã€‚</p><p><a href="https://github.com/skylot/jadx/wiki/Troubleshooting-Q&A#decompilation-issues">Troubleshooting Q&amp;A Â· skylot&#x2F;jadx Wiki</a></p><h3 id="å†…å­˜ä¸è¶³é—®é¢˜"><a href="#å†…å­˜ä¸è¶³é—®é¢˜" class="headerlink" title="å†…å­˜ä¸è¶³é—®é¢˜"></a>å†…å­˜ä¸è¶³é—®é¢˜</h3><h4 id="æ–¹æ³•ä¸€ï¼šåœ¨åç¼–è¯‘è®¾ç½®é‡Œå‡å°‘å¤„ç†çº¿ç¨‹æ•°"><a href="#æ–¹æ³•ä¸€ï¼šåœ¨åç¼–è¯‘è®¾ç½®é‡Œå‡å°‘å¤„ç†çº¿ç¨‹æ•°" class="headerlink" title="æ–¹æ³•ä¸€ï¼šåœ¨åç¼–è¯‘è®¾ç½®é‡Œå‡å°‘å¤„ç†çº¿ç¨‹æ•°"></a>æ–¹æ³•ä¸€ï¼šåœ¨åç¼–è¯‘è®¾ç½®é‡Œå‡å°‘å¤„ç†çº¿ç¨‹æ•°</h4><h4 id="æ–¹æ³•äºŒï¼šåœ¨åç¼–è¯‘è®¾ç½®é‡Œæ’é™¤ä¸éœ€è¦çš„åŒ…"><a href="#æ–¹æ³•äºŒï¼šåœ¨åç¼–è¯‘è®¾ç½®é‡Œæ’é™¤ä¸éœ€è¦çš„åŒ…" class="headerlink" title="æ–¹æ³•äºŒï¼šåœ¨åç¼–è¯‘è®¾ç½®é‡Œæ’é™¤ä¸éœ€è¦çš„åŒ…"></a>æ–¹æ³•äºŒï¼šåœ¨åç¼–è¯‘è®¾ç½®é‡Œæ’é™¤ä¸éœ€è¦çš„åŒ…</h4><h4 id="æ–¹æ³•ä¸‰ï¼šåœ¨è®¾ç½®ä¸­å¯ç”¨ç£ç›˜ç¼“å­˜"><a href="#æ–¹æ³•ä¸‰ï¼šåœ¨è®¾ç½®ä¸­å¯ç”¨ç£ç›˜ç¼“å­˜" class="headerlink" title="æ–¹æ³•ä¸‰ï¼šåœ¨è®¾ç½®ä¸­å¯ç”¨ç£ç›˜ç¼“å­˜"></a>æ–¹æ³•ä¸‰ï¼šåœ¨è®¾ç½®ä¸­å¯ç”¨ç£ç›˜ç¼“å­˜</h4><h4 id="æ–¹æ³•å››ï¼šä¸º-Jadx-åˆ†é…æ›´å¤šå†…å­˜"><a href="#æ–¹æ³•å››ï¼šä¸º-Jadx-åˆ†é…æ›´å¤šå†…å­˜" class="headerlink" title="æ–¹æ³•å››ï¼šä¸º Jadx åˆ†é…æ›´å¤šå†…å­˜"></a>æ–¹æ³•å››ï¼šä¸º Jadx åˆ†é…æ›´å¤šå†…å­˜</h4><p>æ–¹æ³•ä¸€ï¼šç¼–è¾‘è„šæœ¬<code>bin/jadx-gui</code>æˆ–<code>bin/jadx-gui.bat</code> (Windows) å¹¶é€šè¿‡ä¿®æ”¹<code>DEFAULT_JVM_OPTS</code>çš„å®šä¹‰å°†æœ€å¤§å †å†…å­˜ä» 4 ( <code>-Xmx4g</code> ) æ›´æ”¹ä¸º 8 GB ( <code>-Xmx8g</code> ) </p><p><code>DEFAULT_JVM_OPTS=&#39;&quot;-Xms128M&quot; &quot;-Xmx8g&quot; &quot;-Dawt.useSystemAAFontSettings=lcd&quot; &quot;-Dswing.aatext=true&quot; &quot;-XX:+UseG1GC&quot;&#39;</code></p><p>æ–¹æ³•äºŒï¼šå¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ Windows å¹¶ä½¿ç”¨<code>jadx-gui.exe</code>è¯·åœ¨<code>jadx-gui.exe</code>æ‰€åœ¨çš„åŒä¸€ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶<code>jadx-gui.l4j.ini</code> ã€‚å¯¹äºæœ€å¤§ 8 GB å†…å­˜&#x2F;å †ï¼Œè¯·ç¼–è¾‘è¯¥æ–‡æœ¬æ–‡ä»¶å¹¶å°†å…¶å†…å®¹è®¾ç½®ä¸ºï¼š</p><p><code>-Xmx8g</code></p><p>å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ä¸ç¨³å®šç‰ˆæœ¬æˆ– Jadx æˆ–è€…æ‚¨å·²é‡å‘½å<code>jadx-gui.exe</code> ï¼Œåˆ™è¿˜å¿…é¡»è°ƒæ•´<code>.l4j.ini</code>æ–‡ä»¶åã€‚</p><p>ä¾‹å­ï¼š</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ini">Jadx file-name:        jadx-gui-1.1.0-b1279-2207cd7b.exe<br>Jadx config file name: jadx-gui-1.1.0-b1279-2207cd7b.l4j.ini.<br></code></pre></td></tr></table></figure><h3 id="åç¼–è¯‘å¤±è´¥"><a href="#åç¼–è¯‘å¤±è´¥" class="headerlink" title="åç¼–è¯‘å¤±è´¥"></a>åç¼–è¯‘å¤±è´¥</h3><p>å‹¾é€‰åç¼–è¯‘-æ˜¾ç¤ºä¸ä¸€è‡´çš„ä»£ç  <code>Show inconsistent code</code> (<code>--show-bad-code</code> in jadx-cli)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UnsupportedOperationException</span>(<span class="hljs-string">&quot;Method not decompiled:xxxxxxxxxxx&quot;</span>)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å®‰å“å®‰å…¨å’Œé€†å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>jadx</tag>
      
      <tag>åç¼–è¯‘</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å“”å“©å“”å“©ç›´æ’­é“¾æ¥æŠ¥403è§£å†³åŠæ³•</title>
    <link href="/article/c0d037a/"/>
    <url>/article/c0d037a/</url>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘æŠ•å±æ¥åˆ°å®¢è¯‰è¯´è‹¹æœå“”å“©å“”å“©å®¢æˆ·ç«¯æŠ•ç›´æ’­ä¼šæ˜¾ç¤ºæ’­æ”¾å¤±è´¥ã€‚</p><p>æˆ‘æµ‹è¯•å‘ç°å®‰å“ç«¯å“”å“©å“”å“©æ˜¯æ­£å¸¸çš„ï¼ŒæŸæŠ•å±è½¯ä»¶ä¹Ÿèƒ½æ­£å¸¸æ’­æ”¾ï¼Œæˆ‘å¯¹æ­¤æ„Ÿåˆ°å›°æƒ‘ã€‚é€šè¿‡<code>tcpdump</code>åˆ†æï¼Œå‘ç°å®ƒçš„ijkæ’­æ”¾å™¨åœ¨è®¿é—®é“¾æ¥æ—¶æ”¹å˜äº†User Agentã€‚</p><p>ç„¶åæˆ‘å°±å¼€å§‹æµ‹è¯•äº†ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java">headers.put(<span class="hljs-string">&quot;User-Agent&quot;</span>, <span class="hljs-string">&quot;Mozilla/5.0.BiliTV/1.7.2&quot;</span>); <span class="hljs-comment">//æ­£å¸¸</span><br>headers.put(<span class="hljs-string">&quot;User-Agent&quot;</span>, <span class="hljs-string">&quot;Bilibili Freedoooooom/MarkII&quot;</span>);<span class="hljs-comment">//æ­£å¸¸</span><br>headers.put(<span class="hljs-string">&quot;User-Agent&quot;</span>, <span class="hljs-string">&quot;Linux Androi&quot;</span>);<span class="hljs-comment">//æ­£å¸¸</span><br>headers.put(<span class="hljs-string">&quot;User-Agent&quot;</span>, <span class="hljs-string">&quot;Android&quot;</span>);<span class="hljs-comment">//403 forbidden</span><br>headers.put(<span class="hljs-string">&quot;User-Agent&quot;</span>, <span class="hljs-string">&quot;stagefright&quot;</span>);<span class="hljs-comment">//403 forbidden</span><br>headers.put(<span class="hljs-string">&quot;User-Agent&quot;</span>, <span class="hljs-string">&quot;a&quot;</span>);<span class="hljs-comment">//æ­£å¸¸</span><br>headers.put(<span class="hljs-string">&quot;User-Agent&quot;</span>, <span class="hljs-string">&quot;Androi&quot;</span>);<span class="hljs-comment">//æ­£å¸¸</span><br>headers.put(<span class="hljs-string">&quot;User-Agent&quot;</span>, <span class="hljs-string">&quot;stagefrigh&quot;</span>);<span class="hljs-comment">//æ­£å¸¸</span><br></code></pre></td></tr></table></figure><p>ç»æµ‹è¯•å‘ç°å«æœ‰Androidæˆ–è€…stagefrightéƒ½ä¼šå¯¼è‡´è®¿é—®403ï¼Œå…¶ä»–éƒ½æ­£å¸¸ã€‚</p><p>è€Œå®‰å“é»˜è®¤çš„User Agentå°±åŒ…å«äº†Androidå’Œstagefrightã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java">AString <span class="hljs-title function_">MakeUserAgent</span><span class="hljs-params">()</span> &#123;<br>    AString ua;<br>    ua.append(<span class="hljs-string">&quot;stagefright/1.2 (Linux;Android &quot;</span>);<br>#<span class="hljs-keyword">if</span> (PROPERTY_VALUE_MAX &lt; <span class="hljs-number">8</span>)<br>#error <span class="hljs-string">&quot;PROPERTY_VALUE_MAX must be at least 8&quot;</span><br>#endif<br>    <span class="hljs-type">char</span> value[PROPERTY_VALUE_MAX];<br>    property_get(<span class="hljs-string">&quot;ro.build.version.release&quot;</span>, value, <span class="hljs-string">&quot;Unknown&quot;</span>);<br>    ua.append(value);<br>    ua.append(<span class="hljs-string">&quot;)&quot;</span>);<br>    <span class="hljs-keyword">return</span> ua;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h2><p>æ—¢ç„¶çŸ¥é“äº†é—®é¢˜åŸå› ï¼Œé‚£ä¹ˆè§£å†³èµ·æ¥å°±å¾ˆç®€å•äº†ï¼Œå½“åˆ¤æ–­æ˜¯å“”å“©å“”å“©çš„ç›´æ’­é“¾æ¥æ—¶ï¼Œæ”¹å˜æ’­æ”¾å™¨çš„user agentã€‚</p><h3 id="ijkæ’­æ”¾å™¨"><a href="#ijkæ’­æ”¾å™¨" class="headerlink" title="ijkæ’­æ”¾å™¨"></a>ijkæ’­æ”¾å™¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">mIjkPlayer.setOption(IjkMediaPlayer.OPT_CATEGORY_FORMAT, <span class="hljs-string">&quot;user_agent&quot;</span>, <span class="hljs-string">&quot;Bilibili Freedoooooom/MarkII&quot;</span>);<br></code></pre></td></tr></table></figure><h3 id="MediaPlayeræ’­æ”¾å™¨"><a href="#MediaPlayeræ’­æ”¾å™¨" class="headerlink" title="MediaPlayeræ’­æ”¾å™¨"></a>MediaPlayeræ’­æ”¾å™¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">headers.put(<span class="hljs-string">&quot;User-Agent&quot;</span>, <span class="hljs-string">&quot;Bilibili Freedoooooom/MarkII&quot;</span>);<br>mPlayer.setDataSource(<span class="hljs-built_in">this</span>, Uri.parse(videoUrl), headers);<br></code></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œç”±äºè°·æ­Œçš„bugï¼Œå®‰å“5.0å’Œ5.1ä¸æ”¯æŒè¯¥è®¾ç½®</p><p>[MediaPlayer ignores User-Agent header <a href="https://issuetracker.google.com/issues/37018604?pli=1">37018604] - Issue Tracker</a></p><p><a href="https://android-review.googlesource.com/c/platform/frameworks/av/+/124333/1/media/libstagefright/http/MediaHTTP.cpp#b53">â€¦&#x2F;MediaHTTP.cpp Â· Gerrit Code Review</a></p><h3 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h3><p>å½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡æœ¬åœ°ä»£ç†æ¥è§£å†³ï¼Œæ‹¦æˆªæ’­æ”¾è¯·æ±‚å°±å¯ä»¥éšæ„æ”¹å˜user agentäº†ï¼Œè¿™ä¹Ÿå¯ä»¥è§£å†³å®‰å“5.0ä»¥ä¸‹MediaPlayerä¸æ”¯æŒæŸäº›tlsç‰ˆæœ¬çš„é—®é¢˜ã€‚</p><p>å‚è€ƒé“¾æ¥ï¼š</p><p><a href="https://blog.51cto.com/u_16213339/7466348">å“”å“©å“”å“©è§†é¢‘403ForbiddenåŸå› </a></p><p><a href="https://im.salty.fish/index.php/archives/revengr-bilibili-352.html">æµ…åº¦å‰–æBç«™çš„æ–° -352 é£æ§ç­–ç•¥ - A Salty Blog</a></p>]]></content>
    
    
    <categories>
      
      <category>æŠ•å±</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æŠ•å±</tag>
      
      <tag>ç½‘ç»œ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Android java.lang.IncompatibleClassChangeError</title>
    <link href="/article/a299c970/"/>
    <url>/article/a299c970/</url>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘ä¸ºäº†è§£å†³ä¸€ä¸ªé—®é¢˜ï¼Œéœ€è¦åœ¨å‡çº§Xåº”ç”¨æ—¶å¯¹å…¶åšstartInstrumentationã€‚åŠŸèƒ½ä¸Šçº¿åï¼Œæ•°æ®ç›‘æ§å¹³å°å‘ç°å­˜åœ¨IncompatibleClassChangeErrorï¼Œä¸»è¦é›†ä¸­åœ¨å®‰å“5.1ï¼Œ6.0ï¼Œå°‘é‡åœ¨å®‰å“8.0ã€‚ç©¶ç«Ÿæ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿä¸€èµ·æ¥åˆ†æä¸€ä¸‹ã€‚</p><p>å®‰å“6.0æœºå™¨</p><blockquote><p>java.lang.IncompatibleClassChangeError: retrofit2.converter.gson.GsonConverterFactory at dalvik.system.DexFile.defineClassNative(Native Method) at dalvik.system.DexFile.defineClass(DexFile.java:226) at dalvik.system.DexFile.loadClassBinaryName(DexFile.java:219) at dalvik.system.DexPathList.findClass(DexPathList.java:339) at dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:54) at java.lang.ClassLoader.loadClass(ClassLoader.java:511) at java.lang.ClassLoader.loadClass(ClassLoader.java:469) at</p></blockquote><p>å®‰å“8.0æœºå™¨ï¼š</p><blockquote><p>java.lang.IncompatibleClassChangeError: Structural change of retrofit2.Converter$Factory is hazardous (&#x2F;data&#x2F;app&#x2F;com.xxx.xx-2zz63J0ZnL47Rw6U5B3wfw&#x3D;&#x3D;&#x2F;oat&#x2F;arm&#x2F;base.odex at compile time, &#x2F;data&#x2F;app&#x2F;com.xxx.tool-L0IRpZwtps6TiRfTUrRDAw&#x3D;&#x3D;&#x2F;oat&#x2F;arm&#x2F;base.odex at runtime): Direct method count off: 3 vs 1 Lretrofit2&#x2F;Converter$Factory; (Compile time): Static fields: Instance fields: Direct methods: <init>()V getParameterUpperBound(ILjava&#x2F;lang&#x2F;reflect&#x2F;ParameterizedType;)Ljava&#x2F;lang&#x2F;reflect&#x2F;Type; </p></blockquote><p>æ³¨æ„å®‰å“6æŠ›å‡ºçš„AndroidRuntimeæ²¡æœ‰ç›´æ¥è¯´æ˜åŸå› ï¼Œä¸å¦‚å®‰å“8æ¸…æ™°ã€‚</p><p>é¦–å…ˆçœ‹ä¸€ä¸‹IncompatibleClassChangeErrorçš„å®šä¹‰ï¼š</p><table><thead><tr><th><a href="https://developer.android.com/reference/java/lang/Object">java.lang.Object</a></th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><td>â†³</td><td><a href="https://developer.android.com/reference/java/lang/Throwable">java.lang.Throwable</a></td><td></td><td></td><td></td></tr><tr><td></td><td>â†³</td><td><a href="https://developer.android.com/reference/java/lang/Error">java.lang.Error</a></td><td></td><td></td></tr><tr><td></td><td></td><td>â†³</td><td><a href="https://developer.android.com/reference/java/lang/LinkageError">java.lang.LinkageError</a></td><td></td></tr><tr><td></td><td></td><td></td><td>â†³</td><td>java.lang.IncompatibleClassChangeError</td></tr></tbody></table><blockquote><p>å½“æŸä¸ªç±»å®šä¹‰å‘ç”Ÿäº†ä¸å…¼å®¹çš„å˜æ›´æ—¶æŠ›å‡ºã€‚å½“å‰æ­£åœ¨æ‰§è¡Œçš„æ–¹æ³•æ‰€ä¾èµ–çš„æŸä¸ªç±»çš„ç±»å®šä¹‰å·²ç»å‘ç”Ÿäº†å˜åŒ–ã€‚</p></blockquote><h2 id="é—®é¢˜åŸå› "><a href="#é—®é¢˜åŸå› " class="headerlink" title="é—®é¢˜åŸå› "></a>é—®é¢˜åŸå› </h2><p>ç»è¿‡åˆ†ææºç å‘ç°ï¼Œè°·æ­Œåœ¨Jan 15, 2015ï¼Œä¹Ÿå°±æ˜¯å®‰å“5.1.1å¼€å§‹ï¼ŒåŠ å…¥äº†ä»¥ä¸‹æäº¤ï¼š</p><p><a href="https://android-review.googlesource.com/c/platform/art/+/123364">ART: Simple structural class check (123364) Â· Gerrit Code Review</a></p><blockquote><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs smali">ART: Simple structural class<span class="hljs-built_in"> check</span><br><span class="hljs-built_in"></span><br>Adds a simple<span class="hljs-built_in"> check </span>to class-loading when the embedded dex file in<br>an oat file<span class="hljs-built_in"> and </span>the dex file on the class path where we found the<br>class do<span class="hljs-built_in"> not </span>match.<br><br>We require that the number of methods<span class="hljs-built_in"> and </span>fields do<span class="hljs-built_in"> not </span>change, as<br>that will almost certainly mean that quickened<span class="hljs-built_in"> and </span>other compiled<br>offsets are wrong now. This is a reasonably lightweight change, but<br>we should investigate a full comparison including name<span class="hljs-built_in"> and </span>type of<br>members.<br></code></pre></td></tr></table></figure></blockquote><p>å…³é”®æ–¹æ³•å°±æ˜¯<code>CheckSuperClassChange</code>å’Œ<code>SimpleStructuralCheck</code>ï¼Œç®€å•æ¥è¯´å°±æ˜¯å½“artè™šæ‹Ÿæœºå‘ç°åŠ è½½ç±»çš„dexè·¯å¾„å’Œçˆ¶ç±»dexè·¯å¾„ä¸ä¸€è‡´æ—¶ï¼Œå°±ä¼šæ‰§è¡ŒSimpleStructuralCheckæ£€æŸ¥ï¼Œå¦‚æœå‘ç°æ¥è‡ªä¸¤ä¸ªdexæ–‡ä»¶çš„çˆ¶ç±»çš„æ–¹æ³•æ•°ã€å­—æ®µæ•°ä¸ä¸€è‡´ï¼Œå°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p><p>ä½†æ˜¯ä»ç±»çš„å…¼å®¹æ€§è§’åº¦æ¥çœ‹ï¼Œè¿™æ ·çš„ç²—æš´æ£€æŸ¥æ˜¯ä¸åˆç†çš„ã€‚</p><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td><strong>Add API method</strong></td><td>If method need not be reimplemented by Client  If method must be reimplemented by Client</td><td>Binary compatible (0)  <strong>Breaks compatibility</strong> (1)</td></tr><tr><td>Delete API method</td><td>-</td><td><strong>Breaks compatibility</strong></td></tr><tr><td>Move API method up type hierarchy</td><td>If method in supertype need not be reimplemented by Client &lt;br If method in supertype must be reimplemented by Client</td><td>Binary compatible  <strong>Breaks compatibility</strong> (9)</td></tr><tr><td>Move API method down type hierarchy</td><td>-</td><td><strong>Breaks compatibility</strong> (9)</td></tr><tr><td>Add API constructor</td><td>If there are other constructors  If this is only constructor</td><td>Binary compatible  <strong>Breaks compatibility</strong> (2)</td></tr><tr><td>Delete API constructor</td><td>-</td><td><strong>Breaks compatibility</strong></td></tr><tr><td><strong>Add API field</strong></td><td>If class is not subclassable by Client (this includes enums)  If class is subclassable by Client</td><td>Binary compatible  <strong>May break compatibility</strong> (3)</td></tr><tr><td>Delete API field</td><td>-</td><td><strong>Breaks compatibility</strong></td></tr><tr><td>Expand superinterface set (direct or inherited)</td><td>-</td><td>Binary compatible</td></tr><tr><td>Contract superinterface set (direct or inherited)</td><td>-</td><td><strong>Breaks compatibility</strong> (4)</td></tr><tr><td>Expand superclass set (direct or inherited)</td><td>-</td><td>Binary compatible</td></tr><tr><td>Contract superclass set (direct or inherited)</td><td>-</td><td><strong>Breaks compatibility</strong> (4)</td></tr><tr><td>Add, delete, or change static or instance initializers</td><td>-</td><td>Binary compatible</td></tr><tr><td>Add API type member</td><td>-</td><td>Binary compatible</td></tr><tr><td>Delete API type member</td><td>-</td><td><strong>Breaks compatibility</strong></td></tr><tr><td>Re-order field, method, constructor, and type member declarations</td><td>-</td><td>Binary compatible</td></tr><tr><td>Add or delete non-API members; that is, <code>private</code> or default access fields, methods, constructors, and type members</td><td>-</td><td>Binary compatible</td></tr><tr><td>Change <code>abstract</code> to non-<code>abstract</code></td><td>-</td><td>Binary compatible</td></tr><tr><td>Change non-<code>abstract</code> to <code>abstract</code></td><td>-</td><td><strong>Breaks compatibility</strong> (5)</td></tr><tr><td>Change <code>final</code> to non-<code>final</code></td><td>-</td><td>Binary compatible</td></tr><tr><td>Change non-<code>final</code> to <code>final</code></td><td>-</td><td><strong>Breaks compatibility</strong> (6)</td></tr><tr><td>Add type parameter</td><td>If class has no type parameters  If class has type parameters</td><td>Binary compatible (7)  <strong>Breaks compatibility</strong></td></tr><tr><td>Delete type parameter</td><td>-</td><td><strong>Breaks compatibility</strong></td></tr><tr><td>Re-order type parameters</td><td>-</td><td><strong>Breaks compatibility</strong></td></tr><tr><td>Rename type parameter</td><td>-</td><td>Binary compatible</td></tr><tr><td>Add, delete, or change type bounds of type parameter</td><td>-</td><td><strong>Breaks compatibility</strong></td></tr><tr><td>Rename enum constant</td><td>-</td><td><strong>Breaks compatibility</strong></td></tr><tr><td>Add, change, or delete enum constant arguments</td><td>-</td><td>Binary compatible</td></tr><tr><td>Add, change, or delete enum constant class body</td><td>-</td><td>Binary compatible</td></tr><tr><td>Add enum constant</td><td>-</td><td>Binary compatible (8)</td></tr><tr><td>Delete enum constant</td><td>-</td><td><strong>Breaks compatibility</strong></td></tr><tr><td>Re-order enum constants</td><td>-</td><td>Binary compatible (8)</td></tr></tbody></table><p>åé¢è°·æ­Œæ„è¯†åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œåœ¨å®‰å“8.1å»æ‰äº†ï¼Œ<a href="https://android-review.googlesource.com/c/platform/art/+/421051">Revert â€œART: Simple structural class checkâ€ (421051) Â· Gerrit Code Review</a></p><blockquote><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">Revert <span class="hljs-string">&quot;ART: Simple structural class check&quot;</span><br><br>This reverts commit fd9eb3923dcf417afcf5ed4ebb<span class="hljs-symbol">13867f</span>d<span class="hljs-symbol">10f</span>2de3.<br><br>Remove the simple structural check. Its naive expectations for<br>resolution have <span class="hljs-keyword">been </span>wrong since we introduced compiling APKs with<br>a classpath for <span class="hljs-keyword">shared </span>libraries <span class="hljs-keyword">and </span>have never <span class="hljs-keyword">been </span>updated.<br></code></pre></td></tr></table></figure></blockquote><p>æ‰€ä»¥ï¼Œ<code>java.lang.IncompatibleClassChangeError: Structural change of</code> â€¦â€¦. è¿™ä¸ªé”™è¯¯æ³¢åŠèŒƒå›´æ˜¯å®‰å“5.1åˆ°å®‰å“8.0ã€‚</p><h3 id="æºç åˆ†æ"><a href="#æºç åˆ†æ" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h3><p>å®‰å“6.0</p><p><a href="http://aospxref.com/android-6.0.1_r9/xref/art/runtime/class_linker.cc">class_linker.cc - OpenGrok cross reference for &#x2F;art&#x2F;runtime&#x2F;class_linker.cc</a></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">// Very simple structural check on whether the classes match. Only compares the number of</span><br><span class="hljs-comment">// methods and fields.</span><br> <span class="hljs-comment">// æ ¡éªŒå½“å‰åŠ è½½çš„çˆ¶ç±»ä¸ç¼–è¯‘æ—¶(dex2oat)çš„çˆ¶ç±»æ˜¯å¦ä¸€è‡´(odexä¸­çš„æ•°æ®ç»“æ„)</span><br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">bool</span> <span class="hljs-title">SimpleStructuralCheck</span><span class="hljs-params">(<span class="hljs-type">const</span> DexFile&amp; dex_file1, <span class="hljs-type">const</span> DexFile::ClassDef&amp; dex_class_def1,</span></span><br><span class="hljs-params"><span class="hljs-function">                                  <span class="hljs-type">const</span> DexFile&amp; dex_file2, <span class="hljs-type">const</span> DexFile::ClassDef&amp; dex_class_def2,</span></span><br><span class="hljs-params"><span class="hljs-function">                                  std::string* error_msg)</span> </span>&#123;<br>  <span class="hljs-function">ClassDataItemIterator <span class="hljs-title">dex_data1</span><span class="hljs-params">(dex_file1, dex_file<span class="hljs-number">1.</span>GetClassData(dex_class_def1))</span></span>;<br>  <span class="hljs-function">ClassDataItemIterator <span class="hljs-title">dex_data2</span><span class="hljs-params">(dex_file2, dex_file<span class="hljs-number">2.</span>GetClassData(dex_class_def2))</span></span>;<br><br>  <span class="hljs-comment">// Counters for current dex file.</span><br>  <span class="hljs-type">size_t</span> dex_virtual_methods1, dex_direct_methods1, dex_static_fields1, dex_instance_fields1;<br>  <span class="hljs-built_in">CountMethodsAndFields</span>(dex_data1, &amp;dex_virtual_methods1, &amp;dex_direct_methods1, &amp;dex_static_fields1,<br>                        &amp;dex_instance_fields1);<br>  <span class="hljs-comment">// Counters for compile-time dex file.</span><br>  <span class="hljs-type">size_t</span> dex_virtual_methods2, dex_direct_methods2, dex_static_fields2, dex_instance_fields2;<br>  <span class="hljs-built_in">CountMethodsAndFields</span>(dex_data2, &amp;dex_virtual_methods2, &amp;dex_direct_methods2, &amp;dex_static_fields2,<br>                        &amp;dex_instance_fields2);<br><br>  <span class="hljs-keyword">if</span> (dex_virtual_methods1 != dex_virtual_methods2) &#123;<br>    std::string class_dump = <span class="hljs-built_in">DumpClasses</span>(dex_file1, dex_class_def1, dex_file2, dex_class_def2);<br>    *error_msg = <span class="hljs-built_in">StringPrintf</span>(<span class="hljs-string">&quot;Virtual method count off: %zu vs %zu\n%s&quot;</span>, dex_virtual_methods1,<br>                              dex_virtual_methods2, class_dump.<span class="hljs-built_in">c_str</span>());<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>  &#125;<br>  <span class="hljs-keyword">if</span> (dex_direct_methods1 != dex_direct_methods2) &#123;<br>    std::string class_dump = <span class="hljs-built_in">DumpClasses</span>(dex_file1, dex_class_def1, dex_file2, dex_class_def2);<br>    *error_msg = <span class="hljs-built_in">StringPrintf</span>(<span class="hljs-string">&quot;Direct method count off: %zu vs %zu\n%s&quot;</span>, dex_direct_methods1,<br>                              dex_direct_methods2, class_dump.<span class="hljs-built_in">c_str</span>());<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>  &#125;<br>  <span class="hljs-keyword">if</span> (dex_static_fields1 != dex_static_fields2) &#123;<br>    std::string class_dump = <span class="hljs-built_in">DumpClasses</span>(dex_file1, dex_class_def1, dex_file2, dex_class_def2);<br>    *error_msg = <span class="hljs-built_in">StringPrintf</span>(<span class="hljs-string">&quot;Static field count off: %zu vs %zu\n%s&quot;</span>, dex_static_fields1,<br>                              dex_static_fields2, class_dump.<span class="hljs-built_in">c_str</span>());<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>  &#125;<br>  <span class="hljs-keyword">if</span> (dex_instance_fields1 != dex_instance_fields2) &#123;<br>    std::string class_dump = <span class="hljs-built_in">DumpClasses</span>(dex_file1, dex_class_def1, dex_file2, dex_class_def2);<br>    *error_msg = <span class="hljs-built_in">StringPrintf</span>(<span class="hljs-string">&quot;Instance field count off: %zu vs %zu\n%s&quot;</span>, dex_instance_fields1,<br>                              dex_instance_fields2, class_dump.<span class="hljs-built_in">c_str</span>());<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>  &#125;<br><br>  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br><span class="hljs-comment">// klass è¡¨ç¤ºå½“å‰åŠ è½½çš„ç±»</span><br><span class="hljs-comment">// dex_file ä¸ºå½“å‰åŠ è½½çš„ç±»æ‰€åœ¨çš„ dex æ–‡ä»¶</span><br><span class="hljs-comment">// class_def è¡¨ç¤ºå½“å‰ç±»åœ¨ dex æ–‡ä»¶ä¸­çš„æ•°æ®ç»“æ„</span><br><span class="hljs-comment">// super_class è¡¨ç¤ºå½“å‰åŠ è½½çš„çˆ¶ç±»ï¼Œæ­£å¸¸æ¥è¯´(app_imageçš„åœºæ™¯é™¤å¤–)è¿™ä¸ªç±»æ˜¯æŒ‰ç…§åŒäº²å§”æ‰˜æ¨¡å‹åŠ è½½çš„çˆ¶ç±»ï¼Œè€Œè¦æ ¡éªŒçš„æ­£æ˜¯è¿™ä¸ªç±»</span><br><span class="hljs-comment">// Checks whether a the super-class changed from what we had at compile-time. This would</span><br><span class="hljs-comment">// invalidate quickening.</span><br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">bool</span> <span class="hljs-title">CheckSuperClassChange</span><span class="hljs-params">(Handle&lt;mirror::Class&gt; klass,</span></span><br><span class="hljs-params"><span class="hljs-function">                                  <span class="hljs-type">const</span> DexFile&amp; dex_file,</span></span><br><span class="hljs-params"><span class="hljs-function">                                  <span class="hljs-type">const</span> DexFile::ClassDef&amp; class_def,</span></span><br><span class="hljs-params"><span class="hljs-function">                                  mirror::Class* super_class)</span></span><br><span class="hljs-function">    <span class="hljs-title">SHARED_LOCKS_REQUIRED</span><span class="hljs-params">(Locks::mutator_lock_)</span> </span>&#123;<br>  <span class="hljs-comment">// Check for unexpected changes in the superclass.</span><br>  <span class="hljs-comment">// Quick check 1) is the super_class class-loader the boot class loader? This always has</span><br>  <span class="hljs-comment">// precedence.</span><br>  <span class="hljs-keyword">if</span> (super_class-&gt;<span class="hljs-built_in">GetClassLoader</span>() != <span class="hljs-literal">nullptr</span> &amp;&amp;<br>      <span class="hljs-comment">// Quick check 2) different dex cache? Breaks can only occur for different dex files,</span><br>      <span class="hljs-comment">// which is implied by different dex cache.</span><br>      klass-&gt;<span class="hljs-built_in">GetDexCache</span>() != super_class-&gt;<span class="hljs-built_in">GetDexCache</span>()) &#123;<br>    <span class="hljs-comment">// Now comes the expensive part: things can be broken if (a) the klass&#x27; dex file has a</span><br>    <span class="hljs-comment">// definition for the super-class, and (b) the files are in separate oat files. The oat files</span><br>    <span class="hljs-comment">// are referenced from the dex file, so do (b) first. Only relevant if we have oat files.</span><br>    <span class="hljs-type">const</span> OatDexFile* class_oat_dex_file = dex_file.<span class="hljs-built_in">GetOatDexFile</span>();<br>    <span class="hljs-type">const</span> OatFile* class_oat_file = <span class="hljs-literal">nullptr</span>;<br>    <span class="hljs-keyword">if</span> (class_oat_dex_file != <span class="hljs-literal">nullptr</span>) &#123;<br>      class_oat_file = class_oat_dex_file-&gt;<span class="hljs-built_in">GetOatFile</span>();<br>    &#125;<br>    <span class="hljs-comment">// class_oat_fileä¸èƒ½ä¸ºç©º</span><br>    <span class="hljs-keyword">if</span> (class_oat_file != <span class="hljs-literal">nullptr</span>) &#123;<br>      <span class="hljs-type">const</span> OatDexFile* loaded_super_oat_dex_file = super_class-&gt;<span class="hljs-built_in">GetDexFile</span>().<span class="hljs-built_in">GetOatDexFile</span>();<br>      <span class="hljs-type">const</span> OatFile* loaded_super_oat_file = <span class="hljs-literal">nullptr</span>;<br>      <span class="hljs-keyword">if</span> (loaded_super_oat_dex_file != <span class="hljs-literal">nullptr</span>) &#123;<br>        loaded_super_oat_file = loaded_super_oat_dex_file-&gt;<span class="hljs-built_in">GetOatFile</span>();<br>      &#125;<br><br>      <span class="hljs-keyword">if</span> (loaded_super_oat_file != <span class="hljs-literal">nullptr</span> &amp;&amp; class_oat_file != loaded_super_oat_file) &#123;<br>        <span class="hljs-comment">// Now check (a).</span><br>        <span class="hljs-type">const</span> DexFile::ClassDef* super_class_def = dex_file.<span class="hljs-built_in">FindClassDef</span>(class_def.superclass_idx_);<br>        <span class="hljs-keyword">if</span> (super_class_def != <span class="hljs-literal">nullptr</span>) &#123;<br>          <span class="hljs-comment">// Uh-oh, we found something. Do our check.</span><br>          std::string error_msg;<br>          <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">SimpleStructuralCheck</span>(dex_file, *super_class_def,<br>                                     super_class-&gt;<span class="hljs-built_in">GetDexFile</span>(), *super_class-&gt;<span class="hljs-built_in">GetClassDef</span>(),<br>                                     &amp;error_msg)) &#123;<br>            <span class="hljs-comment">// Print a warning to the log. This exception might be caught, e.g., as common in test</span><br>            <span class="hljs-comment">// drivers. When the class is later tried to be used, we re-throw a new instance, as we</span><br>            <span class="hljs-comment">// only save the type of the exception.</span><br>            <span class="hljs-built_in">LOG</span>(WARNING) &lt;&lt; <span class="hljs-string">&quot;Incompatible structural change detected: &quot;</span> &lt;&lt;<br>                <span class="hljs-built_in">StringPrintf</span>(<br>                    <span class="hljs-string">&quot;Structural change of %s is hazardous (%s at compile time, %s at runtime): %s&quot;</span>,<br>                    <span class="hljs-built_in">PrettyType</span>(super_class_def-&gt;class_idx_, dex_file).<span class="hljs-built_in">c_str</span>(),<br>                    class_oat_file-&gt;<span class="hljs-built_in">GetLocation</span>().<span class="hljs-built_in">c_str</span>(),<br>                    loaded_super_oat_file-&gt;<span class="hljs-built_in">GetLocation</span>().<span class="hljs-built_in">c_str</span>(),<br>                    error_msg.<span class="hljs-built_in">c_str</span>());<br>            <span class="hljs-built_in">ThrowIncompatibleClassChangeError</span>(klass.<span class="hljs-built_in">Get</span>(),<br>                <span class="hljs-string">&quot;Structural change of %s is hazardous (%s at compile time, %s at runtime): %s&quot;</span>,<br>                <span class="hljs-built_in">PrettyType</span>(super_class_def-&gt;class_idx_, dex_file).<span class="hljs-built_in">c_str</span>(),<br>                class_oat_file-&gt;<span class="hljs-built_in">GetLocation</span>().<span class="hljs-built_in">c_str</span>(),<br>                loaded_super_oat_file-&gt;<span class="hljs-built_in">GetLocation</span>().<span class="hljs-built_in">c_str</span>(),<br>                error_msg.<span class="hljs-built_in">c_str</span>());<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>          &#125;<br>        &#125;<br>      &#125;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å°±æ‹¿æˆ‘å¸åº”ç”¨æŠ¥çš„é”™è¯¯æ¥è¯´ï¼ŒAåº”ç”¨åœ¨ç¼–è¯‘æ—¶é›†æˆäº†ä¸€ä¸ªæ–°ç‰ˆæœ¬çš„<code>Lretrofit2/Converter$Factory</code>ï¼Œæ’æ¡©åº”ç”¨Bé›†æˆçš„æ˜¯ä¸€ä¸ªæ—§ç‰ˆæœ¬çš„<code>Lretrofit2/Converter$Factory</code>ï¼Œæ‰§è¡Œæ’æ¡©æ—¶ï¼ŒAå’ŒBæ˜¯è¿è¡Œåœ¨åŒä¸€ä¸ªè¿›ç¨‹çš„ï¼Œåˆå› ä¸ºBåº”ç”¨çš„classloaderè·¯å¾„æ’åœ¨Açš„å‰é¢ã€‚æ‰€ä»¥ï¼Œå½“Aåº”ç”¨åˆå§‹åŒ–<code>GsonConverterFactory</code> ï¼ˆBä¸åŒ…å«è¿™ä¸ªç±»ï¼‰æ—¶ï¼Œæ ¹æ®ç±»åŒäº²å§”æ´¾åŸåˆ™ï¼Œä¼˜å…ˆåŠ è½½çš„æ˜¯åº”ç”¨Bçš„<code>Lretrofit2/Converter$Factory</code>ï¼Œç¬¦åˆ<code>CheckSuperClassChange</code>è§„åˆ™ï¼š<code>GsonConverterFactory</code> ç±»çš„dexè·¯å¾„å’Œçˆ¶ç±»<code>Lretrofit2/Converter$Factory</code>dexè·¯å¾„ä¸ä¸€è‡´ï¼Œè¿›å…¥äº†<code>SimpleStructuralCheck</code>æ£€æŸ¥ï¼Œè¿™æ—¶å€™å°±ä¼šæ‹¿Aå’ŒBåº”ç”¨é‡Œé¢çš„<code>Lretrofit2/Converter$Factory</code>ç±»è¿›è¡Œæ£€æŸ¥ï¼Œç»“æœå‘ç°æ–¹æ³•æ•°ä¸ä¸€è‡´ï¼Œå¯¼è‡´äº†å¼‚å¸¸ã€‚</p><h2 id="ç–‘é—®"><a href="#ç–‘é—®" class="headerlink" title="ç–‘é—®"></a>ç–‘é—®</h2><p>ä¸Šé¢æºç åˆ†ææåˆ°åœ¨å®‰å“5.1åˆ°å®‰å“8.0éƒ½æœ‰è¿™ä¸ªæ£€æŸ¥ï¼Œä½†æ ¹æ®ç›‘æ§å¹³å°çš„æ•°æ®æ˜¾ç¤ºåœ¨å®‰å“8.0åŸºæœ¬ä¸ä¼šå‘ç”Ÿï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹<code>CheckSuperClassChange</code>è¿™ä¸ªæ–¹æ³•ï¼Œé™¤äº†è¦æ±‚ç±»å’Œçˆ¶ç±»æ¥è‡ªä¸åŒçš„dexæ–‡ä»¶ï¼Œè¿˜è¦æ±‚class_oat_fileä¸èƒ½ä¸ºç©ºï¼Œä¹Ÿå°±æ˜¯å¯¹åº”çš„odexæ–‡ä»¶ä¸èƒ½ä¸ºç©ºï¼Œå¦åˆ™ä¹Ÿä¸ä¼šæ‰§è¡Œ<code>SimpleStructuralCheck</code>ã€‚é‚£ä¹ˆä»€ä¹ˆæƒ…å†µclass_oat_fileä¸ºç©ºå‘¢ï¼Ÿé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦äº†è§£oatæ–‡ä»¶çš„æ‰“å¼€è¿‡ç¨‹äº†ã€‚</p><h3 id="oatæ–‡ä»¶åŠ è½½æµç¨‹"><a href="#oatæ–‡ä»¶åŠ è½½æµç¨‹" class="headerlink" title="oatæ–‡ä»¶åŠ è½½æµç¨‹"></a>oatæ–‡ä»¶åŠ è½½æµç¨‹</h3><p>åœ¨è¿™é‡Œæˆ‘ä¸ä¼šè¯¦ç»†åˆ†æoatæ–‡ä»¶çš„åŠ è½½æµç¨‹ï¼Œå¦‚éœ€æ·±å…¥äº†è§£å¯ä»¥å‚è€ƒé™„å½•ã€‚æˆ‘æ›´å…³å¿ƒçš„æ˜¯class_oat_fileåœ¨ä»€ä¹ˆæƒ…å†µä¸ºç©ºã€‚</p><p>oatæ–‡ä»¶åŠ è½½æµç¨‹å…³é”®å…¥å£æ˜¯ï¼š<code>ClassLinker::OpenDexFilesFromOat</code></p><p>é¦–å…ˆæ¥çœ‹ä¸€ä¸‹å®‰å“6çš„ï¼š</p><p><a href="http://aospxref.com/android-6.0.1_r9/xref/art/runtime/class_linker.cc">class_linker.cc - OpenGrok cross reference for &#x2F;art&#x2F;runtime&#x2F;class_linker.cc</a></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><code class="hljs c++"><br>std::vector&lt;std::unique_ptr&lt;<span class="hljs-type">const</span> DexFile&gt;&gt; ClassLinker::<span class="hljs-built_in">OpenDexFilesFromOat</span>(<br>    <span class="hljs-type">const</span> <span class="hljs-type">char</span>* dex_location, <span class="hljs-type">const</span> <span class="hljs-type">char</span>* oat_location,<br>    std::vector&lt;std::string&gt;* error_msgs) &#123;<br>  <span class="hljs-built_in">CHECK</span>(error_msgs != <span class="hljs-literal">nullptr</span>);<br>  .....<br>  .....<br>  <span class="hljs-comment">// Check if we already have an up-to-date oat file open.</span><br>  <span class="hljs-comment">//æ£€æŸ¥å†…å­˜æ˜¯å¦å­˜åœ¨å¯¹åº”çš„oatæ–‡ä»¶</span><br>  <span class="hljs-type">const</span> OatFile* source_oat_file = <span class="hljs-literal">nullptr</span>;<br>  &#123;<br>    <span class="hljs-function">ReaderMutexLock <span class="hljs-title">mu</span><span class="hljs-params">(Thread::Current(), dex_lock_)</span></span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">const</span> OatFile* oat_file : oat_files_) &#123;<br>      <span class="hljs-built_in">CHECK</span>(oat_file != <span class="hljs-literal">nullptr</span>);<br>      <span class="hljs-keyword">if</span> (oat_file_assistant.<span class="hljs-built_in">GivenOatFileIsUpToDate</span>(*oat_file)) &#123;<br>        source_oat_file = oat_file;<br>        <span class="hljs-keyword">break</span>;<br>      &#125;<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-comment">// If we didn&#x27;t have an up-to-date oat file open, try to load one from disk.</span><br>  <span class="hljs-comment">//å¦‚æœå†…å­˜æ²¡æœ‰åˆ™ä»ç£ç›˜åŠ è½½</span><br>  <span class="hljs-keyword">if</span> (source_oat_file == <span class="hljs-literal">nullptr</span>) &#123;<br>    <span class="hljs-comment">// Update the oat file on disk if we can. This may fail, but that&#x27;s okay.</span><br>    <span class="hljs-comment">// Best effort is all that matters here.</span><br>    <span class="hljs-comment">// å…³é”®åœ°æ–¹ï¼šæ£€æŸ¥ç£ç›˜çš„oatæ–‡ä»¶æ˜¯å¦éœ€è¦æ›´æ–°</span><br>    <span class="hljs-keyword">if</span> (!oat_file_assistant.<span class="hljs-built_in">MakeUpToDate</span>(&amp;error_msg)) &#123;<br>      <span class="hljs-built_in">LOG</span>(WARNING) &lt;&lt; error_msg;<br>    &#125;<br><br>    <span class="hljs-comment">// Get the oat file on disk.</span><br>    <span class="hljs-comment">// ä»ç£ç›˜åŠ è½½oatæ–‡ä»¶</span><br>    std::unique_ptr&lt;OatFile&gt; oat_file = oat_file_assistant.<span class="hljs-built_in">GetBestOatFile</span>();<br>    <span class="hljs-keyword">if</span> (oat_file.<span class="hljs-built_in">get</span>() != <span class="hljs-literal">nullptr</span>) &#123;<br>      <span class="hljs-comment">// Take the file only if it has no collisions, or we must take it because of preopting.</span><br>      <span class="hljs-comment">// å…³é”®åœ°æ–¹ï¼šæ£€æŸ¥å¾…åŠ è½½çš„oatæ–‡ä»¶æ˜¯å¦å’Œå·²ç»åŠ è½½çš„å­˜åœ¨ç±»å†²çª</span><br>      <span class="hljs-comment">// å¦‚æœå­˜åœ¨ç±»å†²çªï¼Œè€ƒè™‘ç›´æ¥åŠ è½½apké‡Œé¢çš„dexæ–‡ä»¶</span><br>      <span class="hljs-type">bool</span> accept_oat_file = !<span class="hljs-built_in">HasCollisions</span>(oat_file.<span class="hljs-built_in">get</span>(), &amp;error_msg);<br>      <span class="hljs-keyword">if</span> (!accept_oat_file) &#123;<br>        <span class="hljs-comment">// Failed the collision check. Print warning.</span><br>        <span class="hljs-keyword">if</span> (Runtime::<span class="hljs-built_in">Current</span>()-&gt;<span class="hljs-built_in">IsDexFileFallbackEnabled</span>()) &#123;<br>          <span class="hljs-built_in">LOG</span>(WARNING) &lt;&lt; <span class="hljs-string">&quot;Found duplicate classes, falling back to interpreter mode for &quot;</span><br>                       &lt;&lt; dex_location;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>          <span class="hljs-built_in">LOG</span>(WARNING) &lt;&lt; <span class="hljs-string">&quot;Found duplicate classes, dex-file-fallback disabled, will be failing to &quot;</span><br>                          <span class="hljs-string">&quot; load classes for &quot;</span> &lt;&lt; dex_location;<br>        &#125;<br>        <span class="hljs-built_in">LOG</span>(WARNING) &lt;&lt; error_msg;<br><br>        <span class="hljs-comment">// However, if the app was part of /system and preopted, there is no original dex file</span><br>        <span class="hljs-comment">// available. In that case grudgingly accept the oat file.</span><br>        <span class="hljs-comment">// ç³»ç»Ÿåº”ç”¨å¤§éƒ¨åˆ†éƒ½ä¼šåœ¨ç¼–è¯‘æœåŠ¡å™¨åšdexä¼˜åŒ–ï¼Œè¿™æ—¶å€™apké‡Œé¢å°±ä¸ä¼šåŒ…å«dexæ–‡ä»¶äº†ã€‚è¿™ç§æƒ…å†µçš„è¯è¿˜æ˜¯åŠ è½½oatæ–‡ä»¶</span><br>        <span class="hljs-keyword">if</span> (!DexFile::<span class="hljs-built_in">MaybeDex</span>(dex_location)) &#123;<br>          accept_oat_file = <span class="hljs-literal">true</span>;<br>          <span class="hljs-built_in">LOG</span>(WARNING) &lt;&lt; <span class="hljs-string">&quot;Dex location &quot;</span> &lt;&lt; dex_location &lt;&lt; <span class="hljs-string">&quot; does not seem to include dex file. &quot;</span><br>                       &lt;&lt; <span class="hljs-string">&quot;Allow oat file use. This is potentially dangerous.&quot;</span>;<br>        &#125;<br>      &#125;<br><br>      <span class="hljs-keyword">if</span> (accept_oat_file) &#123;<br>        <span class="hljs-comment">// è·å–oatæ–‡ä»¶</span><br>        source_oat_file = oat_file.<span class="hljs-built_in">release</span>();<br>        <span class="hljs-built_in">RegisterOatFile</span>(source_oat_file);<br>      &#125;<br>    &#125;<br>  &#125;<br><br>  std::vector&lt;std::unique_ptr&lt;<span class="hljs-type">const</span> DexFile&gt;&gt; dex_files;<br><br>  <span class="hljs-comment">// Load the dex files from the oat file.</span><br>  <span class="hljs-comment">// åŠ è½½oatæ–‡ä»¶é‡Œé¢çš„dexæ–‡ä»¶</span><br>  <span class="hljs-keyword">if</span> (source_oat_file != <span class="hljs-literal">nullptr</span>) &#123;<br>    dex_files = oat_file_assistant.<span class="hljs-built_in">LoadDexFiles</span>(*source_oat_file, dex_location);<br>    <span class="hljs-keyword">if</span> (dex_files.<span class="hljs-built_in">empty</span>()) &#123;<br>      error_msgs-&gt;<span class="hljs-built_in">push_back</span>(<span class="hljs-string">&quot;Failed to open dex files from &quot;</span><br>          + source_oat_file-&gt;<span class="hljs-built_in">GetLocation</span>());<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-comment">// Fall back to running out of the original dex file if we couldn&#x27;t load any</span><br>  <span class="hljs-comment">// dex_files from the oat file.</span><br>  <span class="hljs-comment">// å¦‚æœåŠ è½½oatæ–‡ä»¶é‡Œé¢çš„dexæ–‡ä»¶å¤±è´¥ï¼Œåˆ™ç›´æ¥å°è¯•åŠ è½½apké‡Œé¢çš„dexæ–‡ä»¶ã€‚</span><br>  <span class="hljs-keyword">if</span> (dex_files.<span class="hljs-built_in">empty</span>()) &#123;<br>    <span class="hljs-keyword">if</span> (oat_file_assistant.<span class="hljs-built_in">HasOriginalDexFiles</span>()) &#123;<br>      <span class="hljs-keyword">if</span> (Runtime::<span class="hljs-built_in">Current</span>()-&gt;<span class="hljs-built_in">IsDexFileFallbackEnabled</span>()) &#123;<br>        <span class="hljs-keyword">if</span> (!DexFile::<span class="hljs-built_in">Open</span>(dex_location, dex_location, &amp;error_msg, &amp;dex_files)) &#123;<br>          <span class="hljs-built_in">LOG</span>(WARNING) &lt;&lt; error_msg;<br>          error_msgs-&gt;<span class="hljs-built_in">push_back</span>(<span class="hljs-string">&quot;Failed to open dex files from &quot;</span> + std::<span class="hljs-built_in">string</span>(dex_location));<br>        &#125;<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        error_msgs-&gt;<span class="hljs-built_in">push_back</span>(<span class="hljs-string">&quot;Fallback mode disabled, skipping dex files.&quot;</span>);<br>      &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      error_msgs-&gt;<span class="hljs-built_in">push_back</span>(<span class="hljs-string">&quot;No original dex files found for dex location &quot;</span><br>          + std::<span class="hljs-built_in">string</span>(dex_location));<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">return</span> dex_files;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä»ä¸Šé¢æºç åˆ†æå¯ä»¥å‘ç°ï¼Œå¦‚æœdexæ–‡ä»¶æ¥è‡ªäºapkè€Œä¸æ˜¯oatæ–‡ä»¶çš„è¯class_oat_fileå°±ä¼šä¸ºç©ºï¼Œä¸ä¼šæ‰§è¡Œ<code>SimpleStructuralCheck</code>ã€‚</p><p>å®‰å“8ï¼š</p><p>å…¥å£ä¹Ÿæ˜¯<code>ClassLinker::OpenDexFilesFromOat</code>ï¼Œåªä¸è¿‡è¿ç§»åˆ°äº†oat_file_manager.ccé‡Œé¢ï¼š</p><p><a href="http://aospxref.com/android-8.0.0_r36/xref/art/runtime/oat_file_manager.cc">oat_file_manager.cc - OpenGrok cross reference for &#x2F;art&#x2F;runtime&#x2F;oat_file_manager.cc</a></p><p>è¿‡ç¨‹ä¹Ÿæ˜¯å¤§åŒå°å¼‚çš„ï¼Œç ”ç©¶å‘ç°<code>HasCollisions</code>æ–¹æ³•æœ‰ä¸ä¸€æ ·çš„åœ°æ–¹ã€‚</p><p>å®‰å“6å¼€å§‹å¼•å…¥<code>HasCollisions</code>è¿™ä¸ªæ–¹æ³•</p><p>å®‰å“6ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">// For b/21333911.</span><br><span class="hljs-type">static</span> <span class="hljs-keyword">constexpr</span> <span class="hljs-type">bool</span> kDuplicateClassesCheck = <span class="hljs-literal">false</span>;<br><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">ClassLinker::HasCollisions</span><span class="hljs-params">(<span class="hljs-type">const</span> OatFile* oat_file, std::string* error_msg)</span> </span>&#123;<br>  <span class="hljs-keyword">if</span> (!kDuplicateClassesCheck) &#123; <span class="hljs-comment">//è¿™ä¸ªè®¾ç½®æˆäº†false</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>  &#125;<br>    ........<br>    ........<br>&#125;<br></code></pre></td></tr></table></figure><p>æœç´¢ä¸€ä¸‹kDuplicateClassesCheckçœ‹æ˜¯å¹²ä»€ä¹ˆçš„ï¼Œ<a href="https://android.googlesource.com/platform/art/+/1bc977c/runtime/oat_file_manager.cc">runtime&#x2F;oat_file_manager.cc - platform&#x2F;art - Git at Google</a></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">// For b/21333911.</span><br><span class="hljs-comment">// Only enabled for debug builds to prevent bit rot. There are too many performance regressions for</span><br><span class="hljs-comment">// normal builds.</span><br><span class="hljs-type">static</span> <span class="hljs-keyword">constexpr</span> <span class="hljs-type">bool</span> kDuplicateClassesCheck = kIsDebugBuild;<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥åœ¨å®‰å“6æ˜¯ä¸ä¼šè§¦å‘è¿™ä¸ªæ£€æŸ¥çš„ï¼ŒæŸ¥çœ‹æºç åå‘ç°å®‰å“7.0æ‰å¼€å§‹é»˜è®¤å¯ç”¨ã€‚</p><p>å› æ­¤ï¼Œåœ¨å®‰å“7.0å¼€å§‹ï¼Œå¦‚æœæ’æ¡©åº”ç”¨æˆ–è€…æ’ä»¶åº”ç”¨åŒ…å«äº†å’Œå®¿ä¸»åº”ç”¨ä¸€æ ·çš„ç±»ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œä¹Ÿä¸ä¼šè§¦å‘<code>SimpleStructuralCheck</code>ã€‚</p><h2 id="å®éªŒ"><a href="#å®éªŒ" class="headerlink" title="å®éªŒ"></a>å®éªŒ</h2><p>æˆ‘åœ¨ä¸€å°64ä½çš„å®‰å“6.0æœºå™¨è¿›è¡Œæ’æ¡©å’ŒåŠ è½½æ’ä»¶æµ‹è¯•ï¼š</p><h3 id="æ’æ¡©æµ‹è¯•"><a href="#æ’æ¡©æµ‹è¯•" class="headerlink" title="æ’æ¡©æµ‹è¯•"></a>æ’æ¡©æµ‹è¯•</h3><p>å®‰è£…åº”ç”¨æ—¶ä¼šåšdexä¼˜åŒ–ï¼Œç”Ÿæˆoatæ–‡ä»¶ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">06-24 16:56:07.393 21329 21384 I PackageManager.DexOptimizer: Running dexopt (dex2oat) on: /data/app/vmdl566966682.tmp/base.apk pkg=com.example.myapplication.myapplication isa=arm vmSafeMode=false debuggable=false oatDir = /data/app/vmdl566966682.tmp/oat<br>06-24 16:56:07.422  5953  5953 I dex2oat : Starting dex2oat.<br>06-24 16:56:07.874  5953  5958 I dex2oat : Skipping compilation of long com.alibaba.fastjson.parser.JSONLexer.longValue(): it contains a non natural loop<br>06-24 16:56:07.933  5953  5958 I dex2oat : Skipping compilation of double[] com.alibaba.fastjson.parser.JSONLexer.scanFieldDoubleArray(long): it contains a non natural loop<br>06-24 16:56:07.963  5953  5958 I dex2oat : Skipping compilation of float[] com.alibaba.fastjson.parser.JSONLexer.scanFieldFloatArray(long): it contains a non natural loop<br>06-24 16:56:09.083  5953  5953 I dex2oat : dex2oat took 1.659s (threads: 4) arena alloc=10MB java alloc=971KB native alloc=15MB free=600KB<br></code></pre></td></tr></table></figure><p>æƒ…å†µ1ï¼š64ä½åº”ç”¨å¯¹32ä½åº”ç”¨åšæ’æ¡©</p><p>åŠ è½½oatæ–‡ä»¶ï¼Œæ‰§è¡Œ<code>MakeUpToDate</code>æ£€æŸ¥æ—¶ï¼Œå‘ç°å®‰è£…æ—¶çš„oatæ–‡ä»¶ä¸é€‚ç”¨äº32ä½ç¯å¢ƒï¼Œéœ€è¦é‡æ–°ç”Ÿæˆoatæ–‡ä»¶ï¼Œç»“æœå› ä¸ºæƒé™é—®é¢˜ç”Ÿæˆå¤±è´¥ã€‚ç»“æœå°±æ˜¯class_oat_fileä¸ºç©ºï¼Œä¸ä¼šæ‰§è¡Œ<code>SimpleStructuralCheck</code>ã€‚æ‰€ä»¥ï¼Œä¸€èˆ¬ä¸ä¼šå‡ºç°<code>IncompatibleClassChangeError</code>ã€‚</p><blockquote><p>åŠ è½½ç±»æ—¶ï¼Œ forkå‡ºæ¥çš„dex2oatæ˜¯åº”ç”¨æƒé™ï¼Œä¸èƒ½å¯¹&#x2F;data&#x2F;dalvik-cache&#x2F;ï¼ˆrootæƒé™ï¼‰è¿›è¡Œè¯»å†™ã€‚</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs shell">06-24 16:36:29.851 32154 32154 W art     : wesley GivenOatFileIsUpToDate is false, dex_location:/data/app/com.example.myapplication.myapplication-1/base.apk<br>06-24 16:36:29.851 32154 32154 W art     : wesley source_oat_file is null<br>06-24 16:36:29.851 32154 32154 W art     : wesley :GetDexOptNeeded HasOriginalDexFiles: 1<br>06-24 16:36:29.889 32174 32174 E dex2oat : Failed to create oat file: /data/dalvik-cache/arm/data@app@com.example.myapplication.myapplication-1@base.apk@classes.dex: Permission denied<br>06-24 16:36:29.889 32174 32174 I dex2oat : dex2oat took 307.667us (threads: 4)<br>06-24 16:36:29.893 32154 32154 W art     : wesley MakeUpToDate fail: Failed execv(/system/bin/dex2oat --runtime-arg -classpath --runtime-arg  --instruction-set=arm --instruction-set-features=smp,div,-atomic_ldrd_strd --runtime-arg -Xrelocate --boot-image=/system/framework/boot.art --runtime-arg -Xms64m --runtime-arg -Xmx512m --instruction-set-variant=cortex-a7 --instruction-set-features=default --dex-file=/data/app/com.example.myapplication.myapplication-1/base.apk --oat-file=/data/dalvik-cache/arm/data@app@com.example.myapplication.myapplication-1@base.apk@classes.dex) because non-0 exit status<br>06-24 16:36:29.893 32154 32154 W art     : wesley oat_file is null:<br>06-24 16:36:29.893 32154 32154 W art     : wesley :HasOriginalDexFiles true<br>06-24 16:36:29.985 32154 32154 W art     : wesley :load OriginalDexFiles success<br>06-24 16:36:29.986 32154 32154 W art     : wesley GivenOatFileIsUpToDate is false, dex_location:/data/app/com.tianci.de-2/base.apk<br>06-24 16:36:29.986 32154 32154 W art     : wesley source_oat_file is null<br>06-24 16:36:29.989 32154 32154 W art     : wesley :GetDexOptNeeded: kNoDexOptNeeded<br>06-24 16:36:29.989 32154 32154 W art     : wesley MakeUpToDate success<br>06-24 16:36:29.989 32154 32154 W art     : wesley accept_oat_file:1<br></code></pre></td></tr></table></figure><p>æƒ…å†µ2ï¼š32ä½åº”ç”¨å¯¹32ä½åº”ç”¨åšæ’æ¡©</p><p>é€šè¿‡<code>adb install --abi armeabi-v7a &lt;path to apk&gt;</code>å¼ºåˆ¶æŒ‡å®šåº”ç”¨è¿è¡Œåœ¨32ä½ï¼Œè¿™ç§æƒ…å†µclass_oat_fileä¸ä¼šä¸ºç©ºäº†ï¼Œå°±ä¼šè§¦å‘ï¼š<code>Incompatible structural change detected: Structural change......</code> ã€‚</p><h3 id="æ’ä»¶åŠ è½½"><a href="#æ’ä»¶åŠ è½½" class="headerlink" title="æ’ä»¶åŠ è½½"></a>æ’ä»¶åŠ è½½</h3><p>æƒ…å†µ1ï¼šé€šè¿‡<code>PathClassLoader</code>å»<code>loadClass</code>ï¼ˆé€šè¿‡adb installå®‰è£…çš„æ’ä»¶ï¼‰ï¼Œä¼šè§¦å‘ï¼š<code>Incompatible structural change detected: Structural change......</code>ï¼ˆä¸¤ä¸ªåº”ç”¨éƒ½æ˜¯64ä½å®‰è£…ï¼‰</p><p>æƒ…å†µ2ï¼šæ²¡æœ‰å®‰è£…çš„æ’ä»¶ï¼Œåº”ç”¨è¿è¡Œæ­£å¸¸ï¼Œä¹Ÿæ˜¯å› ä¸ºæƒé™é—®é¢˜åš<code>dex2oat</code>å¤±è´¥ï¼Œç›´æ¥ä»apkæ–‡ä»¶åŠ è½½äº†dexã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs shell">06-24 16:11:56.975 24635 24635 W art     : wesley GivenOatFileIsUpToDate is false, dex_location:/data/app/com.example.myapplication.myapplication-2/base.apk<br>06-24 16:11:56.975 24635 24635 W art     : wesley source_oat_file is null<br>06-24 16:11:56.979 24635 24635 W art     : wesley :GetDexOptNeeded: kNoDexOptNeeded<br>06-24 16:11:56.979 24635 24635 W art     : wesley MakeUpToDate success<br>06-24 16:11:56.979 24635 24635 W art     : wesley accept_oat_file:1<br>06-24 16:11:57.050 24635 24635 W art     : wesley GivenOatFileIsUpToDate is false, dex_location:/data/app/plugin.platform-1/base.apk<br>06-24 16:11:57.050 24635 24635 W art     : wesley GivenOatFileIsUpToDate is false, dex_location:/data/app/plugin.platform-1/base.apk<br>06-24 16:11:57.050 24635 24635 W art     : wesley source_oat_file is null<br>06-24 16:11:57.053 24635 24635 W art     : wesley :GetDexOptNeeded: kNoDexOptNeeded<br>06-24 16:11:57.053 24635 24635 W art     : wesley MakeUpToDate success<br>06-24 16:11:57.053 24635 24635 W art     : wesley accept_oat_file:1<br><br>06-24 16:11:57.063 24635 24635 W art     : wesley GivenOatFileIsUpToDate is false, dex_location:/data/user/0/com.example.myapplication.myapplication/files/Plugin.apk<br>06-24 16:11:57.063 24635 24635 W art     : wesley GivenOatFileIsUpToDate is false, dex_location:/data/user/0/com.example.myapplication.myapplication/files/Plugin.apk<br>06-24 16:11:57.063 24635 24635 W art     : wesley GivenOatFileIsUpToDate is false, dex_location:/data/user/0/com.example.myapplication.myapplication/files/Plugin.apk<br>06-24 16:11:57.063 24635 24635 W art     : wesley source_oat_file is null<br>06-24 16:11:57.063 24635 24635 W art     : wesley :GetDexOptNeeded HasOriginalDexFiles: 1<br>06-24 16:11:57.107 24661 24661 E dex2oat : Failed to create oat file: /data/dalvik-cache/arm64/data@user@0@com.example.myapplication.myapplication@files@Plugin.apk@classes.dex: Permission denied<br>06-24 16:11:57.107 24661 24661 I dex2oat : dex2oat took 295.167us (threads: 4)<br>06-24 16:11:57.108 24635 24635 W art     : wesley MakeUpToDate fail: Failed execv(/system/bin/dex2oat --runtime-arg -classpath --runtime-arg  --instruction-set=arm64 --instruction-set-features=smp,a53 --runtime-arg -Xrelocate --boot-image=/system/framework/boot.art --runtime-arg -Xms64m --runtime-arg -Xmx512m --instruction-set-variant=generic --instruction-set-features=default --dex-file=/data/user/0/com.example.myapplication.myapplication/files/Plugin.apk --oat-file=/data/dalvik-cache/arm64/data@user@0@com.example.myapplication.myapplication@files@Plugin.apk@classes.dex) because non-0 exit status<br>06-24 16:11:57.108 24635 24635 W art     : wesley oat_file is null:<br>06-24 16:11:57.108 24635 24635 W art     : wesley :HasOriginalDexFiles true<br>06-24 16:11:57.121 24635 24635 W art     : wesley :load OriginalDexFiles success<br></code></pre></td></tr></table></figure><h2 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h2><p>çœ‹å®Œä¸Šé¢çš„å†…å®¹åï¼Œåº”è¯¥å¾ˆå®¹æ˜“çŸ¥é“æ€ä¹ˆè§£å†³äº†ã€‚è¦ä¹ˆå°±æ˜¯æƒ³åŠæ³•é€šè¿‡<code>SimpleStructuralCheck</code>ï¼Œè¦ä¹ˆå°±æ˜¯æƒ³åŠæ³•ä¸è¿›äºº<code>SimpleStructuralCheck</code>ã€‚</p><p>æƒ³åŠæ³•é€šè¿‡<code>SimpleStructuralCheck</code>ï¼šæ’æ¡©æˆ–è€…æ’ä»¶çš„ç±»å’Œå®¿ä¸»ä¿æŒä¸€è‡´ã€‚</p><p>æƒ³åŠæ³•ä¸è¿›äºº<code>SimpleStructuralCheck</code>ï¼šæ’ä»¶compileOnlyå…¬å…±æ¥å£ï¼›æ’ä»¶ä¸å®‰è£…ï¼Œä»¥æ–‡ä»¶çš„æ–¹å¼è¿›è¡ŒåŠ è½½ï¼›æ’ä»¶å®‰è£…ï¼Œç±»åŠ è½½å…¥å£ä¸­è½¬åˆ°æ’ä»¶æ–‡ä»¶ç­‰ç­‰ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://juejin.cn/post/6894165613028048904">æ’ä»¶åŒ–ä¹‹ Incompatible structural change detected é—®é¢˜åˆ†æ - æ˜é‡‘</a></p><p>[<a href="https://bbs.kanxue.com/thread-257893.htm">åŸåˆ›]èœé¸Ÿå­¦8.1ç‰ˆæœ¬dexåŠ è½½æµç¨‹ç¬”è®°â€“ç¬¬ä¸€ç¯‡ï¼šoat_file_managerä¸oat_file_assistant-Androidå®‰å…¨-çœ‹é›ª-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|kanxue.com</a></p><p><a href="https://docs.oracle.com/javase/specs/jls/se7/html/jls-13.html">Chapter 13. Binary Compatibility</a></p>]]></content>
    
    
    <categories>
      
      <category>AndroidBugFix</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Java</tag>
      
      <tag>art</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ubuntu24.04å¯åŠ¨é»‘å±</title>
    <link href="/article/860ebe82/"/>
    <url>/article/860ebe82/</url>
    
    <content type="html"><![CDATA[<p>åœ¨vmwareå®‰è£…å®Œubuntu24.04åï¼Œç™»å½•è¿›å»é»‘å±ã€‚</p><p>é¦–å…ˆå…³é—­è™šæ‹Ÿæœºï¼Œç„¶ååœ¨è™šæ‹Ÿæœºè®¾ç½®-æ˜¾ç¤ºå™¨-3Då›¾å½¢é‚£é‡Œå…³é—­åŠ é€Ÿ3Då›¾å½¢ã€‚</p><p>è¿™æ—¶å€™å°±å¯ä»¥é‡æ–°ç™»å½•è¿›å»äº†ï¼Œä½†æ˜¯æ²¡æœ‰äº†å›¾å½¢åŠ é€Ÿï¼Œç”»é¢å°±æ²¡æœ‰é‚£ä¹ˆæµç•…äº†ã€‚</p><p>æ€ä¹ˆåŠï¼Ÿ</p><hr><h2 id="æ›´æ–°å›¾å½¢é©±åŠ¨"><a href="#æ›´æ–°å›¾å½¢é©±åŠ¨" class="headerlink" title="æ›´æ–°å›¾å½¢é©±åŠ¨"></a>æ›´æ–°å›¾å½¢é©±åŠ¨</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo add-apt-repository ppa:oibaf/graphics-drivers<br>sudo apt update &amp;&amp; sudo apt upgrade<br></code></pre></td></tr></table></figure><p>å®‰è£…å®Œåï¼Œå…³é—­è™šæ‹Ÿæœºï¼Œé‡æ–°åœ¨è™šæ‹Ÿæœºè®¾ç½®-æ˜¾ç¤ºå™¨-3Då›¾å½¢é‚£é‡Œæ‰“å¼€åŠ é€Ÿ3Då›¾å½¢ã€‚</p><p>è¿™æ—¶å€™ï¼Œå†ç™»å½•è¿›å»å°±å¯ä»¥æ­£å¸¸ä½¿ç”¨äº†ã€‚æœ‰äº†å›¾å½¢åŠ é€Ÿï¼ŒUIæµç•…åº¦ä¹Ÿæ›´åŠ å¥½äº†ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://askubuntu.com/questions/1511670/problem-with-ubuntu-24-04-on-vmware">Problem with Ubuntu 24.04 on VMware - Ask Ubuntu</a></p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Ubuntu</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®‰å“ä¸åŒgradleç‰ˆæœ¬æ€ä¹ˆå‘å¸ƒsdkåˆ°Maven</title>
    <link href="/article/3d160ee3/"/>
    <url>/article/3d160ee3/</url>
    
    <content type="html"><![CDATA[<p>ä¸€ç›´ä»¥æ¥ï¼Œå…¬å¸çš„å¾ˆå¤šsdkä¸Šä¼ æ—¶éƒ½æ²¡æœ‰é™„å¸¦æºç ï¼Œå¯¹äºå¼€å‘è€…æ¥è¯´æ˜¯æ¯”è¾ƒä¸æ–¹ä¾¿çš„ï¼Œæ‰€ä»¥æˆ‘å°±æƒ³å¢åŠ ä¸€ä¸‹ã€‚å› ä¸ºä¸åŒçš„é¡¹ç›®ä½¿ç”¨çš„gradleç‰ˆæœ¬ä¸ä¸€æ ·ï¼Œå‘å¸ƒsdkçš„æ–¹å¼ä¹Ÿä¸ä¸€æ ·ï¼Œç‰¹æ­¤è®°å½•ä¸€ä¸‹ï¼Œå¸Œæœ›èƒ½å¸®åˆ°å¤§å®¶ã€‚</p><h2 id="gradle7-1ä¹‹å‰"><a href="#gradle7-1ä¹‹å‰" class="headerlink" title="gradle7.1ä¹‹å‰"></a>gradle7.1ä¹‹å‰</h2><h3 id="mavenæ’ä»¶"><a href="#mavenæ’ä»¶" class="headerlink" title="mavenæ’ä»¶"></a>mavenæ’ä»¶</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs groovy">apply <span class="hljs-attr">plugin:</span> <span class="hljs-string">&#x27;maven&#x27;</span><br><br>task androidSourcesJar(<span class="hljs-attr">type:</span> Jar) &#123;<br>    classifier = <span class="hljs-string">&#x27;sources&#x27;</span><br>    from android.sourceSets.main.java.srcDirs<br>&#125;<br><br>uploadArchives &#123;<br>    repositories.mavenDeployer &#123;<br>        <span class="hljs-comment">//repo_urlã€repo_usernameã€repo_passwordå®šä¹‰åœ¨local.propertiesæˆ–è€…gradle.properties</span><br>        repository(<span class="hljs-attr">url:</span> repo_url) &#123;<br>                authentication(<span class="hljs-attr">userName:</span> repo_username, <span class="hljs-attr">password:</span> repo_password)<br>        &#125;<br>        pom.version = <span class="hljs-string">&quot;1.1.2&quot;</span><br>        pom.groupId = <span class="hljs-string">&quot;com.wesley.sdk&quot;</span> <br>        pom.artifactId = <span class="hljs-string">&quot;xxx&quot;</span><br>        pom.name = <span class="hljs-string">&quot;xxx&quot;</span><br>        pom.packaging = <span class="hljs-string">&#x27;aar&#x27;</span> <span class="hljs-comment">//æ‰“åŒ…çš„æ ¼å¼ï¼Œaaræˆ–è€…jar</span><br><br>    &#125;<br>&#125;<br><br>artifacts &#123;<br>    archives androidSourcesJar<br>&#125;<br><br></code></pre></td></tr></table></figure><p>å¦‚æœæ˜¯javaå’Œandroidæ··åˆå·¥ç¨‹</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs groovy">apply <span class="hljs-attr">plugin:</span> <span class="hljs-string">&#x27;maven&#x27;</span><br><br>task androidSourcesJar(<span class="hljs-attr">type:</span> Jar) &#123;<br>    classifier = <span class="hljs-string">&#x27;sources&#x27;</span><br>    <span class="hljs-keyword">if</span> (project.plugins.hasPlugin(<span class="hljs-string">&#x27;java&#x27;</span>)) &#123;<br>        println <span class="hljs-string">&quot;This is a Java project.&quot;</span><br>        from sourceSets.main.java.srcDirs<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (project.plugins.hasPlugin(<span class="hljs-string">&#x27;com.android.application&#x27;</span>) || project.plugins.hasPlugin(<span class="hljs-string">&#x27;com.android.library&#x27;</span>)) &#123;<br>        println <span class="hljs-string">&quot;This is an Android project.&quot;</span><br>        from android.sourceSets.main.java.srcDirs<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        println <span class="hljs-string">&quot;This is an unknown type of project.&quot;</span><br>    &#125;<br>&#125;<br><br>uploadArchives &#123;<br>    repositories.mavenDeployer &#123;<br>        <span class="hljs-comment">//repo_urlã€repo_usernameã€repo_passwordå®šä¹‰åœ¨local.propertiesæˆ–è€…gradle.properties</span><br>        repository(<span class="hljs-attr">url:</span> repo_url) &#123;<br>                authentication(<span class="hljs-attr">userName:</span> repo_username, <span class="hljs-attr">password:</span> repo_password)<br>        &#125;<br>        pom.version = <span class="hljs-string">&quot;1.1.2&quot;</span><br>        pom.groupId = <span class="hljs-string">&quot;com.wesley.sdk&quot;</span> <br>        pom.artifactId = <span class="hljs-string">&quot;xxx&quot;</span><br>        pom.name = <span class="hljs-string">&quot;xxx&quot;</span><br>        pom.packaging = <span class="hljs-string">&#x27;aar&#x27;</span> <span class="hljs-comment">//æˆ–è€…jar</span><br><br>    &#125;<br>&#125;<br><br>artifacts &#123;<br>    archives androidSourcesJar<br>&#125;<br><br></code></pre></td></tr></table></figure><p>ä¸Šä¼ å‘½ä»¤ï¼šgradlew uploadArchives </p><h3 id="maven-publishæ’ä»¶"><a href="#maven-publishæ’ä»¶" class="headerlink" title="maven-publishæ’ä»¶"></a>maven-publishæ’ä»¶</h3><p><a href="https://docs.gradle.org/current/userguide/publishing_maven.html">The Maven Publish Plugin</a></p><p><a href="https://docs.gradle.org/7.0/userguide/upgrading_version_6.html?_ga=2.89654745.374070913.1630385037-1835317872.1629704027#removal_of_the_legacy_maven_plugin">Upgrading your build from Gradle 6.x to the latest</a></p><p>gradle7å¼€å§‹å»é™¤mavenæ’ä»¶ï¼Œéœ€è¦ç”¨maven-publishæ›¿ä»£ã€‚å…¶å®åœ¨Gradle 6.2 ä¹‹åï¼Œå°±å®Œå…¨åºŸå¼ƒäº†ã€‚</p><p>gradle maven-publish æ’ä»¶ï¼Œä»gradle 1.3 ä¹‹åå¼€å§‹æ”¯æŒã€‚</p><blockquote><h4 id="Removal-of-the-uploadArchives-task"><a href="#Removal-of-the-uploadArchives-task" class="headerlink" title="Removal of the uploadArchives task"></a><a href="https://docs.gradle.org/7.0/userguide/upgrading_version_6.html?_ga=2.89654745.374070913.1630385037-1835317872.1629704027#removal_of_the_uploadarchives_task">Removal of the <code>uploadArchives</code> task</a></h4><p>The <code>uploadArchives</code> task was used in combination with the legacy Ivy or Maven publishing mechanisms. It has been removed in Gradle 7. You should migrate to the <code>maven-publish</code> or <code>ivy-publish</code> plugin instead.</p></blockquote><p>Android Gradle Plugin 3.6.0å¼€å§‹æ”¯æŒmaven-publishæ’ä»¶ï¼ˆgradleç‰ˆæœ¬5.6.4+ï¼‰</p><p><a href="https://developer.android.com/build/releases/past-releases/agp-3-6-0-release-notes">Android Studio  | Android Developers</a></p><blockquote><h3 id="Support-for-the-Maven-Publish-plugin"><a href="#Support-for-the-Maven-Publish-plugin" class="headerlink" title="Support for the Maven Publish plugin"></a>Support for the Maven Publish plugin</h3><p>The Android Gradle plugin includes support for the <a href="https://docs.gradle.org/current/userguide/publishing_maven.html">Maven Publish Gradle plugin</a>, which allows you to publish build artifacts to an Apache Maven repository. The Android Gradle plugin creates a <a href="https://docs.gradle.org/current/userguide/dependency_management_terminology.html#sub:terminology_component"><em>component</em></a> for each build variant artifact in your app or library module that you can use to customize a <a href="https://docs.gradle.org/current/userguide/publishing_maven.html#publishing_maven:publications"><em>publication</em></a> to a Maven repository.</p><p>To learn more, go to the page about how to <a href="https://developer.android.com/studio/build/maven-publish-plugin">use the Maven Publish plugin</a>.</p></blockquote><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs groovy">plugins &#123;<br>    id <span class="hljs-string">&#x27;com.android.library&#x27;</span><br>    id <span class="hljs-string">&#x27;maven-publish&#x27;</span><br>&#125;<br><br>tasks.register(<span class="hljs-string">&#x27;androidSourcesJar&#x27;</span>, Jar) &#123;<br>    archiveClassifier.set(<span class="hljs-string">&#x27;sources&#x27;</span>)<br>    from android.sourceSets.main.java.srcDirs<br>&#125;<br><br>afterEvaluate &#123;<br>    publishing &#123;<br>        publications &#123;<br>            release(MavenPublication) &#123;<br>                from components.release<br>                artifact androidSourcesJar<br><br>                groupId = <span class="hljs-string">&quot;com.wesley.sdk&quot;</span> <br>                artifactId = <span class="hljs-string">&quot;xxxxx&quot;</span><br>                version = <span class="hljs-string">&quot;1.1.2&quot;</span><br>            &#125;<br>        &#125;<br>        <br>        repositories &#123;<br>            maven &#123;<br>                allowInsecureProtocol <span class="hljs-literal">true</span><br>                <span class="hljs-keyword">def</span> releaseUrl = <span class="hljs-string">&quot;http://172.20.12.12:8080/nexus/content/repositories/releases/&quot;</span>  <span class="hljs-comment">//å‘å¸ƒåœ°å€</span><br>                <span class="hljs-keyword">def</span> snapshotsUrl = <span class="hljs-string">&quot;http://172.20.12.12:8080/nexus/content/repositories/snapshots/&quot;</span> <span class="hljs-comment">//å¿«ç…§åœ°å€</span><br>                url = SDK_TV_MAVEN_VERSION.endsWith(<span class="hljs-string">&#x27;SNAPSHOT&#x27;</span>) ? snapshotsUrl : releaseUrl<br>                credentials &#123;<br>                username project.username <span class="hljs-comment">//usernameå®šä¹‰åœ¨local.propertiesæˆ–è€…gradle.properties</span><br>                password project.password <span class="hljs-comment">//passwordå®šä¹‰åœ¨local.propertiesæˆ–è€…gradle.properties</span><br>            &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šä¼ å‘½ä»¤ï¼šgradlew publish</p><h2 id="gradle-7-1å¼€å§‹"><a href="#gradle-7-1å¼€å§‹" class="headerlink" title="gradle 7.1å¼€å§‹"></a>gradle 7.1å¼€å§‹</h2><p>ä¸€å®šè¦ä¼˜å…ˆæŸ¥çœ‹è‹±æ–‡ç‰ˆæ•™ç¨‹ï¼Œä¸­æ–‡ç‰ˆæœ‰æ—¶å€™æ›´æ–°ä¸åŠæ—¶ã€‚</p><p><a href="https://developer.android.com/build/publish-library">Publish your library  | Android Studio  | Android Developers</a> </p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs groovy">plugins &#123;<br>    id <span class="hljs-string">&#x27;com.android.library&#x27;</span><br>    id <span class="hljs-string">&#x27;maven-publish&#x27;</span>  <span class="hljs-comment">//ä¾èµ–çš„å‘å¸ƒæ’ä»¶</span><br>&#125;<br><br>group <span class="hljs-string">&quot;com.wesley.sdk&quot;</span> <br>version <span class="hljs-string">&quot;1.0.4&quot;</span> <span class="hljs-comment">//ç‰ˆæœ¬å·æ§åˆ¶</span><br><br>android &#123;<br>    publishing &#123;<br>        singleVariant(<span class="hljs-string">&#x27;release&#x27;</span>) &#123;<br>            withSourcesJar() <span class="hljs-comment">//å‘å¸ƒæºç ï¼Œæ–¹ä¾¿SDKä½¿ç”¨è€…é˜…è¯»</span><br>        &#125;<br>    &#125;<br>&#125;<br><br>publishing &#123;<br>    publications &#123;<br>        maven(MavenPublication) &#123;<br>            groupId group  <span class="hljs-comment">//sdkçš„ç»„ç»‡</span><br>            artifactId <span class="hljs-string">&quot;theme-tools&quot;</span> <span class="hljs-comment">//sdkåç§°</span><br>            version version<br><br>            afterEvaluate &#123;<br>                from components.release<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    repositories &#123;<br>        maven &#123;<br>            credentials &#123;<br>                username project.username <span class="hljs-comment">//usernameå®šä¹‰åœ¨local.propertiesæˆ–è€…gradle.properties</span><br>                password project.password <span class="hljs-comment">//passwordå®šä¹‰åœ¨local.propertiesæˆ–è€…gradle.properties</span><br>            &#125;<br><br>            allowInsecureProtocol <span class="hljs-literal">true</span> <span class="hljs-comment">//å¦‚æœæ˜¯httpåè®®éœ€è¦åŠ </span><br><br>            <span class="hljs-keyword">def</span> releaseUrl = <span class="hljs-string">&quot;http://172.20.12.12:8080/nexus/content/repositories/releases/&quot;</span>  <span class="hljs-comment">//å‘å¸ƒåœ°å€</span><br>            <span class="hljs-keyword">def</span> snapshotsUrl = <span class="hljs-string">&quot;http://172.20.12.12:8080/nexus/content/repositories/snapshots/&quot;</span> <span class="hljs-comment">//å¿«ç…§åœ°å€</span><br><br>            url = version.endsWith(<span class="hljs-string">&#x27;SNAPSHOT&#x27;</span>) ? snapshotsUrl : releaseUrl<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>ä¸Šä¼ å‘½ä»¤ï¼šgradlew publish</p><p>æ›´åŠ æ¨èandroid studioçš„ä¾§è¾¹æ Gradle-æ¨¡å—åå­—-Tasks-publishing-publish</p><p>å¦‚æœæ²¡æœ‰ä»»åŠ¡éœ€è¦æ‰“å¼€ä¸‹é¢çš„è®¾ç½®</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2023/202406081843237.png" alt="image-20240608184315147"></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://developer.android.com/build/publish-library/upload-library">Upload your library  | Android Studio  | Android Developers</a></p><p><a href="https://developer.android.com/reference/tools/gradle-api/8.0/com/android/build/api/dsl/Publishing">Publishing  | Android Developers</a></p><p><a href="https://blog.csdn.net/android_cai_niao/article/details/119541995">æŠŠAndroidåº“é¡¹ç›®å‘å¸ƒåˆ°mavenä»“åº“ä¸”å¸¦ä¸Šæºä»£ç _å°†androidé¡¹ç›®ä¸Šä¼ è‡³è¿œç¨‹movenåº“-CSDNåšå®¢</a><a href="https://blog.csdn.net/qq_37482202/article/details/136077534">Android SDK ä¸Šä¼  Maven å–‚å¥¶çº§æ•™ç¨‹_android ä¸Šä¼ sdkåˆ°maven-CSDNåšå®¢</a></p><p><a href="https://juejin.cn/post/7087036809804251167">ä½¿ç”¨Gradleæ’ä»¶ä¸Šä¼ ç»„ä»¶åˆ°Mavenä¹‹æºç ä¸Šä¼  - æ˜é‡‘</a></p><p><a href="https://blog.csdn.net/qq_43422537/article/details/120009978">ã€Gradleã€‘gradleé¡¹ç›®è½¬mavenä¹‹maven-publishæ’ä»¶çš„ä½¿ç”¨_publishtomavenlocal-CSDNåšå®¢</a></p><p><a href="https://www.jianshu.com/p/cc21c1aa1a2a">Plugin with id â€˜mavenâ€™ not found. - ç®€ä¹¦</a></p><p><a href="https://blog.csdn.net/lucky_tom/article/details/120738113">Android Gradle 7.0 ä½¿ç”¨maven-publishå‘å¸ƒç»„ä»¶_android gradle publishing-CSDNåšå®¢</a></p><p><a href="https://cloud.tencent.com/developer/article/1911642">Androidï¼šå‘å¸ƒaaråŒ…åˆ°mavenä»“åº“ä»¥åŠ mavenæ’ä»¶ å’Œ maven-publish æ’ä»¶çš„åŒºåˆ«-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘</a></p><p><a href="https://developer.aliyun.com/article/830507">Android å¤šæ¨¡å—ï¼ˆlibï¼‰æ‰¹é‡æ‰“åŒ… aar ä¸Šä¼  maven ä»“åº“å®è·µ-é˜¿é‡Œäº‘å¼€å‘è€…ç¤¾åŒº</a></p><p><a href="https://juejin.cn/post/7251875626906107965">ä½¿ç”¨ Gradle Kotlin DSL å°† Android aar å‘å¸ƒåˆ° Maven Repository - JFrog çš„å‡ ç‚¹ç»éªŒ - æ˜é‡‘</a></p>]]></content>
    
    
    <categories>
      
      <category>AppBuild</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>gradle</tag>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>java.lang.ExceptionInInitializerErroråŸå› åŠè§£å†³åŠæ³•</title>
    <link href="/article/78c113a2/"/>
    <url>/article/78c113a2/</url>
    
    <content type="html"><![CDATA[<table><thead><tr><th><a href="https://developer.android.com/reference/java/lang/Object">java.lang.Object</a></th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><td>â†³</td><td><a href="https://developer.android.com/reference/java/lang/Throwable">java.lang.Throwable</a></td><td></td><td></td><td></td></tr><tr><td></td><td>â†³</td><td><a href="https://developer.android.com/reference/java/lang/Error">java.lang.Error</a></td><td></td><td></td></tr><tr><td></td><td></td><td>â†³</td><td><a href="https://developer.android.com/reference/java/lang/LinkageError">java.lang.LinkageError</a></td><td></td></tr><tr><td></td><td></td><td></td><td>â†³</td><td>java.lang.ExceptionInInitializerError</td></tr></tbody></table><p><code>ExceptionInInitializerError</code> é€šå¸¸æ„å‘³ç€åœ¨é™æ€åˆå§‹åŒ–å—æˆ–é™æ€å˜é‡åˆå§‹åŒ–è¿‡ç¨‹ä¸­å‘ç”Ÿäº†å¼‚å¸¸ã€‚</p><p><strong>é™æ€ä»£ç å—å¼‚å¸¸</strong>ï¼šå¦‚æœåœ¨é™æ€ä»£ç å—ä¸­æœ‰ä»»ä½•å¼‚å¸¸æŠ›å‡ºï¼Œéƒ½ä¼šå¯¼è‡´æ­¤é”™è¯¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StaticBlock</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> state;<br><br>    <span class="hljs-keyword">static</span> &#123;<br>        state = <span class="hljs-number">42</span> / <span class="hljs-number">0</span>; <span class="hljs-comment">//é™¤0å¼‚å¸¸</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>é™æ€å˜é‡åˆå§‹åŒ–å¼‚å¸¸</strong>ï¼šå¦‚æœé™æ€å˜é‡åœ¨åˆå§‹åŒ–æ—¶æŠ›å‡ºäº†å¼‚å¸¸ï¼Œä¹Ÿä¼šå¯¼è‡´æ­¤é”™è¯¯ã€‚ï¼ˆç¼–è¯‘åå®é™…ä¸Šä¹Ÿæ˜¯åœ¨é™æ€ä»£ç å—é‡Œé¢ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Example</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">number</span> <span class="hljs-operator">=</span> Integer.parseInt(<span class="hljs-string">&quot;abc&quot;</span>); <span class="hljs-comment">// è¿™é‡Œä¼šæŠ›å‡ºNumberFormatException</span><br>&#125;<br><br></code></pre></td></tr></table></figure><h2 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h2><p>ä¸€èˆ¬æ¥è¯´ï¼ŒæŸ¥çœ‹å †æ ˆè·Ÿè¸ªéƒ½èƒ½æ‰¾å‡ºé—®é¢˜æ‰€åœ¨ã€‚</p><ol><li><strong>æ£€æŸ¥é™æ€åˆå§‹åŒ–å—</strong>ï¼šç¡®ä¿é™æ€åˆå§‹åŒ–å—ä¸­æ²¡æœ‰æŠ›å‡ºå¼‚å¸¸çš„ä»£ç ã€‚</li><li><strong>æ£€æŸ¥é™æ€å˜é‡åˆå§‹åŒ–</strong>ï¼šç¡®ä¿æ‰€æœ‰é™æ€å˜é‡çš„åˆå§‹åŒ–éƒ½æ˜¯å®‰å…¨çš„ï¼Œæ²¡æœ‰æŠ›å‡ºå¼‚å¸¸ã€‚</li></ol><h2 id="å·¥ä½œä¸­çš„ä¾‹å­"><a href="#å·¥ä½œä¸­çš„ä¾‹å­" class="headerlink" title="å·¥ä½œä¸­çš„ä¾‹å­"></a>å·¥ä½œä¸­çš„ä¾‹å­</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">java.lang.ExceptionInInitializerError at com.xxx.xx.Service.onInit(Service.java:<span class="hljs-number">654</span>) <br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹654è¡Œä»£ç ï¼Œå¼•ç”¨äº†ä¸€ä¸ªé™æ€ç±»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> &#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">path</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;/data/data/com.xxx.xx/lib/libxxplay.so&quot;</span>;<br>        <span class="hljs-type">File</span> <span class="hljs-variable">file</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(path);<br>        <span class="hljs-keyword">if</span> (file.exists()) &#123;<br>            SFLogger.d(TAG, <span class="hljs-string">&quot;use /data/data/com.xxx.xx/lib/libxxplay.so&quot;</span>);<br>            System.load(path);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            SFLogger.d(TAG, <span class="hljs-string">&quot;use /system/lib/libxxplay.so&quot;</span>);<br>            System.loadLibrary(<span class="hljs-string">&quot;xxplay&quot;</span>);<br>        &#125;<br>    &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>        SFLogger.e(TAG, <span class="hljs-string">&quot;JniUtil loadLibrary exception = &quot;</span> + e.getMessage());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä»¥ä¸Šä»£ç å’‹ä¸€çœ‹å¥½åƒä¹Ÿæ²¡ä»€ä¹ˆé—®é¢˜å•Šï¼Œå¼‚å¸¸éƒ½catchä½äº†ã€‚</p><p>ä½†å¦‚æœä»”ç»†ç ”ç©¶å°±ä¼šå‘ç°ï¼Œè¿™é‡Œçš„é—®é¢˜æ˜¯æ»¥ç”¨äº†<code>Exception</code>ï¼Œæ²¡æœ‰é’ˆå¯¹å…·ä½“å¼‚å¸¸è¿›è¡Œæ•è·ã€‚æŸ¥çœ‹loadLibraryæºç å‘ç°å…¶å¯èƒ½ä¼šæŠ›å‡º<code>SecurityException</code>ã€<code>UnsatisfiedLinkError</code>æˆ–è€…<code>NullPointerException</code>ï¼Œ<code>SecurityException</code>å’Œ<code>NullPointerException</code>çš„çˆ¶ç±»éƒ½æ˜¯<code>RuntimeException</code>ï¼Œæ˜¯ä¸€ç§å¼‚å¸¸ï¼ˆ<code>Exception</code>ï¼‰ï¼Œ<code>UnsatisfiedLinkError</code>çš„çˆ¶ç±»æ˜¯<code>LinkageError</code>ï¼Œæ˜¯ä¸€ç§é”™è¯¯ï¼ˆ<code>Error</code>ï¼‰ï¼Œæ‰€ä»¥å¦‚æœè¿™é‡Œå‘ç”Ÿäº†<code>UnsatisfiedLinkError</code>ï¼Œé€šè¿‡<code>Exception</code>æ˜¯æ•è·ä¸äº†çš„ï¼Œå¿…é¡»é€šè¿‡ä»–ä»¬çš„å…±åŒçˆ¶ç±»<code>Throwable</code>æ¥è¿›è¡Œæ•è·ã€‚å½“ç„¶ï¼Œæœ€å¥½è¿˜æ˜¯é’ˆå¯¹å…·ä½“çš„å¼‚å¸¸è¿›è¡Œæ•è·ï¼Œä¸è¦ç”¨è¿™ç§æ‰©å¤§åŒ–çš„æ•è·æ–¹å¼ï¼Œå®¹æ˜“éšè—é—®é¢˜ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Loads the native library specified by the &lt;code&gt;libname&lt;/code&gt;</span><br><span class="hljs-comment"> * argument.  The &lt;code&gt;libname&lt;/code&gt; argument must not contain any platform</span><br><span class="hljs-comment"> * specific prefix, file extension or path. If a native library</span><br><span class="hljs-comment"> * called &lt;code&gt;libname&lt;/code&gt; is statically linked with the VM, then the</span><br><span class="hljs-comment"> * JNI_OnLoad_&lt;code&gt;libname&lt;/code&gt; function exported by the library is invoked.</span><br><span class="hljs-comment"> * See the JNI Specification for more details.</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * Otherwise, the libname argument is loaded from a system library</span><br><span class="hljs-comment"> * location and mapped to a native library image in an implementation-</span><br><span class="hljs-comment"> * dependent manner.</span><br><span class="hljs-comment"> * &lt;p&gt;</span><br><span class="hljs-comment"> * The call &lt;code&gt;System.loadLibrary(name)&lt;/code&gt; is effectively</span><br><span class="hljs-comment"> * equivalent to the call</span><br><span class="hljs-comment"> * &lt;blockquote&gt;&lt;pre&gt;</span><br><span class="hljs-comment"> * Runtime.getRuntime().loadLibrary(name)</span><br><span class="hljs-comment"> * &lt;/pre&gt;&lt;/blockquote&gt;</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span>      libname   the name of the library.</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@exception</span>  SecurityException  if a security manager exists and its</span><br><span class="hljs-comment"> *             &lt;code&gt;checkLink&lt;/code&gt; method doesn&#x27;t allow</span><br><span class="hljs-comment"> *             loading of the specified dynamic library</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@exception</span>  UnsatisfiedLinkError if either the libname argument</span><br><span class="hljs-comment"> *             contains a file path, the native library is not statically</span><br><span class="hljs-comment"> *             linked with the VM,  or the library cannot be mapped to a</span><br><span class="hljs-comment"> *             native library image by the host system.</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@exception</span>  NullPointerException if &lt;code&gt;libname&lt;/code&gt; is</span><br><span class="hljs-comment"> *             &lt;code&gt;null&lt;/code&gt;</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@see</span>        java.lang.Runtime#loadLibrary(java.lang.String)</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@see</span>        java.lang.SecurityManager#checkLink(java.lang.String)</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@CallerSensitive</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">loadLibrary</span><span class="hljs-params">(String libname)</span> &#123;<br>    Runtime.getRuntime().loadLibrary0(Reflection.getCallerClass(), libname);<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://developer.android.com/reference/java/lang/ExceptionInInitializerError">ExceptionInInitializerError  | Android Developers</a></p><p><a href="https://www.baeldung.com/java-exceptionininitializererror">When Does Java Throw the ExceptionInInitializerError? | Baeldung</a></p><p><a href="https://docs.oracle.com/javase/specs/jls/se14/html/jls-11.html#jls-11.2.3">Chapter 11. Exceptions</a></p>]]></content>
    
    
    <categories>
      
      <category>AndroidBugFix</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ¢ç©¶å®‰å“åº”ç”¨ç±»æ‰¾ä¸åˆ°çš„åŸå› (NoClassDefFoundErrorå’ŒClassNotFoundException)</title>
    <link href="/article/3122544f/"/>
    <url>/article/3122544f/</url>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨å…¬å¸ååŠ©åŒäº‹è§£å†³äº†å‡ ä¸ªç±»æ‰¾ä¸åˆ°çš„é—®é¢˜ï¼Œéƒ½æ¯”è¾ƒå…¸å‹ï¼Œç‰¹æ­¤è®°å½•ä¸€ä¸‹ã€‚</p><h1 id="åŸå› 1ï¼šæ–°æ—§ç‰ˆæœ¬SDK-APIå…¼å®¹æ€§"><a href="#åŸå› 1ï¼šæ–°æ—§ç‰ˆæœ¬SDK-APIå…¼å®¹æ€§" class="headerlink" title="åŸå› 1ï¼šæ–°æ—§ç‰ˆæœ¬SDK APIå…¼å®¹æ€§"></a>åŸå› 1ï¼šæ–°æ—§ç‰ˆæœ¬SDK APIå…¼å®¹æ€§</h1><p><code>io.reactivex.exceptions.UndeliverableException: java.lang.NoClassDefFoundError: Failed resolution of: Lretrofit2/HttpException;  at io.reactivex.plugins.RxJavaPlugins.onError(RxJavaPlugins.java:366)  at io.reactivex.internal.schedulers.ScheduledRunnable.run(ScheduledRunnable.java:69)  at io.reactivex.internal.schedulers.ScheduledRunnable.call(ScheduledRunnable.java:57)  at java.util.concurrent.FutureTask.run(FutureTask.java:266)  at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:301)  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1167)  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:641)  at java.lang.Thread.run(Thread.java:923) Caused by: java.lang.NoClassDefFoundError: Failed resolution of: Lretrofit2/HttpException;  at retrofit2.adapter.rxjava2.BodyObservable$BodyObserver.onNext(BodyObservable.java:54)  at retrofit2.adapter.rxjava2.BodyObservable$BodyObserver.onNext(BodyObservable.java:</code></p><p>ä¸€èˆ¬ç¢°åˆ°è¿™ç§ç±»æ‰¾ä¸åˆ°çš„é—®é¢˜ï¼Œç¬¬ä¸€æ—¶é—´å…ˆçœ‹çœ‹apkæœ¬èº«ï¼Œç”¨jadx-guiåç¼–è¯‘å‡ºæ¥å‘ç°æ²¡æœ‰HttpExceptionè¿™ä¸ªç±»ï¼Œç„¶åç”¨android studioæŸ¥çœ‹ï¼Œæœ‰è¿™ä¸ªç±»ï¼Œä½†show bytecodeæ˜¯ç°è‰²çš„ï¼Œè¯æ˜ç¼–è¯‘å‡ºæ¥çš„apkæ˜¯ä¸åŒ…å«è¿™ä¸ªç±»çš„ã€‚</p><p>ç„¶åå»æ’æŸ¥æºç ï¼Œæˆ‘ä»¬ç¡®å®æœ‰ä¾èµ–retrofitï¼Œä½†ä¸ºä»€ä¹ˆç¼–è¯‘å‡ºæ¥æ²¡æœ‰å‘¢ã€‚çœ‹äº†ä¸€ä¸‹dependencyä¾èµ–æ ‘ï¼Œç¡®å®åªæœ‰ä¸€ä¸ªç‰ˆæœ¬çš„retrofitã€‚ã€‚ã€‚é‚£æ˜¯ä¸æ˜¯ç¼–è¯‘çš„æ—¶å€™å»æ‰äº†å‘¢ï¼Ÿç„¶åå…¨å±€æœç´¢äº†ä¸€ä¸‹retrofitï¼Œå‘ç°äº†ä¸‹é¢çš„ä»£ç ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs groovy">android.applicationVariants.all &#123; variant -&gt;<br>variant.getRuntimeConfiguration().exclude <span class="hljs-attr">group:</span> <span class="hljs-string">&#x27;com.squareup.retrofit2&#x27;</span>, <span class="hljs-attr">module:</span> <span class="hljs-string">&#x27;retrofit&#x27;</span><br>variant.getRuntimeConfiguration().exclude <span class="hljs-attr">group:</span> <span class="hljs-attr">module:</span> <span class="hljs-string">&#x27;retrofit&#x27;</span><br><br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆè¦å»æ‰å‘¢ï¼Ÿä¸€èˆ¬éƒ½æ˜¯ä¸ºäº†è§£å†³å¤šä¸ªç‰ˆæœ¬ä¾èµ–çš„é—®é¢˜ï¼Œä½†ä¾èµ–æ ‘æ²¡æœ‰çœ‹åˆ°å¤šä¸ªç‰ˆæœ¬ä¾èµ–å•Šï¼Œæ˜¯ä¸æ˜¯æŸä¸ªsdkæºç ä¾èµ–äº†retrofitï¼Ÿ</p><p>æœç„¶ï¼Œæ³¨é‡Šæ‰ä¸Šé¢ä»£ç åï¼ŒæŠ¥ç±»å†²çªäº†ï¼Œå‘ç°æ˜¯æˆ‘å¸æŸä¸ªsdkçš„é—®é¢˜ï¼Œä»–è‡ªå·±æºç é›†æˆäº†retrofitï¼ŒåŒ…åä¸€æ ·ï¼Œä½†å› ä¸ºæ˜¯æ¯”è¾ƒè€çš„ç‰ˆæœ¬ï¼Œæ²¡æœ‰HttpExceptionè¿™ä¸ªç±»ï¼Œè€Œåº”ç”¨åˆæ˜¯åŸºäºæ–°ç‰ˆçš„retrofitå¼€å‘çš„ï¼Œä½†ç¼–è¯‘ä¸ºäº†è§£å†³å†²çªå»æ‰äº†ï¼Œç»“æœå°±å‡ºé—®é¢˜äº†ã€‚</p><p>é‚£è¦æ€ä¹ˆè§£å†³å‘¢ï¼Ÿæ”¹æˆexcludeæ—§ç‰ˆçš„retrofitï¼Ÿè¡Œä¸é€šï¼Œå› ä¸ºè¿™ä¸ªsdkæ˜¯æºç ä¾èµ–äº†retrofitï¼Œä¸æ˜¯é€šè¿‡implementè¿™ç§æ–¹æ³•ã€‚</p><p>æœ€åï¼Œæˆ‘æ‰¾åˆ°äº†è¿™ä¸ªsdkçš„æºç ï¼Œç¼–è¯‘äº†ä¸€ä¸ªæ²¡æœ‰retrofitçš„ç‰ˆæœ¬ã€‚å› ä¸ºä¾èµ–å…³ç³»æ˜¯åº”ç”¨ä¾èµ–äº†Aæ¨¡å—ï¼ŒAæ¨¡å—ä¾èµ–äº†è¿™ä¸ªsdkã€‚å¼•è¿›Aæ¨¡å—æ—¶ï¼Œexcludeæ‰è¿™ä¸ªsdkï¼Œç„¶ååœ¨åº”ç”¨ä¾§ç›´æ¥ä¾èµ–æ²¡æœ‰retrofitçš„ç‰ˆæœ¬ã€‚</p><h2 id="å¯å‘"><a href="#å¯å‘" class="headerlink" title="å¯å‘"></a>å¯å‘</h2><p>è§£å†³ç¼–è¯‘ç±»å†²çªæ—¶ï¼Œä¸€å®šè¦ç•™ä¸€ä¸ªå¿ƒçœ¼ï¼Œæ³¨æ„æ–°æ—§ç‰ˆæœ¬apiå˜æ›´çš„é—®é¢˜ã€‚å¦‚æœä»£ç è¦†ç›–ç‡æµ‹è¯•æ²¡æœ‰è·‘å…¨ï¼Œå°±æŠŠé—®é¢˜å¸¦åˆ°çº¿ä¸Šäº†ã€‚æ¯”å¦‚ï¼Œä¸Šé¢é‚£ä¸ªé—®é¢˜ï¼Œåªæœ‰åœ¨æŠ¥é”™çš„æ—¶å€™æ‰æœ‰å¯èƒ½è§¦å‘ï¼Œæ­£å¸¸æµ‹è¯•å¤§æ¦‚ç‡æ˜¯æµ‹ä¸å‡ºæ¥çš„ï¼Œæ¯”è¾ƒéšè”½ã€‚</p><h1 id=""><a href="#" class="headerlink" title=""></a></h1><h1 id="åŸå› 2ï¼šç³»ç»Ÿçš„æŸä¸ªjarå¼•ç”¨äº†ä¸åŒç‰ˆæœ¬çš„SDK"><a href="#åŸå› 2ï¼šç³»ç»Ÿçš„æŸä¸ªjarå¼•ç”¨äº†ä¸åŒç‰ˆæœ¬çš„SDK" class="headerlink" title="åŸå› 2ï¼šç³»ç»Ÿçš„æŸä¸ªjarå¼•ç”¨äº†ä¸åŒç‰ˆæœ¬çš„SDK"></a>åŸå› 2ï¼šç³»ç»Ÿçš„æŸä¸ªjarå¼•ç”¨äº†ä¸åŒç‰ˆæœ¬çš„SDK</h1><p><code>java.lang.NoSuchMethodError: No static method parseString(Ljava/lang/String;)Lcom/google/gson/JsonElement; in class Lcom/google/gson/JsonParser; or its super classes (declaration of &#39;com.google.gson.JsonParser&#39; appears in /system/framework/xxxxxx.jar)</code></p><p>è¿™ä¹Ÿæ˜¯ä¸€ä¸ªç¼–è¯‘é€šè¿‡ï¼Œè¿è¡Œæ—¶æŠ¥é”™çš„ä¾‹å­ã€‚é‡ç‚¹æ˜¯æœ€åä¸€å¥ï¼š&#x2F;system&#x2F;framework&#x2F;xxxxxx.jarï¼Œè¿™æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„ç³»ç»Ÿåº“ï¼Œæ”¾åˆ°äº†BootClasspathé‡Œé¢ã€‚åç¼–è¯‘åå‘ç°é‡Œé¢ä¾èµ–äº†ä¸€ä¸ªæ—§ç‰ˆæœ¬çš„gsonï¼Œæ²¡æœ‰parseStringè¿™ä¸ªæ–¹æ³•ï¼Œç”±äºåŒäº²å§”æ´¾æœºåˆ¶ï¼Œåº”ç”¨ä¼˜å…ˆä½¿ç”¨äº†è¿™ä¸ªæ—§ç‰ˆæœ¬çš„gsonï¼Œç»“æœå°±å‡ºé—®é¢˜äº†ã€‚</p><h2 id="å¯å‘-1"><a href="#å¯å‘-1" class="headerlink" title="å¯å‘"></a>å¯å‘</h2><p>ç³»ç»Ÿåº“å¼€å‘çš„æ—¶å€™è¦æ…é‡ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼›å¦‚æœç³»ç»Ÿåº“åªæ˜¯æœåŠ¡äºä¸€äº›ç‰¹å®šçš„åº”ç”¨ï¼Œä¸è¦åŠ å…¥åˆ°BootClasspathï¼Œåº”è¯¥è®©åº”ç”¨ä½¿ç”¨ï¼šuse-library:åŠ¨æ€è¿æ¥åº“çš„æ–¹æ³•ã€‚</p><h1 id="åŸå› 3ï¼šå‡çº§persiståº”ç”¨"><a href="#åŸå› 3ï¼šå‡çº§persiståº”ç”¨" class="headerlink" title="åŸå› 3ï¼šå‡çº§persiståº”ç”¨"></a>åŸå› 3ï¼šå‡çº§persiståº”ç”¨</h1><p><code>AndroidRuntime: java.lang.RuntimeException: Unable to get provider com.xxxx.sdk.xxxProvider: java.lang.ClassNotFoundException: Didn&#39;t find class &quot;com.xxxx.sdk.xxxProvider&quot; on path: DexPathList[[zip file &quot;/system/vendor/app/xx.apk&quot;],nativeLibraryDirectories=[/vendor/lib, /system/lib]]</code></p><p>ä¸€èˆ¬æ¥è¯´ï¼Œå®‰å“ç³»ç»Ÿæ˜¯ç¦æ­¢é€šè¿‡å®‰è£…çš„æ–¹æ³•æ¥å‡çº§persiståº”ç”¨çš„ï¼Œä½†å› ä¸ºå†å²åŸå› ï¼Œæˆ‘å¸ä¿®æ”¹äº†è¿™ä¸ªæœºåˆ¶ï¼Œå¯¼è‡´å¯ä»¥å‡çº§è¿™ç±»åº”ç”¨ï¼Œç»“æœå°±å¼•å‘äº†è¿™ä¸ªé—®é¢˜ï¼šDexPathListæ²¡æœ‰æ›´æ–°æˆæ–°å®‰è£…çš„è·¯å¾„ï¼šdataä¸‹é¢ï¼Œè¿˜æ˜¯åœç•™åœ¨systemåˆ†åŒºã€‚</p><p>ä¸€èˆ¬å‡çº§æ™®é€šåº”ç”¨æ—¶ï¼Œç³»ç»Ÿä¼šæ¸…é™¤è¯¥åº”ç”¨çš„è¿›ç¨‹ï¼ŒåŒæ—¶æ¸…ç†ä¹‹å‰åœ¨ActivityManagerServiceè®°å½•çš„è¯¥åº”ç”¨çš„å››å¤§ç»„ä»¶ï¼Œåœ¨ä¸‹æ¬¡åº”ç”¨é‡æ–°å¯åŠ¨æ—¶ï¼Œç³»ç»Ÿä¼šé‡æ–°åˆ›å»ºè¿›ç¨‹å¹¶åŠ è½½å„ç§ç»„ä»¶è¿è¡Œã€‚</p><p>ä½†æ˜¯ï¼Œå½“å‡çº§çš„åº”ç”¨æœ‰persistentå±æ€§æ—¶ï¼Œç³»ç»Ÿä¸ä¼šæ¸…é™¤è¯¥åº”ç”¨ã€‚åŸå› å¦‚ä¸‹ï¼š</p><p><a href="http://aospxref.com/android-11.0.0_r21/s?refs=killPackageProcessesLocked&project=frameworks">killPackageProcessesLocked (reference) in projects: frameworks - OpenGrok search results</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">killPackageProcessesLocked</span><span class="hljs-params">(String packageName, <span class="hljs-type">int</span> appId,</span><br><span class="hljs-params">           <span class="hljs-type">int</span> userId, <span class="hljs-type">int</span> minOomAdj, <span class="hljs-type">boolean</span> callerWillRestart, <span class="hljs-type">boolean</span> allowRestart,</span><br><span class="hljs-params">           <span class="hljs-type">boolean</span> doit, <span class="hljs-type">boolean</span> evenPersistent, <span class="hljs-type">boolean</span> setRemoved, <span class="hljs-type">int</span> reasonCode,</span><br><span class="hljs-params">           <span class="hljs-type">int</span> subReason, String reason)</span> &#123;<br>       ArrayList&lt;ProcessRecord&gt; procs = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br><br>       <span class="hljs-comment">// Remove all processes this package may have touched: all with the</span><br>       <span class="hljs-comment">// same UID (except for the system or root user), and all whose name</span><br>       <span class="hljs-comment">// matches the package name.</span><br>       <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">NP</span> <span class="hljs-operator">=</span> mProcessNames.getMap().size();<br>       <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">ip</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; ip &lt; NP; ip++) &#123;<br>           SparseArray&lt;ProcessRecord&gt; apps = mProcessNames.getMap().valueAt(ip);<br>           <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">NA</span> <span class="hljs-operator">=</span> apps.size();<br>           <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">ia</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; ia &lt; NA; ia++) &#123;<br>               <span class="hljs-type">ProcessRecord</span> <span class="hljs-variable">app</span> <span class="hljs-operator">=</span> apps.valueAt(ia);<br>               <span class="hljs-keyword">if</span> (app.isPersistent() &amp;&amp; !evenPersistent) &#123;<br>                   <span class="hljs-comment">// we don&#x27;t kill persistent processes</span><br>                   <span class="hljs-keyword">continue</span>;<br>               &#125;<br>               <span class="hljs-keyword">if</span> (app.removed) &#123;<br>                   <span class="hljs-keyword">if</span> (doit) &#123;<br>                       procs.add(app);<br>                   &#125;<br>                   <span class="hljs-keyword">continue</span>;<br>               &#125;<br>------------------------------------------<br>&#125;<br></code></pre></td></tr></table></figure><p>ç³»ç»Ÿä¹Ÿæ²¡æœ‰æ›´æ–°åº”ç”¨çš„ç±»åŠ è½½è·¯å¾„ã€‚</p><p>æ–¹æ¡ˆä¸€ï¼š</p><p>å®‰è£…å®Œæ–°ç‰ˆæœ¬åé‡å¯ç³»ç»Ÿã€‚</p><p>æ–¹æ¡ˆäºŒï¼š</p><p>åœ¨åº”ç”¨å†…æ¥æ”¶æ–°ç‰ˆåº”ç”¨å®‰è£…å®Œæˆçš„å¹¿æ’­ï¼Œå½“APKå‘ç”Ÿæ›´æ–°æˆ–å®‰è£…æ—¶ï¼Œ åŒ¹é…è‡ªå·±çš„åŒ…åï¼Œç„¶åè°ƒç”¨contextçš„startInstrumentation æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šå¼ºåˆ¶ç³»ç»Ÿæ¸…é™¤åº”ç”¨è¿›ç¨‹å¹¶æ¸…ç†AMSå¯¹å„ç§ç»„ä»¶çš„çŠ¶æ€è®°å¿†å¹¶é‡æ–°å¯åŠ¨è¯¥åº”ç”¨ã€‚</p><p>æˆ–è€…ï¼Œé€šè¿‡threadçš„å…¨å±€å¼‚å¸¸æ•è·ï¼ˆç±»æ‰¾ä¸åˆ°ï¼Œæ–¹æ³•æ‰¾ä¸åˆ°ï¼‰ï¼Œè°ƒç”¨ï¼š</p><p><code>boolean b = context.startInstrumentation(new ComponentName(getApplicationContext(), InstrumentationRoboot.class), null, null);</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InstrumentationRoboot</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Instrumentation</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle arguments)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(arguments);<br>    &#125;<br>&#125;          <br></code></pre></td></tr></table></figure><p>AndroidManifest.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">manifest</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">package</span>=<span class="hljs-string">&quot;è‡ªå·±çš„åŒ…å&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">instrumentation</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:name</span>=<span class="hljs-string">&quot;com.test.InstrumentationRoboot&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:targetPackage</span>=<span class="hljs-string">&quot;è‡ªå·±çš„åŒ…å&quot;</span>/&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">manifest</span>&gt;</span><br></code></pre></td></tr></table></figure><h1 id="å…¶ä»–åœºæ™¯"><a href="#å…¶ä»–åœºæ™¯" class="headerlink" title="å…¶ä»–åœºæ™¯"></a>å…¶ä»–åœºæ™¯</h1><p>æ’ä»¶åŒ–åŠ è½½è·¯å¾„ä¸å½“ï¼Œå®¿ä¸»å’Œæ’ä»¶çš„ç±»åŠ è½½é—®é¢˜ï¼›æ··æ·†å¯¼è‡´åå°„å¤±æ•ˆï¼›åœ¨å®‰å“5.0ä»¥ä¸‹æ²¡æœ‰å¯ç”¨MutilDexç­‰ç­‰ã€‚</p><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://blog.csdn.net/lindroid/article/details/90213146">Androidåº”ç”¨å…·æœ‰persistentå±æ€§æ—¶å‡çº§æ¸…ç†AMSç¼“å­˜æ•°æ®_android:persistent&#x3D;â€œtrueâ€ è‡ªå‡çº§-CSDNåšå®¢</a></p><p><a href="https://juejin.cn/post/6844904179626934279">ä¸€ä¸ªä¸€å¹´æ²¡è§£å†³çš„ClassNotFoundExceptionï½œç±»åŠ è½½æœºåˆ¶æ¢ç´¢ - æ˜é‡‘</a></p><p><a href="https://blog.csdn.net/jamesjxin/article/details/46606307">æ€ä¹ˆè§£å†³java.lang.NoClassDefFoundErroré”™è¯¯-CSDNåšå®¢</a></p>]]></content>
    
    
    <categories>
      
      <category>AndroidBugFix</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaåå°„çš„ä¼˜é›…ä½¿ç”¨</title>
    <link href="/article/ba67228f/"/>
    <url>/article/ba67228f/</url>
    
    <content type="html"><![CDATA[<p>å®‰å“9å¼€å§‹é™åˆ¶åå°„çš„è°ƒç”¨ï¼Œä½†æ˜¯å¸¦ç³»ç»Ÿç­¾åæˆ–è€…å†…ç½®ç³»ç»Ÿçš„åº”ç”¨æ˜¯å¯ä»¥è±å…çš„ ã€‚</p><p>æˆ–è€…ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“çªç ´è¿™ä¸ªé™åˆ¶ï¼š</p><p><a href="https://github.com/tiann/FreeReflection">tiann&#x2F;FreeReflection: A library that lets you use reflection without any restriction above Android P</a></p><h2 id="å¦‚ä½•ä½¿ç”¨"><a href="#å¦‚ä½•ä½¿ç”¨" class="headerlink" title="å¦‚ä½•ä½¿ç”¨"></a>å¦‚ä½•ä½¿ç”¨</h2><p>å‡è®¾æœ‰ä¸€ä¸ªPersonç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.wesley.app;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> &#123;<br>    <span class="hljs-keyword">private</span>  String name;<br>    <span class="hljs-keyword">private</span>  <span class="hljs-type">int</span> age;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">num</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Person</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> age)</span> &#123;<br>        <span class="hljs-built_in">this</span>.name = name;<br>        <span class="hljs-built_in">this</span>.age = age;<br>        num++;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> name;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAge</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> age;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> &#123;<br>        <span class="hljs-built_in">this</span>.name = name;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAge</span><span class="hljs-params">(<span class="hljs-type">int</span> age)</span> &#123;<br>        <span class="hljs-built_in">this</span>.age = age;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æ›¿æ¢ä¸€ä¸ªå®ä¾‹ä¸­çš„å­—æ®µ"><a href="#æ›¿æ¢ä¸€ä¸ªå®ä¾‹ä¸­çš„å­—æ®µ" class="headerlink" title="æ›¿æ¢ä¸€ä¸ªå®ä¾‹ä¸­çš„å­—æ®µ"></a>æ›¿æ¢ä¸€ä¸ªå®ä¾‹ä¸­çš„å­—æ®µ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Person</span> <span class="hljs-variable">person</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&quot;Wesley&quot;</span>, <span class="hljs-number">25</span>);<br><span class="hljs-keyword">try</span> &#123;<br>    Reflector.with(person).field(<span class="hljs-string">&quot;age&quot;</span>).set(<span class="hljs-number">28</span>);<br>&#125; <span class="hljs-keyword">catch</span> (Reflector.ReflectedException e) &#123;<br>    e.printStackTrace();<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="è°ƒç”¨ä¸€ä¸ªå®ä¾‹ä¸­å¯¹åº”çš„æ–¹æ³•"><a href="#è°ƒç”¨ä¸€ä¸ªå®ä¾‹ä¸­å¯¹åº”çš„æ–¹æ³•" class="headerlink" title="è°ƒç”¨ä¸€ä¸ªå®ä¾‹ä¸­å¯¹åº”çš„æ–¹æ³•"></a>è°ƒç”¨ä¸€ä¸ªå®ä¾‹ä¸­å¯¹åº”çš„æ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-comment">//æ— å‚æ•°</span><br>    Reflector.with(person).method(<span class="hljs-string">&quot;getAge&quot;</span>).call();<br>    <span class="hljs-comment">//æœ‰å‚æ•°</span><br>    Reflector.with(person).method(<span class="hljs-string">&quot;setAge&quot;</span>, <span class="hljs-type">int</span>.class).call(<span class="hljs-number">26</span>);<br>&#125; <span class="hljs-keyword">catch</span> (Reflector.ReflectedException e) &#123;<br>    e.printStackTrace();<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="è·å–é™æ€å˜é‡"><a href="#è·å–é™æ€å˜é‡" class="headerlink" title="è·å–é™æ€å˜é‡"></a>è·å–é™æ€å˜é‡</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">try</span> &#123;<br>    Reflector.on(Person.class).field(<span class="hljs-string">&quot;num&quot;</span>).get();<br>&#125; <span class="hljs-keyword">catch</span> (Reflector.ReflectedException e) &#123;<br>    e.printStackTrace();<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="ç”Ÿæˆå®ä¾‹å¯¹è±¡"><a href="#ç”Ÿæˆå®ä¾‹å¯¹è±¡" class="headerlink" title="ç”Ÿæˆå®ä¾‹å¯¹è±¡"></a>ç”Ÿæˆå®ä¾‹å¯¹è±¡</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-type">Person</span> <span class="hljs-variable">tom</span> <span class="hljs-operator">=</span> Reflector.on(Person.class).constructor(String.class, <span class="hljs-type">int</span>.class).newInstance(<span class="hljs-string">&quot;Tom&quot;</span>, <span class="hljs-number">18</span>);<br>&#125; <span class="hljs-keyword">catch</span> (Reflector.ReflectedException e) &#123;<br>    e.printStackTrace();<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="è°ƒç”¨é€šè¿‡åå°„ç”Ÿæˆçš„å®ä¾‹çš„æ–¹æ³•"><a href="#è°ƒç”¨é€šè¿‡åå°„ç”Ÿæˆçš„å®ä¾‹çš„æ–¹æ³•" class="headerlink" title="è°ƒç”¨é€šè¿‡åå°„ç”Ÿæˆçš„å®ä¾‹çš„æ–¹æ³•"></a>è°ƒç”¨é€šè¿‡åå°„ç”Ÿæˆçš„å®ä¾‹çš„æ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-type">Reflector</span> <span class="hljs-variable">reflector</span> <span class="hljs-operator">=</span> Reflector.on(Person.class);<br>    <span class="hljs-type">Person</span> <span class="hljs-variable">tom</span> <span class="hljs-operator">=</span> reflector.constructor(String.class, <span class="hljs-type">int</span>.class).newInstance(<span class="hljs-string">&quot;Tom&quot;</span>, <span class="hljs-number">18</span>);<br><br>    reflector.field(<span class="hljs-string">&quot;age&quot;</span>).get(tom);<br>    reflector.method(<span class="hljs-string">&quot;getAge&quot;</span>).callByCaller(tom); <br>    <span class="hljs-comment">//æˆ–è€…</span><br>    reflector.bind(tom);<br>    reflector.field(<span class="hljs-string">&quot;age&quot;</span>).get();<br>    reflector.method(<span class="hljs-string">&quot;getAge&quot;</span>).call();<br>&#125; <span class="hljs-keyword">catch</span> (Reflector.ReflectedException e) &#123;<br>    e.printStackTrace();<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="Reflectorå·¥å…·ç±»"><a href="#Reflectorå·¥å…·ç±»" class="headerlink" title="Reflectorå·¥å…·ç±»"></a>Reflectorå·¥å…·ç±»</h2><p><a href="https://github.com/didi/VirtualAPK/blob/master/CoreLibrary/src/main/java/com/didi/virtualapk/utils/Reflector.java">https://github.com/didi/VirtualAPK/blob/master/CoreLibrary/src/main/java/com/didi/virtualapk/utils/Reflector.java</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.wesley.sdk.helper.util;<br><br><span class="hljs-keyword">import</span> androidx.annotation.NonNull;<br><span class="hljs-keyword">import</span> androidx.annotation.Nullable;<br><br><span class="hljs-keyword">import</span> java.lang.reflect.Constructor;<br><span class="hljs-keyword">import</span> java.lang.reflect.Field;<br><span class="hljs-keyword">import</span> java.lang.reflect.InvocationTargetException;<br><span class="hljs-keyword">import</span> java.lang.reflect.Member;<br><span class="hljs-keyword">import</span> java.lang.reflect.Method;<br><span class="hljs-keyword">import</span> java.lang.reflect.Modifier;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Created by qiaopu on 2018/4/26.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Reflector</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">TAG</span> <span class="hljs-operator">=</span>  <span class="hljs-string">&quot;Reflector&quot;</span>;<br><br>    <span class="hljs-keyword">protected</span> Class&lt;?&gt; mType;<br>    <span class="hljs-keyword">protected</span> Object mCaller;<br>    <span class="hljs-keyword">protected</span> Constructor mConstructor;<br>    <span class="hljs-keyword">protected</span> Field mField;<br>    <span class="hljs-keyword">protected</span> Method mMethod;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ReflectedException</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Exception</span> &#123;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">ReflectedException</span><span class="hljs-params">(String message)</span> &#123;<br>            <span class="hljs-built_in">super</span>(message);<br>        &#125;<br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">ReflectedException</span><span class="hljs-params">(String message, Throwable cause)</span> &#123;<br>            <span class="hljs-built_in">super</span>(message, cause);<br>        &#125;<br><br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Reflector <span class="hljs-title function_">on</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> String name)</span> <span class="hljs-keyword">throws</span> ReflectedException &#123;<br>        <span class="hljs-keyword">return</span> on(name, <span class="hljs-literal">true</span>, Reflector.class.getClassLoader());<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Reflector <span class="hljs-title function_">on</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> String name, <span class="hljs-type">boolean</span> initialize)</span> <span class="hljs-keyword">throws</span> ReflectedException &#123;<br>        <span class="hljs-keyword">return</span> on(name, initialize, Reflector.class.getClassLoader());<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Reflector <span class="hljs-title function_">on</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> String name, <span class="hljs-type">boolean</span> initialize, <span class="hljs-meta">@Nullable</span> ClassLoader loader)</span> <span class="hljs-keyword">throws</span> ReflectedException &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">return</span> on(Class.forName(name, initialize, loader));<br>        &#125; <span class="hljs-keyword">catch</span> (Throwable e) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReflectedException</span>(<span class="hljs-string">&quot;Oops!&quot;</span>, e);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Reflector <span class="hljs-title function_">on</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> Class&lt;?&gt; type)</span> &#123;<br>        <span class="hljs-type">Reflector</span> <span class="hljs-variable">reflector</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Reflector</span>();<br>        reflector.mType = type;<br>        <span class="hljs-keyword">return</span> reflector;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Reflector <span class="hljs-title function_">with</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> Object caller)</span> <span class="hljs-keyword">throws</span> ReflectedException &#123;<br>        <span class="hljs-keyword">return</span> on(caller.getClass()).bind(caller);<br>    &#125;<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-title function_">Reflector</span><span class="hljs-params">()</span> &#123;<br><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> Reflector <span class="hljs-title function_">constructor</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Class&lt;?&gt;... parameterTypes)</span> <span class="hljs-keyword">throws</span> ReflectedException &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            mConstructor = mType.getDeclaredConstructor(parameterTypes);<br>            mConstructor.setAccessible(<span class="hljs-literal">true</span>);<br>            mField = <span class="hljs-literal">null</span>;<br>            mMethod = <span class="hljs-literal">null</span>;<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;<br>        &#125; <span class="hljs-keyword">catch</span> (Throwable e) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReflectedException</span>(<span class="hljs-string">&quot;Oops!&quot;</span>, e);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-meta">@SuppressWarnings(&quot;unchecked&quot;)</span><br>    <span class="hljs-keyword">public</span> &lt;R&gt; R <span class="hljs-title function_">newInstance</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Object ... initargs)</span> <span class="hljs-keyword">throws</span> ReflectedException &#123;<br>        <span class="hljs-keyword">if</span> (mConstructor == <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReflectedException</span>(<span class="hljs-string">&quot;Constructor was null!&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">return</span> (R) mConstructor.newInstance(initargs);<br>        &#125; <span class="hljs-keyword">catch</span> (InvocationTargetException e) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReflectedException</span>(<span class="hljs-string">&quot;Oops!&quot;</span>, e.getTargetException());<br>        &#125; <span class="hljs-keyword">catch</span> (Throwable e) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReflectedException</span>(<span class="hljs-string">&quot;Oops!&quot;</span>, e);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">protected</span> Object <span class="hljs-title function_">checked</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Object caller)</span> <span class="hljs-keyword">throws</span> ReflectedException &#123;<br>        <span class="hljs-keyword">if</span> (caller == <span class="hljs-literal">null</span> || mType.isInstance(caller)) &#123;<br>            <span class="hljs-keyword">return</span> caller;<br>        &#125;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReflectedException</span>(<span class="hljs-string">&quot;Caller [&quot;</span> + caller + <span class="hljs-string">&quot;] is not a instance of type [&quot;</span> + mType + <span class="hljs-string">&quot;]!&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">check</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Object caller, <span class="hljs-meta">@Nullable</span> Member member, <span class="hljs-meta">@NonNull</span> String name)</span> <span class="hljs-keyword">throws</span> ReflectedException &#123;<br>        <span class="hljs-keyword">if</span> (member == <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReflectedException</span>(name + <span class="hljs-string">&quot; was null!&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">if</span> (caller == <span class="hljs-literal">null</span> &amp;&amp; !Modifier.isStatic(member.getModifiers())) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReflectedException</span>(<span class="hljs-string">&quot;Need a caller!&quot;</span>);<br>        &#125;<br>        checked(caller);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> Reflector <span class="hljs-title function_">bind</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Object caller)</span> <span class="hljs-keyword">throws</span> ReflectedException &#123;<br>        mCaller = checked(caller);<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> Reflector <span class="hljs-title function_">unbind</span><span class="hljs-params">()</span> &#123;<br>        mCaller = <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> Reflector <span class="hljs-title function_">field</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> String name)</span> <span class="hljs-keyword">throws</span> ReflectedException &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            mField = findField(name);<br>            mField.setAccessible(<span class="hljs-literal">true</span>);<br>            mConstructor = <span class="hljs-literal">null</span>;<br>            mMethod = <span class="hljs-literal">null</span>;<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;<br>        &#125; <span class="hljs-keyword">catch</span> (Throwable e) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReflectedException</span>(<span class="hljs-string">&quot;Oops!&quot;</span>, e);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">protected</span> Field <span class="hljs-title function_">findField</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> String name)</span> <span class="hljs-keyword">throws</span> NoSuchFieldException &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">return</span> mType.getField(name);<br>        &#125; <span class="hljs-keyword">catch</span> (NoSuchFieldException e) &#123;<br>            <span class="hljs-keyword">for</span> (Class&lt;?&gt; cls = mType; cls != <span class="hljs-literal">null</span>; cls = cls.getSuperclass()) &#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    <span class="hljs-keyword">return</span> cls.getDeclaredField(name);<br>                &#125; <span class="hljs-keyword">catch</span> (NoSuchFieldException ex) &#123;<br>                    <span class="hljs-comment">// Ignored</span><br>                &#125;<br>            &#125;<br>            <span class="hljs-keyword">throw</span> e;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-meta">@SuppressWarnings(&quot;unchecked&quot;)</span><br>    <span class="hljs-keyword">public</span> &lt;R&gt; R <span class="hljs-title function_">get</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> ReflectedException &#123;<br>        <span class="hljs-keyword">return</span> get(mCaller);<br>    &#125;<br><br>    <span class="hljs-meta">@SuppressWarnings(&quot;unchecked&quot;)</span><br>    <span class="hljs-keyword">public</span> &lt;R&gt; R <span class="hljs-title function_">get</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Object caller)</span> <span class="hljs-keyword">throws</span> ReflectedException &#123;<br>        check(caller, mField, <span class="hljs-string">&quot;Field&quot;</span>);<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">return</span> (R) mField.get(caller);<br>        &#125; <span class="hljs-keyword">catch</span> (Throwable e) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReflectedException</span>(<span class="hljs-string">&quot;Oops!&quot;</span>, e);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> Reflector <span class="hljs-title function_">set</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Object value)</span> <span class="hljs-keyword">throws</span> ReflectedException &#123;<br>        <span class="hljs-keyword">return</span> set(mCaller, value);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> Reflector <span class="hljs-title function_">set</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Object caller, <span class="hljs-meta">@Nullable</span> Object value)</span> <span class="hljs-keyword">throws</span> ReflectedException &#123;<br>        check(caller, mField, <span class="hljs-string">&quot;Field&quot;</span>);<br>        <span class="hljs-keyword">try</span> &#123;<br>            mField.set(caller, value);<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;<br>        &#125; <span class="hljs-keyword">catch</span> (Throwable e) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReflectedException</span>(<span class="hljs-string">&quot;Oops!&quot;</span>, e);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> Reflector <span class="hljs-title function_">method</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> String name, <span class="hljs-meta">@Nullable</span> Class&lt;?&gt;... parameterTypes)</span> <span class="hljs-keyword">throws</span> ReflectedException &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            mMethod = findMethod(name, parameterTypes);<br>            mMethod.setAccessible(<span class="hljs-literal">true</span>);<br>            mConstructor = <span class="hljs-literal">null</span>;<br>            mField = <span class="hljs-literal">null</span>;<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;<br>        &#125; <span class="hljs-keyword">catch</span> (NoSuchMethodException e) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReflectedException</span>(<span class="hljs-string">&quot;Oops!&quot;</span>, e);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">protected</span> Method <span class="hljs-title function_">findMethod</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> String name, <span class="hljs-meta">@Nullable</span> Class&lt;?&gt;... parameterTypes)</span> <span class="hljs-keyword">throws</span> NoSuchMethodException &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">return</span> mType.getMethod(name, parameterTypes);<br>        &#125; <span class="hljs-keyword">catch</span> (NoSuchMethodException e) &#123;<br>            <span class="hljs-keyword">for</span> (Class&lt;?&gt; cls = mType; cls != <span class="hljs-literal">null</span>; cls = cls.getSuperclass()) &#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    <span class="hljs-keyword">return</span> cls.getDeclaredMethod(name, parameterTypes);<br>                &#125; <span class="hljs-keyword">catch</span> (NoSuchMethodException ex) &#123;<br>                    <span class="hljs-comment">// Ignored</span><br>                &#125;<br>            &#125;<br>            <span class="hljs-keyword">throw</span> e;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> &lt;R&gt; R <span class="hljs-title function_">call</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Object... args)</span> <span class="hljs-keyword">throws</span> ReflectedException &#123;<br>        <span class="hljs-keyword">return</span> callByCaller(mCaller, args);<br>    &#125;<br><br>    <span class="hljs-meta">@SuppressWarnings(&quot;unchecked&quot;)</span><br>    <span class="hljs-keyword">public</span> &lt;R&gt; R <span class="hljs-title function_">callByCaller</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Object caller, <span class="hljs-meta">@Nullable</span> Object... args)</span> <span class="hljs-keyword">throws</span> ReflectedException &#123;<br>        check(caller, mMethod, <span class="hljs-string">&quot;Method&quot;</span>);<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">return</span> (R) mMethod.invoke(caller, args);<br>        &#125; <span class="hljs-keyword">catch</span> (InvocationTargetException e) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReflectedException</span>(<span class="hljs-string">&quot;Oops!&quot;</span>, e.getTargetException());<br>        &#125; <span class="hljs-keyword">catch</span> (Throwable e) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReflectedException</span>(<span class="hljs-string">&quot;Oops!&quot;</span>, e);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">QuietReflector</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Reflector</span> &#123;<br><br>        <span class="hljs-keyword">protected</span> Throwable mIgnored;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> QuietReflector <span class="hljs-title function_">on</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> String name)</span> &#123;<br>            <span class="hljs-keyword">return</span> on(name, <span class="hljs-literal">true</span>, QuietReflector.class.getClassLoader());<br>        &#125;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> QuietReflector <span class="hljs-title function_">on</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> String name, <span class="hljs-type">boolean</span> initialize)</span> &#123;<br>            <span class="hljs-keyword">return</span> on(name, initialize, QuietReflector.class.getClassLoader());<br>        &#125;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> QuietReflector <span class="hljs-title function_">on</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> String name, <span class="hljs-type">boolean</span> initialize, <span class="hljs-meta">@Nullable</span> ClassLoader loader)</span> &#123;<br>            Class&lt;?&gt; cls = <span class="hljs-literal">null</span>;<br>            <span class="hljs-keyword">try</span> &#123;<br>                cls = Class.forName(name, initialize, loader);<br>                <span class="hljs-keyword">return</span> on(cls, <span class="hljs-literal">null</span>);<br>            &#125; <span class="hljs-keyword">catch</span> (Throwable e) &#123;<br><span class="hljs-comment">//                Log.w(LOG_TAG, &quot;Oops!&quot;, e);</span><br>                <span class="hljs-keyword">return</span> on(cls, e);<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> QuietReflector <span class="hljs-title function_">on</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Class&lt;?&gt; type)</span> &#123;<br>            <span class="hljs-keyword">return</span> on(type, (type == <span class="hljs-literal">null</span>) ? <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReflectedException</span>(<span class="hljs-string">&quot;Type was null!&quot;</span>) : <span class="hljs-literal">null</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> QuietReflector <span class="hljs-title function_">on</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Class&lt;?&gt; type, <span class="hljs-meta">@Nullable</span> Throwable ignored)</span> &#123;<br>            <span class="hljs-type">QuietReflector</span> <span class="hljs-variable">reflector</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">QuietReflector</span>();<br>            reflector.mType = type;<br>            reflector.mIgnored = ignored;<br>            <span class="hljs-keyword">return</span> reflector;<br>        &#125;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> QuietReflector <span class="hljs-title function_">with</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Object caller)</span> &#123;<br>            <span class="hljs-keyword">if</span> (caller == <span class="hljs-literal">null</span>) &#123;<br>                <span class="hljs-keyword">return</span> on((Class&lt;?&gt;) <span class="hljs-literal">null</span>);<br>            &#125;<br>            <span class="hljs-keyword">return</span> on(caller.getClass()).bind(caller);<br>        &#125;<br><br>        <span class="hljs-keyword">protected</span> <span class="hljs-title function_">QuietReflector</span><span class="hljs-params">()</span> &#123;<br><br>        &#125;<br><br>        <span class="hljs-keyword">public</span> Throwable <span class="hljs-title function_">getIgnored</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">return</span> mIgnored;<br>        &#125;<br><br>        <span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">skip</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">return</span> skipAlways() || mIgnored != <span class="hljs-literal">null</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">skipAlways</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">return</span> mType == <span class="hljs-literal">null</span>;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> QuietReflector <span class="hljs-title function_">constructor</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Class&lt;?&gt;... parameterTypes)</span> &#123;<br>            <span class="hljs-keyword">if</span> (skipAlways()) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;<br>            &#125;<br>            <span class="hljs-keyword">try</span> &#123;<br>                mIgnored = <span class="hljs-literal">null</span>;<br>                <span class="hljs-built_in">super</span>.constructor(parameterTypes);<br>            &#125; <span class="hljs-keyword">catch</span> (Throwable e) &#123;<br>                mIgnored = e;<br><span class="hljs-comment">//                Log.w(LOG_TAG, &quot;Oops!&quot;, e);</span><br>            &#125;<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> &lt;R&gt; R <span class="hljs-title function_">newInstance</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Object... initargs)</span> &#123;<br>            <span class="hljs-keyword">if</span> (skip()) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>            &#125;<br>            <span class="hljs-keyword">try</span> &#123;<br>                mIgnored = <span class="hljs-literal">null</span>;<br>                <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.newInstance(initargs);<br>            &#125; <span class="hljs-keyword">catch</span> (Throwable e) &#123;<br>                mIgnored = e;<br><span class="hljs-comment">//                Log.w(LOG_TAG, &quot;Oops!&quot;, e);</span><br>            &#125;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> QuietReflector <span class="hljs-title function_">bind</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Object obj)</span> &#123;<br>            <span class="hljs-keyword">if</span> (skipAlways()) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;<br>            &#125;<br>            <span class="hljs-keyword">try</span> &#123;<br>                mIgnored = <span class="hljs-literal">null</span>;<br>                <span class="hljs-built_in">super</span>.bind(obj);<br>            &#125; <span class="hljs-keyword">catch</span> (Throwable e) &#123;<br>                mIgnored = e;<br><span class="hljs-comment">//                Log.w(LOG_TAG, &quot;Oops!&quot;, e);</span><br>            &#125;<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> QuietReflector <span class="hljs-title function_">unbind</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-built_in">super</span>.unbind();<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> QuietReflector <span class="hljs-title function_">field</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> String name)</span> &#123;<br>            <span class="hljs-keyword">if</span> (skipAlways()) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;<br>            &#125;<br>            <span class="hljs-keyword">try</span> &#123;<br>                mIgnored = <span class="hljs-literal">null</span>;<br>                <span class="hljs-built_in">super</span>.field(name);<br>            &#125; <span class="hljs-keyword">catch</span> (Throwable e) &#123;<br>                mIgnored = e;<br><span class="hljs-comment">//                Log.w(LOG_TAG, &quot;Oops!&quot;, e);</span><br>            &#125;<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> &lt;R&gt; R <span class="hljs-title function_">get</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">if</span> (skip()) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>            &#125;<br>            <span class="hljs-keyword">try</span> &#123;<br>                mIgnored = <span class="hljs-literal">null</span>;<br>                <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.get();<br>            &#125; <span class="hljs-keyword">catch</span> (Throwable e) &#123;<br>                mIgnored = e;<br><span class="hljs-comment">//                Log.w(LOG_TAG, &quot;Oops!&quot;, e);</span><br>            &#125;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> &lt;R&gt; R <span class="hljs-title function_">get</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Object caller)</span> &#123;<br>            <span class="hljs-keyword">if</span> (skip()) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>            &#125;<br>            <span class="hljs-keyword">try</span> &#123;<br>                mIgnored = <span class="hljs-literal">null</span>;<br>                <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.get(caller);<br>            &#125; <span class="hljs-keyword">catch</span> (Throwable e) &#123;<br>                mIgnored = e;<br><span class="hljs-comment">//                Log.w(LOG_TAG, &quot;Oops!&quot;, e);</span><br>            &#125;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> QuietReflector <span class="hljs-title function_">set</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Object value)</span> &#123;<br>            <span class="hljs-keyword">if</span> (skip()) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;<br>            &#125;<br>            <span class="hljs-keyword">try</span> &#123;<br>                mIgnored = <span class="hljs-literal">null</span>;<br>                <span class="hljs-built_in">super</span>.set(value);<br>            &#125; <span class="hljs-keyword">catch</span> (Throwable e) &#123;<br>                mIgnored = e;<br><span class="hljs-comment">//                Log.w(LOG_TAG, &quot;Oops!&quot;, e);</span><br>            &#125;<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> QuietReflector <span class="hljs-title function_">set</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Object caller, <span class="hljs-meta">@Nullable</span> Object value)</span> &#123;<br>            <span class="hljs-keyword">if</span> (skip()) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;<br>            &#125;<br>            <span class="hljs-keyword">try</span> &#123;<br>                mIgnored = <span class="hljs-literal">null</span>;<br>                <span class="hljs-built_in">super</span>.set(caller, value);<br>            &#125; <span class="hljs-keyword">catch</span> (Throwable e) &#123;<br>                mIgnored = e;<br><span class="hljs-comment">//                Log.w(LOG_TAG, &quot;Oops!&quot;, e);</span><br>            &#125;<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> QuietReflector <span class="hljs-title function_">method</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> String name, <span class="hljs-meta">@Nullable</span> Class&lt;?&gt;... parameterTypes)</span> &#123;<br>            <span class="hljs-keyword">if</span> (skipAlways()) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;<br>            &#125;<br>            <span class="hljs-keyword">try</span> &#123;<br>                mIgnored = <span class="hljs-literal">null</span>;<br>                <span class="hljs-built_in">super</span>.method(name, parameterTypes);<br>            &#125; <span class="hljs-keyword">catch</span> (Throwable e) &#123;<br>                mIgnored = e;<br><span class="hljs-comment">//                Log.w(LOG_TAG, &quot;Oops!&quot;, e);</span><br>            &#125;<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> &lt;R&gt; R <span class="hljs-title function_">call</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Object... args)</span>  &#123;<br>            <span class="hljs-keyword">if</span> (skip()) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>            &#125;<br>            <span class="hljs-keyword">try</span> &#123;<br>                mIgnored = <span class="hljs-literal">null</span>;<br>                <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.call(args);<br>            &#125; <span class="hljs-keyword">catch</span> (Throwable e) &#123;<br>                mIgnored = e;<br><span class="hljs-comment">//                Log.w(LOG_TAG, &quot;Oops!&quot;, e);</span><br>            &#125;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> &lt;R&gt; R <span class="hljs-title function_">callByCaller</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Object caller, <span class="hljs-meta">@Nullable</span> Object... args)</span> &#123;<br>            <span class="hljs-keyword">if</span> (skip()) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>            &#125;<br>            <span class="hljs-keyword">try</span> &#123;<br>                mIgnored = <span class="hljs-literal">null</span>;<br>                <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.callByCaller(caller, args);<br>            &#125; <span class="hljs-keyword">catch</span> (Throwable e) &#123;<br>                mIgnored = e;<br><span class="hljs-comment">//                Log.w(LOG_TAG, &quot;Oops!&quot;, e);</span><br>            &#125;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç¼–ç¨‹æŠ€å·§</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åœ¨WSL2ç¼–è¯‘å®‰å“13å¹¶åœ¨WSL2å’Œwindowsè¿è¡Œ</title>
    <link href="/article/3fc1a37/"/>
    <url>/article/3fc1a37/</url>
    
    <content type="html"><![CDATA[<h1 id="åœ¨WSL2ç¼–è¯‘å®‰å“13å¹¶åœ¨WSL2å’Œwindowsè¿è¡Œ"><a href="#åœ¨WSL2ç¼–è¯‘å®‰å“13å¹¶åœ¨WSL2å’Œwindowsè¿è¡Œ" class="headerlink" title="åœ¨WSL2ç¼–è¯‘å®‰å“13å¹¶åœ¨WSL2å’Œwindowsè¿è¡Œ"></a>åœ¨WSL2ç¼–è¯‘å®‰å“13å¹¶åœ¨WSL2å’Œwindowsè¿è¡Œ</h1><p>åˆšå¼€å§‹çš„æ—¶å€™ï¼Œæˆ‘æ˜¯åœ¨masteråˆ†æ”¯ç¼–è¯‘å®‰å“çš„ï¼Œç»“æœè¿è¡Œemulatorèµ·ä¸æ¥ï¼Œåæ¥åˆ‡æ¢åˆ°android-13.0.0_r35å°±OKäº†ã€‚</p><h2 id="åœ¨wsl2ç¼–è¯‘å¹¶è¿è¡Œ"><a href="#åœ¨wsl2ç¼–è¯‘å¹¶è¿è¡Œ" class="headerlink" title="åœ¨wsl2ç¼–è¯‘å¹¶è¿è¡Œ"></a>åœ¨wsl2ç¼–è¯‘å¹¶è¿è¡Œ</h2><p>ä»¥ä¸‹æ˜¯ç¼–è¯‘å’Œè¿è¡Œæ­¥éª¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">wesley@Wesley:~/aosp$ source build/envsetup.sh<br>wesley@Wesley:~/aosp$ lunch sdk_pc_x86_64-userdebug<br>wesley@Wesley:~/aosp$ make -j18<br>wesley@Wesley:~/aosp$ emulator<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2023/202305281541373.png" alt="image-20230528154122118"></p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2023/202305281542994.png" alt="image-20230528154227766"></p><h3 id="å¯èƒ½å‡ºç°çš„é”™è¯¯"><a href="#å¯èƒ½å‡ºç°çš„é”™è¯¯" class="headerlink" title="å¯èƒ½å‡ºç°çš„é”™è¯¯"></a>å¯èƒ½å‡ºç°çš„é”™è¯¯</h3><p>1ã€MoTTY X11 proxy: Unsupported authorisation protocolMoTTY X11 proxy: Unsupported authorisation protocol</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">æ™®é€šç”¨æˆ·æŠ¥é”™ï¼Œrootç”¨æˆ·ä¸æŠ¥é”™çš„è§£å†³æ–¹æ³•ï¼š</span><br>cp /root/.Xauthority /home/xxx/<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">æ™®é€šç”¨æˆ·ä¸æŠ¥é”™ï¼Œrootç”¨æˆ·æŠ¥é”™çš„è§£å†³æ–¹æ³•ï¼š</span><br>cp /home/xxx/.Xauthority /root/<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">xxxä¸ºç”¨æˆ·å</span><br></code></pre></td></tr></table></figure><p>2ã€kvmæ— æƒé™è®¿é—®</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs shell">wesley@Wesley:~/aosp$ emulator<br>INFO    | Android emulator version 31.3.9.0 (build_id 8748233) (CL:N/A)<br>INFO    | Storing crashdata in: /tmp/android-wesley/emu-crash.db, detection is enabled<br>INFO    | Duplicate loglines will be removed, if you wish to see each indiviudal line launch with the -log-nofilter flag.<br>ProbeKVM: This user doesn&#x27;t have permissions to use KVM (/dev/kvm).<br>The KVM line in /etc/group is: [kvm:x:108:wesley]<br><br>If the current user has KVM permissions,<br>the KVM line in /etc/group should end with &quot;:&quot; followed by your username.<br><br>If we see LINE_NOT_FOUND, the kvm group may need to be created along with permissions:<br>sudo groupadd -r kvm<br><span class="hljs-meta prompt_"># </span><span class="language-bash">Then ensure /lib/udev/rules.d/50-udev-default.rules contains something like:</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">KERNEL==<span class="hljs-string">&quot;kvm&quot;</span>, GROUP=<span class="hljs-string">&quot;kvm&quot;</span>, MODE=<span class="hljs-string">&quot;0660&quot;</span></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">and <span class="hljs-keyword">then</span> run:</span><br>sudo gpasswd -a $USER kvm<br><br>If we see kvm:... but no username at the end, running the following command may allow KVM access:<br>sudo gpasswd -a $USER kvm<br><br>You may need to log out and back in for changes to take effect.<br><br>ERROR   | x86_64 emulation currently requires hardware acceleration!<br>CPU acceleration status: This user doesn&#x27;t have permissions to use KVM (/dev/kvm).<br>The KVM line in /etc/group is: [kvm:x:108:wesley]<br><br>If the current user has KVM permissions,<br>the KVM line in /etc/group should end with &quot;:&quot; followed by your username.<br><br>If we see LINE_NOT_FOUND, the<br>More info on configuring VM acceleration on Linux:<br>https://developer.android.com/studio/run/emulator-acceleration#vm-linux<br>General information on acceleration: https://developer.android.com/studio/run/emulator-acceleration.<br></code></pre></td></tr></table></figure><p>è§£å†³åŠæ³•ï¼š</p><p>1ã€åˆ›å»ºkvmç”¨æˆ·ç»„</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo groupadd -r kvm #åˆ›å»ºkvmç”¨æˆ·ç»„<br>sudo gpasswd -a $USER kvm #æ·»åŠ ç”¨æˆ·åˆ°kvm<br></code></pre></td></tr></table></figure><p>2ã€æ›´æ”¹&#x2F;dev&#x2F;kvmè®¿é—®æƒé™</p><p>&#x2F;dev&#x2F;kvmé»˜è®¤æƒé™æ˜¯600ï¼Œåªæœ‰rootç”¨æˆ·å¯ä»¥è®¿é—®ï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶ç”¨æˆ·ç»„æ›´æ”¹ä¸ºkvmå¹¶èµ‹äºˆ660æƒé™ã€‚</p><p>ç¼–è¾‘&#x2F;etc&#x2F;wsl.conf</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">[boot]<br>command = /bin/bash -c &#x27;chown -v root:kvm /dev/kvm &amp;&amp; chmod 660 /dev/kvm&#x27;<br></code></pre></td></tr></table></figure><p>ä½ç‰ˆæœ¬çš„windowså¯èƒ½æ²¡æœ‰æ‰“å¼€åµŒå¥—è™šæ‹ŸåŒ–ï¼Œéœ€è¦åŠ å…¥ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">[wsl2]<br>nestedVirtualization=true<br></code></pre></td></tr></table></figure><p>é‡å¯wsl</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">wsl.exe --shutdown<br></code></pre></td></tr></table></figure><h2 id="åœ¨windowsä¸Šè¿è¡Œ"><a href="#åœ¨windowsä¸Šè¿è¡Œ" class="headerlink" title="åœ¨windowsä¸Šè¿è¡Œ"></a>åœ¨windowsä¸Šè¿è¡Œ</h2><p>ç”±äºåµŒå¥—è™šæ‹ŸåŒ–ï¼Œç›®å‰åœ¨wsl2ç›´æ¥è¿è¡Œæ¨¡æ‹Ÿå™¨ä¼šæ¯”è¾ƒå¡ï¼Œæˆ‘ä»¬éœ€è¦åˆ‡æ¢åˆ°windowsè¿è¡Œã€‚</p><h3 id="æ‰“åŒ…-AVD-æ˜ åƒ-zip-æ–‡ä»¶"><a href="#æ‰“åŒ…-AVD-æ˜ åƒ-zip-æ–‡ä»¶" class="headerlink" title="æ‰“åŒ… AVD æ˜ åƒ zip æ–‡ä»¶"></a>æ‰“åŒ… AVD æ˜ åƒ zip æ–‡ä»¶</h3><p>å®‰å“12å¼€å§‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">make -j18 emu_img_zip<br></code></pre></td></tr></table></figure><p>å®‰å“12ä»¥ä¸‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">make -j18 sdk sdk_repo</span><br></code></pre></td></tr></table></figure><p>ç¼–è¯‘å®Œæˆåä¼šç”Ÿæˆä»¥ <code>sdk-repo-linux-system-images</code> ä¸ºå‰ç¼€çš„ AVD æ˜ åƒ zip æ–‡ä»¶ã€‚</p><p>æ¯”å¦‚æˆ‘çš„æ˜¯<code>\home\wesley\aosp\out\target\product\emulator64_x86_64\sdk-repo-linux-system-images-eng.wesley.zip</code></p><p>å¯ä»¥å°†å…¶è§£å‹åœ¨å½“å‰æ–‡ä»¶å¤¹æˆ–è€…å…¶ä»–windowsè·¯å¾„ï¼Œæˆ‘è¿™é‡Œé€‰æ‹©å°±åœ°è§£å‹ï¼š</p><p>è·å¾—windowsè®¿é—®è·¯å¾„ï¼š<code>\\wsl.localhost\Ubuntu-20.04\home\wesley\aosp\out\target\product\emulator64_x86_64\x86_64</code></p><p>åœ¨powershellæ‰§è¡Œï¼š</p><blockquote><p>æˆ‘å·²ç»å°†C:\Users\Windows\AppData\Local\Android\Sdk\emulatorè·¯å¾„æ·»åŠ åˆ°ç¯å¢ƒå˜é‡äº†ï¼ŒLarge_Desktop_API_33æ˜¯æˆ‘åœ¨android studioåˆ›å»ºæ¨¡æ‹Ÿå™¨çš„åç§°ã€‚</p></blockquote><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs moonscript">emulator -avd Large_Desktop_API_33  -sysdir \\wsl.localhost\Ubuntu<span class="hljs-number">-20.04</span>\home\wesley\aosp\out\target\product\emulator64_x86_64\x86_64  -dns-server <span class="hljs-number">8.8</span><span class="hljs-number">.8</span><span class="hljs-number">.8</span>,<span class="hljs-number">114.114</span><span class="hljs-number">.114</span><span class="hljs-number">.114</span> -verbose<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img2023/202305281603646.png" alt="image-20230528160320010"></p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://developer.android.google.cn/studio/run/emulator-commandline?hl=zh-cn">ä»å‘½ä»¤è¡Œå¯åŠ¨æ¨¡æ‹Ÿå™¨  | Android Studio  | Android Developers</a></p><p><a href="https://developer.android.com/studio/run/managing-avds?utm_source=android-studio&hl=zh-cn">åˆ›å»ºå’Œç®¡ç†è™šæ‹Ÿè®¾å¤‡  | Android Studio  | Android Developers</a></p><p><a href="https://source.android.google.cn/docs/devices/automotive/start/avd/android_virtual_device?hl=zh-cn">ç”¨ä½œå¼€å‘å¹³å°çš„ Android è™šæ‹Ÿè®¾å¤‡  | Android å¼€æºé¡¹ç›®  | Android Open Source Project</a></p><p><a href="https://source.android.com/docs/setup/create/avd?hl=zh-cn#sharing_avd_system_images_for_others_to_use_with_android_studio">ä½¿ç”¨ Android æ¨¡æ‹Ÿå™¨è™šæ‹Ÿè®¾å¤‡  | Android å¼€æºé¡¹ç›®  | Android Open Source Project</a></p><p>[AOSP-13 : Not able to create AVD system image from <a href="https://issuetracker.google.com/issues/244956535">244956535] - Visible to Public - Issue Tracker</a></p><p><a href="https://serverfault.com/questions/1043441/how-to-run-kvm-nested-in-wsl2-or-vmware">hyper v - How to run KVM nested in WSL2 (or vmware)? - Server Fault</a></p><p><a href="https://www.cnblogs.com/create-serenditipy/p/15407983.html">Linuxè¿œç¨‹å›¾å½¢åŒ–ç•Œé¢å‡ºé”™ï¼šMoTTY X11 proxy: Unsupported authorisation protocol - æ—¶é—´çš„é£æ™¯ - åšå®¢å›­</a></p>]]></content>
    
    
    <categories>
      
      <category>Android Build System</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Android Build</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®‰å“ç³»ç»Ÿåº”ç”¨çš„å¸è½½å’Œæ¢å¤(édataåˆ†åŒº)</title>
    <link href="/article/5867f171/"/>
    <url>/article/5867f171/</url>
    
    <content type="html"><![CDATA[<h1 id="å®‰å“ç³»ç»Ÿåº”ç”¨çš„å¸è½½å’Œæ¢å¤-édataåˆ†åŒº"><a href="#å®‰å“ç³»ç»Ÿåº”ç”¨çš„å¸è½½å’Œæ¢å¤-édataåˆ†åŒº" class="headerlink" title="å®‰å“ç³»ç»Ÿåº”ç”¨çš„å¸è½½å’Œæ¢å¤(édataåˆ†åŒº)"></a>å®‰å“ç³»ç»Ÿåº”ç”¨çš„å¸è½½å’Œæ¢å¤(édataåˆ†åŒº)</h1><h2 id="Uninstall-and-Restore-Android-System-Apps-non-data-partition"><a href="#Uninstall-and-Restore-Android-System-Apps-non-data-partition" class="headerlink" title="Uninstall and Restore Android System Apps (non-data partition)"></a>Uninstall and Restore Android System Apps (non-data partition)</h2><p>ç½‘ä¸Šå·²ç»æœ‰å¾ˆå¤šé¢„è£…åº”ç”¨å¸è½½çš„æ–¹æ³•äº†ï¼Œä½†æ˜¯ä»–ä»¬åŸºæœ¬éƒ½æ˜¯è®¾æ³•åœ¨ç¬¬ä¸€æ¬¡å¼€æœºçš„æ—¶å€™å®‰è£…åˆ°dataåˆ†åŒºã€‚</p><p>æœ¬æ–‡éœ€è¦è¾¾åˆ°çš„ç›®æ ‡æ˜¯é¢„è£…åœ¨systemåˆ†åŒºçš„åº”ç”¨èƒ½å¤Ÿè¢«å¸è½½ï¼Œä¸”èƒ½æ¢å¤å®‰è£…ã€‚</p><h3 id="å‘½ä»¤è¡Œæ–¹æ³•"><a href="#å‘½ä»¤è¡Œæ–¹æ³•" class="headerlink" title="å‘½ä»¤è¡Œæ–¹æ³•"></a>å‘½ä»¤è¡Œæ–¹æ³•</h3><p>å®‰å“5.0å¼€å§‹å¯ä»¥é’ˆå¯¹ç”¨æˆ·å¸è½½ç³»ç»Ÿåº”ç”¨</p><h4 id="å¸è½½ç³»ç»Ÿåº”ç”¨"><a href="#å¸è½½ç³»ç»Ÿåº”ç”¨" class="headerlink" title="å¸è½½ç³»ç»Ÿåº”ç”¨"></a>å¸è½½ç³»ç»Ÿåº”ç”¨</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">adb shell pm uninstall -k --user 0 appåŒ…å<br></code></pre></td></tr></table></figure><p>-kæ˜¯æ˜¯å¦éœ€è¦ä¿ç•™æ•°æ®ï¼Œå¯ä»¥ä¸åŠ ã€‚</p><h4 id="æ¢å¤ç³»ç»Ÿåº”ç”¨"><a href="#æ¢å¤ç³»ç»Ÿåº”ç”¨" class="headerlink" title="æ¢å¤ç³»ç»Ÿåº”ç”¨"></a>æ¢å¤ç³»ç»Ÿåº”ç”¨</h4><p>å®‰å“7å¼€å§‹æ‰å¯ä»¥é€šè¿‡å‘½ä»¤æ¢å¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">adb shell cmd package install-existing appåŒ…å<br></code></pre></td></tr></table></figure><h3 id="ä»£ç æ–¹æ³•"><a href="#ä»£ç æ–¹æ³•" class="headerlink" title="ä»£ç æ–¹æ³•"></a>ä»£ç æ–¹æ³•</h3><h4 id="ä»£ç åˆ†æ-åŸºäºç›®å‰aosp-masteråˆ†æ”¯æœ€æ–°ä»£ç "><a href="#ä»£ç åˆ†æ-åŸºäºç›®å‰aosp-masteråˆ†æ”¯æœ€æ–°ä»£ç " class="headerlink" title="ä»£ç åˆ†æ(åŸºäºç›®å‰aosp masteråˆ†æ”¯æœ€æ–°ä»£ç )"></a>ä»£ç åˆ†æ(åŸºäºç›®å‰aosp masteråˆ†æ”¯æœ€æ–°ä»£ç )</h4><h5 id="å¸è½½"><a href="#å¸è½½" class="headerlink" title="å¸è½½"></a>å¸è½½</h5><p>com&#x2F;android&#x2F;server&#x2F;pm&#x2F;PackageManagerShellCommand.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">runUninstall</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> RemoteException &#123;<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">PrintWriter</span> <span class="hljs-variable">pw</span> <span class="hljs-operator">=</span> getOutPrintWriter();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">flags</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">userId</span> <span class="hljs-operator">=</span> UserHandle.USER_ALL;<br>        <span class="hljs-type">long</span> <span class="hljs-variable">versionCode</span> <span class="hljs-operator">=</span> PackageManager.VERSION_CODE_HIGHEST;<br><br>        String opt;<br>        <span class="hljs-keyword">while</span> ((opt = getNextOption()) != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">switch</span> (opt) &#123;<br>                <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;-k&quot;</span>:<br>                    flags |= PackageManager.DELETE_KEEP_DATA;<br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;--user&quot;</span>:<br>                    userId = UserHandle.parseUserArg(getNextArgRequired());<br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;--versionCode&quot;</span>:<br>                    versionCode = Long.parseLong(getNextArgRequired());<br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">default</span>:<br>                    pw.println(<span class="hljs-string">&quot;Error: Unknown option: &quot;</span> + opt);<br>                    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">packageName</span> <span class="hljs-operator">=</span> getNextArg();<br>        <span class="hljs-keyword">if</span> (packageName == <span class="hljs-literal">null</span>) &#123;<br>            pw.println(<span class="hljs-string">&quot;Error: package name not specified&quot;</span>);<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>        &#125;<br><br>        / <span class="hljs-keyword">if</span> a split is specified, just remove it and not the whole <span class="hljs-keyword">package</span><br>        ArrayList&lt;String&gt; splitNames = getRemainingArgs();<br>        <span class="hljs-keyword">if</span> (!splitNames.isEmpty()) &#123;<br>            <span class="hljs-keyword">return</span> runRemoveSplits(packageName, splitNames);<br>        &#125;<br>        <span class="hljs-comment">// ä¸åŠ --useræ˜¯å¸è½½æ‰€æœ‰ç”¨æˆ·çš„åº”ç”¨</span><br>        <span class="hljs-keyword">if</span> (userId == UserHandle.USER_ALL) &#123;<br>            flags |= PackageManager.DELETE_ALL_USERS;<br>        &#125;<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">translatedUserId</span> <span class="hljs-operator">=</span><br>                translateUserId(userId, UserHandle.USER_SYSTEM, <span class="hljs-string">&quot;runUninstall&quot;</span>);<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">LocalIntentReceiver</span> <span class="hljs-variable">receiver</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LocalIntentReceiver</span>();<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">PackageManagerInternal</span> <span class="hljs-variable">internal</span> <span class="hljs-operator">=</span><br>                LocalServices.getService(PackageManagerInternal.class);<br><br>        <span class="hljs-keyword">if</span> (internal.isApexPackage(packageName)) &#123;<br>            internal.uninstallApex(<br>                    packageName, versionCode, translatedUserId, receiver.getIntentSender(), flags);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">//å¦‚æœåˆ é™¤æŸä¸€ä¸ªç”¨æˆ·çš„åº”ç”¨ï¼Œèµ°è¿™é‡Œ</span><br>            <span class="hljs-keyword">if</span> ((flags &amp; PackageManager.DELETE_ALL_USERS) == <span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-keyword">final</span> <span class="hljs-type">PackageInfo</span> <span class="hljs-variable">info</span> <span class="hljs-operator">=</span> mInterface.getPackageInfo(packageName,<br>                        PackageManager.MATCH_STATIC_SHARED_AND_SDK_LIBRARIES, translatedUserId);<br>                <span class="hljs-keyword">if</span> (info == <span class="hljs-literal">null</span>) &#123;<br>                    pw.println(<span class="hljs-string">&quot;Failure [not installed for &quot;</span> + translatedUserId + <span class="hljs-string">&quot;]&quot;</span>);<br>                    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>                &#125;<br>                <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">isSystem</span> <span class="hljs-operator">=</span><br>                        (info.applicationInfo.flags &amp; ApplicationInfo.FLAG_SYSTEM) != <span class="hljs-number">0</span>;<br>                <span class="hljs-comment">// If we are being asked to delete a system app for just one</span><br>                <span class="hljs-comment">// user set flag so it disables rather than reverting to system</span><br>                <span class="hljs-comment">// version of the app.</span><br>                <span class="hljs-keyword">if</span> (isSystem) &#123;<br>                    flags |= PackageManager.DELETE_SYSTEM_APP;<br>                &#125;<br>            &#125;<br>            mInterface.getPackageInstaller().uninstall(<span class="hljs-keyword">new</span> <span class="hljs-title class_">VersionedPackage</span>(packageName,<br>                            versionCode), <span class="hljs-literal">null</span> <span class="hljs-comment">/*callerPackageName*/</span>, flags,<br>                    receiver.getIntentSender(), translatedUserId);<br>        &#125;<br><br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Intent</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> receiver.getResult();<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">status</span> <span class="hljs-operator">=</span> result.getIntExtra(PackageInstaller.EXTRA_STATUS,<br>                PackageInstaller.STATUS_FAILURE);<br>        <span class="hljs-keyword">if</span> (status == PackageInstaller.STATUS_SUCCESS) &#123;<br>            pw.println(<span class="hljs-string">&quot;Success&quot;</span>);<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            pw.println(<span class="hljs-string">&quot;Failure [&quot;</span><br>                    + result.getStringExtra(PackageInstaller.EXTRA_STATUS_MESSAGE) + <span class="hljs-string">&quot;]&quot;</span>);<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><p>android&#x2F;content&#x2F;pm&#x2F;PackageInstaller.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Uninstall the given package with a specific version code, removing it</span><br><span class="hljs-comment">     * completely from the device. If the version code of the package</span><br><span class="hljs-comment">     * does not match the one passed in the versioned package argument this</span><br><span class="hljs-comment">     * method is a no-op. Use &#123;<span class="hljs-doctag">@link</span> PackageManager#VERSION_CODE_HIGHEST&#125; to</span><br><span class="hljs-comment">     * uninstall the latest version of the package.</span><br><span class="hljs-comment">     * &lt;p&gt;</span><br><span class="hljs-comment">     * This method is available to:</span><br><span class="hljs-comment">     * &lt;ul&gt;</span><br><span class="hljs-comment">     * &lt;li&gt;the current &quot;installer of record&quot; for the package</span><br><span class="hljs-comment">     * &lt;li&gt;the device owner</span><br><span class="hljs-comment">     * &lt;li&gt;the affiliated profile owner</span><br><span class="hljs-comment">     * &lt;/ul&gt;</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> versionedPackage The versioned package to uninstall.</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> statusReceiver Where to deliver the result.</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@see</span> android.app.admin.DevicePolicyManager</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@RequiresPermission(anyOf = &#123;</span><br><span class="hljs-meta">            Manifest.permission.DELETE_PACKAGES,</span><br><span class="hljs-meta">            Manifest.permission.REQUEST_DELETE_PACKAGES&#125;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">uninstall</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> VersionedPackage versionedPackage,</span><br><span class="hljs-params">            <span class="hljs-meta">@NonNull</span> IntentSender statusReceiver)</span> &#123;<br>        uninstall(versionedPackage, <span class="hljs-number">0</span> <span class="hljs-comment">/*flags*/</span>, statusReceiver);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Uninstall the given package with a specific version code, removing it</span><br><span class="hljs-comment">     * completely from the device. This method is only available to the current</span><br><span class="hljs-comment">     * &quot;installer of record&quot; for the package. If the version code of the package</span><br><span class="hljs-comment">     * does not match the one passed in the versioned package argument this</span><br><span class="hljs-comment">     * method is a no-op. Use &#123;<span class="hljs-doctag">@link</span> PackageManager#VERSION_CODE_HIGHEST&#125; to</span><br><span class="hljs-comment">     * uninstall the latest version of the package.</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> versionedPackage The versioned package to uninstall.</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> flags Flags for uninstall.</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> statusReceiver Where to deliver the result.</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@hide</span></span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@RequiresPermission(anyOf = &#123;</span><br><span class="hljs-meta">            Manifest.permission.DELETE_PACKAGES,</span><br><span class="hljs-meta">            Manifest.permission.REQUEST_DELETE_PACKAGES&#125;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">uninstall</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> VersionedPackage versionedPackage, <span class="hljs-meta">@DeleteFlags</span> <span class="hljs-type">int</span> flags,</span><br><span class="hljs-params">            <span class="hljs-meta">@NonNull</span> IntentSender statusReceiver)</span> &#123;<br>        Objects.requireNonNull(versionedPackage, <span class="hljs-string">&quot;versionedPackage cannot be null&quot;</span>);<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//binderè°ƒç”¨</span><br>            mInstaller.uninstall(versionedPackage, mInstallerPackageName,<br>                    flags, statusReceiver, mUserId);<br>        &#125; <span class="hljs-keyword">catch</span> (RemoteException e) &#123;<br>            <span class="hljs-keyword">throw</span> e.rethrowFromSystemServer();<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><p>com&#x2F;android&#x2F;server&#x2F;pm&#x2F;PackageInstallerService.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">uninstall</span><span class="hljs-params">(VersionedPackage versionedPackage, String callerPackageName, <span class="hljs-type">int</span> flags,</span><br><span class="hljs-params">                IntentSender statusReceiver, <span class="hljs-type">int</span> userId)</span> &#123;<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Computer</span> <span class="hljs-variable">snapshot</span> <span class="hljs-operator">=</span> mPm.snapshotComputer();<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">callingUid</span> <span class="hljs-operator">=</span> Binder.getCallingUid();<br>        snapshot.enforceCrossUserPermission(callingUid, userId, <span class="hljs-literal">true</span>, <span class="hljs-literal">true</span>, <span class="hljs-string">&quot;uninstall&quot;</span>);<br>        <span class="hljs-keyword">if</span> ((callingUid != Process.SHELL_UID) &amp;&amp; (callingUid != Process.ROOT_UID)) &#123;<br>            mAppOps.checkPackage(callingUid, callerPackageName);<br>        &#125;<br><br>        <span class="hljs-comment">// Check whether the caller is device owner or affiliated profile owner, in which case we do</span><br>        <span class="hljs-comment">// it silently.</span><br>        <span class="hljs-type">DevicePolicyManagerInternal</span> <span class="hljs-variable">dpmi</span> <span class="hljs-operator">=</span><br>                LocalServices.getService(DevicePolicyManagerInternal.class);<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">canSilentlyInstallPackage</span> <span class="hljs-operator">=</span><br>                dpmi != <span class="hljs-literal">null</span> &amp;&amp; dpmi.canSilentlyInstallPackage(callerPackageName, callingUid);<br><br>        <span class="hljs-keyword">final</span> <span class="hljs-type">PackageDeleteObserverAdapter</span> <span class="hljs-variable">adapter</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PackageDeleteObserverAdapter</span>(mContext,<br>                statusReceiver, versionedPackage.getPackageName(),<br>                canSilentlyInstallPackage, userId);<br>        <span class="hljs-keyword">if</span> (mContext.checkCallingOrSelfPermission(android.Manifest.permission.DELETE_PACKAGES)<br>                    == PackageManager.PERMISSION_GRANTED) &#123;<br>            <span class="hljs-comment">// Sweet, call straight through!</span><br>            mPm.deletePackageVersioned(versionedPackage, adapter.getBinder(), userId, flags);<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (canSilentlyInstallPackage) &#123;<br>            <span class="hljs-comment">// Allow the device owner and affiliated profile owner to silently delete packages</span><br>            <span class="hljs-comment">// Need to clear the calling identity to get DELETE_PACKAGES permission</span><br>            <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">ident</span> <span class="hljs-operator">=</span> Binder.clearCallingIdentity();<br>            <span class="hljs-keyword">try</span> &#123;<br>                mPm.deletePackageVersioned(versionedPackage, adapter.getBinder(), userId, flags);<br>            &#125; <span class="hljs-keyword">finally</span> &#123;<br>                Binder.restoreCallingIdentity(ident);<br>            &#125;<br>            DevicePolicyEventLogger<br>                    .createEvent(DevicePolicyEnums.UNINSTALL_PACKAGE)<br>                    .setAdmin(callerPackageName)<br>                    .write();<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-type">ApplicationInfo</span> <span class="hljs-variable">appInfo</span> <span class="hljs-operator">=</span> snapshot.getApplicationInfo(callerPackageName, <span class="hljs-number">0</span>, userId);<br>            <span class="hljs-keyword">if</span> (appInfo.targetSdkVersion &gt;= Build.VERSION_CODES.P) &#123;<br>                mContext.enforceCallingOrSelfPermission(Manifest.permission.REQUEST_DELETE_PACKAGES,<br>                        <span class="hljs-literal">null</span>);<br>            &#125;<br><br>            <span class="hljs-comment">// Take a short detour to confirm with user</span><br>            <span class="hljs-keyword">final</span> <span class="hljs-type">Intent</span> <span class="hljs-variable">intent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>(Intent.ACTION_UNINSTALL_PACKAGE);<br>            intent.setData(Uri.fromParts(<span class="hljs-string">&quot;package&quot;</span>, versionedPackage.getPackageName(), <span class="hljs-literal">null</span>));<br>            intent.putExtra(PackageInstaller.EXTRA_CALLBACK, adapter.getBinder().asBinder());<br>            adapter.onUserActionRequired(intent);<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><p>com&#x2F;android&#x2F;server&#x2F;pm&#x2F;IPackageManagerBase.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br>    <span class="hljs-meta">@Deprecated</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deletePackageAsUser</span><span class="hljs-params">(String packageName, <span class="hljs-type">int</span> versionCode,</span><br><span class="hljs-params">                                          IPackageDeleteObserver observer, <span class="hljs-type">int</span> userId, <span class="hljs-type">int</span> flags)</span> &#123;<br>        deletePackageVersioned(<span class="hljs-keyword">new</span> <span class="hljs-title class_">VersionedPackage</span>(packageName, versionCode),<br>                               <span class="hljs-keyword">new</span> <span class="hljs-title class_">PackageManager</span>.LegacyPackageDeleteObserver(observer).getBinder(), userId,<br>                               flags);<br>    &#125;<br></code></pre></td></tr></table></figure><h5 id="æ¢å¤å®‰è£…"><a href="#æ¢å¤å®‰è£…" class="headerlink" title="æ¢å¤å®‰è£…"></a>æ¢å¤å®‰è£…</h5><p>com&#x2F;android&#x2F;server&#x2F;pm&#x2F;PackageManagerShellCommand.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">runInstallExisting</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> RemoteException &#123;<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">PrintWriter</span> <span class="hljs-variable">pw</span> <span class="hljs-operator">=</span> getOutPrintWriter();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">userId</span> <span class="hljs-operator">=</span> UserHandle.USER_CURRENT;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">installFlags</span> <span class="hljs-operator">=</span> PackageManager.INSTALL_ALL_WHITELIST_RESTRICTED_PERMISSIONS;<br>        String opt;<br>        <span class="hljs-type">boolean</span> <span class="hljs-variable">waitTillComplete</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br>        <span class="hljs-keyword">while</span> ((opt = getNextOption()) != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">switch</span> (opt) &#123;<br>                <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;--user&quot;</span>:<br>                    userId = UserHandle.parseUserArg(getNextArgRequired());<br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;--ephemeral&quot;</span>:<br>                <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;--instant&quot;</span>:<br>                    installFlags |= PackageManager.INSTALL_INSTANT_APP;<br>                    installFlags &amp;= ~PackageManager.INSTALL_FULL_APP;<br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;--full&quot;</span>:<br>                    installFlags &amp;= ~PackageManager.INSTALL_INSTANT_APP;<br>                    installFlags |= PackageManager.INSTALL_FULL_APP;<br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;--wait&quot;</span>:<br>                    waitTillComplete = <span class="hljs-literal">true</span>;<br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;--restrict-permissions&quot;</span>:<br>                    installFlags &amp;= ~PackageManager.INSTALL_ALL_WHITELIST_RESTRICTED_PERMISSIONS;<br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">default</span>:<br>                    pw.println(<span class="hljs-string">&quot;Error: Unknown option: &quot;</span> + opt);<br>                    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">packageName</span> <span class="hljs-operator">=</span> getNextArg();<br>        <span class="hljs-keyword">if</span> (packageName == <span class="hljs-literal">null</span>) &#123;<br>            pw.println(<span class="hljs-string">&quot;Error: package name not specified&quot;</span>);<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>        &#125;<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">translatedUserId</span> <span class="hljs-operator">=</span><br>                translateUserId(userId, UserHandle.USER_NULL, <span class="hljs-string">&quot;runInstallExisting&quot;</span>);<br><br>        <span class="hljs-type">int</span> <span class="hljs-variable">installReason</span> <span class="hljs-operator">=</span> PackageManager.INSTALL_REASON_UNKNOWN;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">if</span> (waitTillComplete) &#123;<br>                <span class="hljs-keyword">final</span> <span class="hljs-type">LocalIntentReceiver</span> <span class="hljs-variable">receiver</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LocalIntentReceiver</span>();<br>                <span class="hljs-keyword">final</span> <span class="hljs-type">IPackageInstaller</span> <span class="hljs-variable">installer</span> <span class="hljs-operator">=</span> mInterface.getPackageInstaller();<br>                pw.println(<span class="hljs-string">&quot;Installing package &quot;</span> + packageName + <span class="hljs-string">&quot; for user: &quot;</span> + translatedUserId);<br>                installer.installExistingPackage(packageName, installFlags, installReason,<br>                        receiver.getIntentSender(), translatedUserId, <span class="hljs-literal">null</span>);<br>                <span class="hljs-keyword">final</span> <span class="hljs-type">Intent</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> receiver.getResult();<br>                <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">status</span> <span class="hljs-operator">=</span> result.getIntExtra(PackageInstaller.EXTRA_STATUS,<br>                        PackageInstaller.STATUS_FAILURE);<br>                pw.println(<span class="hljs-string">&quot;Received intent for package install&quot;</span>);<br>                <span class="hljs-keyword">return</span> status == PackageInstaller.STATUS_SUCCESS ? <span class="hljs-number">0</span> : <span class="hljs-number">1</span>;<br>            &#125;<br>         <span class="hljs-comment">//èµ°è¿™é‡Œ</span><br>            <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">res</span> <span class="hljs-operator">=</span> mInterface.installExistingPackageAsUser(packageName, translatedUserId,<br>                    installFlags, installReason, <span class="hljs-literal">null</span>);<br>            <span class="hljs-keyword">if</span> (res == PackageManager.INSTALL_FAILED_INVALID_URI) &#123;<br>                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NameNotFoundException</span>(<span class="hljs-string">&quot;Package &quot;</span> + packageName + <span class="hljs-string">&quot; doesn&#x27;t exist&quot;</span>);<br>            &#125;<br>            pw.println(<span class="hljs-string">&quot;Package &quot;</span> + packageName + <span class="hljs-string">&quot; installed for user: &quot;</span> + translatedUserId);<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>        &#125; <span class="hljs-keyword">catch</span> (RemoteException | NameNotFoundException e) &#123;<br>            pw.println(e.toString());<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><h3 id="ç³»ç»Ÿåº”ç”¨åå°„è°ƒç”¨æ¥å£è¿›è¡Œå¸è½½å’Œæ¢å¤"><a href="#ç³»ç»Ÿåº”ç”¨åå°„è°ƒç”¨æ¥å£è¿›è¡Œå¸è½½å’Œæ¢å¤" class="headerlink" title="ç³»ç»Ÿåº”ç”¨åå°„è°ƒç”¨æ¥å£è¿›è¡Œå¸è½½å’Œæ¢å¤"></a>ç³»ç»Ÿåº”ç”¨åå°„è°ƒç”¨æ¥å£è¿›è¡Œå¸è½½å’Œæ¢å¤</h3><p>è™½ç„¶å‘½ä»¤ä»å®‰å“5.0æ‰å¼€å§‹æ”¯æŒï¼Œä½†æ¥å£åº”è¯¥æ˜¯ä»å®‰å“4.2ï¼ˆæ”¯æŒå¤šç”¨æˆ·ï¼‰å°±å¼€å§‹æ”¯æŒäº†ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-comment">//å®‰å“8ä»¥å‰</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deletePackageAsUser</span><span class="hljs-params">(<span class="hljs-keyword">final</span> String packageName,</span><br><span class="hljs-params">                                    <span class="hljs-keyword">final</span> IPackageDeleteObserver observer,</span><br><span class="hljs-params">                                    <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> userId, <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> flags)</span> <br><br><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">installExistingPackageAsUser</span><span class="hljs-params">(String packageName, <span class="hljs-type">int</span> userId)</span> <br><br><span class="hljs-comment">//å®‰å“8å¼€å§‹</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deletePackageAsUser</span><span class="hljs-params">(String packageName, <span class="hljs-type">int</span> versionCode, IPackageDeleteObserver observer, <span class="hljs-type">int</span> userId, <span class="hljs-type">int</span> flags)</span> <br><br><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">installExistingPackageAsUser</span><span class="hljs-params">(String packageName, <span class="hljs-type">int</span> userId, <span class="hljs-type">int</span> installFlags,<span class="hljs-type">int</span> installReason)</span><br></code></pre></td></tr></table></figure><h4 id="æ€ä¹ˆåš"><a href="#æ€ä¹ˆåš" class="headerlink" title="æ€ä¹ˆåš"></a>æ€ä¹ˆåš</h4><p>ç³»ç»Ÿåº”ç”¨å¯ä»¥é€šè¿‡android.content.pm.IPackageManager$Stubåå°„åˆ†åˆ«è·å¾—deletePackageAsUserå’ŒinstallExistingPackageAsUserï¼Œå‰è€…å¯ä»¥å¸è½½ï¼Œåè€…å¯ä»¥æ¢å¤å®‰è£…ã€‚æ¢å¤å®‰è£…ä¹‹å‰å¯ä»¥é€šè¿‡packageManager.getApplicationInfoåˆ¤æ–­ç³»ç»Ÿæ˜¯å¦è¿˜å­˜åœ¨å®‰è£…åŒ…ï¼Œå¦åˆ™å¯ä»¥è·³åº”ç”¨å•†åº—è¿›è¡Œå®‰è£…ã€‚</p><p>æ³¨æ„ï¼š</p><p>1ã€deletePackageAsUserä¼šæ¸…é™¤æ•°æ®ï¼Œä½†ä¸ä¼šå¸è½½æ›´æ–°ã€‚å³å¦‚æœç³»ç»Ÿåº”ç”¨æ›´æ–°åï¼Œä¼šå­˜åœ¨ä¸¤ä¸ªapkï¼Œä¸€ä¸ªåœ¨systemåˆ†åŒºï¼Œä¸€ä¸ªåœ¨dataåˆ†åŒºã€‚</p><p>å¦‚æœè¦åˆ é™¤dataä¸‹çš„æ›´æ–°ï¼Œå¯ä»¥å…ˆè°ƒç”¨å¸è½½æ¥å£å†è°ƒç”¨deletePackageAsUserã€‚</p><p>2ã€&#x2F;data&#x2F;dalvik-cache&#x2F;ä¸‹é¢ä¼šæ®‹ç•™dexæ–‡ä»¶ï¼Œå¯ä»¥æ‰«æåˆ é™¤ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>AndroidFrameworkFeature</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>PackageMangerService</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®‰å“å¸§ç‡FPSè®¡ç®—åŸç†</title>
    <link href="/article/8fa06fb4/"/>
    <url>/article/8fa06fb4/</url>
    
    <content type="html"><![CDATA[<p>FPSï¼ˆå¸§ç‡ï¼‰ï¼Œå³frames per secondã€‚</p><p>ç›®å‰ï¼Œå¸§ç‡ç»Ÿè®¡è½¯ä»¶ä½¿ç”¨çš„ä¿¡æ¯æ¥æºä¸»è¦æœ‰ä¸¤ä¸ª: ä¸€ä¸ªæ˜¯åŸºäº<code>dumpsys SurfaceFlinger --latency layer-name</code>ï¼›å¦ä¸€ä¸ªæ˜¯åŸºäº<code>dumpsys gfxinfo</code>ã€‚</p><p>æœ¬æ–‡ä¸è¯´æ€ä¹ˆä½¿ç”¨ä¸Šé¢ä¸¤ä¸ªæ–¹æ³•æ¥ç»Ÿè®¡å¸§ç‡ï¼Œä¸»è¦è¯´<code>dumpsys SurfaceFlinger --latency layer-name</code>çš„æ•°æ®æ¥æºã€‚</p><p>æƒ³çŸ¥é“æ€ä¹ˆç»Ÿè®¡å¸§ç‡çš„ï¼Œå¯ä»¥å‚è€ƒä¸‹é¢ä¸¤ç¯‡æ–‡ç« ï¼š</p><p><a href="https://testerhome.com/topics/20187">android ç«¯ç›‘æ§æ–¹æ¡ˆåˆ†äº« Â· TesterHome</a></p><p><a href="https://testerhome.com/topics/21045">ä»‹ç»ä¸‹åŸºäº systrace gfx ç»Ÿè®¡å¸§ç‡æ–¹æ¡ˆçš„å®ç°è¿‡ç¨‹ Â· TesterHome</a></p><p>æ‰§è¡Œ<code>dumpsys SurfaceFlinger --latency layer-name</code>å‘½ä»¤åï¼Œäº§ç”Ÿçš„è¾“å‡ºæ¥æºäº<code>FrameTracker::dumpStats(std::string&amp; result)</code>æ–¹æ³•ã€‚</p><p>frameworks&#x2F;native&#x2F;services&#x2F;surfaceflinger&#x2F;FrameTracker.cpp</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">FrameTracker::dumpStats</span><span class="hljs-params">(std::string&amp; result)</span> <span class="hljs-type">const</span> </span>&#123;<br>    <span class="hljs-function">Mutex::Autolock <span class="hljs-title">lock</span><span class="hljs-params">(mMutex)</span></span>;<br>    <span class="hljs-built_in">processFencesLocked</span>();<br><br>    <span class="hljs-type">const</span> <span class="hljs-type">size_t</span> o = mOffset;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">1</span>; i &lt; NUM_FRAME_RECORDS; i++) &#123;<br>        <span class="hljs-type">const</span> <span class="hljs-type">size_t</span> index = (o+i) % NUM_FRAME_RECORDS;<br>        base::<span class="hljs-built_in">StringAppendF</span>(&amp;result, <span class="hljs-string">&quot;%&quot;</span> PRId64 <span class="hljs-string">&quot;\t%&quot;</span> PRId64 <span class="hljs-string">&quot;\t%&quot;</span> PRId64 <span class="hljs-string">&quot;\n&quot;</span>,<br>                            mFrameRecords[index].desiredPresentTime,<br>                            mFrameRecords[index].actualPresentTime,<br>                            mFrameRecords[index].frameReadyTime);<br>    &#125;<br>    result.<span class="hljs-built_in">append</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>å…ˆè¯´ç»“è®ºï¼šdesiredPresentTimeï¼ŒactualPresentTimeï¼ŒframeReadyTimeåˆ†åˆ«ä»£è¡¨ï¼š</p><ul><li>desiredPresentTimeï¼šqueueBuffer çš„æ—¶é—´æˆ³</li><li>actualPresentTimeï¼špresent fence signal çš„æ—¶é—´æˆ³</li><li>frameReadyTimeï¼šacquire fence signal çš„æ—¶é—´æˆ³</li></ul><p><strong>Fenceçš„ç±»å‹</strong>ï¼š</p><p><a href="https://source.android.com/devices/graphics/sync">Synchronization Framework</a> </p><p>The Hardware Composer handles three types of sync fences:</p><ul><li><strong>Acquire fences</strong> are passed along with input buffers to the <code>setLayerBuffer</code> and <code>setClientTarget</code> calls. These represent a pending write into the buffer and must signal before the SurfaceFlinger or the HWC attempts to read from the associated buffer to perform composition.</li><li><strong>Release fences</strong> are retrieved after the call to <code>presentDisplay</code> using the <code>getReleaseFences</code> call. These represent a pending read from the previous buffer on the same layer. A release fence signals when the HWC is no longer using the previous buffer because the current buffer has replaced the previous buffer on the display. Release fences are passed back to the app along with the previous buffers that will be replaced during the current composition. The app must wait until a release fence signals before writing new contents into the buffer that was returned to them.</li><li><strong>Present fences</strong> are returned, one per frame, as part of the call to <code>presentDisplay</code>. Present fences represent when the composition of this frame has completed, or alternately, when the composition result of the prior frame is no longer needed. For physical displays, <code>presentDisplay</code> returns present fences when the current frame appears on the screen. After present fences are returned, itâ€™s safe to write to the SurfaceFlinger target buffer again, if applicable. For virtual displays, present fences are returned when itâ€™s safe to read from the output buffer.</li></ul><p>åœ¨ Android é‡Œé¢ï¼Œæ€»å…±æœ‰ä¸‰ç±» fence â€”â€” acquire fenceï¼Œrelease fence å’Œ present fenceã€‚å…¶ä¸­ï¼Œacquire fence å’Œ release fence éš¶å±äº Layerï¼Œpresent fence éš¶å±äºå¸§ï¼ˆå³ Layersï¼‰ï¼š</p><p>acquire fence ï¼šApp å°† Buffer é€šè¿‡ <code>queueBuffer()</code> è¿˜ç»™ BufferQueue çš„æ—¶å€™ï¼Œæ­¤æ—¶è¯¥ Buffer çš„ GPU ä¾§å…¶å®æ˜¯è¿˜æ²¡æœ‰å®Œæˆçš„ï¼Œæ­¤æ—¶ä¼šå¸¦ä¸Šä¸€ä¸ª fenceï¼Œè¿™ä¸ª fence å°±æ˜¯ <strong>acquire fence</strong>ã€‚å½“ SurfaceFlinger&#x2F; HWC è¦è¯»å– Buffer ä»¥è¿›è¡Œåˆæˆæ“ä½œçš„æ—¶å€™ï¼Œéœ€è¦ç­‰ <strong>acquire fence</strong> é‡Šæ”¾ä¹‹åæ‰è¡Œã€‚</p><p>release fence ï¼šå½“ App é€šè¿‡ <code>dequeueBuffer()</code> ä» BufferQueue ç”³è¯· Bufferï¼Œè¦å¯¹ Buffer è¿›è¡Œç»˜åˆ¶çš„æ—¶å€™ï¼Œéœ€è¦ä¿è¯ HWC å·²ç»ä¸å†éœ€è¦è¿™ä¸ª Buffer äº†ï¼Œå³éœ€è¦ç­‰ release fence signal æ‰èƒ½å¯¹ Buffer è¿›è¡Œå†™æ“ä½œã€‚</p><p>present fence ï¼špresent fence åœ¨ HWC1 çš„æ—¶å€™ç§°ä¸º retire fenceï¼Œåœ¨ HWC2 ä¸­æ”¹åä¸º present fenceã€‚å½“å‰å¸§æˆåŠŸæ˜¾ç¤ºåˆ°å±å¹•çš„æ—¶å€™ï¼Œpresent fence å°±ä¼š signalã€‚</p><h2 id="desiredPresentTimeå’ŒframeReadyTimeæ¥è‡ªå“ªé‡Œï¼ˆåŸºäºå®‰å“12æºç åˆ†æï¼‰"><a href="#desiredPresentTimeå’ŒframeReadyTimeæ¥è‡ªå“ªé‡Œï¼ˆåŸºäºå®‰å“12æºç åˆ†æï¼‰" class="headerlink" title="desiredPresentTimeå’ŒframeReadyTimeæ¥è‡ªå“ªé‡Œï¼ˆåŸºäºå®‰å“12æºç åˆ†æï¼‰"></a>desiredPresentTimeå’ŒframeReadyTimeæ¥è‡ªå“ªé‡Œï¼ˆåŸºäº<a href="https://cs.android.com/android/platform/superproject/+/android-12.0.0_r32:frameworks/native/services/surfaceflinger/FrameTracker.h;bpv=1;bpt=0">å®‰å“12</a>æºç åˆ†æï¼‰</h2><p>frameworks&#x2F;native&#x2F;services&#x2F;surfaceflinger&#x2F;FrameTracker.h</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">// setDesiredPresentTime sets the time at which the current frame</span><br><span class="hljs-comment">// should be presented to the user under ideal (i.e. zero latency)</span><br><span class="hljs-comment">// conditions.</span><br><span class="hljs-comment">//ç†æƒ³æ¡ä»¶ä¸‹ï¼ˆå³é›¶å»¶è¿Ÿï¼‰å‘ˆç°ç»™ç”¨æˆ·çš„æ—¶é—´ç‚¹ã€‚</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">setDesiredPresentTime</span><span class="hljs-params">(<span class="hljs-type">nsecs_t</span> desiredPresentTime)</span></span>;<br><br><span class="hljs-comment">// setFrameReadyTime sets the time at which the current frame became ready</span><br><span class="hljs-comment">// to be presented to the user.  For example, if the frame contents is</span><br><span class="hljs-comment">// being written to memory by some asynchronous hardware, this would be</span><br><span class="hljs-comment">// the time at which those writes completed.</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">setFrameReadyTime</span><span class="hljs-params">(<span class="hljs-type">nsecs_t</span> readyTime)</span></span>;<br><br><span class="hljs-comment">// setFrameReadyFence sets the fence that is used to get the time at which</span><br><span class="hljs-comment">// the current frame became ready to be presented to the user.</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">setFrameReadyFence</span><span class="hljs-params">(std::shared_ptr&lt;FenceTime&gt;&amp;&amp; readyFence)</span></span>;<br><br><span class="hljs-comment">// setActualPresentTime sets the timestamp at which the current frame became</span><br><span class="hljs-comment">// visible to the user.</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">setActualPresentTime</span><span class="hljs-params">(<span class="hljs-type">nsecs_t</span> displayTime)</span></span>;<br><br><span class="hljs-comment">// setActualPresentFence sets the fence that is used to get the time</span><br><span class="hljs-comment">// at which the current frame became visible to the user.</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">setActualPresentFence</span><span class="hljs-params">(<span class="hljs-type">const</span> std::shared_ptr&lt;FenceTime&gt;&amp; fence)</span></span>;<br></code></pre></td></tr></table></figure><p>frameworks&#x2F;native&#x2F;services&#x2F;surfaceflinger&#x2F;BufferLayer.cpp</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">BufferLayer::onPostComposition</span><span class="hljs-params">(<span class="hljs-type">const</span> DisplayDevice* display,</span></span><br><span class="hljs-params"><span class="hljs-function">                                    <span class="hljs-type">const</span> std::shared_ptr&lt;FenceTime&gt;&amp; glDoneFence,</span></span><br><span class="hljs-params"><span class="hljs-function">                                    <span class="hljs-type">const</span> std::shared_ptr&lt;FenceTime&gt;&amp; presentFence,</span></span><br><span class="hljs-params"><span class="hljs-function">                                    <span class="hljs-type">const</span> CompositorTiming&amp; compositorTiming)</span> </span>&#123;<br>......<br><br>    <span class="hljs-comment">// Update mFrameTracker.</span><br>    <span class="hljs-type">nsecs_t</span> desiredPresentTime = mBufferInfo.mDesiredPresentTime;<br>    <span class="hljs-comment">//å…³é”®ç‚¹1ï¼šè®¾ç½®desiredPresentTime</span><br>    mFrameTracker.<span class="hljs-built_in">setDesiredPresentTime</span>(desiredPresentTime);<br><br> ......<br>std::shared_ptr&lt;FenceTime&gt; frameReadyFence = mBufferInfo.mFenceTime;<br>    <span class="hljs-keyword">if</span> (frameReadyFence-&gt;<span class="hljs-built_in">isValid</span>()) &#123;<br>        <span class="hljs-comment">//å…³é”®ç‚¹2ï¼šè®¾ç½®frameReadyFence</span><br>        mFrameTracker.<span class="hljs-built_in">setFrameReadyFence</span>(std::<span class="hljs-built_in">move</span>(frameReadyFence));<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">//çº¯è½¯ä»¶ç»˜åˆ¶æ‰èµ°è¿™é‡Œï¼ŒframeReadyTimeå’ŒdesiredPresentTimeå°±ä¸€æ ·äº†</span><br>        <span class="hljs-comment">// There was no fence for this frame, so assume that it was ready</span><br>        <span class="hljs-comment">// to be presented at the desired present time.</span><br>        mFrameTracker.<span class="hljs-built_in">setFrameReadyTime</span>(desiredPresentTime);<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (display) &#123;<br>        <span class="hljs-type">const</span> Fps refreshRate = display-&gt;<span class="hljs-built_in">refreshRateConfigs</span>().<span class="hljs-built_in">getCurrentRefreshRate</span>().<span class="hljs-built_in">getFps</span>();<br>        <span class="hljs-type">const</span> std::optional&lt;Fps&gt; renderRate =<br>                mFlinger-&gt;mScheduler-&gt;<span class="hljs-built_in">getFrameRateOverride</span>(<span class="hljs-built_in">getOwnerUid</span>());<br>        <span class="hljs-keyword">if</span> (presentFence-&gt;<span class="hljs-built_in">isValid</span>()) &#123;<br>            <span class="hljs-comment">//å…³é”®ç‚¹3,è®¾ç½®actualPresentFence</span><br>            mFlinger-&gt;mTimeStats-&gt;<span class="hljs-built_in">setPresentFence</span>(layerId, mCurrentFrameNumber, presentFence,<br>                                                  refreshRate, renderRate,<br>                                                  <span class="hljs-built_in">frameRateToSetFrameRateVotePayload</span>(<br>                                                          mDrawingState.frameRate),<br>                                                  <span class="hljs-built_in">getGameMode</span>());<br>            mFlinger-&gt;mFrameTracer-&gt;<span class="hljs-built_in">traceFence</span>(layerId, <span class="hljs-built_in">getCurrentBufferId</span>(), mCurrentFrameNumber,<br>                                               presentFence,<br>                                               FrameTracer::FrameEvent::PRESENT_FENCE);<br>            mFrameTracker.<span class="hljs-built_in">setActualPresentFence</span>(std::<span class="hljs-built_in">shared_ptr</span>&lt;FenceTime&gt;(presentFence));<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-type">const</span> <span class="hljs-keyword">auto</span> displayId = PhysicalDisplayId::<span class="hljs-built_in">tryCast</span>(display-&gt;<span class="hljs-built_in">getId</span>());<br>                   displayId &amp;&amp; mFlinger-&gt;<span class="hljs-built_in">getHwComposer</span>().<span class="hljs-built_in">isConnected</span>(*displayId)) &#123;<br>            <span class="hljs-comment">// The HWC doesn&#x27;t support present fences, so use the refresh</span><br>            <span class="hljs-comment">// timestamp instead.</span><br>            <span class="hljs-type">const</span> <span class="hljs-type">nsecs_t</span> actualPresentTime = display-&gt;<span class="hljs-built_in">getRefreshTimestamp</span>();<br>            mFlinger-&gt;mTimeStats-&gt;<span class="hljs-built_in">setPresentTime</span>(layerId, mCurrentFrameNumber, actualPresentTime,<br>                                                 refreshRate, renderRate,<br>                                                 <span class="hljs-built_in">frameRateToSetFrameRateVotePayload</span>(<br>                                                         mDrawingState.frameRate),<br>                                                 <span class="hljs-built_in">getGameMode</span>());<br>            mFlinger-&gt;mFrameTracer-&gt;<span class="hljs-built_in">traceTimestamp</span>(layerId, <span class="hljs-built_in">getCurrentBufferId</span>(),<br>                                                   mCurrentFrameNumber, actualPresentTime,<br>                                                   FrameTracer::FrameEvent::PRESENT_FENCE);<br>            <span class="hljs-comment">//ä¸æ”¯æŒfenceï¼Œæ‰è®¾ç½®æˆå±å¹•åˆ·æ–°å‘¨æœŸæ—¶é—´æˆ³</span><br>            mFrameTracker.<span class="hljs-built_in">setActualPresentTime</span>(actualPresentTime);<br>        &#125;<br>    &#125;<br>    mFrameTracker.<span class="hljs-built_in">advanceFrame</span>();<br>    mBufferInfo.mFrameLatencyNeeded = <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä»ä¸Šé¢ä»£ç æ¥çœ‹ï¼ŒdesiredPresentTimeå’ŒframeReadyFenceä¸mBufferInfoæœ‰å…³ï¼Œæ¥ä¸‹æ¥çœ‹ä¸€ä¸‹å®ƒæ˜¯åœ¨å“ªé‡Œèµ‹å€¼çš„ã€‚</p><p>frameworks&#x2F;native&#x2F;services&#x2F;surfaceflinger&#x2F;BufferQueueLayer.cpp</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">BufferQueueLayer::gatherBufferInfo</span><span class="hljs-params">()</span> </span>&#123;<br>    BufferLayer::<span class="hljs-built_in">gatherBufferInfo</span>();<br><br>    <span class="hljs-comment">//ä¸desiredPresentTimeæœ‰å…³</span><br>    mBufferInfo.mDesiredPresentTime = mConsumer-&gt;<span class="hljs-built_in">getTimestamp</span>();<br>    <span class="hljs-comment">//ä¸frameReadyFenceæœ‰å…³</span><br>    mBufferInfo.mFenceTime = mConsumer-&gt;<span class="hljs-built_in">getCurrentFenceTime</span>();<br>    mBufferInfo.mFence = mConsumer-&gt;<span class="hljs-built_in">getCurrentFence</span>();<br>......<br>&#125;<br></code></pre></td></tr></table></figure><p>ç»§ç»­å¾€ä¸‹è¿½è¸ªï¼Œçœ‹mConsumerçš„<a href="https://cs.android.com/android/platform/superproject/+/android-12.0.0_r32:frameworks/native/services/surfaceflinger/BufferLayerConsumer.h;drc=df83280563736a5778100a42f04bc2ca5523442e;bpv=1;bpt=1;l=287">mCurrentTimestamp</a>å’Œ<a href="https://cs.android.com/android/platform/superproject/+/android-12.0.0_r32:frameworks/native/services/surfaceflinger/BufferLayerConsumer.h;drc=df83280563736a5778100a42f04bc2ca5523442e;bpv=1;bpt=1;l=278">mCurrentFenceTime</a>æ˜¯åœ¨å“ªé‡Œèµ‹å€¼çš„ã€‚</p><p>frameworks&#x2F;native&#x2F;services&#x2F;surfaceflinger&#x2F;BufferLayerConsumer.cpp</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">//è·å–mCurrentTimestamp</span><br><span class="hljs-function"><span class="hljs-type">nsecs_t</span> <span class="hljs-title">BufferLayerConsumer::getTimestamp</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">BLC_LOGV</span>(<span class="hljs-string">&quot;getTimestamp&quot;</span>);<br>    <span class="hljs-function">Mutex::Autolock <span class="hljs-title">lock</span><span class="hljs-params">(mMutex)</span></span>;<br>    <span class="hljs-keyword">return</span> mCurrentTimestamp;<br>&#125;<br><br><span class="hljs-comment">//è·å–mCurrentFenceTime</span><br><span class="hljs-function">std::shared_ptr&lt;FenceTime&gt; <span class="hljs-title">BufferLayerConsumer::getCurrentFenceTime</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>&#123;<br>    <span class="hljs-function">Mutex::Autolock <span class="hljs-title">lock</span><span class="hljs-params">(mMutex)</span></span>;<br>    <span class="hljs-keyword">return</span> mCurrentFenceTime;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">status_t</span> <span class="hljs-title">BufferLayerConsumer::updateAndReleaseLocked</span><span class="hljs-params">(<span class="hljs-type">const</span> BufferItem&amp; item,</span></span><br><span class="hljs-params"><span class="hljs-function">                                                     PendingRelease* pendingRelease)</span> </span>&#123;<br>    <span class="hljs-type">status_t</span> err = NO_ERROR;<br><br>    <span class="hljs-type">int</span> slot = item.mSlot;<br><br>    <span class="hljs-built_in">BLC_LOGV</span>(<span class="hljs-string">&quot;updateAndRelease: (slot=%d buf=%p) -&gt; (slot=%d buf=%p)&quot;</span>, mCurrentTexture,<br>             (mCurrentTextureBuffer != <span class="hljs-literal">nullptr</span> &amp;&amp; mCurrentTextureBuffer-&gt;<span class="hljs-built_in">getBuffer</span>() != <span class="hljs-literal">nullptr</span>)<br>                     ? mCurrentTextureBuffer-&gt;<span class="hljs-built_in">getBuffer</span>()-&gt;handle<br>                     : <span class="hljs-number">0</span>,<br>             slot, mSlots[slot].mGraphicBuffer-&gt;handle);<br><br>    <span class="hljs-comment">// Hang onto the pointer so that it isn&#x27;t freed in the call to</span><br>    <span class="hljs-comment">// releaseBufferLocked() if we&#x27;re in shared buffer mode and both buffers are</span><br>    <span class="hljs-comment">// the same.</span><br><br>    std::shared_ptr&lt;renderengine::ExternalTexture&gt; nextTextureBuffer;<br>    &#123;<br>        <span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lock</span><span class="hljs-params">(mImagesMutex)</span></span>;<br>        nextTextureBuffer = mImages[slot];<br>    &#125;<br><br>    <span class="hljs-comment">// release old buffer</span><br>    <span class="hljs-keyword">if</span> (mCurrentTexture != BufferQueue::INVALID_BUFFER_SLOT) &#123;<br>        <span class="hljs-keyword">if</span> (pendingRelease == <span class="hljs-literal">nullptr</span>) &#123;<br>            <span class="hljs-type">status_t</span> status =<br>                    <span class="hljs-built_in">releaseBufferLocked</span>(mCurrentTexture, mCurrentTextureBuffer-&gt;<span class="hljs-built_in">getBuffer</span>());<br>            <span class="hljs-keyword">if</span> (status &lt; NO_ERROR) &#123;<br>                <span class="hljs-built_in">BLC_LOGE</span>(<span class="hljs-string">&quot;updateAndRelease: failed to release buffer: %s (%d)&quot;</span>, <span class="hljs-built_in">strerror</span>(-status),<br>                         status);<br>                err = status;<br>                <span class="hljs-comment">// keep going, with error raised [?]</span><br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            pendingRelease-&gt;currentTexture = mCurrentTexture;<br>            pendingRelease-&gt;graphicBuffer = mCurrentTextureBuffer-&gt;<span class="hljs-built_in">getBuffer</span>();<br>            pendingRelease-&gt;isPending = <span class="hljs-literal">true</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// Update the BufferLayerConsumer state.</span><br>    mCurrentTexture = slot;<br>    mCurrentTextureBuffer = nextTextureBuffer;<br>    mCurrentCrop = item.mCrop;<br>    mCurrentTransform = item.mTransform;<br>    mCurrentScalingMode = item.mScalingMode;<br>    <span class="hljs-comment">//mCurrentTimestampåœ¨è¿™é‡Œèµ‹å€¼</span><br>    mCurrentTimestamp = item.mTimestamp;<br>    mCurrentDataSpace = <span class="hljs-built_in">static_cast</span>&lt;ui::Dataspace&gt;(item.mDataSpace);<br>    mCurrentHdrMetadata = item.mHdrMetadata;<br>    mCurrentFence = item.mFence;<br>    <span class="hljs-comment">//mCurrentFenceTimeåœ¨è¿™é‡Œèµ‹å€¼</span><br>    mCurrentFenceTime = item.mFenceTime;<br>    mCurrentFrameNumber = item.mFrameNumber;<br>    mCurrentTransformToDisplayInverse = item.mTransformToDisplayInverse;<br>    mCurrentSurfaceDamage = item.mSurfaceDamage;<br>    mCurrentApi = item.mApi;<br><br>    <span class="hljs-built_in">computeCurrentTransformMatrixLocked</span>();<br><br>    <span class="hljs-keyword">return</span> err;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">status_t</span> <span class="hljs-title">BufferLayerConsumer::updateTexImage</span><span class="hljs-params">(BufferRejecter* rejecter, <span class="hljs-type">nsecs_t</span> expectedPresentTime,</span></span><br><span class="hljs-params"><span class="hljs-function">                                             <span class="hljs-type">bool</span>* autoRefresh, <span class="hljs-type">bool</span>* queuedBuffer,</span></span><br><span class="hljs-params"><span class="hljs-function">                                             <span class="hljs-type">uint64_t</span> maxFrameNumber)</span> </span>&#123;<br>    <span class="hljs-built_in">ATRACE_CALL</span>();<br>    <span class="hljs-built_in">BLC_LOGV</span>(<span class="hljs-string">&quot;updateTexImage&quot;</span>);<br>    <span class="hljs-function">Mutex::Autolock <span class="hljs-title">lock</span><span class="hljs-params">(mMutex)</span></span>;<br><br>    <span class="hljs-keyword">if</span> (mAbandoned) &#123;<br>        <span class="hljs-built_in">BLC_LOGE</span>(<span class="hljs-string">&quot;updateTexImage: BufferLayerConsumer is abandoned!&quot;</span>);<br>        <span class="hljs-keyword">return</span> NO_INIT;<br>    &#125;<br><br>    BufferItem item;<br><br>    <span class="hljs-comment">// Acquire the next buffer.</span><br>    <span class="hljs-comment">// In asynchronous mode the list is guaranteed to be one buffer</span><br>    <span class="hljs-comment">// deep, while in synchronous mode we use the oldest buffer.</span><br>    <span class="hljs-type">status_t</span> err = <span class="hljs-built_in">acquireBufferLocked</span>(&amp;item, expectedPresentTime, maxFrameNumber);<br>    <span class="hljs-keyword">if</span> (err != NO_ERROR) &#123;<br>        <span class="hljs-keyword">if</span> (err == BufferQueue::NO_BUFFER_AVAILABLE) &#123;<br>            err = NO_ERROR;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (err == BufferQueue::PRESENT_LATER) &#123;<br>            <span class="hljs-comment">// return the error, without logging</span><br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-built_in">BLC_LOGE</span>(<span class="hljs-string">&quot;updateTexImage: acquire failed: %s (%d)&quot;</span>, <span class="hljs-built_in">strerror</span>(-err), err);<br>        &#125;<br>        <span class="hljs-keyword">return</span> err;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (autoRefresh) &#123;<br>        *autoRefresh = item.mAutoRefresh;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (queuedBuffer) &#123;<br>        *queuedBuffer = item.mQueuedBuffer;<br>    &#125;<br><br>    <span class="hljs-comment">// We call the rejecter here, in case the caller has a reason to</span><br>    <span class="hljs-comment">// not accept this buffer.  This is used by SurfaceFlinger to</span><br>    <span class="hljs-comment">// reject buffers which have the wrong size</span><br>    <span class="hljs-type">int</span> slot = item.mSlot;<br>    <span class="hljs-keyword">if</span> (rejecter &amp;&amp; rejecter-&gt;<span class="hljs-built_in">reject</span>(mSlots[slot].mGraphicBuffer, item)) &#123;<br>        <span class="hljs-built_in">releaseBufferLocked</span>(slot, mSlots[slot].mGraphicBuffer);<br>        <span class="hljs-keyword">return</span> BUFFER_REJECTED;<br>    &#125;<br><br>    <span class="hljs-comment">// Release the previous buffer.</span><br>    <span class="hljs-comment">//è¿™é‡Œè°ƒç”¨</span><br>    err = <span class="hljs-built_in">updateAndReleaseLocked</span>(item, &amp;mPendingRelease);<br>    <span class="hljs-keyword">if</span> (err != NO_ERROR) &#123;<br>        <span class="hljs-keyword">return</span> err;<br>    &#125;<br>    <span class="hljs-keyword">return</span> err;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä»ä¸Šé¢ä»£ç æ¥çœ‹ï¼ŒmCurrentTimestampå’ŒmCurrentFenceTimeæ˜¯updateAndReleaseLockedé‡Œé¢èµ‹å€¼çš„ï¼Œè€Œå…¶åˆè¢«updateTexImageè°ƒç”¨ï¼Œè¿™ä¸ªå‡½æ•°åœ¨systraceå¯è§†åŒ–é¡µé¢å¾ˆå¸¸è§äº†ï¼Œæ¥ä¸‹æ¥åˆ†æä¸ä»–ä»¬ç›¸å…³çš„mTimestampå’ŒmFenceTimeã€‚</p><p>frameworks&#x2F;native&#x2F;libs&#x2F;gui&#x2F;include&#x2F;gui&#x2F;BufferItem.h</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c++"> <span class="hljs-comment">// mTimestamp is the current timestamp for this buffer slot. This gets</span><br>    <span class="hljs-comment">// to set by queueBuffer each time this slot is queued. This value</span><br>    <span class="hljs-comment">// is guaranteed to be monotonically increasing for each newly</span><br>    <span class="hljs-comment">// acquired buffer.</span><br><span class="hljs-comment">//ä»è¿™é‡Œçš„æ³¨é‡Šå·²ç»å¯ä»¥çŸ¥é“å®ƒæ˜¯queueBufferæ—¶çš„æ—¶é—´æˆ³</span><br>    <span class="hljs-type">int64_t</span> mTimestamp;<br><br> <span class="hljs-comment">// The std::shared_ptr&lt;FenceTime&gt; wrapper around mFence.</span><br>    std::shared_ptr&lt;FenceTime&gt; mFenceTime&#123;FenceTime::NO_FENCE&#125;;<br></code></pre></td></tr></table></figure><p>frameworks&#x2F;native&#x2F;libs&#x2F;gui&#x2F;BufferQueueProducer.cpp</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs c++"><br><span class="hljs-function"><span class="hljs-type">status_t</span> <span class="hljs-title">BufferQueueProducer::queueBuffer</span><span class="hljs-params">(<span class="hljs-type">int</span> slot,</span></span><br><span class="hljs-params"><span class="hljs-function">        <span class="hljs-type">const</span> QueueBufferInput &amp;input, QueueBufferOutput *output)</span> </span>&#123;<br>    <span class="hljs-built_in">ATRACE_CALL</span>();<br>    <span class="hljs-built_in">ATRACE_BUFFER_INDEX</span>(slot);<br><br>    <span class="hljs-type">int64_t</span> requestedPresentTimestamp;<br>    <span class="hljs-type">bool</span> isAutoTimestamp;<br>    android_dataspace dataSpace;<br>    <span class="hljs-function">Rect <span class="hljs-title">crop</span><span class="hljs-params">(Rect::EMPTY_RECT)</span></span>;<br>    <span class="hljs-type">int</span> scalingMode;<br>    <span class="hljs-type">uint32_t</span> transform;<br>    <span class="hljs-type">uint32_t</span> stickyTransform;<br>    sp&lt;Fence&gt; acquireFence;<br>    <span class="hljs-type">bool</span> getFrameTimestamps = <span class="hljs-literal">false</span>;<br>    <span class="hljs-comment">//å…³é”®ç‚¹</span><br>    input.<span class="hljs-built_in">deflate</span>(&amp;requestedPresentTimestamp, &amp;isAutoTimestamp, &amp;dataSpace,<br>            &amp;crop, &amp;scalingMode, &amp;transform, &amp;acquireFence, &amp;stickyTransform,<br>            &amp;getFrameTimestamps);<br>    <span class="hljs-type">const</span> Region&amp; surfaceDamage = input.<span class="hljs-built_in">getSurfaceDamage</span>();<br>    <span class="hljs-type">const</span> HdrMetadata&amp; hdrMetadata = input.<span class="hljs-built_in">getHdrMetadata</span>();<br><br>    <span class="hljs-keyword">if</span> (acquireFence == <span class="hljs-literal">nullptr</span>) &#123;<br>        <span class="hljs-built_in">BQ_LOGE</span>(<span class="hljs-string">&quot;queueBuffer: fence is NULL&quot;</span>);<br>        <span class="hljs-keyword">return</span> BAD_VALUE;<br>    &#125;<br>    <span class="hljs-comment">//å…³é”®ç‚¹</span><br>    <span class="hljs-keyword">auto</span> acquireFenceTime = std::<span class="hljs-built_in">make_shared</span>&lt;FenceTime&gt;(acquireFence);<br><br>    ......<br><br>    sp&lt;IConsumerListener&gt; frameAvailableListener;<br>    sp&lt;IConsumerListener&gt; frameReplacedListener;<br>    <span class="hljs-type">int</span> callbackTicket = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">uint64_t</span> currentFrameNumber = <span class="hljs-number">0</span>;<br>    BufferItem item;<br>    &#123; <span class="hljs-comment">// Autolock scope</span><br>        ......<br>        <span class="hljs-comment">//è¿™é‡Œèµ‹å€¼</span><br>        item.mTimestamp = requestedPresentTimestamp;<br>        item.mIsAutoTimestamp = isAutoTimestamp;<br>        item.mDataSpace = dataSpace;<br>        item.mHdrMetadata = hdrMetadata;<br>        item.mFrameNumber = currentFrameNumber;<br>        item.mSlot = slot;<br>        item.mFence = acquireFence;<br>         <span class="hljs-comment">//è¿™é‡Œèµ‹å€¼</span><br>        item.mFenceTime = acquireFenceTime;<br>        ......<br><br>        <span class="hljs-built_in">ATRACE_INT</span>(mCore-&gt;mConsumerName.<span class="hljs-built_in">string</span>(),<br>                <span class="hljs-built_in">static_cast</span>&lt;<span class="hljs-type">int32_t</span>&gt;(mCore-&gt;mQueue.<span class="hljs-built_in">size</span>()));<br><span class="hljs-meta">#<span class="hljs-keyword">ifndef</span> NO_BINDER</span><br>        mCore-&gt;mOccupancyTracker.<span class="hljs-built_in">registerOccupancyChange</span>(mCore-&gt;mQueue.<span class="hljs-built_in">size</span>());<br><span class="hljs-meta">#<span class="hljs-keyword">endif</span></span><br>        <span class="hljs-comment">// Take a ticket for the callback functions</span><br>        callbackTicket = mNextCallbackTicket++;<br><br>        <span class="hljs-built_in">VALIDATE_CONSISTENCY</span>();<br>    &#125; <span class="hljs-comment">// Autolock scope</span><br>    ......<br>    <span class="hljs-keyword">return</span> NO_ERROR;<br>&#125;<br></code></pre></td></tr></table></figure><p>frameworks&#x2F;native&#x2F;libs&#x2F;gui&#x2F;include&#x2F;gui&#x2F;IGraphicBufferProducer.h</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// timestamp - a monotonically increasing value in nanoseconds</span><br>        <span class="hljs-comment">// isAutoTimestamp - if the timestamp was synthesized at queue time</span><br>        <span class="hljs-comment">// dataSpace - description of the contents, interpretation depends on format</span><br>        <span class="hljs-comment">// crop - a crop rectangle that&#x27;s used as a hint to the consumer</span><br>        <span class="hljs-comment">// scalingMode - a set of flags from NATIVE_WINDOW_SCALING_* in &lt;window.h&gt;</span><br>        <span class="hljs-comment">// transform - a set of flags from NATIVE_WINDOW_TRANSFORM_* in &lt;window.h&gt;</span><br><br>        <span class="hljs-comment">// acquireFenceTimeç›¸å…³</span><br>        <span class="hljs-comment">// fence - a fence that the consumer must wait on before reading the buffer,</span><br>        <span class="hljs-comment">//         set this to Fence::NO_FENCE if the buffer is ready immediately</span><br><br>        <span class="hljs-comment">// sticky - the sticky transform set in Surface (only used by the LEGACY</span><br>        <span class="hljs-comment">//          camera mode).</span><br>        <span class="hljs-comment">// getFrameTimestamps - whether or not the latest frame timestamps</span><br>        <span class="hljs-comment">//                      should be retrieved from the consumer.</span><br>        <span class="hljs-comment">// slot - the slot index to queue. This is used only by queueBuffers().</span><br>        <span class="hljs-comment">//        queueBuffer() ignores this value and uses the argument `slot`</span><br>        <span class="hljs-comment">//        instead.</span><br>        <span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-title">QueueBufferInput</span><span class="hljs-params">(<span class="hljs-type">int64_t</span> _timestamp, <span class="hljs-type">bool</span> _isAutoTimestamp,</span></span><br><span class="hljs-params"><span class="hljs-function">                android_dataspace _dataSpace, <span class="hljs-type">const</span> Rect&amp; _crop,</span></span><br><span class="hljs-params"><span class="hljs-function">                <span class="hljs-type">int</span> _scalingMode, <span class="hljs-type">uint32_t</span> _transform, <span class="hljs-type">const</span> sp&lt;Fence&gt;&amp; _fence,</span></span><br><span class="hljs-params"><span class="hljs-function">                <span class="hljs-type">uint32_t</span> _sticky = <span class="hljs-number">0</span>, <span class="hljs-type">bool</span> _getFrameTimestamps = <span class="hljs-literal">false</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">                <span class="hljs-type">int</span> _slot = <span class="hljs-number">-1</span>)</span></span><br><span class="hljs-function">                : timestamp(_timestamp), isAutoTimestamp(_isAutoTimestamp),</span><br><span class="hljs-function">                  dataSpace(_dataSpace), crop(_crop), scalingMode(_scalingMode),</span><br><span class="hljs-function">                  transform(_transform), stickyTransform(_sticky),</span><br><span class="hljs-function">                  fence(_fence), surfaceDamage(),</span><br><span class="hljs-function">                  getFrameTimestamps(_getFrameTimestamps), slot(_slot) &#123;</span> &#125;<br><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">deflate</span><span class="hljs-params">(<span class="hljs-type">int64_t</span>* outTimestamp, <span class="hljs-type">bool</span>* outIsAutoTimestamp,</span></span><br><span class="hljs-params"><span class="hljs-function">                android_dataspace* outDataSpace,</span></span><br><span class="hljs-params"><span class="hljs-function">                Rect* outCrop, <span class="hljs-type">int</span>* outScalingMode,</span></span><br><span class="hljs-params"><span class="hljs-function">                <span class="hljs-type">uint32_t</span>* outTransform, sp&lt;Fence&gt;* outFence,</span></span><br><span class="hljs-params"><span class="hljs-function">                <span class="hljs-type">uint32_t</span>* outStickyTransform = <span class="hljs-literal">nullptr</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">                <span class="hljs-type">bool</span>* outGetFrameTimestamps = <span class="hljs-literal">nullptr</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">                <span class="hljs-type">int</span>* outSlot = <span class="hljs-literal">nullptr</span>)</span> <span class="hljs-type">const</span> </span>&#123;<br>            <span class="hljs-comment">//mTimestampç›¸å…³</span><br>            *outTimestamp = timestamp;<br>            *outIsAutoTimestamp = <span class="hljs-built_in">bool</span>(isAutoTimestamp);<br>            *outDataSpace = dataSpace;<br>            *outCrop = crop;<br>            *outScalingMode = scalingMode;<br>            *outTransform = transform;<br>            <span class="hljs-comment">//acquireFenceTimeç›¸å…³</span><br>            *outFence = fence;<br>            <span class="hljs-keyword">if</span> (outStickyTransform != <span class="hljs-literal">nullptr</span>) &#123;<br>                *outStickyTransform = stickyTransform;<br>            &#125;<br>            <span class="hljs-keyword">if</span> (outGetFrameTimestamps) &#123;<br>                *outGetFrameTimestamps = getFrameTimestamps;<br>            &#125;<br>            <span class="hljs-keyword">if</span> (outSlot) &#123;<br>                *outSlot = slot;<br>            &#125;<br>        &#125;<br></code></pre></td></tr></table></figure><p>frameworks&#x2F;native&#x2F;libs&#x2F;gui&#x2F;Surface.cpp</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Surface::getQueueBufferInputLocked</span><span class="hljs-params">(<span class="hljs-type">android_native_buffer_t</span>* buffer, <span class="hljs-type">int</span> fenceFd,</span></span><br><span class="hljs-params"><span class="hljs-function">        <span class="hljs-type">nsecs_t</span> timestamp, IGraphicBufferProducer::QueueBufferInput* out)</span> </span>&#123;<br>    <span class="hljs-type">bool</span> isAutoTimestamp = <span class="hljs-literal">false</span>;<br>     <span class="hljs-comment">//desiredPresentTimeçš„çœŸæ­£æ¥æº</span><br>    <span class="hljs-keyword">if</span> (timestamp == NATIVE_WINDOW_TIMESTAMP_AUTO) &#123;<br>        timestamp = <span class="hljs-built_in">systemTime</span>(SYSTEM_TIME_MONOTONIC);<br>        isAutoTimestamp = <span class="hljs-literal">true</span>;<br>        <span class="hljs-built_in">ALOGV</span>(<span class="hljs-string">&quot;Surface::queueBuffer making up timestamp: %.2f ms&quot;</span>,<br>            timestamp / <span class="hljs-number">1000000.0</span>);<br>    &#125;<br><br>    <span class="hljs-comment">// Make sure the crop rectangle is entirely inside the buffer.</span><br>    <span class="hljs-function">Rect <span class="hljs-title">crop</span><span class="hljs-params">(Rect::EMPTY_RECT)</span></span>;<br>    mCrop.<span class="hljs-built_in">intersect</span>(<span class="hljs-built_in">Rect</span>(buffer-&gt;width, buffer-&gt;height), &amp;crop);<br>    <span class="hljs-comment">//frameReadyFenceçœŸæ­£æ¥æº</span><br>    <span class="hljs-function">sp&lt;Fence&gt; <span class="hljs-title">fence</span><span class="hljs-params">(fenceFd &gt;= <span class="hljs-number">0</span> ? <span class="hljs-keyword">new</span> Fence(fenceFd) : Fence::NO_FENCE)</span></span>;<br>    <span class="hljs-comment">//å®ä¾‹åŒ–QueueBufferInputï¼Œå¹¶ä¼ é€’timestampå’Œfence</span><br>    <span class="hljs-function">IGraphicBufferProducer::QueueBufferInput <span class="hljs-title">input</span><span class="hljs-params">(timestamp, isAutoTimestamp,</span></span><br><span class="hljs-params"><span class="hljs-function">            <span class="hljs-keyword">static_cast</span>&lt;android_dataspace&gt;(mDataSpace), crop, mScalingMode,</span></span><br><span class="hljs-params"><span class="hljs-function">            mTransform ^ mStickyTransform, fence, mStickyTransform,</span></span><br><span class="hljs-params"><span class="hljs-function">            mEnableFrameTimestamps)</span></span>;<br><br>    <span class="hljs-comment">// we should send HDR metadata as needed if this becomes a bottleneck</span><br>    input.<span class="hljs-built_in">setHdrMetadata</span>(mHdrMetadata);<br><br>    ......<br>&#125;<br><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">Surface::queueBuffer</span><span class="hljs-params">(<span class="hljs-type">android_native_buffer_t</span>* buffer, <span class="hljs-type">int</span> fenceFd)</span> </span>&#123;<br>    <span class="hljs-built_in">ATRACE_CALL</span>();<br>    <span class="hljs-built_in">ALOGV</span>(<span class="hljs-string">&quot;Surface::queueBuffer&quot;</span>);<br>    ......<br><br>    IGraphicBufferProducer::QueueBufferOutput output;<br>    IGraphicBufferProducer::QueueBufferInput input;<br>    <span class="hljs-comment">//è°ƒç”¨</span><br>    <span class="hljs-built_in">getQueueBufferInputLocked</span>(buffer, fenceFd, mTimestamp, &amp;input);<br>    sp&lt;Fence&gt; fence = input.fence;<br><br>    <span class="hljs-type">nsecs_t</span> now = <span class="hljs-built_in">systemTime</span>();<br>    <span class="hljs-comment">//è°ƒç”¨</span><br>    <span class="hljs-type">status_t</span> err = mGraphicBufferProducer-&gt;<span class="hljs-built_in">queueBuffer</span>(i, input, &amp;output);<br>    mLastQueueDuration = <span class="hljs-built_in">systemTime</span>() - now;<br>    <span class="hljs-keyword">if</span> (err != OK)  &#123;<br>        <span class="hljs-built_in">ALOGE</span>(<span class="hljs-string">&quot;queueBuffer: error queuing buffer, %d&quot;</span>, err);<br>    &#125;<br><br>    <span class="hljs-built_in">onBufferQueuedLocked</span>(i, fence, output);<br>    <span class="hljs-keyword">return</span> err;<br>&#125;<br></code></pre></td></tr></table></figure><p>getQueueBufferInputLockedæœ€ç»ˆè¢« <a href="https://cs.android.com/android/platform/superproject/+/android-12.0.0_r32:frameworks/native/libs/gui/include/gui/Surface.h;drc=3816c49c18dcf85b5939fe1a19df9e90df7f7f77;bpv=1;bpt=1;l=68">Surface</a>::<a href="https://cs.android.com/android/platform/superproject/+/android-12.0.0_r32:frameworks/native/libs/gui/Surface.cpp;drc=3816c49c18dcf85b5939fe1a19df9e90df7f7f77;bpv=1;bpt=1;l=1147?gsn=queueBuffer&gs=kythe://android.googlesource.com/platform/superproject?lang=c++?path=frameworks/native/libs/gui/include/gui/Surface.h%238ix9Mzse72s8AmkfJJL8ZC5PpQSlym212XP1ntX0qEA&gs=kythe://android.googlesource.com/platform/superproject?lang=c++?path=frameworks/native/libs/gui/Surface.cpp%236jMutzq7HDv_qx9HGBbz2a0yzcDbFeo_I0RFUPJcBuQ">queueBuffer</a>è°ƒç”¨ã€‚</p><p>è‡³æ­¤ï¼Œå·²ç»åˆ†æå®Œ desiredPresentTime å’Œ frameReadyTime çš„æœ€ç»ˆæ¥æºäº†ï¼Œå³ï¼š</p><ul><li>desiredPresentTimeï¼šqueueBuffer çš„æ—¶é—´æˆ³</li><li>frameReadyTimeï¼šacquire fence signal çš„æ—¶é—´æˆ³</li></ul><h2 id="actualPresentTimeæŒ‡ä»£çš„æ˜¯ä»€ä¹ˆ"><a href="#actualPresentTimeæŒ‡ä»£çš„æ˜¯ä»€ä¹ˆ" class="headerlink" title="actualPresentTimeæŒ‡ä»£çš„æ˜¯ä»€ä¹ˆ"></a>actualPresentTimeæŒ‡ä»£çš„æ˜¯ä»€ä¹ˆ</h2><p>æˆ‘å°±ä¸åˆ†æè¿™ä¸ªäº†ï¼Œæµç¨‹éƒ½æ˜¯å·®ä¸å¤šçš„ï¼Œè¯¦æƒ…å‚è€ƒï¼š</p><p><a href="https://juejin.cn/post/6844904182898524168">æˆ–è®¸æ˜¯è¿„ä»Šä¸ºæ­¢ç¬¬ä¸€ç¯‡è®²è§£ fps è®¡ç®—åŸç†çš„æ–‡ç« å§ - æ˜é‡‘</a></p><p>å…¶ä½œè€…æåˆ°ï¼Œè®¡ç®—ä¸€ä¸ª App çš„ fps çš„åŸç†å°±æ˜¯ï¼š</p><p>ç»Ÿè®¡åœ¨ä¸€ç§’å†…è¯¥ App å¾€å±å¹•åˆ·äº†å¤šå°‘å¸§ï¼Œè€Œåœ¨ Android çš„ä¸–ç•Œé‡Œï¼Œæ¯ä¸€å¸§æ˜¾ç¤ºåˆ°å±å¹•çš„æ ‡å¿—æ˜¯ï¼špresent fence signal äº†ï¼Œå› æ­¤è®¡ç®— App çš„ fps å°±å¯ä»¥è½¬æ¢ä¸ºï¼š<strong>ä¸€ç§’å†… App çš„ Layer æœ‰å¤šå°‘ä¸ªæœ‰æ•ˆ present fence signal äº†ï¼ˆè¿™é‡Œæœ‰æ•ˆ present fence æ˜¯æŒ‡ï¼Œåœ¨æœ¬æ¬¡ VSYNC ä¸­è¯¥ Layer æœ‰æ›´æ–°çš„ present fenceï¼‰</strong></p><h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h2><p><a href="https://zhuanlan.zhihu.com/p/435304317">å®‰å“å¸§ç‡è®¡ç®—æ–¹æ¡ˆå’ŒèƒŒååŸç†å‰–æ</a></p><p><a href="https://juejin.cn/post/6844904182898524168">æˆ–è®¸æ˜¯è¿„ä»Šä¸ºæ­¢ç¬¬ä¸€ç¯‡è®²è§£ fps è®¡ç®—åŸç†çš„æ–‡ç« å§ - æ˜é‡‘</a></p>]]></content>
    
    
    <categories>
      
      <category>Android Display System</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>å®‰å“æ˜¾ç¤ºç³»ç»Ÿ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®‰å“TVæˆ–è€…ç›’å­é‡å¯ååº”ç”¨ä½¿ç”¨æ—¶é—´ä¸¢å¤±çš„é—®é¢˜</title>
    <link href="/article/5e685b29/"/>
    <url>/article/5e685b29/</url>
    
    <content type="html"><![CDATA[<h1 id="å®‰å“TVæˆ–è€…ç›’å­é‡å¯ååº”ç”¨ä½¿ç”¨æ—¶é—´ä¸¢å¤±çš„é—®é¢˜"><a href="#å®‰å“TVæˆ–è€…ç›’å­é‡å¯ååº”ç”¨ä½¿ç”¨æ—¶é—´ä¸¢å¤±çš„é—®é¢˜" class="headerlink" title="å®‰å“TVæˆ–è€…ç›’å­é‡å¯ååº”ç”¨ä½¿ç”¨æ—¶é—´ä¸¢å¤±çš„é—®é¢˜"></a>å®‰å“TVæˆ–è€…ç›’å­é‡å¯ååº”ç”¨ä½¿ç”¨æ—¶é—´ä¸¢å¤±çš„é—®é¢˜</h1><h2 id="Loss-of-app-usage-time-after-android-TV-or-box-reboots"><a href="#Loss-of-app-usage-time-after-android-TV-or-box-reboots" class="headerlink" title="Loss of app usage time after android TV or box reboots"></a>Loss of app usage time after android TV or box reboots</h2><p>åœ¨æœç´¢å¼•æ“æˆ‘åªæ‰¾åˆ°äº†ä¸€ç¯‡ä¸è¿™ä¸ªé—®é¢˜ç›¸å…³çš„é“¾æ¥ï¼Œå¤§å®¶å¯ä»¥çœ‹ä¸€ä¸‹ï¼Œä»–çš„è§£å†³åŠæ³•æ˜¯APPè‡ªå·±ä¿å­˜ä½¿ç”¨æ•°æ®ã€‚</p><p><a href="https://stackoverflow.com/questions/53992982/androidtv-usagestatsmanager-not-returning-details-for-apps-results-after-reboot">android - AndroidTV: UsageStatsManager not returning details for apps results after Reboot - Stack Overflow</a></p><blockquote><p>As we had experienced that after a device power cycle , Android Tv box wonâ€™t return the usage stats of installed application. Here is a workaround I followed .</p><ul><li>We fetch the details of installed application then store only last used time in a Hash map.</li><li>And we used a custom comparator to compare via last time used and sort our Installed application details list (ResolveInfo) , for recently used app list.</li><li>Now to overcome the situation of device power cycle scenario, We are maintaining a Hash map locally in app . Where we will store the installed Appâ€™s Last used time as Long millis (epoch) . lastTimeUsedMap &#x3D; new HashMap(); And we update the map every time we get a new data from UsageStatsManager.</li><li>We simplify the map object and store as string in shared preference.</li><li>And after reboot first we will find in usage stats if installed package is having a time stamp or not . If not we will get the time from stored MAP .</li></ul></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">SortByRecentlyUsed</span><span class="hljs-params">(<span class="hljs-keyword">final</span> List&lt;ResolveInfo&gt; info, <span class="hljs-keyword">final</span> Context context)</span>&#123;<br><br>    <span class="hljs-comment">/*load LastTimeUsedMap from pref*/</span><br>    lastTimeUsedMap = loadLastTimeUsedMap(context);<br><br>    <span class="hljs-type">UsageStatsManager</span> <span class="hljs-variable">usm</span> <span class="hljs-operator">=</span> getUsageStatsManager(context);<br>    <span class="hljs-type">Calendar</span> <span class="hljs-variable">calendar</span> <span class="hljs-operator">=</span> Calendar.getInstance();<br>    <span class="hljs-type">long</span> <span class="hljs-variable">endTime</span> <span class="hljs-operator">=</span> calendar.getTimeInMillis();<br>    calendar.add(Calendar.MONTH, -<span class="hljs-number">1</span>);<br>    <span class="hljs-type">long</span> <span class="hljs-variable">startTime</span> <span class="hljs-operator">=</span> calendar.getTimeInMillis();<br><br>    <span class="hljs-keyword">final</span> List&lt;UsageStats&gt; usageStatsList = usm.queryUsageStats(UsageStatsManager.INTERVAL_BEST, startTime, endTime);<br><br>    <span class="hljs-comment">/*Update AppRecentTimeUsedMap with latest data from UsageStatsManager*/</span><br>    updateAppRecentTimeUsedMap(usageStatsList,info);<br><br>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">RecentUseComparator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Comparator</span>&lt;ResolveInfo&gt; &#123;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compare</span><span class="hljs-params">(ResolveInfo lhs, ResolveInfo rhs)</span> &#123;<br>            String lhsPackageName=lhs.activityInfo.applicationInfo.packageName;<br>            String rhsPackageName=rhs.activityInfo.applicationInfo.packageName;<br>            <span class="hljs-type">long</span> <span class="hljs-variable">lhsUsedTime</span> <span class="hljs-operator">=</span> getLastUsedTime(lhsPackageName);<br>            <span class="hljs-type">long</span> <span class="hljs-variable">rhsUsedTime</span> <span class="hljs-operator">=</span> getLastUsedTime(rhsPackageName);<br>            <span class="hljs-keyword">return</span> (lhsUsedTime &gt; rhsUsedTime) ? -<span class="hljs-number">1</span> : (lhsUsedTime == rhsUsedTime) ? <span class="hljs-number">0</span> : <span class="hljs-number">1</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">private</span> <span class="hljs-type">long</span> <span class="hljs-title function_">getLastUsedTime</span><span class="hljs-params">(String packageDetails)</span> &#123;<br>            <span class="hljs-type">long</span> <span class="hljs-variable">appRecentUsedtime</span> <span class="hljs-operator">=</span> -<span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">if</span> (appRecentTimeUsedMap.containsKey(packageDetails)) &#123;<br>                appRecentUsedtime = appRecentTimeUsedMap.get(packageDetails);<br>                &#125;<br>            <span class="hljs-keyword">return</span> appRecentUsedtime;<br>        &#125;<br>    &#125;<br>    <span class="hljs-type">RecentUseComparator</span> <span class="hljs-variable">mRecentComp</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RecentUseComparator</span>();<br>    Collections.sort(info, mRecentComp);<br>    <span class="hljs-comment">/*Save the updated  LastTimeUsedMap in pref*/</span><br>    saveLastTimeUsedMap(lastTimeUsedMap, context);<br><br>&#125;<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateAppRecentTimeUsedMap</span><span class="hljs-params">(List&lt;UsageStats&gt; usageStatsList,List&lt;ResolveInfo&gt; info)</span>&#123;<br><br>    String packageName=<span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">if</span> (usageStatsList != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">for</span> (ResolveInfo Rinfo : info) &#123;<br>            packageName = Rinfo.activityInfo.applicationInfo.packageName;<br>            <span class="hljs-type">boolean</span> <span class="hljs-variable">added</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br>            <span class="hljs-keyword">for</span> (UsageStats usageStats : usageStatsList) &#123;<br>                <span class="hljs-keyword">if</span> (packageName.equalsIgnoreCase(usageStats.getPackageName())) &#123;<br>                    appRecentTimeUsedMap.put(usageStats.getPackageName(), usageStats.getLastTimeUsed());<br>                    updateLastTimeUsedMap(usageStats.getPackageName(), usageStats.getLastTimeUsed());<br>                    added=<span class="hljs-literal">true</span>;<br>                &#125;<br>            &#125;<br>            <span class="hljs-keyword">if</span> (!added &amp;&amp; lastTimeUsedMap.containsKey(packageName)) &#123;<br>                appRecentTimeUsedMap.put(packageName, lastTimeUsedMap.get(packageName));<br>            &#125;<br>        &#125;<br><br>    &#125;<br><br>&#125;<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateLastTimeUsedMap</span><span class="hljs-params">(String packageName,Long timeStamp)</span>&#123;<br>    lastTimeUsedMap.put(packageName, timeStamp);<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Return Map containing Package name and recent used time from preference</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> context</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> Map&lt;String,Long&gt;</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">private</span> Map&lt;String,Long&gt; <span class="hljs-title function_">loadLastTimeUsedMap</span><span class="hljs-params">(Context context)</span>&#123;<br>    Map&lt;String,Long&gt; outputMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;String,Long&gt;();<br>    <span class="hljs-type">SharedPreferences</span> <span class="hljs-variable">pSharedPref</span> <span class="hljs-operator">=</span> context.getSharedPreferences(LAST_TIME_USED_PREFS, Context.MODE_PRIVATE);<br>    <span class="hljs-keyword">try</span>&#123;<br>        <span class="hljs-keyword">if</span> (pSharedPref != <span class="hljs-literal">null</span>)&#123;<br>            <span class="hljs-type">String</span> <span class="hljs-variable">jsonString</span> <span class="hljs-operator">=</span> pSharedPref.getString(LAST_TIME_USED_MAP, (<span class="hljs-keyword">new</span> <span class="hljs-title class_">JSONObject</span>()).toString());<br>            <span class="hljs-type">JSONObject</span> <span class="hljs-variable">jsonObject</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JSONObject</span>(jsonString);<br>            Iterator&lt;String&gt; keysItr = jsonObject.keys();<br>            <span class="hljs-keyword">while</span>(keysItr.hasNext()) &#123;<br>                <span class="hljs-type">String</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> keysItr.next();<br>                <span class="hljs-type">Long</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> jsonObject.getLong(key);<br>                outputMap.put(key, value);<br>            &#125;<br>        &#125;<br>    &#125;<span class="hljs-keyword">catch</span>(Exception e)&#123;<br>        e.printStackTrace();<br>    &#125;<br>    <span class="hljs-keyword">return</span> outputMap;<br>&#125;<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Save the updated map containing Package name and recent used time in preference</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> inputMap</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> context</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">saveLastTimeUsedMap</span><span class="hljs-params">(Map&lt;String,Long&gt; inputMap, Context context)</span>&#123;<br>    <span class="hljs-keyword">final</span> <span class="hljs-type">SharedPreferences</span> <span class="hljs-variable">sharedPreferences</span> <span class="hljs-operator">=</span> context.getSharedPreferences(LAST_TIME_USED_PREFS,Context.MODE_PRIVATE);<br>    <span class="hljs-keyword">if</span> (sharedPreferences != <span class="hljs-literal">null</span>)&#123;<br>        <span class="hljs-type">JSONObject</span> <span class="hljs-variable">jsonObject</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JSONObject</span>(inputMap);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">jsonString</span> <span class="hljs-operator">=</span> jsonObject.toString();<br>        <span class="hljs-keyword">final</span> SharedPreferences.<span class="hljs-type">Editor</span> <span class="hljs-variable">editor</span> <span class="hljs-operator">=</span> sharedPreferences.edit();<br>        editor.remove(LAST_TIME_USED_MAP).commit();<br>        editor.putString(LAST_TIME_USED_MAP, jsonString);<br>        editor.commit();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å…·ä½“çš„ä»£ç æˆ‘æ²¡æ€ä¹ˆçœ‹ï¼Œä»–åº”è¯¥æ˜¯æ²¡åšæ—¶é—´è·³å˜çš„å¤„ç†ã€‚</p><h2 id="åŸå› åˆ†æ"><a href="#åŸå› åˆ†æ" class="headerlink" title="åŸå› åˆ†æ"></a>åŸå› åˆ†æ</h2><p>å…¶å®æ˜¯å› ä¸ºç»å¤§å¤šæ•°ç”µè§†æœºå’Œç›’å­éƒ½æ²¡æœ‰åšRTCç”µè·¯æ¥ä¿å­˜æ—¶é—´ï¼Œå¯¼è‡´æ–­ç”µæˆ–è€…é‡å¯åä½¿æœºå™¨æ¢å¤åˆ°å‡ºå‚è®¾ç½®çš„æ—¶é—´ã€‚ è¿™æ ·çš„åæœå°±æ˜¯ï¼šUsageStatsServiceåˆå§‹åŒ–çš„æ—¶å€™ä¼šåˆ é™¤æ‰æœªæ¥çš„æ•°æ®ï¼Œå¯¼è‡´åº”ç”¨ä½¿ç”¨æ—¶é—´ä¸¢å¤±ï¼Œè¯¦æƒ…è§å¦‚ä¸‹ä»£ç æ³¨é‡Šã€‚</p><p><a href="https://cs.android.com/android/platform/superproject/+/master:frameworks/base/services/usage/java/com/android/server/usage/UsageStatsDatabase.java">https://cs.android.com/android/platform/superproject/+/master:frameworks/base/services/usage/java/com/android/server/usage/UsageStatsDatabase.java</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">(<span class="hljs-type">long</span> currentTimeMillis)</span> &#123;<br>        <span class="hljs-keyword">synchronized</span> (mLock) &#123;<br>            <span class="hljs-keyword">for</span> (File f : mIntervalDirs) &#123;<br>                f.mkdirs();<br>                <span class="hljs-keyword">if</span> (!f.exists()) &#123;<br>                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalStateException</span>(<span class="hljs-string">&quot;Failed to create directory &quot;</span><br>                            + f.getAbsolutePath());<br>                &#125;<br>            &#125;<br><br>            checkVersionAndBuildLocked();<br>            indexFilesLocked();<br><br>            <span class="hljs-comment">//è¿™é‡Œä¼šåˆ é™¤æ‰æœªæ¥æ•°æ®</span><br>            <span class="hljs-comment">//æ¯”å¦‚æˆ‘ä½¿ç”¨æœºå™¨çš„æ—¶å€™æ˜¯2022å¹´1æœˆ1å·ï¼Œæ­¤æ—¶è®°å½•çš„æ˜¯è¿™å¤©çš„æ—¶é—´ï¼Œä½†æ˜¯é‡å¯åæ—¶é—´ä¸¢å¤±äº†ï¼Œå˜æˆäº†å‡ºå‚è®¾ç½®æ—¶é—´ï¼Œä¾‹å¦‚2018å¹´1æœˆ1å·ï¼Œè¿™å°±é€ æˆäº†æ•°æ®çš„æœªæ¥æ—¶</span><br>            <span class="hljs-comment">// Delete files that are in the future.</span><br>            <span class="hljs-keyword">for</span> (TimeSparseArray&lt;AtomicFile&gt; files : mSortedStatFiles) &#123;<br>                <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">startIndex</span> <span class="hljs-operator">=</span> files.closestIndexOnOrAfter(currentTimeMillis);<br>                <span class="hljs-keyword">if</span> (startIndex &lt; <span class="hljs-number">0</span>) &#123;<br>                    <span class="hljs-keyword">continue</span>;<br>                &#125;<br><br>                <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">fileCount</span> <span class="hljs-operator">=</span> files.size();<br>                <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> startIndex; i &lt; fileCount; i++) &#123;<br>                    files.valueAt(i).delete();<br>                &#125;<br><br>                <span class="hljs-comment">// Remove in a separate loop because any accesses (valueAt)</span><br>                <span class="hljs-comment">// will cause a gc in the SparseArray and mess up the order.</span><br>                <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> startIndex; i &lt; fileCount; i++) &#123;<br>                    files.removeAt(i);<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br><br></code></pre></td></tr></table></figure><h2 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h2><p>çŸ¥é“äº†åŸå› ï¼Œé‚£ä¹ˆè§£å†³æ–¹æ¡ˆå°±ç®€å•äº†ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨å†™å…¥æ•°æ®çš„æ—¶å€™è®°å½•ä¸‹æ—¶é—´æˆ³ï¼Œç„¶åå¼€æœºçš„æ—¶å€™ï¼Œè®¾ç½®å›å»ï¼Œå°±å¯ä»¥é¿å…æ•°æ®çš„æœªæ¥æ—¶ã€‚</p><p><a href="https://cs.android.com/android/platform/superproject/+/master:frameworks/base/services/usage/java/com/android/server/usage/UsageStatsService.java;l=1091;bpv=0;bpt=1">UsageStatsService.java - Android Code Search</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">void</span> <span class="hljs-title function_">flushToDisk</span><span class="hljs-params">()</span> &#123;<br>       <span class="hljs-keyword">synchronized</span> (mLock) &#123;<br>           <span class="hljs-comment">// Before flush to disk, report FLUSH_TO_DISK event to signal UsageStats to update app</span><br>           <span class="hljs-comment">// usage. In case of abrupt power shutdown like battery drain or cold temperature,</span><br>           <span class="hljs-comment">// all UsageStats has correct data up to last flush to disk.</span><br>           <span class="hljs-comment">// The FLUSH_TO_DISK event is an internal event, it will not show up in IntervalStats&#x27;</span><br>           <span class="hljs-comment">// EventList.</span><br>           <span class="hljs-type">Event</span> <span class="hljs-variable">event</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Event</span>(FLUSH_TO_DISK, SystemClock.elapsedRealtime());<br>           event.mPackage = DEVICE_EVENT_PACKAGE_NAME;<br>           reportEventToAllUserId(event);<br>           flushToDiskLocked();<br>       &#125;<br>       mAppStandby.flushToDisk();<br>      <span class="hljs-comment">//æ³¨æ„æœ‰äº›æœºå™¨çš„dateå‘½ä»¤è®¾ç½®è¿™ä¸ªæ—¶é—´ä¼šå‡å°‘8å°æ—¶ï¼Œæ‰€ä»¥æ ¹æ®å®é™…æƒ…å†µæ‰‹åŠ¨è°ƒæ•´ä¸€ä¸‹ï¼šSystemProperties.set(&quot;persist.sys.reboot.time&quot;,  String.valueOf(System.currentTimeMillis() / 1000 + 8 * 60 * 60 + 60));</span><br>       SystemProperties.set(<span class="hljs-string">&quot;persist.sys.reboot.time&quot;</span>, String.valueOf(System.currentTimeMillis() / <span class="hljs-number">1000</span>));<br>   &#125;<br></code></pre></td></tr></table></figure><p>æ—¶é—´æˆ³ä¿å­˜äº†ï¼Œé‚£ä¹ˆä»€ä¹ˆæ—¶å€™è®¾ç½®å›å»å‘¢ï¼Œå› ä¸ºUsageStatsServiceçš„åˆå§‹åŒ–æ—¶é—´æ¯”è¾ƒæ—©ï¼Œæˆ‘ä»¬ä¸èƒ½åœ¨frameworkè¿›è¡Œè®¾ç½®ï¼Œéœ€è¦åœ¨initè¿›ç¨‹è¿›è¡Œè®¾ç½®</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">!/system/bin/sh</span><br>time=$(getprop persist.sys.reboot.time)<br>current_time=$(date +%s)<br>if [ -n &quot;$time&quot; ] &amp;&amp; [ &quot;$time&quot; -gt &quot;$current_time&quot; ]; then<br>date @$time set<br>hwclock -w<br>fi<br></code></pre></td></tr></table></figure><p>init.rc</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">service set_time /vendor/bin/set_time.sh<br>    <span class="hljs-keyword">class</span> <span class="hljs-symbol">main</span><br>    <span class="hljs-symbol">user</span> <span class="hljs-symbol">root</span><br>    <span class="hljs-symbol">group</span> <span class="hljs-symbol">root</span><br>    <span class="hljs-symbol">oneshot</span><br></code></pre></td></tr></table></figure><p>æ­¤å¤–è¿˜éœ€è¦è¿›è¡Œselinuxçš„é…ç½®ï¼Œè¿™é‡Œä¸å†åˆ—å‡ºã€‚</p><p>æœ€åï¼Œæœ‰äº›å‚å•†å¯èƒ½æ›´æ”¹äº†å®‰å“æŒ‰é”®çš„å¤„ç†é€»è¾‘ï¼Œå¯¼è‡´æŒ‰ç”µæºé”®æ‰§è¡Œä¸åˆ°flushToDiskLocked()æ–¹æ³•ï¼Œå¯¼è‡´æ•°æ®æ²¡æœ‰ä¿å­˜ï¼Œè¿™ä¹Ÿéœ€è¦æ³¨æ„ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>[æ ‡ç­¾: UsageStatsä½¿ç”¨çŠ¶æ€ç®¡ç† | Coolqi&#96;s Blog](<a href="https://lishuaiqi.top/tags/UsageStats%E4%BD%BF%E7%94%A8%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/">https://lishuaiqi.top/tags/UsageStatsä½¿ç”¨çŠ¶æ€ç®¡ç†/</a>)</p>]]></content>
    
    
    <categories>
      
      <category>AndroidFrameworkFeature</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>UsageStatsService</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>all-makefiles-under vs all-subdir-makefiles vs first-makefiles-under</title>
    <link href="/article/ea68fa1f/"/>
    <url>/article/ea68fa1f/</url>
    
    <content type="html"><![CDATA[<p>å‚è€ƒï¼š<a href="https://groups.google.com/g/android-building/c/d4ulUWGy0fg">all-makefiles-under v.s. first-makefiles-under</a></p><p><a href="http://aospxref.com/android-12.0.0_r3/xref/build/make/core/definitions.mk#184">definitions.mk - OpenGrok cross reference for &#x2F;build&#x2F;make&#x2F;core&#x2F;definitions.mk (aospxref.com)</a></p><p>å…ˆæ¥çœ‹ä¸€ä¸‹è¿™ä¸‰è€…çš„å®šä¹‰ï¼š</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-comment">###########################################################</span><br><span class="hljs-comment">## Retrieve a list of all makefiles immediately below some directory</span><br><span class="hljs-comment">###########################################################</span><br><br><span class="hljs-comment">#æ‰¾å‡ºæŒ‡å®šç›®å½•çš„äºŒçº§ç›®å½•çš„æ‰€æœ‰Android.mk</span><br><span class="hljs-keyword">define</span> all-makefiles-under<br><span class="hljs-variable">$(<span class="hljs-built_in">wildcard</span> $(1)</span>/*/Android.mk)<br><span class="hljs-keyword">endef</span><br><br><span class="hljs-comment">###########################################################</span><br><span class="hljs-comment">## Look under a directory for makefiles that don&#x27;t have parent</span><br><span class="hljs-comment">## makefiles.</span><br><span class="hljs-comment">###########################################################</span><br><span class="hljs-comment"># $(1): directory to search under</span><br><span class="hljs-comment"># Ignores $(1)/Android.mk</span><br><span class="hljs-keyword">define</span> first-makefiles-under<br><span class="hljs-variable">$(<span class="hljs-built_in">shell</span> build/make/tools/findleaves.py <span class="hljs-variable">$(FIND_LEAVES_EXCLUDES)</span> \</span><br><span class="hljs-variable">        --mindepth=2 $(<span class="hljs-built_in">addprefix</span> --<span class="hljs-built_in">dir</span>=,$(1)</span>) Android.mk)<br><span class="hljs-keyword">endef</span><br><br><span class="hljs-comment">###########################################################</span><br><span class="hljs-comment">## Retrieve a list of all makefiles immediately below your directory</span><br><span class="hljs-comment">## Must be called before including any other makefile!!</span><br><span class="hljs-comment">###########################################################</span><br><span class="hljs-comment">#æ‰¾å‡ºå½“å‰ç›®å½•çš„äºŒçº§ç›®å½•çš„æ‰€æœ‰Android.mk</span><br><span class="hljs-keyword">define</span> all-subdir-makefiles<br><span class="hljs-variable">$(<span class="hljs-built_in">call</span> all-makefiles-under,$(<span class="hljs-built_in">call</span> my-<span class="hljs-built_in">dir</span>)</span>)<br><span class="hljs-keyword">endef</span><br><br></code></pre></td></tr></table></figure><p>The builtin wildcard is quite efficient. So we should use $(call all-makefiles-under, $(LOCAL_PATH)) as you can.</p><p> <strong>first-makefiles-under calls the script build&#x2F;tools&#x2F;findleaves.py to find Android.mks in the given directory.</strong></p><p>If it finds an Android.mk in a directory, it just stops searching the subdirs.</p><p>Itâ€™s not efficient, especially in case you have deep complex directory structure that does not have Android.mk in the top dirs.</p><p>We should use it as little as possible.</p><p>If your Android.mkâ€™s only purpose is to include all <strong>first-level sub-directory</strong> Android.mks, use:</p><p>include $(call all-subdir-makefiles)</p><p>If you want to include Android.mks in a specific set of first-level sub-directories:</p><p>include $(call all-named-subdir-makefiles, <subdirs>)</p><p><strong>æ³¨æ„ï¼š</strong></p><p>1ã€ä¸Šé¢çš„å‡½æ•°éƒ½ä¸åŒ…æ‹¬æŒ‡å®šç›®å½•çš„Android.mkã€‚</p><p>2ã€Both all-subdir-makefiles and all-named-subdir-makefiles use $(my-dir), which uses makefileâ€™s builtin MAKEFILE_LIST to get the current include chain of makefiles.</p><p>So they must be the called before any â€œincludeâ€ statement in your makefile.</p><p>ä½ç½®é”™è¯¯ä¼šæŠ¥é”™ï¼šerror: my-dir must be called before including any other makefile..</p><p>åŸå› åˆ†æï¼š</p><p><a href="https://people.cispa.io/weisgerber/2018/03/01/android-mk-calling-all-subdir-makefiles.html">Android AOSP Android.mk - $(call all-subdir-makefiles) Path problems | Sebastian Weisgerber</a></p><p><a href="https://groups.google.com/g/android-ndk/c/7cUf3tkuBSM">Problems using NDK build system and subdirectories</a></p><p>å³ï¼š</p><p>This is due to a limitation of the GNU Make command language: <strong>All variables are</strong> <strong>global</strong><strong>, and the implementation of $(call my-dir)</strong> <strong>can only give you the name of the last included Makefile</strong> <strong>(even if you already exited the Makefile).</strong> There is no way to implement something that works properly with GNU Make.</p><h2 id="æµ‹è¯•ç»“æœï¼š"><a href="#æµ‹è¯•ç»“æœï¼š" class="headerlink" title="æµ‹è¯•ç»“æœï¼š"></a>æµ‹è¯•ç»“æœï¼š</h2><p>å‡è®¾appç›®å½•ç»“æ„å¦‚ä¸‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">app-&gt;</span><span class="language-bash">app1-&gt;Android.mk</span><br><span class="hljs-meta prompt_">   -&gt;</span><span class="language-bash">app2-&gt;Android.mk</span><br><span class="hljs-meta prompt_">   -&gt;</span><span class="language-bash">app3-&gt;app4-&gt;Android.mk</span><br>         -&gt;app5-&gt;Android.mk<br><span class="hljs-meta prompt_">   -&gt;</span><span class="language-bash">app6-&gt;Android.mk</span><br>   -&gt;app7-&gt;Android.mk<br>         -&gt;app8-&gt;Android.mk<br><span class="hljs-meta prompt_">   -&gt;</span><span class="language-bash">Android.mk</span><br></code></pre></td></tr></table></figure><p>åœ¨appç›®å½•åˆ†åˆ«è°ƒç”¨ä»¥ä¸Šå‡½æ•°ï¼Œç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">all-makefiles-under</span><br><span class="hljs-meta prompt_">app-&gt;</span><span class="language-bash">app1-&gt;Android.mk</span><br><span class="hljs-meta prompt_">   -&gt;</span><span class="language-bash">app2-&gt;Android.mk</span><br><span class="hljs-meta prompt_">   -&gt;</span><span class="language-bash">app6-&gt;Android.mk</span><br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">all-subdir-makefiles</span><br><span class="hljs-meta prompt_">app-&gt;</span><span class="language-bash">app1-&gt;Android.mk</span><br><span class="hljs-meta prompt_">   -&gt;</span><span class="language-bash">app2-&gt;Android.mk</span><br><span class="hljs-meta prompt_">   -&gt;</span><span class="language-bash">app6-&gt;Android.mk</span><br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">first-makefiles-under</span><br><span class="hljs-meta prompt_">app-&gt;</span><span class="language-bash">app1-&gt;Android.mk</span><br><span class="hljs-meta prompt_">   -&gt;</span><span class="language-bash">app2-&gt;Android.mk</span><br><span class="hljs-meta prompt_">   -&gt;</span><span class="language-bash">app3-&gt;app4-&gt;Android.mk</span><br>         -&gt;app5-&gt;Android.mk<br><span class="hljs-meta prompt_">   -&gt;</span><span class="language-bash">app6-&gt;Android.mk</span><br></code></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/jackyu613/article/details/5949324">Android.mkä¸­call all-subdir-makefileså’Œcall all-makefiles-under,$(LOCAL_PATH)çš„åŒºåˆ«_jackyu613çš„ä¸“æ  Embedded Linux Android-CSDNåšå®¢</a></p><p><a href="https://www.jianshu.com/p/28992a35037e">call all-subdir-makefileså’Œcall all-makefiles-under - ç®€ä¹¦</a></p>]]></content>
    
    
    <categories>
      
      <category>Android Build System</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>å®‰å“Makefile</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®‰å“è®°äº‹æœ¬ç³»ç»Ÿè®¾è®¡å’Œæ¨¡å—å®ç°</title>
    <link href="/article/71902dbe/"/>
    <url>/article/71902dbe/</url>
    
    <content type="html"><![CDATA[<h1 id="å®‰å“è®°äº‹æœ¬ç³»ç»Ÿè®¾è®¡å’Œæ¨¡å—å®ç°"><a href="#å®‰å“è®°äº‹æœ¬ç³»ç»Ÿè®¾è®¡å’Œæ¨¡å—å®ç°" class="headerlink" title="å®‰å“è®°äº‹æœ¬ç³»ç»Ÿè®¾è®¡å’Œæ¨¡å—å®ç°"></a>å®‰å“è®°äº‹æœ¬ç³»ç»Ÿè®¾è®¡å’Œæ¨¡å—å®ç°</h1><h2 id="å‹æƒ…æç¤º"><a href="#å‹æƒ…æç¤º" class="headerlink" title="å‹æƒ…æç¤º"></a>å‹æƒ…æç¤º</h2><p>è®°äº‹æœ¬æ˜¯æˆ‘å­¦ä¹ å®‰å“åç¼–å†™çš„ç¬¬ä¸€ä¸ªè½¯ä»¶ï¼Œä¹Ÿæ˜¯æˆ‘çš„æ¯•ä¸šè®¾è®¡ã€‚å®ƒå­˜åœ¨ç€è®¸å¤šä¸å®Œå–„çš„åœ°æ–¹ï¼Œå¦‚æœä½ æœ‰æƒ³æ³•å¯ä»¥è¿›ä¸€æ­¥å»å®Œå–„å®ƒã€‚</p><p>æˆ‘å½“æ—¶çœ‹çš„æ˜¯éƒ­éœ–ã€Šç¬¬ä¸€è¡Œä»£ç ã€‹ç¬¬2ç‰ˆå…¥é—¨çš„ï¼Œç°åœ¨å·²ç»å‡ºåˆ°ç¬¬3ç‰ˆäº†ï¼Œç¼–ç¨‹è¯­è¨€ç”±Javaæ”¹æˆäº†Kotlinï¼Œå¦‚æœä½ æœ‰æ—¶é—´ï¼Œä¹Ÿå¯ä»¥æŠŠæˆ‘çš„é¡¹ç›®ä»Javaæ”¹æˆKotlinç¼–å†™ã€‚ç›®å‰è¿™ä¸¤æœ¬ä¹¦éƒ½å¯ä»¥åœ¨å¾®ä¿¡è¯»ä¹¦ä¸Šé¢æ‰¾åˆ°ã€‚</p><p><a href="https://github.com/wesley666/note">ä»£ç é“¾æ¥</a></p><p><a href="https://www.bilibili.com/video/BV1sz4y1D7a6/">è§†é¢‘æ¼”ç¤º</a></p><h2 id="ç”¨åˆ°çš„å…³é”®æŠ€æœ¯"><a href="#ç”¨åˆ°çš„å…³é”®æŠ€æœ¯" class="headerlink" title="ç”¨åˆ°çš„å…³é”®æŠ€æœ¯"></a>ç”¨åˆ°çš„å…³é”®æŠ€æœ¯</h2><h3 id="è¯­éŸ³è¯†åˆ«æŠ€æœ¯å’Œè¯­éŸ³åˆæˆæŠ€æœ¯"><a href="#è¯­éŸ³è¯†åˆ«æŠ€æœ¯å’Œè¯­éŸ³åˆæˆæŠ€æœ¯" class="headerlink" title="è¯­éŸ³è¯†åˆ«æŠ€æœ¯å’Œè¯­éŸ³åˆæˆæŠ€æœ¯"></a>è¯­éŸ³è¯†åˆ«æŠ€æœ¯å’Œè¯­éŸ³åˆæˆæŠ€æœ¯</h3><p>å¤šåŠŸèƒ½è®°äº‹æœ¬APPé‡‡ç”¨è®¯é£çš„è¯­éŸ³è¯†åˆ«å¼•æ“ï¼Œç›¸å½“äºç»™è½¯ä»¶åŠ ä¸Šäº†â€œè€³æœµâ€ï¼Œè®©è®°äº‹æœ¬èƒ½â€œå¬æ‡‚â€ç”¨æˆ·çš„è®²è¯ã€‚è®¯é£å…¬å¸ä½œä¸ºè¯­éŸ³è¯†åˆ«è¡Œä¸šçš„ä½¼ä½¼è€…ï¼Œå®ƒçš„è¾“å…¥æ³•å·²ç»å¯ä»¥åšåˆ°ä¸€åˆ†é’Ÿè¾“å…¥400å­—äº†ï¼Œè¿™æå¤§åœ°æå‡äº†ç”¨æˆ·çš„è¾“å…¥æ•ˆç‡ã€‚æ­¤å¤–ï¼Œè®°äº‹æœ¬è¿˜ä¼šé‡‡ç”¨å®‰å“å®˜æ–¹TextToSpeechç±»æ¥å®ç°è¯­éŸ³åˆæˆï¼Œå®ƒä½¿ç”¨çš„åˆæˆå¼•æ“å–å†³äºæ‰‹æœºå“ç‰Œï¼Œæ¯”å¦‚å°ç±³æ‰‹æœºé»˜è®¤ä½¿ç”¨çš„æ˜¯å°çˆ±è¯­éŸ³å¼•æ“ï¼Œè°·æ­Œçš„åŸç”Ÿç³»ç»Ÿä¸€èˆ¬ä½¿ç”¨Pico TTSï¼Œä½†ä¸æ”¯æŒä¸­æ–‡ï¼Œåšæœæ‰‹æœºé‡‡ç”¨çš„æ˜¯è®¯é£åˆæˆå¼•æ“ã€‚</p><h3 id="å›¾ç‰‡å‹ç¼©å’ŒåŠ è½½æŠ€æœ¯"><a href="#å›¾ç‰‡å‹ç¼©å’ŒåŠ è½½æŠ€æœ¯" class="headerlink" title="å›¾ç‰‡å‹ç¼©å’ŒåŠ è½½æŠ€æœ¯"></a>å›¾ç‰‡å‹ç¼©å’ŒåŠ è½½æŠ€æœ¯</h3><p>ç°åœ¨æ‰‹æœºçš„ç›¸æœºåƒç´ è¶Šæ¥è¶Šé«˜ï¼Œä¼´éšç€çš„å°±æ˜¯å›¾ç‰‡ä½“ç§¯çš„å¢å¤§ï¼Œå¯¹å­˜å‚¨å’Œæ˜¾ç¤ºéƒ½æœ‰å‹åŠ›ã€‚æ‰€ä»¥ï¼Œå›¾ç‰‡çš„å‹ç¼©å°±å˜å¾—éå¸¸é‡è¦ã€‚è®°äº‹æœ¬è½¯ä»¶é‡‡ç”¨çš„æ˜¯é²ç­å‹ç¼©å¼€æºæ¡†æ¶ï¼Œä½œè€…å·ç§°å…¶å‹ç¼©ç®—æ³•è¾¾åˆ°çš„æ•ˆæœå¯ä»¥æ¥è¿‘å¾®ä¿¡æœ‹å‹åœˆçš„å›¾ç‰‡å‹ç¼©ç®—æ³•ã€‚æ‰€æœ‰æ’å…¥åˆ°ç¬”è®°çš„å›¾ç‰‡éƒ½ä¼šå…ˆè¿›è¡Œå›¾ç‰‡å‹ç¼©å†è¿›è¡Œå­˜å‚¨å’Œæ˜¾ç¤ºï¼Œè¿™æå¤§çš„ç¼“è§£äº†æ‰‹æœºçš„å­˜å‚¨ç©ºé—´å’Œé¿å…äº†å›¾ç‰‡æ˜¾ç¤ºçš„å†…å­˜æº¢å‡ºé—®é¢˜ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå›¾ç‰‡åŠ è½½ä½œä¸ºå›¾ç‰‡æ˜¾ç¤ºçš„é‡è¦è¿‡ç¨‹ï¼Œä¼šç›´æ¥å½±å“å›¾ç‰‡æ˜¾ç¤ºçš„æ€§èƒ½ï¼Œå°¤å…¶æ‰‹æœºè¿™ç§ç¡¬ä»¶å—é™çš„è®¾å¤‡ã€‚å®‰å“æœ‰è®¸å¤šå¼€æºçš„å›¾ç‰‡åŠ è½½åº“ï¼Œå…¶ä¸­Glideå°¤ä¸ºå‡ºè‰²ï¼Œæ›¾ç»è¢«è°·æ­Œå®˜æ–¹æ¨èè¿‡ã€‚å®ƒæ€§èƒ½ä¼˜å¼‚ã€å¿«é€Ÿé«˜æ•ˆï¼Œåœ¨å›¾ç‰‡è§£ç é€Ÿåº¦å’Œè§£ç å›¾ç‰‡å¸¦æ¥çš„èµ„æºå‹åŠ›ä¸¤æ–¹é¢é—®é¢˜éƒ½æœ‰å¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆï¼Œé‡‡ç”¨çš„ç¼“å­˜å’Œè‡ªåŠ¨èµ„æºæ± ç­‰æŠ€æœ¯å¾ˆå¥½åœ°ç¡®ä¿å›¾ç‰‡æ˜¾ç¤ºä¸ä¼šå†…å­˜æº¢å‡ºï¼Œå°½å¯èƒ½åœ°è®©å›¾ç‰‡åŠ è½½è¿™ä¸ªè¿‡ç¨‹å˜çš„æ›´åŠ å¿«é€Ÿå’Œå¹³æ»‘ã€‚åœ¨è®°äº‹æœ¬çš„å¤šä¸ªåœ°æ–¹éƒ½è¦ç”¨åˆ°GlideåŠ è½½å¼•æ“ï¼Œæ¯”å¦‚æ’å…¥å›¾ç‰‡æ—¶éœ€è¦é€‰æ‹©å›¾ç‰‡ï¼Œç¬”è®°æŸ¥çœ‹ç•Œé¢éœ€è¦æµè§ˆå›¾ç‰‡ç­‰ç­‰ã€‚</p><h3 id="äº‘å­˜å‚¨æŠ€æœ¯"><a href="#äº‘å­˜å‚¨æŠ€æœ¯" class="headerlink" title="äº‘å­˜å‚¨æŠ€æœ¯"></a>äº‘å­˜å‚¨æŠ€æœ¯</h3><p>éšç€ç§»åŠ¨äº’è”ç½‘çš„å‘å±•ï¼Œå‡ ä¹æ‰€æœ‰çš„æ‰‹æœºéƒ½æä¾›äº†äº‘æœåŠ¡ï¼Œå¯ä»¥åŒæ­¥ç”¨æˆ·çš„å›¾ç‰‡ã€è”ç³»äººç­‰æ•°æ®ï¼Œå…¶ä¸­æ¶‰åŠåˆ°çš„ä¸€é¡¹é‡è¦æŠ€æœ¯å°±æ˜¯äº‘å­˜å‚¨æŠ€æœ¯ï¼Œå®ƒå°†å¤§é‡ä¸åŒç±»å‹çš„å­˜å‚¨è®¾å¤‡é€šè¿‡è½¯ä»¶é›†åˆèµ·æ¥ååŒå·¥ä½œï¼Œå…±åŒå¯¹å¤–æä¾›æ•°æ®å­˜å‚¨æœåŠ¡ã€‚æœ¬è½¯ä»¶é‡‡ç”¨çš„æœåŠ¡å•†æ˜¯åšæœäº‘ï¼Œå®‰å“å®¢æˆ·ç«¯é€šè¿‡WebDavåè®®ä¸å…¶è¿›è¡Œé€šè®¯ï¼Œè¿™ä¸ªåè®®æ˜¯åŸºäºHTTPçš„æ‰©å±•ï¼Œæœ‰åˆ©äºç”¨æˆ·å¯¹æœåŠ¡å™¨ç«¯çš„æ–‡ä»¶è¿›è¡Œè¯»å†™æ“ä½œã€‚</p><h3 id="Material-Design"><a href="#Material-Design" class="headerlink" title="Material Design"></a>Material Design</h3><p>å®‰å“åˆšåˆšå‘å±•çš„é‚£å‡ å¹´ï¼ŒUIè®¾è®¡å¹¶ä¸ç¾è§‚ï¼Œè¿œè¿œä¸å¦‚å½“æ—¶çš„iOSç³»ç»Ÿç¾è§‚ã€‚è€Œä¸”ï¼Œç”±äºå®‰å“æ˜¯ä¸€ä¸ªå¼€æºç³»ç»Ÿï¼Œå„ä¸ªæ‰‹æœºå‚å•†åœ¨UIè®¾è®¡çš„è§„èŒƒå¹¶ä¸ç›¸åŒï¼Œæ‰€ä»¥å¾ˆå¤šå¼€å‘è€…å¹²è„†å°±æŠŠiOSä¸Šçš„è®¾è®¡æ¬åˆ°å®‰å“ä¸Šé¢æ¥ã€‚åæ¥ï¼Œè°·æ­Œæ„è¯†åˆ°äº†è¿™ä¸ªé—®é¢˜å¹¶åœ¨2014å¹´çš„å¼€å‘è€…å¤§ä¼šä¸Šå‘å¸ƒäº†ä¸€å¥—å…¨æ–°çš„UIè®¾è®¡è¯­è¨€ï¼šMaterial Designï¼Œå®ƒæ˜¯ç”±Googleçš„è®¾è®¡å·¥ç¨‹å¸ˆä»¬åŸºäºä¼ ç»Ÿä¼˜ç§€çš„è®¾è®¡åŸåˆ™ï¼Œç»“åˆä¸°å¯Œçš„åˆ›æ„å’Œç§‘å­¦æŠ€æœ¯æ‰€å¼€å‘çš„ä¸€å¥—å…¨æ–°çš„ç•Œé¢è®¾è®¡è¯­è¨€ï¼ŒåŒ…å«äº†è§†è§‰ã€è¿åŠ¨ã€äº’åŠ¨æ•ˆæœç­‰ç‰¹æ€§ã€‚è¿™ç§ç»“åˆå¡ç‰‡åŒ–è®¾è®¡é£æ ¼çš„è¯­è¨€ï¼Œç»™ç”¨æˆ·å¸¦æ¥äº†è‰¯å¥½ã€ç¾è§‚å’Œä¸€è‡´æ€§çš„ä½“éªŒï¼Œä»è€Œç»Ÿä¸€äº†è°·æ­Œåœ¨UIè®¾è®¡ä¸Šé¢çš„è¡¨è¾¾ã€‚ç›®å‰ï¼ŒMaterial Designçš„æ”¯æŒåº“éå¸¸å®Œå–„äº†ï¼Œå¤šåŠŸèƒ½è®°äº‹æœ¬APPä¹Ÿå°†é‡‡ç”¨è¿™ä¸€è®¾è®¡è¯­è¨€ã€‚</p><h3 id="å¯Œæ–‡æœ¬æŠ€æœ¯"><a href="#å¯Œæ–‡æœ¬æŠ€æœ¯" class="headerlink" title="å¯Œæ–‡æœ¬æŠ€æœ¯"></a>å¯Œæ–‡æœ¬æŠ€æœ¯</h3><p>å¯Œæ–‡æœ¬æŠ€æœ¯çš„å®ç°å¯ä»¥è®©è®°äº‹æœ¬çš„å†…å®¹ä¸ä»…ä»…æ˜¯ä¸€ç§å•è°ƒçš„æ ·å¼ï¼Œè¿˜å¯ä»¥æœ‰å…¶ä»–ä¸°å¯Œçš„æ ·å¼ï¼Œæ¯”å¦‚å¯ä»¥çªå‡ºæ ‡é¢˜çš„æ˜¾ç¤ºï¼Œå¯ä»¥è®©é‡ç‚¹çš„æ–‡å­—å†…å®¹å˜çº¢ï¼Œå¯ä»¥æ˜¾ç¤ºå›¾ç‰‡ç­‰ç­‰ã€‚æ‰€ä»¥ï¼Œå¯Œæ–‡æœ¬æŠ€æœ¯å¯¹å¤šåŠŸèƒ½è®°äº‹æœ¬APPè‡³å…³é‡è¦ã€‚ç›®å‰æœ‰å‡ ç§æ–¹æ³•æ¥å®ç°å¯Œæ–‡æœ¬ï¼š</p><ul><li><p>é€šè¿‡ä½¿ç”¨Html.fromHtml()æ¥è§£ææ–‡æœ¬å†…å®¹ï¼Œç„¶åæ˜¾ç¤ºåœ¨TextViewä¸­ï¼Œä½†å®‰å“åŸç”Ÿçš„Htmlæ”¯æŒçš„æ ·å¼è¾ƒå°‘ï¼Œå›¾ç‰‡æ˜¾ç¤ºéœ€è¦å•ç‹¬å¤„ç†ç­‰ç­‰ã€‚</p></li><li><p>é€šè¿‡ScrollViewã€å¤šä¸ªEditTextã€å¤šä¸ªImageViewç­‰ç»„ä»¶æ¥æ‹†åˆ†å†…å®¹æ˜¾ç¤ºï¼Œç”±äºæ˜¯åŸç”Ÿå¸ƒå±€æ‰€ä»¥èƒ½å®ç°çš„æ•ˆæœæœ‰å¾ˆå¤šï¼Œä½†æ˜¯å®ç°èµ·æ¥éå¸¸å›°éš¾ï¼Œéœ€è¦å¤„ç†è¾“å…¥ç„¦ç‚¹ã€ç»„ä»¶ä¹‹é—´çš„å…³ç³»æ€ä¹ˆå®‰æ’ç­‰é—®é¢˜ã€‚</p></li><li><p>é€šè¿‡ä½¿ç”¨å®‰å“SpannableStringç±»æ¥å®ç°ï¼Œé€šè¿‡å®ƒçš„public void setSpan(Object what, int start, int end, int flags)æ–¹æ³•å¯ä»¥è®¾ç½®å¤šç§æ ·å¼ï¼Œå‚æ•°whatä»£è¡¨æ‰€è¦è®¾ç½®çš„æ ·å¼ï¼Œå‚æ•°startå’Œendä»£è¡¨æ ·å¼è®¾ç½®èŒƒå›´ï¼Œå‚æ•°flagsæ˜¯å¯¹æ–°æ’å…¥å­—ç¬¦çš„å¤„ç†æ–¹å¼ã€‚ç»“åˆClickableSpanç±»å’ŒImageSpanç±»å°±å¯ä»¥å®ç°ç‚¹å‡»äº‹ä»¶å’Œå›¾ç‰‡æ˜¾ç¤ºï¼Œä½¿ç”¨éå¸¸æ–¹ä¾¿ï¼ŒåŸºæœ¬æ»¡è¶³äº†å¤šåŠŸèƒ½è®°äº‹æœ¬APPå¯¹å¯Œæ–‡æœ¬çš„è¦æ±‚ã€‚</p></li></ul><h3 id="æŒä¹…åŒ–æŠ€æœ¯"><a href="#æŒä¹…åŒ–æŠ€æœ¯" class="headerlink" title="æŒä¹…åŒ–æŠ€æœ¯"></a>æŒä¹…åŒ–æŠ€æœ¯</h3><p>æ•°æ®æŒä¹…åŒ–æŠ€æœ¯ä½œä¸ºè½¯ä»¶çš„å‹èˆ±çŸ³ï¼Œæ˜¯éå¸¸é‡è¦çš„ï¼Œå®ƒå¯ä»¥åœ¨ç”¨æˆ·é€€å‡ºè½¯ä»¶åä¿å­˜ç”¨æˆ·æ‰€éœ€è¦çš„æ•°æ®ã€‚æ–‡ä»¶å­˜å‚¨ã€æ•°æ®åº“å­˜å‚¨å’ŒSharedPreferenceså­˜å‚¨æ˜¯å®‰å“ç³»ç»Ÿæä¾›çš„ä¸‰ç§æ•°æ®æŒä¹…åŒ–æ–¹æ³•ã€‚æ–‡ä»¶å­˜å‚¨å¯ä»¥ç›´æ¥æŠŠæ•°æ®å®Œå…¨ä¿å­˜åˆ°æ–‡ä»¶é‡Œé¢å»ï¼Œé€‚åˆå­˜å‚¨ä¸€äº›ç®€å•çš„æ–‡æœ¬æ•°æ®å’ŒäºŒè¿›åˆ¶æ•°æ®ã€‚æ‰€ä»¥ï¼Œåœ¨å¤šåŠŸèƒ½è®°äº‹æœ¬APPä¸­ä¸»è¦ç”¨æ¥ä¿å­˜å›¾ç‰‡å’Œè¯­éŸ³èµ„æºã€‚æ•°æ®åº“å­˜å‚¨åœ¨å®‰å“ç³»ç»Ÿä¸­ä½¿ç”¨çš„ä¸»è¦æ˜¯SQLiteæ•°æ®åº“ï¼Œå®ƒä½œä¸ºå¹³å°ç³»ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“ï¼Œå…·æœ‰å ç”¨å†…å­˜ã€èµ„æºå°ç­‰æ–¹é¢çš„ä¼˜åŠ¿ï¼Œåœ¨å¹³å°APPå¼€å‘ä¸­èƒ½å¤Ÿå‘æŒ¥é‡å¤§ä½œç”¨ã€‚å®ƒå®Œå…¨å†…ç½®äºå®‰å“æ“ä½œç³»ç»Ÿï¼Œå¯¹å­˜å‚¨ç»“æ„æ€§å¤æ‚çš„æ•°æ®éå¸¸å‹å¥½ï¼Œè¿è¡Œé€Ÿåº¦ä¹Ÿéå¸¸å¿«ã€‚è™½ç„¶å®‰å“æä¾›äº†SQLiteOpenHelperå¸®åŠ©ç±»æ¥å®ç°æ•°æ®åº“çš„å¢åˆ æ”¹æŸ¥å„ç§æ“ä½œï¼Œä½†æ˜¯ç”¨èµ·æ¥è¿˜æ˜¯æ²¡æœ‰é‚£ä¹ˆæ–¹ä¾¿ã€‚æ‰€ä»¥åœ¨è®°äº‹æœ¬å·¥ç¨‹é‡Œå¼•å…¥LitePalè¿™ä¸ªå¼€æºçš„æ•°æ®åº“æ¡†æ¶ï¼Œå®ƒé‡‡ç”¨çš„å¯¹è±¡å…³ç³»æ˜ å°„æ¨¡å¼å¯ä»¥è®©åˆ›å»ºæ•°æ®è¡¨å˜å¾—å¼‚å¸¸ç®€å•ï¼Œå¹¶ä¸”å°è£…äº†å¾ˆå¤šå¸¸ç”¨çš„æ•°æ®åº“åŠŸèƒ½æ¥å£ï¼Œè®©å¼€å‘æµç¨‹å˜å¾—æ›´åŠ ä¾¿æ·å’Œå¿«é€Ÿã€‚SQLiteæ•°æ®åº“ä¸»è¦ç”¨æ¥ä¿å­˜ç¬”è®°å’Œå¾…åŠäº‹é¡¹ç›¸å…³å†…å®¹ã€‚SharedPreferenceså­˜å‚¨é‡‡ç”¨çš„æ˜¯key-valueçš„æ–¹å¼æ¥å­˜å‚¨æ•°æ®ï¼Œé€‚åˆä¿å­˜ä¸€äº›ç®€å•æ•°æ®ï¼Œæ“ä½œèµ·æ¥éå¸¸æ–¹ä¾¿ã€‚æ­¤å¤–ï¼ŒSharedPreferenceså¯¹è±¡ä¸SQLiteæ•°æ®åº“ç›¸æ¯”ï¼Œå…å»äº†åˆ›å»ºæ•°æ®åº“ã€åˆ›å»ºè¡¨ã€å†™SQLè¯­å¥ç­‰è¯¸å¤šæ“ä½œï¼Œç›¸å¯¹è€Œè¨€æ›´åŠ æ–¹ä¾¿ï¼Œç®€æ´ã€‚å› æ­¤ï¼Œåœ¨APPä¸­ä¸»è¦ç”¨æ¥ä¿å­˜ç”¨æˆ·åå¥½æ•°æ®å’Œè´¦å·å¯†ç ã€‚</p><h2 id="ç³»ç»Ÿè®¾è®¡"><a href="#ç³»ç»Ÿè®¾è®¡" class="headerlink" title="ç³»ç»Ÿè®¾è®¡"></a>ç³»ç»Ÿè®¾è®¡</h2><h3 id="ç³»ç»Ÿæ€»ä½“è®¾è®¡"><a href="#ç³»ç»Ÿæ€»ä½“è®¾è®¡" class="headerlink" title="ç³»ç»Ÿæ€»ä½“è®¾è®¡"></a>ç³»ç»Ÿæ€»ä½“è®¾è®¡</h3><h4 id="ç³»ç»Ÿå±‚æ¬¡ç»“æ„"><a href="#ç³»ç»Ÿå±‚æ¬¡ç»“æ„" class="headerlink" title="ç³»ç»Ÿå±‚æ¬¡ç»“æ„"></a>ç³»ç»Ÿå±‚æ¬¡ç»“æ„</h4><p>å¤šåŠŸèƒ½è®°äº‹æœ¬APPåŸºäºå®‰å“æ‰‹æœºæ“ä½œç³»ç»Ÿå¼€å‘ï¼Œç³»ç»Ÿæ€»ä½“æ¶æ„æŒ‰ç…§APPå®¢æˆ·ç«¯-æœåŠ¡å™¨ç«¯æ¨¡å¼è®¾è®¡ï¼Œæ¶æ„è®¾è®¡å¦‚å›¾æ‰€ç¤ºã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210619193435.png" alt="ç³»ç»Ÿæ¶æ„è®¾è®¡å›¾"></p><p>å…¶ä¸­äº‘ç«¯çš„æœåŠ¡å™¨æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯æ•°æ®å­˜å‚¨æœåŠ¡å™¨ï¼Œè¿™é‡ŒæŒ‡çš„æ˜¯åšæœäº‘çš„æœåŠ¡å™¨ï¼Œå®‰å“å®¢æˆ·ç«¯å¯ä»¥é€šè¿‡WebDavåè®®å‘æœåŠ¡å™¨ç«¯è¯·æ±‚æˆ–è€…å‘é€æ•°æ®ã€‚å¦å¤–ä¸€ç§æ˜¯æä¾›è¯­éŸ³è¯†åˆ«åŠŸèƒ½çš„æœåŠ¡å™¨ï¼Œè¿™é‡ŒæŒ‡çš„æ˜¯è®¯é£å…¬å¸æä¾›è¯­éŸ³æœåŠ¡çš„æœåŠ¡å™¨ï¼Œå®‰å“å®¢æˆ·ç«¯é€šè¿‡ç½‘ç»œå’Œå¯†é’¥ä¸å…¶è¿›è¡Œé€šä¿¡ï¼Œè·å–è¯­éŸ³è½¬æ¢æˆæ–‡å­—çš„ç»“æœã€‚</p><p>å®‰å“å®¢æˆ·ç«¯çš„æ¡†æ¶é‡‡ç”¨MVCç»“æ„ï¼ŒMVCå³Model-View-Controllerï¼Œå…¶ä¸­Mé€»è¾‘æ¨¡å‹ï¼ŒVæ˜¯è§†å›¾æ¨¡å‹ï¼ŒCæ˜¯æ§åˆ¶å™¨ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210619193815.png" alt="MVCæ¶æ„è®¾è®¡å›¾"></p><p>è§†å›¾å±‚çš„ä¸»è¦èŒè´£å°±æ˜¯æ§åˆ¶å„ç§ç”¨æˆ·ç•Œé¢çš„æ˜¾ç¤ºï¼Œå³è´Ÿè´£ç”¨æˆ·æ•°æ®çš„æ˜¾ç¤ºï¼ŒåŒæ—¶å¯ä»¥ä¸ç”¨æˆ·è¿›è¡Œäº¤äº’ã€‚åŒ…æ‹¬ä¸»ç•Œé¢ã€ç¬”è®°ç¼–è¾‘é¡µé¢å’Œç¬”è®°æŸ¥çœ‹é¡µé¢ç­‰ç­‰ã€‚</p><p>æ§åˆ¶å±‚çš„ä¸»è¦èŒè´£å°±æ˜¯å¤„ç†å„ç§é€»è¾‘ä¸šåŠ¡ï¼Œå³æ¥æ”¶å¹¶è§£æç”¨æˆ·å±‚çš„æ“ä½œæŒ‡ä»¤ç„¶ååˆ°æ¨¡å‹å±‚è¯·æ±‚æ•°æ®ï¼Œå¾—åˆ°æ•°æ®åå¯ä»¥é€åˆ°è§†å›¾å±‚è¿›è¡Œæ˜¾ç¤ºã€‚ä¾‹å¦‚ï¼Œå½“ç”¨æˆ·å±‚è¯·æ±‚è¯­éŸ³è¾“å…¥æ—¶ï¼Œæ§åˆ¶å±‚ä¼šè´Ÿè´£è°ƒç”¨è®¯é£ç›¸å…³æ¥å£ï¼Œè·å–åˆ°è¯­éŸ³æ•°æ®åï¼Œé€šè¿‡ç½‘ç»œè¿æ¥åˆ°è®¯é£è¯­éŸ³è¯†åˆ«æœåŠ¡å™¨ï¼Œé‚£è¾¹æ•°æ®å¤„ç†å®Œæˆåï¼Œæ¨¡å‹å±‚å°±ä¼šæŠŠæ•°æ®é€åˆ°è§†å›¾å±‚è¿›è¡Œå±•ç¤ºã€‚</p><p>æ¨¡å‹å±‚ä¸»è¦èŒè´£å°±æ˜¯è´Ÿè´£å„ç§ç”¨æˆ·æ•°æ®çš„åŠ è½½å’Œå­˜å‚¨ã€‚ä¾‹å¦‚ç¬”è®°ç¼–è¾‘å®Œæ¯•åæ¨¡å‹å±‚è¦æŠŠå®ƒä¿å­˜åˆ°æ•°æ®åº“ï¼Œç”¨æˆ·æŸ¥çœ‹ç¬”è®°æ—¶æ¨¡å‹å±‚è¦è·å–ç›¸åº”çš„æ•°æ®ã€‚æ•°æ®åº“é‡‡ç”¨çš„æ˜¯ä¸“é—¨ä¸ºåµŒå…¥å¼è®¾å¤‡è®¾è®¡çš„SQLiteè½»é‡çº§æ•°æ®åº“ã€‚</p><h4 id="ç³»ç»Ÿå„åŠŸèƒ½æ¨¡å—ç»„æˆ"><a href="#ç³»ç»Ÿå„åŠŸèƒ½æ¨¡å—ç»„æˆ" class="headerlink" title="ç³»ç»Ÿå„åŠŸèƒ½æ¨¡å—ç»„æˆ"></a>ç³»ç»Ÿå„åŠŸèƒ½æ¨¡å—ç»„æˆ</h4><p>å¤šåŠŸèƒ½è®°äº‹æœ¬APPä¸»è¦åˆ†ä¸ºä¹å¤§æ¨¡å—ï¼šç”¨æˆ·ç•Œé¢ã€è¾“å…¥æ¨¡å—ã€æé†’æ¨¡å—ç­‰ç­‰ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210619193936.png" alt="ç³»ç»Ÿæ¨¡å—ç»„æˆå›¾"></p><p>å„ä¸ªç³»ç»Ÿæ¨¡å—åŠŸèƒ½å¦‚ä¸‹ï¼š</p><p>ï¼ˆ1ï¼‰ ç”¨æˆ·ç•Œé¢ï¼šä¸ç”¨æˆ·ç›´æ¥æ‰“äº¤é“çš„å°±æ˜¯ç”¨æˆ·ç•Œé¢ï¼Œæ‰€ä»¥ä¸€ä¸ªè§†è§‰ç¾è§‚å’Œæ“ä½œä¾¿æ·çš„ç”¨æˆ·ç•Œé¢è‡³å…³é‡è¦ï¼Œå®ƒç›´æ¥å½±å“äº†ç”¨æˆ·ä½“éªŒã€‚</p><p>ï¼ˆ2ï¼‰ è¾“å…¥æ¨¡å—ï¼šä¸»è¦ç”¨æ¥è®°å½•ç”¨æˆ·æƒ³æ³•ï¼ŒåŒ…æ‹¬æ–‡å­—ã€å›¾ç‰‡å’Œè¯­éŸ³ã€‚å…¶ä¸­ï¼Œæ–‡å­—è¾“å…¥å¯ä»¥é€šè¿‡ä¼ ç»Ÿçš„é”®ç›˜è¾“å…¥æˆ–è€…è¯­éŸ³è¯†åˆ«è¾“å…¥ã€‚</p><p>ï¼ˆ3ï¼‰ æ˜¾ç¤ºæ¨¡å—ï¼šç”¨æ¥æ˜¾ç¤ºä¿å­˜åçš„ç¬”è®°æˆ–è€…å¾…åŠäº‹é¡¹ã€‚</p><p>ï¼ˆ4ï¼‰ æé†’æ¨¡å—ï¼šç›®å‰ï¼Œäººä»¬è¡Œè‰²åŒ†åŒ†ï¼Œéœ€è¦å¿™æ´»çš„äº‹æƒ…å¤ªå¤šäº†ã€‚æ‰€ä»¥ï¼Œè®°äº‹æœ¬çš„æé†’åŠŸèƒ½å¿…ä¸å¯å°‘ï¼ŒåŒ…æ‹¬æ—¥å†æé†’å’Œåº”ç”¨å†…è¯­éŸ³æ’­æŠ¥æé†’ã€‚</p><p>ï¼ˆ5ï¼‰ æ•°æ®åŒæ­¥ï¼šç°åœ¨æ˜¯å¤§æ•°æ®æ—¶ä»£ï¼Œå¾ˆå¤šæœ¬åœ°æ•°æ®éƒ½æ”¯æŒåŒæ­¥åˆ°äº‘ç«¯äº†ã€‚å› æ­¤ï¼Œç”¨æˆ·çš„æ•°æ®å¯ä»¥åŒæ—¶ä¿å­˜åˆ°æœ¬åœ°å’Œäº‘ç«¯ï¼Œä¾¿æ·æ€§å’Œå®‰å…¨æ€§éƒ½å¾—åˆ°äº†æé«˜ã€‚</p><p>ï¼ˆ6ï¼‰ æœç´¢æ¨¡å—ï¼šç”¨æˆ·çš„æ•°æ®é‡æ˜¯å·¨å¤§çš„ï¼Œæœ‰äº†æœç´¢åŠŸèƒ½æ‰èƒ½åœ¨æµ·é‡çš„ä¿¡æ¯ä¸­æ‰¾åˆ°è‡ªå·±éœ€è¦çš„ï¼ŒèŠ‚çœå¤§é‡æŸ¥æ‰¾æ—¶é—´ã€‚</p><p>ï¼ˆ7ï¼‰ ç®¡ç†æ¨¡å—ï¼šä¸»è¦å°±æ˜¯è´Ÿè´£ç¬”è®°å’Œå¾…åŠäº‹é¡¹çš„å¢åˆ æ”¹æŸ¥ã€‚æ­¤å¤–ï¼Œä¸ºäº†é¿å…è¯¯åˆ é™¤ç¬”è®°ï¼Œç³»ç»Ÿè¿˜æä¾›å›æ”¶ç«™åŠŸèƒ½ï¼Œå½“ä½ åæ‚”çš„æ—¶å€™ï¼Œè¿˜å¯ä»¥ä»å›æ”¶ç«™æ¢å¤ç¬”è®°å†…å®¹ã€‚ç”±äºå¾…åŠäº‹é¡¹æ˜¯ä¸€äº›ç®€çŸ­çš„æ–‡å­—è®°å½•ï¼ŒåŠå®Œäº‹ååŸºæœ¬æ²¡ç”¨äº†ï¼Œæ‰€ä»¥åªæœ‰æ°¸ä¹…åˆ é™¤é€‰é¡¹ã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥æ›´æ”¹ç¬”è®°åˆ†ç»„ã€‚</p><p>ï¼ˆ8ï¼‰ åˆ†äº«æ¨¡å—ï¼šç°åœ¨æ˜¯äº’è”ç½‘æ—¶ä»£ï¼Œäººä¸äººä¹‹é—´çš„äº¤æµå˜å¾—è¶Šæ¥è¶Šå®¹æ˜“ã€‚ç”¨æˆ·å¯å°†ç¬”è®°é€šè¿‡ç¤¾äº¤è½¯ä»¶å®ç°ä¸ä»–äººçš„ä¾¿æ·åˆ†äº«ï¼Œè®©ç¬”è®°ä¸å•å•æ˜¯è‡ªå·±æ‰‹æœºä¸Šçš„ç®€å•å­˜å‚¨ã€‚è¿™æ ·å°±å¯ä»¥èŠ‚çœå¤§é‡çš„å¤åˆ¶ç²˜è´´æ—¶é—´ï¼Œé€šè¿‡åˆ†äº«æ¥å£ç›´æ¥å‘é€æ¶ˆæ¯ã€‚</p><p>ï¼ˆ9ï¼‰ æƒé™ç”³è¯·æ¨¡å—ï¼šå®‰å“6.0ç³»ç»Ÿå¼€å§‹å¼•å…¥äº†è¿è¡Œæ—¶æƒé™åŠŸèƒ½ï¼Œå¯¹äºä¸€äº›å±é™©çš„æƒé™ï¼Œä¾‹å¦‚å½•éŸ³ï¼Œè¯»å–æ•°æ®ç­‰ç­‰ï¼Œéœ€è¦å¾—åˆ°ç”¨æˆ·çš„æˆæƒã€‚å¯¹äºæ™®é€šæƒé™ï¼Œæ¯”å¦‚è¯»å–ç½‘ç»œä¿¡æ¯ï¼Œç”±ç³»ç»Ÿè‡ªåŠ¨å®Œæˆæˆæƒã€‚</p><h3 id="ç³»ç»Ÿå„åŠŸèƒ½æ¨¡å—è®¾è®¡"><a href="#ç³»ç»Ÿå„åŠŸèƒ½æ¨¡å—è®¾è®¡" class="headerlink" title="ç³»ç»Ÿå„åŠŸèƒ½æ¨¡å—è®¾è®¡"></a>ç³»ç»Ÿå„åŠŸèƒ½æ¨¡å—è®¾è®¡</h3><h4 id="ç”¨æˆ·ç•Œé¢"><a href="#ç”¨æˆ·ç•Œé¢" class="headerlink" title="ç”¨æˆ·ç•Œé¢"></a>ç”¨æˆ·ç•Œé¢</h4><p>è½¯ä»¶é‡‡ç”¨Material Designè¯­è¨€è¿›è¡Œç•Œé¢è®¾è®¡ã€‚ç”¨æˆ·ç•Œé¢ä¸»è¦åˆ†ä¸ºäº”å¤§éƒ¨åˆ†ã€‚</p><ul><li><p>ç”¨æˆ·ä¸»ç•Œé¢ï¼šé‡‡ç”¨<strong>DrawerLayout</strong>ä¸ºæ€»ä½“å¸ƒå±€æ¡†æ¶ã€‚ä¸ºäº†è®©å¾…åŠäº‹é¡¹è¿™ä¸ªåŠŸèƒ½æ›´åŠ é«˜æ•ˆåœ°æä¾›ç»™ç”¨æˆ·ä½¿ç”¨ï¼Œå°†å…¶å•ç‹¬ç‹¬ç«‹æˆä¸€ä¸ªåŠŸèƒ½æ¨¡å—ï¼Œä¸å’Œç¬”è®°ç¼–è¾‘å™¨ç»“åˆåœ¨ä¸€èµ·ï¼Œç»™ç”¨æˆ·æä¾›æ›´åŠ ä¾¿æ·å’Œå¿«é€Ÿçš„è®°å½•ã€‚åˆ©ç”¨<strong>ViewPager</strong>å’Œ<strong>TabLayout</strong>å®ç°ç¬”è®°ä¸»ç•Œé¢å’Œå¾…åŠäº‹é¡¹ä¸»ç•Œé¢çš„å¹³æ»‘åˆ‡æ¢ã€‚ä¿¡æ¯çš„æ»šåŠ¨é¡µé¢ç»“åˆ<strong>RecycleView</strong>ã€‚åŒæ—¶ï¼Œç»“åˆ<strong>FloatingActionButton</strong>ï¼Œæä¾›è¯­éŸ³è¾“å…¥å’Œé”®ç›˜è¾“å…¥çš„å…¥å£ã€‚</p></li><li><p>ä¾§è¾¹æ ï¼šé‡‡ç”¨<strong>NavigationView</strong>ä¸ºå¸ƒå±€æ¡†æ¶ï¼Œå’Œä¸»ç•Œé¢çš„<strong>DrawerLayout</strong>æ¡†æ¶é…åˆä½¿ç”¨ã€‚æä¾›çš„æ˜¯ç¬”è®°çš„åˆ†ç»„åŠŸèƒ½å’Œåšæœäº‘çš„ç™»å½•ç•Œé¢ã€‚ç”¨æˆ·ç™»å½•åšæœäº‘è´¦å·åï¼Œæ‰èƒ½å°†æ•°æ®åŒæ­¥åˆ°äº‘ç«¯ã€‚è´¦å·å’Œå¯†ç ä¿å­˜åœ¨<strong>SharedPreferences</strong>é‡Œé¢ã€‚</p></li><li><p>ç¬”è®°çš„ç¼–è¾‘ç•Œé¢ï¼šä¸»è¦é‡‡ç”¨<strong>EditText</strong>å’Œ<strong>ScrollView</strong>ç»„ä»¶ï¼Œå‰è€…æ˜¯ä¸ºäº†è¾“å…¥ç¬”è®°å†…å®¹ï¼Œåè€…æ˜¯ä¸ºäº†æ›´æµç•…åœ°æŸ¥çœ‹ç¼–è¾‘å†…å®¹ï¼Œä¾¿äºä¿®æ”¹ã€‚æ­¤å¤–ï¼Œç¼–è¾‘ç•Œé¢ä¸‹ä¾§ä¼šæä¾›å¤šä¸ª<strong>ImageButton</strong>æŒ‰é’®ï¼Œå½“è¾“å…¥æ³•å”¤é†’æ—¶ï¼Œ<strong>ImageButton</strong>ä¹Ÿä¼šå¼¹å‡ºæ¥ï¼Œç»™ç”¨æˆ·æä¾›è¯­éŸ³è¾“å…¥ã€å›¾ç‰‡æ’å…¥ã€åŠ æ ‡é¢˜ã€ç»™æ–‡å­—åŠ ç²—å’Œä¿®æ”¹æ–‡å­—çš„é¢œè‰²ä»¥çªå‡ºé‡ç‚¹çš„åŠŸèƒ½ã€‚</p></li><li><p>ç¬”è®°çš„æµè§ˆç•Œé¢ï¼šä¸»è¦é‡‡ç”¨<strong>ScrollView</strong>å’Œ<strong>TextView</strong>ç»„ä»¶ï¼Œå‰è€…ä¸ºæµç•…æ»šåŠ¨ç¬”è®°å†…å®¹æä¾›ä¿è¯ï¼Œåè€…ç”¨æ¥æ˜¾ç¤ºç¬”è®°å†…å®¹ã€‚é‡‡ç”¨<strong>ContentLoadingProgressBar</strong>ç»„ä»¶æ¥è¡¨ç¤ºç¬”è®°åŠ è½½è¿‡ç¨‹ï¼Œå› ä¸ºå½“åŠ è½½äº‘ç«¯ç¬”è®°æ—¶ï¼Œæœ¬åœ°æ²¡æœ‰ç›¸åº”çš„å¤šåª’ä½“èµ„æºæ—¶ï¼Œéœ€è¦ä»åšæœäº‘ä¸‹è½½ï¼Œå­˜åœ¨ç¼“å†²æ—¶é—´ã€‚æµè§ˆç•Œé¢çš„å³ä¸Šè§’æ˜¯èœå•æ ï¼Œæä¾›åˆ é™¤ç¬”è®°ã€åˆ†äº«ç¬”è®°ã€æé†’ç­‰åŠŸèƒ½ã€‚</p></li><li><p>å¾…åŠäº‹é¡¹çš„ç¼–è¾‘å’Œæµè§ˆç•Œé¢ï¼šç”±äºå¾…åŠäº‹é¡¹åŠŸèƒ½åªæ˜¯æœåŠ¡äºç®€çŸ­çš„æ–‡å­—è®°å½•ï¼Œæ‰€ä»¥ç¼–è¾‘å’Œæµè§ˆç•Œé¢åˆäºŒä¸ºä¸€ï¼Œç»Ÿä¸€é‡‡ç”¨<strong>PopupWindow</strong>ç»„ä»¶ï¼Œé‡Œé¢ä¹ŸåŒ…å«äº†<strong>EditText</strong>ç»„ä»¶ï¼Œç”¨äºæ–‡å­—è¾“å…¥å’Œæ˜¾ç¤ºã€‚åŒæ—¶ï¼Œè¿˜æœ‰æé†’æŒ‰é’®ï¼Œç”¨äºäº‹ä»¶æé†’ã€‚</p></li></ul><h4 id="è¾“å…¥æ¨¡å—"><a href="#è¾“å…¥æ¨¡å—" class="headerlink" title="è¾“å…¥æ¨¡å—"></a>è¾“å…¥æ¨¡å—</h4><p>ç¬”è®°ç¼–è¾‘å™¨é‡‡ç”¨<strong>EditText</strong>ç»„ä»¶ï¼Œç»“åˆ<strong>SpannableString</strong>ç±»å®ç°å¯Œæ–‡æœ¬åŠŸèƒ½ï¼Œæ¯”å¦‚æ·»åŠ æ ‡é¢˜å’ŒåŠ ç²—æ–‡å­—ç­‰ç­‰ã€‚ç»“åˆ<strong>ImageSpan</strong>ç±»å®ç°å›¾ç‰‡æ˜¾ç¤ºã€‚æ–‡æœ¬å’Œå¤šåª’ä½“æ•°æ®åˆ†åˆ«ä¿å­˜åˆ°SQLiteæ•°æ®åº“å’Œæœ¬åœ°æ–‡ä»¶å¤¹ã€‚è¯­éŸ³è¾“å…¥é‡‡ç”¨è®¯é£è¯†åˆ«å¼•æ“ï¼Œå®ç°å®æ—¶è¯­éŸ³è¯†åˆ«è½¬æ¢æˆæ–‡å­—ï¼ŒåŒæ—¶æŠŠè¯­éŸ³æ–‡ä»¶ä¿å­˜åˆ°æœ¬åœ°ï¼Œç»“åˆ<strong>MediaPlayer</strong>ç±»å¯ä»¥å®ç°è¯­éŸ³æ’­æ”¾ã€‚æ’å…¥å›¾ç‰‡é‡‡ç”¨çŸ¥ä¹çš„å¼€æºæ¡†æ¶<strong>matisse</strong>ï¼Œç»“åˆå¼€æºæ¡†æ¶<strong>Glide</strong>å®ç°å›¾ç‰‡åŠ è½½ã€‚å›¾ç‰‡å‹ç¼©é‡‡ç”¨é²ç­å‹ç¼©æ¡†æ¶ã€‚å›¾ç‰‡é¢„è§ˆé‡‡ç”¨<strong>MNImageBrowser</strong>å¼€æºæ¡†æ¶ï¼Œè¿™é‡Œä¹Ÿé‡‡ç”¨Glideä½œä¸ºå›¾ç‰‡åŠ è½½å¼•æ“ï¼Œå…¶æ”¯æŒå•å‡»å’Œé•¿æŒ‰ç›‘å¬ï¼Œå¯ä»¥åœ¨è¿™é‡Œé¢å®ç°åˆ†äº«å’Œä¿å­˜å›¾ç‰‡åˆ°æœ¬åœ°çš„åŠŸèƒ½ã€‚è¯­éŸ³å’Œå›¾ç‰‡çš„ç‚¹å‡»äº‹ä»¶ä½¿ç”¨<strong>ClickableSpan</strong>ç±»ã€‚å…·ä½“çš„è¯­éŸ³è¾“å…¥æµç¨‹å’Œå›¾ç‰‡æ’å…¥æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p>å¾…åŠäº‹é¡¹çš„è¾“å…¥åªæ”¯æŒçº¯æ–‡æœ¬è¾“å…¥ï¼Œé‡‡ç”¨EditTextç»„ä»¶å³å¯ï¼Œå¯ä»¥é€šè¿‡è¯­éŸ³æˆ–è€…é”®ç›˜è¾“å…¥ï¼Œå½“è¯­éŸ³è¾“å…¥æ—¶ï¼Œè¯­éŸ³æ–‡ä»¶ä¸ä¼šè¢«ä¿å­˜ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210619194139.png" alt="è¯­éŸ³è¾“å…¥æµç¨‹å›¾"></p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210619194248.png" alt="å›¾ç‰‡æ’å…¥æµç¨‹å›¾"></p><h4 id="æ˜¾ç¤ºæ¨¡å—"><a href="#æ˜¾ç¤ºæ¨¡å—" class="headerlink" title="æ˜¾ç¤ºæ¨¡å—"></a>æ˜¾ç¤ºæ¨¡å—</h4><p>ç¬”è®°æ˜¾ç¤ºéœ€è¦æ”¯æŒå¯Œæ–‡æœ¬æ˜¾ç¤ºï¼Œæ‰€ä»¥è¦ç»“åˆ<strong>SpannableStringBuilder</strong>ç±»ã€‚é€šè¿‡æŠŠç¬”è®°å†…å®¹çš„<strong>String</strong>å­—ç¬¦ä¸²è½¬æ¢æˆ<strong>SpannableStringBuilder</strong>å¯Œæ–‡æœ¬è¿›è¡Œæ˜¾ç¤ºã€‚è¿™è¿‡ç¨‹ä¹Ÿéœ€è¦ç”¨åˆ°<strong>ImageSpan</strong>ç±»ã€<strong>ClickableSpan</strong>ç±»ã€<strong>MediaPlayer</strong>ç±»ã€<strong>MNImageBrowser</strong>å’Œ<strong>Glide</strong>å¼€æºæ¡†æ¶ã€‚é¦–å…ˆé€šè¿‡æ­£åˆ™è¡¨è¾¾å¼æŸ¥æ‰¾å‡ºè¯­éŸ³å’Œå›¾ç‰‡å¹¶è®¾ç½®ç›‘å¬ï¼Œç„¶åé€šè¿‡ååºåˆ—åŒ–æ¢å¤å¯Œæ–‡æœ¬æ ·å¼ï¼Œæœ€åé€šè¿‡<strong>TextView</strong>æ˜¾ç¤ºå‡ºæ¥ã€‚å¾…åŠäº‹é¡¹ç”±äºåªæœ‰çº¯æ–‡æœ¬ï¼Œä¸éœ€è¦ç»è¿‡ä»»ä½•å¤„ç†ï¼Œå³å¯ä»¥é€šè¿‡<strong>EditText</strong>æ˜¾ç¤ºå‡ºæ¥ã€‚ç¬”è®°å†…å®¹æ˜¾ç¤ºè¿‡ç¨‹å¦‚å›¾æ‰€ç¤ºã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210619194353.png" alt="ç¬”è®°å†…å®¹æ˜¾ç¤ºæµç¨‹å›¾"></p><h4 id="æé†’æ¨¡å—"><a href="#æé†’æ¨¡å—" class="headerlink" title="æé†’æ¨¡å—"></a>æé†’æ¨¡å—</h4><p>æé†’æ¨¡å—åŒ…æ‹¬æ—¥å†æé†’å’Œåº”ç”¨å†…è¯­éŸ³æé†’ã€‚æ—¥å†æé†’ç›´æ¥ä»åº”ç”¨æ‰“å¼€æ—¥å†è®¾ç½®æé†’æ—¶é—´å°±è¡Œï¼Œå¹¶ä¼ é€’ç›¸å…³ä¿¡æ¯ï¼Œè¿™ä¸ªç”±ç³»ç»Ÿæ¥ä¿è¯æ—¶æ•ˆæ€§ï¼Œä¸€èˆ¬ä¸ä¼šæœ‰è€½æã€‚åº”ç”¨å†…è¯­éŸ³æé†’é‡‡ç”¨<strong>AlarmManager</strong>ç»„ä»¶æ¥è®¾ç½®ï¼Œåˆ°ç‚¹ä¹‹åé‡‡ç”¨<strong>TextToSpeech</strong>ç»„ä»¶æ¥è¿›è¡Œè¯­éŸ³æ’­æŠ¥ï¼ŒåŒæ—¶é€šçŸ¥æ ä¼šå¼¹å‡ºå…·ä½“æ¶ˆæ¯ã€‚è®¾ç½®æ—¥å†äº‹ä»¶å’Œåº”ç”¨å†…è¯­éŸ³æé†’è¿‡ç¨‹å¦‚å›¾æ‰€ç¤ºã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210619194443.png" alt="è®¾ç½®æ—¥å†äº‹ä»¶æµç¨‹å›¾"></p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210619194511.png" alt="è®¾ç½®è¯­éŸ³æé†’æµç¨‹å›¾"></p><h4 id="æ•°æ®åŒæ­¥"><a href="#æ•°æ®åŒæ­¥" class="headerlink" title="æ•°æ®åŒæ­¥"></a>æ•°æ®åŒæ­¥</h4><p>æ•°æ®åŒæ­¥çš„äº‘ç«¯æœåŠ¡å™¨é‡‡ç”¨æ”¯æŒ<strong>WebDav</strong>åè®®çš„åšæœäº‘ã€‚å®‰å“å®¢æˆ·ç«¯é‡‡ç”¨<strong>sardine-android</strong>å¼€æºæ¡†æ¶ï¼Œä½¿å¤šåŠŸèƒ½è®°äº‹æœ¬APPæ”¯æŒWebDavåè®®ï¼Œè®©æœ¬åœ°å®¢æˆ·ç«¯å¯ä»¥å’Œæ”¯æŒWebDavåè®®çš„åšæœäº‘é€šä¿¡ï¼Œä»è€Œæ”¯æŒåŒæ­¥æ•°æ®ã€‚è¿™æ ·çš„å¥½å¤„å°±æ˜¯å¼€å‘è€…ä¸å¿…å†å¦å¤–å¼€å‘æœåŠ¡å™¨ç«¯ç¨‹åºï¼Œç”¨æˆ·åªéœ€è¦åˆ°åšæœäº‘æ³¨å†Œè´¦å·å°±è¡Œï¼Œæ•°æ®ç”±åšæœäº‘è¿›è¡Œä¿ç®¡ã€‚å…·ä½“æ•°æ®åŒæ­¥è¿‡ç¨‹å¦‚å›¾æ‰€ç¤ºã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210619194958.png" alt="æ•°æ®åŒæ­¥æµç¨‹å›¾"></p><h4 id="æœç´¢æ¨¡å—"><a href="#æœç´¢æ¨¡å—" class="headerlink" title="æœç´¢æ¨¡å—"></a>æœç´¢æ¨¡å—</h4><p>ç”¨æˆ·ä¸»ç•Œé¢ä¼šæœ‰ä¸ª<strong>SearchView</strong>ç»„ä»¶ï¼Œç”¨äºæŸ¥æ‰¾æ‰€éœ€è¦çš„æ•°æ®ã€‚å½“ç”¨æˆ·è¾“å…¥æ•°æ®åï¼Œåå°çº¿ç¨‹å°±ä¼šåˆ°æ•°æ®åº“æŸ¥æ‰¾ç›¸åº”ä¿¡æ¯ï¼Œç»“æœä¼šè¿”å›åˆ°<strong>RecycleView</strong>æ˜¾ç¤ºã€‚å½“é€€å‡ºæœç´¢æ—¶ï¼Œåˆä¼šé‡æ–°æ˜¾ç¤ºä¸»ç•Œé¢å†…å®¹ã€‚å…·ä½“æœç´¢è¿‡ç¨‹å¦‚å›¾æ‰€ç¤ºã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210619195236.png" alt="æœç´¢æµç¨‹å›¾"></p><h4 id="ç®¡ç†æ¨¡å—"><a href="#ç®¡ç†æ¨¡å—" class="headerlink" title="ç®¡ç†æ¨¡å—"></a>ç®¡ç†æ¨¡å—</h4><p>ç¬”è®°å’Œå¾…åŠäº‹é¡¹çš„ç®¡ç†ï¼Œä¸»è¦å°±æ˜¯å¯¹æ•°æ®åº“çš„å¢åˆ æ”¹æŸ¥ï¼Œè¿™é‡Œä¼šç”¨åˆ°å¼€æºæ¡†æ¶<strong>LitePal</strong>æ¥å¯¹æ•°æ®åº“è¿›è¡Œæ“ä½œã€‚å¯¹äºç¬”è®°çš„åˆ†ç»„åŠŸèƒ½ï¼Œä¼šåœ¨ç¬”è®°çš„æ•°æ®è¡¨é‡Œå¢åŠ ä¸€ä¸ªå­—æ®µï¼Œç”¨æ¥åˆ¤æ–­å½“å‰ç¬”è®°ä½äºå“ªä¸€ä¸ªç»„ã€‚è¿™é‡Œï¼Œä¸»è¦åˆ†æˆæœªåˆ†ç»„ã€ç”Ÿæ´»ã€å·¥ä½œå’Œå›æ”¶ç«™å››ä¸ªç»„ï¼Œæ–¹ä¾¿ç”¨æˆ·è‡ªä¸»é€‰æ‹©ç¬”è®°çš„åˆ†ç±»ï¼ŒåŒæ—¶è¿˜å¯ä»¥åœ¨ç¬”è®°æŸ¥çœ‹ç•Œé¢æ›´æ”¹åˆ†ç»„ã€‚ç”±äºå¾…åŠäº‹é¡¹æ˜¯æ¯”è¾ƒç®€å•çš„æ–‡å­—è®°å½•ï¼Œä¸æä¾›ä»»ä½•åˆ†ç»„ã€‚ç¬”è®°çš„å›æ”¶ã€æ¢å¤å’Œæ›´æ”¹åˆ†ç»„è¿‡ç¨‹å¦‚å›¾æ‰€ç¤ºã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210619195332.png" alt="image-20210619195332112"></p><h4 id="åˆ†äº«æ¨¡å—"><a href="#åˆ†äº«æ¨¡å—" class="headerlink" title="åˆ†äº«æ¨¡å—"></a>åˆ†äº«æ¨¡å—</h4><p>é€šè¿‡ä½¿ç”¨<strong>Android Sharesheet</strong>æ¥å®ç°å°†ç¬”è®°å†…å®¹æˆ–è€…å›¾ç‰‡å‘é€åˆ°åº”ç”¨å¤–éƒ¨ï¼Œæ¯”å¦‚å¾®ä¿¡ã€QQç­‰ç­‰ã€‚ç¬”è®°åˆ†äº«å†…å®¹å’Œå›¾ç‰‡è¿‡ç¨‹å¦‚å›¾æ‰€ç¤ºã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210619195410.png" alt="image-20210619195410709"></p><h4 id="æƒé™ç”³è¯·æ¨¡å—"><a href="#æƒé™ç”³è¯·æ¨¡å—" class="headerlink" title="æƒé™ç”³è¯·æ¨¡å—"></a>æƒé™ç”³è¯·æ¨¡å—</h4><p>æ™®é€šæƒé™éœ€è¦åœ¨AndroidManifest.xmlæ·»åŠ æƒé™å£°æ˜ï¼Œå¯¹äºå±é™©æƒé™ï¼Œé™¤äº†æ·»åŠ å£°æ˜å¤–ï¼Œè¿˜éœ€è¦ç»è¿‡ç”¨æˆ·æˆæƒå¤„ç†ã€‚å…·ä½“æˆæƒè¿‡ç¨‹å¦‚å›¾æ‰€ç¤ºã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210619195433.png" alt="è½¯ä»¶æˆæƒæµç¨‹å›¾"></p><h4 id="æ•°æ®åº“è®¾è®¡"><a href="#æ•°æ®åº“è®¾è®¡" class="headerlink" title="æ•°æ®åº“è®¾è®¡"></a>æ•°æ®åº“è®¾è®¡</h4><p>é‡‡ç”¨<strong>SQLite</strong>ä½œä¸ºè½¯ä»¶æ•°æ®åº“ã€‚</p><p>ç¬”è®°è¡¨Noteï¼šç”¨äºè®°å½•ç¬”è®°çš„å„ç§ä¿¡æ¯ï¼Œä¾‹å¦‚ç¬”è®°å†…å®¹ã€ç¬”è®°åˆ›å»ºæ—¶é—´ã€ç¬”è®°æ ‡é¢˜ç­‰ç­‰ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰ç”¨äºåšæœäº‘åŒæ­¥çš„ä¿¡æ¯å­—æ®µã€‚</p><table><thead><tr><th>å­—æ®µ</th><th>ç±»å‹</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>id</td><td>int</td><td>ç¬”è®°å”¯ä¸€ç¼–å·ã€‚</td></tr><tr><td>content</td><td>String</td><td>ç¬”è®°å†…å®¹ã€‚</td></tr><tr><td>groupName</td><td>String</td><td>ç¬”è®°æ‰€å±ç»„åå­—ã€‚</td></tr><tr><td>createTime</td><td>String</td><td>ç¬”è®°åˆ›å»ºæ—¶é—´ã€‚</td></tr><tr><td>createdTime</td><td>long</td><td>ç¬”è®°åˆ›å»ºæ—¶é—´ï¼Œç”¨äºæœ¬åœ°å’Œäº‘ç«¯æ•°æ®çš„å”¯ä¸€æ ‡è¯†ã€‚</td></tr><tr><td>updateTime</td><td>String</td><td>ç¬”è®°æ›´æ–°æ—¶é—´ï¼Œç”¨æ¥æ˜¾ç¤ºã€‚</td></tr><tr><td>updatedTime</td><td>long</td><td>ç¬”è®°æ›´æ–°æ—¶é—´ï¼Œç”¨æ¥æ’åºã€‚</td></tr><tr><td>title</td><td>String</td><td>ç¬”è®°æ ‡é¢˜ã€‚</td></tr><tr><td>subContent</td><td>String</td><td>ç¬”è®°éƒ¨åˆ†å†…å®¹ã€‚</td></tr><tr><td>restoreSpans</td><td>byte[]</td><td>ä¿å­˜å¯Œæ–‡æœ¬çš„æ ·å¼äºŒè¿›åˆ¶æ•°æ®ã€‚</td></tr><tr><td>timeRemind</td><td>long</td><td>æé†’æ—¶é—´ã€‚</td></tr><tr><td>status</td><td>int</td><td>ç”¨æ¥æ ‡è¯†ç¬”è®°çš„çŠ¶æ€ï¼Œ0ï¼šæœ¬åœ°æ–°å¢ï¼Œ -1ï¼šæ ‡è®°åˆ é™¤ï¼Œ1ï¼šæœ¬åœ°æ›´æ–°ï¼Œ2ï¼šå·²ç»åŒæ­¥ã€‚</td></tr><tr><td>anchor</td><td>long</td><td>è®°å½•æœ€è¿‘ä¸€æ¬¡åŒæ­¥æ—¶é—´ã€‚</td></tr></tbody></table><p>å¾…åŠäº‹é¡¹è¡¨Todoï¼šç”¨äºè®°å½•å¾…åŠäº‹é¡¹çš„å„ç§ä¿¡æ¯ï¼Œä¾‹å¦‚å¾…åŠäº‹é¡¹å†…å®¹ã€åˆ›å»ºæ—¶é—´ç­‰ç­‰ã€‚æ­¤å¤–ï¼Œä¹Ÿæœ‰ç”¨äºåšæœäº‘åŒæ­¥çš„ä¿¡æ¯å­—æ®µã€‚</p><table><thead><tr><th>å­—æ®µ</th><th>ç±»å‹</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>id</td><td>int</td><td>å¾…åŠäº‹é¡¹å”¯ä¸€ç¼–å·ã€‚</td></tr><tr><td>checkBoxFlag</td><td>boolean</td><td>å¾…åŠäº‹é¡¹æ˜¯å¦å®Œæˆçš„æ ‡å¿—ã€‚</td></tr><tr><td>content</td><td>String</td><td>å¾…åŠäº‹é¡¹å†…å®¹ã€‚</td></tr><tr><td>createTime</td><td>long</td><td>å¾…åŠäº‹é¡¹åˆ›å»ºæ—¶é—´ï¼Œç”¨äºæœ¬åœ°å’Œäº‘ç«¯çš„å”¯ä¸€æ ‡è¯†ã€‚</td></tr><tr><td>updatedTime</td><td>long</td><td>å¾…åŠäº‹é¡¹åˆ›å»ºæ—¶é—´ï¼Œç”¨äºæ’åºã€‚</td></tr><tr><td>updateTime</td><td>String</td><td>å¾…åŠäº‹é¡¹åˆ›å»ºæ—¶é—´ï¼Œç”¨äºæ˜¾ç¤ºã€‚</td></tr><tr><td>timeRemind</td><td>long</td><td>å¾…åŠäº‹é¡¹æé†’æ—¶é—´ã€‚</td></tr><tr><td>status</td><td>int</td><td>ç”¨æ¥æ ‡è¯†å¾…åŠäº‹é¡¹çš„çŠ¶æ€ï¼Œæ„æ€å’Œç¬”è®°è¡¨ä¸€æ ·ã€‚</td></tr><tr><td>anchor</td><td>long</td><td>è®°å½•æœ€è¿‘ä¸€æ¬¡åŒæ­¥æ—¶é—´ã€‚</td></tr></tbody></table><p>å¤šåª’ä½“è®°å½•è¡¨MediaForNoteï¼šç”¨äºç¬”è®°çš„å›¾ç‰‡å’Œè¯­éŸ³èµ„æºçš„åšæœäº‘åŒæ­¥ã€‚</p><table><thead><tr><th>å­—æ®µ</th><th>ç±»å‹</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>id</td><td>int</td><td>å¤šåª’ä½“èµ„æºå”¯ä¸€æ ‡è¯†ã€‚</td></tr><tr><td>mediaName</td><td>String</td><td>å¤šåª’ä½“èµ„æºåå­—ã€‚</td></tr><tr><td>noteCreateTime</td><td>long</td><td>ç¬”è®°åˆ›å»ºæ—¶é—´ï¼Œç”¨æ¥æ ‡è¯†å¤šåª’ä½“èµ„æºå±äºå“ªä¸€ä¸ªç¬”è®°ã€‚</td></tr><tr><td>isPhoto</td><td>boolean</td><td>åŒºåˆ†å›¾ç‰‡å’Œè¯­éŸ³ï¼Œä»è€ŒåŒºåˆ†ä¸Šä¼ è·¯å¾„ã€‚</td></tr><tr><td>status</td><td>int</td><td>ç”¨æ¥æ ‡è¯†è®°å½•çš„çŠ¶æ€ï¼Œæ„æ€å’Œç¬”è®°è¡¨ä¸€æ ·ã€‚</td></tr><tr><td>anchor</td><td>long</td><td>è®°å½•æœ€è¿‘ä¸€æ¬¡åŒæ­¥æ—¶é—´ã€‚</td></tr></tbody></table><h2 id="å¤šåŠŸèƒ½è®°äº‹æœ¬åŠŸèƒ½æ¨¡å—å®ç°"><a href="#å¤šåŠŸèƒ½è®°äº‹æœ¬åŠŸèƒ½æ¨¡å—å®ç°" class="headerlink" title="å¤šåŠŸèƒ½è®°äº‹æœ¬åŠŸèƒ½æ¨¡å—å®ç°"></a>å¤šåŠŸèƒ½è®°äº‹æœ¬åŠŸèƒ½æ¨¡å—å®ç°</h2><h3 id="ç³»ç»Ÿå„åŠŸèƒ½æ¨¡å—çš„å®ç°"><a href="#ç³»ç»Ÿå„åŠŸèƒ½æ¨¡å—çš„å®ç°" class="headerlink" title="ç³»ç»Ÿå„åŠŸèƒ½æ¨¡å—çš„å®ç°"></a>ç³»ç»Ÿå„åŠŸèƒ½æ¨¡å—çš„å®ç°</h3><h4 id="ç”¨æˆ·ç•Œé¢-1"><a href="#ç”¨æˆ·ç•Œé¢-1" class="headerlink" title="ç”¨æˆ·ç•Œé¢"></a>ç”¨æˆ·ç•Œé¢</h4><p>æ•´ä¸ªè½¯ä»¶çš„UIç•Œé¢æ˜¯åŸºäºMaterial Designè®¾è®¡çš„ã€‚</p><p>ç”¨æˆ·ä¸»ç•Œé¢ï¼šç”¨<strong>DrawerLayout</strong>ä½œä¸ºæ•´ä¸ªç•Œé¢çš„æ ¹å¸ƒå±€ï¼Œé‡Œé¢ç”±<strong>CoordinatorLayout</strong>å’Œ<strong>NavigationView</strong>ç»„æˆã€‚<strong>CoordinatorLayout</strong>ä¸»è¦åŒ…æ‹¬äº†<strong>Toolbar</strong>ã€<strong>TabLayout</strong>å’Œ<strong>ViewPager</strong>ï¼Œå…¶ä¸­<strong>TabLayout</strong>ã€<strong>ViewPager</strong>åŠ ä¸Š<strong>Fragment</strong>çš„ç»„åˆèƒ½è®©ç¬”è®°ç•Œé¢å’Œå¾…åŠäº‹é¡¹ç•Œé¢å®ç°å¹³æ»‘åˆ‡æ¢ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p><p>ç¬¬ä¸€ï¼Œåˆ›å»ºå­˜å‚¨<strong>NoteFragment</strong>å’Œ<strong>TodoFragment</strong>ç¢ç‰‡å®ä¾‹çš„åˆ—è¡¨ï¼›</p><p>ç¬¬äºŒï¼Œåˆ›å»ºåŸºäº<strong>FragmentPagerAdapter</strong>çš„<strong>MyAdapter</strong>çš„æ‰©å±•ç±»å®ä¾‹ï¼›</p><p>ç¬¬ä¸‰ï¼Œå°†<strong>ViewPager</strong>å’Œ<strong>TabLayout</strong>å…³è”èµ·æ¥ã€‚</p><p>ç¬¬å››ï¼Œè®¾ç½®<strong>TabLayout</strong>çš„å±æ€§ã€‚ä¸ºäº†ç›‘å¬ä¸åŒçš„ç¢ç‰‡é¡µé¢ï¼Œå¯ä»¥è®¾ç½®<strong>ViewPager</strong>ç›‘å¬å™¨ï¼Œåœ¨<strong>onPageSelected</strong>æ–¹æ³•é‡Œåˆ¤æ–­å½“å‰ç¢ç‰‡æ˜¯<strong>NoteFragment</strong>è¿˜æ˜¯<strong>TodoFragment</strong>ã€‚ï¼Œä»è€Œåˆ‡æ¢å³ä¸Šè§’çš„èœå•æ ã€‚<strong>NoteFragment</strong>å’Œ<strong>TodoFragment</strong>ç¢ç‰‡é‡Œé¢éƒ½åŒ…å«äº†<strong>SearchView</strong>ã€<strong>RecyclerView</strong>å’Œä¸¤ä¸ª<strong>FloatingActionButton</strong>ç»„ä»¶ã€‚<strong>SearchView</strong>ä¾›ç”¨æˆ·æœç´¢ä¿¡æ¯ï¼Œ<strong>RecyclerView</strong>æä¾›æ»šåŠ¨æ˜¾ç¤ºåŠŸèƒ½ï¼Œå…¶ä¸­ç¬”è®°æ”¯æŒç€‘å¸ƒæµå¸ƒå±€å’Œåˆ—è¡¨å¸ƒå±€ï¼Œå¾…åŠäº‹é¡¹åªæ”¯æŒåˆ—è¡¨å¸ƒå±€ã€‚ä¸ºäº†å®ç°æ»šåŠ¨æ˜¾ç¤ºï¼Œéœ€è¦å®šä¹‰ä¸¤ä¸ªé€‚é…å™¨ï¼Œåˆ†åˆ«æ˜¯<strong>NoteAdapter</strong>å’Œ<strong>TodoAdapter</strong>ï¼Œ<strong>NoteAdapter</strong>ä¸ºäº†æ”¯æŒç€‘å¸ƒæµå¸ƒå±€å’Œåˆ—è¡¨å¸ƒå±€ï¼Œéœ€è¦æ ¹æ®æƒ…å†µå¼•å…¥ä¸åŒçš„å¸ƒå±€æ–‡ä»¶ï¼Œè€Œ<strong>TodoAdapter</strong>åªéœ€è¦ä¸€ä¸ªå¸ƒå±€æ–‡ä»¶å³å¯ã€‚åŒæ—¶ï¼Œä¸ºäº†æ”¯æŒå•å‡»æ‰“å¼€ç¬”è®°æˆ–è€…å¾…åŠäº‹é¡¹ï¼Œé•¿æŒ‰æ¡ç›®å¼¹å‡ºåˆ é™¤é€‰é¡¹ï¼Œéœ€è¦åœ¨é€‚é…å™¨ç±»é‡Œé¢å®ç°<strong>onClick</strong>å’Œ<strong>onLongClick</strong>æ–¹æ³•ã€‚<strong>FloatingActionButton</strong>æä¾›è¯­éŸ³è¾“å…¥å’Œé”®ç›˜è¾“å…¥çš„å…¥å£ã€‚ç¬”è®°çš„åˆ—è¡¨ç•Œé¢å’Œç€‘å¸ƒæµç•Œé¢ï¼Œå¾…åŠäº‹é¡¹åˆ—è¡¨ç•Œé¢å¦‚å›¾æ‰€ç¤ºã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210619195701.png" alt="image-20210619195701525"></p><p>ä¾§è¾¹æ ï¼šä¾æ‰˜ç”¨æˆ·ä¸»ç•Œé¢çš„<strong>DrawerLayout</strong>æ ¹å¸ƒå±€ï¼Œå¼•å…¥<strong>NavigationView</strong>ç»„ä»¶ï¼Œé‡Œé¢æœ‰ä¸¤ä¸ªé‡è¦å‚æ•°<strong>app:headerLayout</strong>å’Œ<strong>app:menu</strong>ï¼Œå‰è€…å¼•å…¥çš„å¸ƒå±€åŒ…å«äº†ç”¨äºæ˜¾ç¤ºåšæœäº‘å“ç‰Œå›¾ç‰‡çš„å¼€æºç»„ä»¶<strong>CircleImageView</strong>ã€ç”¨äºè¾“å…¥ç”¨æˆ·åå’Œå¯†ç çš„ä¸¤ä¸ª<strong>EditText</strong>ç»„ä»¶å’Œç”¨äºç™»å½•åšæœäº‘çš„<strong>Button</strong>ã€‚åè€…å¼•å…¥çš„èœå•åŒ…å«äº†ç¬”è®°çš„åˆ†ç»„é€‰é¡¹ã€‚ä¾§è¾¹æ ç•Œé¢å¦‚å›¾æ‰€ç¤ºã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210619195818.png" alt="ä¾§è¾¹æ ç•Œé¢"></p><p>ç¬”è®°çš„ç¼–è¾‘ç•Œé¢ï¼šä»¥<strong>CoordinatorLayout</strong>ä¸ºæ ¹å¸ƒå±€ï¼Œé‡Œé¢ä¸»è¦åŒ…æ‹¬<strong>Toolbar</strong>ã€<strong>ScrollView</strong>å’Œäº”ä¸ª<strong>ImageButton</strong>æŒ‰é’®ã€‚<strong>ScrollView</strong>é‡Œé¢ç»§ç»­åŒ…å«äº†<strong>EditText</strong>ç»„ä»¶ï¼Œå½“å…¶è·å¾—è¾“å…¥ç„¦ç‚¹æ—¶ï¼Œè¾“å…¥æ³•å’Œäº”ä¸ª<strong>ImageButton</strong>ä¼šä¸€èµ·å¼¹å‡ºæ¥ï¼Œä¾›ç”¨æˆ·è¾“å…¥æ–‡å­—ã€è¯­éŸ³è¾“å…¥ã€æ’å…¥å›¾ç‰‡ç­‰ç­‰ã€‚ç¬”è®°ç¼–è¾‘ç•Œé¢å¦‚å›¾æ‰€ç¤ºã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210619195900.png" alt="ç¬”è®°ç¼–è¾‘ç•Œé¢"></p><p>ç¬”è®°çš„æµè§ˆç•Œé¢ï¼šä»¥<strong>CoordinatorLayout</strong>ä¸ºæ ¹å¸ƒå±€ï¼Œä¸»è¦åŒ…å«äº†<strong>Toolbar</strong>ã€<strong>FloatingActionButton</strong>å’Œ<strong>LinearLayout</strong>å¸ƒå±€ã€‚<strong>FloatingActionButton</strong>æä¾›æ›´æ”¹ç¬”è®°çš„å…¥å£ï¼Œ<strong>LinearLayout</strong>å¸ƒå±€åˆåŒ…å«äº†ä¸‰æ–¹é¢å†…å®¹ï¼Œç¬¬ä¸€å°±æ˜¯åŒ…å«äº†ç”¨äºæ˜¾ç¤ºç¬”è®°æ›´æ”¹æ—¶é—´å’Œæé†’æ—¶é—´çš„ä¸¤ä¸ª<strong>TextView</strong>çš„<strong>LinearLayout</strong>å¸ƒå±€ï¼Œç¬¬äºŒå°±æ˜¯<strong>ContentLoadingProgressBar</strong>ç»„ä»¶ï¼Œæ˜¾ç¤ºç¬”è®°åŠ è½½è¿‡ç¨‹ï¼Œç¬¬ä¸‰å°±æ˜¯åŒ…å«äº†<strong>TextView</strong>çš„<strong>ScrollView</strong>æ»šåŠ¨ç»„ä»¶ã€‚å³ä¸Šè§’æ˜¯èœå•é€‰é¡¹ï¼Œé€šè¿‡å·¥ç¨‹menuçš„æ–‡ä»¶å¤¹æ–°å»ºèœå•æ–‡ä»¶<em>note_show_menu.xml</em>æ¥å®ç°ã€‚ç¬”è®°æµè§ˆç•Œé¢å¦‚å›¾æ‰€ç¤ºã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210619195943.png" alt="ç¬”è®°æµè§ˆç•Œé¢"></p><p>å¾…åŠäº‹é¡¹çš„ç¼–è¾‘å’Œæµè§ˆç•Œé¢ï¼šé¦–å…ˆæ–°å»º<strong>PopupWindow</strong>çš„å¸ƒå±€æ–‡ä»¶ï¼Œé‡Œé¢ä»¥<strong>CardView</strong>ä¸ºæ ¹å¸ƒå±€ï¼Œé‡Œé¢ä¸»è¦åŒ…å«äº†<strong>EditText</strong>å’Œ<strong>LinearLayout</strong>å¸ƒå±€ï¼Œå‰è€…è·å¾—è¾“å…¥ç„¦ç‚¹æ—¶ä¼šå¼¹å‡ºè¾“å…¥æ³•ï¼Œåè€…åŒ…å«äº†ä¸¤ä¸ªç”¨äºè®¾ç½®åº”ç”¨å†…æé†’å’Œæ—¥å†æé†’çš„<strong>Button</strong>å’Œä¸€ä¸ªæ˜¾ç¤ºæé†’æ—¶é—´çš„<strong>TextView</strong>ï¼Œæœ€åé€šè¿‡å®ä¾‹åŒ–<strong>PopupWindow</strong>å¹¶åŠ è½½å¸ƒå±€æ˜¾ç¤ºç¼–è¾‘ç•Œé¢ã€‚ç¼–è¾‘å®Œæˆåï¼Œåªéœ€è¦ç‚¹<strong>PopupWindow</strong>ä»¥å¤–è§¦æ‘¸ç©ºé—´æˆ–è€…è¿”å›æŒ‰é’®ï¼Œç¼–è¾‘ç•Œé¢å°±ä¼šå…³é—­ã€‚å¾…åŠäº‹é¡¹çš„ç¼–è¾‘å’Œæµè§ˆç•Œé¢å¦‚å›¾æ‰€ç¤ºã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210619200021.png" alt="å¾…åŠäº‹é¡¹ç¼–è¾‘å’Œæµè§ˆç•Œé¢"></p><h4 id="è¾“å…¥æ¨¡å—-1"><a href="#è¾“å…¥æ¨¡å—-1" class="headerlink" title="è¾“å…¥æ¨¡å—"></a>è¾“å…¥æ¨¡å—</h4><p>è¾“å…¥æ¨¡å—ä¸»è¦åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼šè¯­éŸ³è¾“å…¥ã€å›¾ç‰‡æ’å…¥å’Œæ–‡å­—è¾“å…¥ã€‚</p><p>è¯­éŸ³è¾“å…¥ï¼šå¦‚å›¾æ‰€ç¤ºï¼Œå½“è¾“å…¥æ¡†è·å¾—ç„¦ç‚¹åï¼Œä¼šæ˜¾ç¤ºè¾“å…¥é€‰é¡¹ï¼Œé€‰æ‹©è¯­éŸ³è¾“å…¥å›¾æ ‡åä¼šå¼¹å‡ºè¯­éŸ³å½•å…¥ç•Œé¢ï¼Œè¯­éŸ³æ•°æ®ä¼šå®æ—¶ä¸Šä¼ åˆ°è®¯é£æœåŠ¡å™¨è¿›è¡Œè¯†åˆ«ï¼Œè¯†åˆ«ç»“æœä¼šæ˜¾ç¤ºåœ¨è¾“å…¥ç•Œé¢ï¼Œç”¨æˆ·è¯´å®Œè¯åï¼Œè¯­éŸ³å½•å…¥ç•Œé¢å…³é—­å¹¶åœ¨è¾“å…¥æ¡†æ·»åŠ å°å–‡å­å›¾æ ‡ã€‚</p><p>è½¯ä»¶ä¸Šçš„å®ç°è¿‡ç¨‹ï¼šé¦–å…ˆï¼Œä½¿ç”¨è®¯é£è¯†åˆ«å¼•æ“ä¹‹å‰è¦åœ¨åº“æ–‡ä»¶ä¸­å¼•å…¥è®¯é£è¯†åˆ«åº“ï¼Œç„¶åè°ƒç”¨<strong>SpeechUtility.createUtility()</strong> éªŒè¯å¯†é’¥ã€‚æ¥ä¸‹æ¥é€šè¿‡è‡ªå®šä¹‰çš„<strong>XunFeiEngine</strong>ç±»å®Œæˆè¯†åˆ«è¿‡ç¨‹ï¼Œæä¾›çš„æ–¹æ³•ä¸»è¦æœ‰è®¾ç½®è¯­éŸ³è¯†åˆ«å‚æ•°çš„<strong>setParam()<strong>ï¼Œæ‰“å°ç»“æœæ–¹æ³•</strong>printResult()</strong> å’Œæ„é€ å‡½æ•°<strong>XunFeiEngine()<strong>ã€‚å…ˆå®ä¾‹åŒ–</strong>XunFeiEngine</strong>ç±»å®Œæˆè®¯é£è¯­éŸ³è¯†åˆ«å¼•æ“çš„åˆå§‹åŒ–ï¼Œç„¶åè°ƒç”¨<strong>setParam()</strong> æ–¹æ³•å®Œæˆå‚æ•°è®¾ç½®ï¼Œæ¯”å¦‚è®¯é£çš„å¬å†™å¼•æ“ã€è¯­è¨€åŒºåŸŸã€éŸ³é¢‘ä¿å­˜è·¯å¾„ç­‰ç­‰ã€‚æ¥ä¸‹æ¥è°ƒç”¨<strong>SpeechRecognizer</strong>ç±»çš„<strong>startListening()</strong> æ–¹æ³•å®Œæˆç›‘å¬å™¨è®¾ç½®ï¼Œåœ¨ç›‘å¬å™¨é‡Œé¢é€šè¿‡<strong>onVolumeChanged()</strong> æ–¹æ³•æ”¹å˜è¯­éŸ³è¾“å…¥ç•Œé¢çš„åŠ¨ç”»æ•ˆæœï¼›é€šè¿‡<strong>onBeginOfSpeech()</strong> æ–¹æ³•çŸ¥é“è®¯é£è¯­éŸ³è¯†åˆ«å¼•æ“å·²ç»å‡†å¤‡å¥½äº†ï¼Œç”¨æˆ·å¯ä»¥å¼€å§‹è¯­éŸ³è¾“å…¥ï¼›é€šè¿‡<strong>onEndOfSpeech()</strong> æ–¹æ³•çŸ¥é“æ£€æµ‹åˆ°äº†è¯­éŸ³çš„å°¾ç«¯ç‚¹ï¼Œå·²ç»è¿›å…¥è¯†åˆ«è¿‡ç¨‹ï¼Œä¸å†æ¥å—è¯­éŸ³è¾“å…¥ï¼›é€šè¿‡<strong>onResult()</strong> æ–¹æ³•è·å–è¯†åˆ«ç»“æœå¹¶æ˜¾ç¤ºåœ¨è¾“å…¥ç•Œé¢ï¼›é€šè¿‡<strong>onError()</strong> æ–¹æ³•äº†è§£å‡ºé”™é—®é¢˜ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210619200112.png" alt="è¯­éŸ³è¾“å…¥ç•Œé¢"></p><p>å›¾ç‰‡æ’å…¥ï¼šåœ¨è¾“å…¥é€‰é¡¹é€‰æ‹©ç›¸æœºå°å›¾æ ‡è¿›å…¥å›¾ç‰‡æ’å…¥åŠŸèƒ½ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚åœ¨ç›¸å†Œç•Œé¢å¯ä»¥é¢„è§ˆå›¾ç‰‡ï¼Œé€‰æ‹©å¥½å›¾ç‰‡åç‚¹å‡»å³ä¸‹è§’çš„ä½¿ç”¨æŒ‰é’®è·³è½¬å›æ¥è¾“å…¥æ¡†ï¼Œå›¾ç‰‡å·²ç»æ­£å¸¸æ’å…¥äº†ã€‚</p><p>è½¯ä»¶çš„å®ç°è¿‡ç¨‹ï¼šé¦–å…ˆåœ¨å·¥ç¨‹å¼•å…¥çŸ¥ä¹çš„å¼€æºæ¡†æ¶<strong>matisse</strong>å’Œé²ç­å›¾ç‰‡å‹ç¼©æ¡†æ¶<strong>Luban</strong>ï¼Œç„¶ååœ¨<strong>callGallery()</strong> æ–¹æ³•ä¸­è®¾ç½®å¥½<strong>Matisse</strong>ç±»ï¼Œä¸»è¦è®¾ç½®å‚æ•°æœ‰æä¾›æ‹ç…§åŠŸèƒ½ã€åªæ˜¾ç¤ºå›¾ç‰‡èµ„æºã€è®¾ç½®å›¾ç‰‡åŠ è½½å¼•æ“ä¸º<strong>Glide</strong>ã€è®¾ç½®å”¯ä¸€æ ‡è®°è¯·æ±‚ç ç­‰ç­‰ã€‚æ¥ä¸‹æ¥ï¼Œå›¾ç‰‡çš„é€‰æ‹©ç»“æœåœ¨<strong>onActivityResult()</strong> æ–¹æ³•ä¸­å¤„ç†ï¼Œé€šè¿‡<strong>Matisse.obtainPathResult()</strong> æ–¹æ³•è·å–å›¾ç‰‡çš„å®é™…è·¯å¾„åˆ—è¡¨ï¼Œç„¶åé€šè¿‡<strong>Luban</strong>ç±»ç›¸å…³æ–¹æ³•å®Œæˆå›¾ç‰‡çš„å‹ç¼©å’Œä¿å­˜ï¼Œæœ€åå®Œæˆå›¾ç‰‡çš„æ’å…¥ï¼šæ ¹æ®Uriè·å¾—<strong>Drawable</strong>èµ„æºï¼Œè®¾ç½®<strong>ClickableSpan</strong>ç‚¹å‡»äº‹ä»¶ï¼Œé€šè¿‡<strong>ImageSpan</strong>å’Œ<strong>SpannableString</strong>æ˜¾ç¤ºåˆ°è¾“å…¥ç•Œé¢ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210619200212.png" alt="å›¾ç‰‡é€‰æ‹©ç•Œé¢"></p><p>æ–‡å­—è¾“å…¥ï¼šæ–‡å­—çš„è¾“å…¥é€‰é¡¹æœ‰ä¸‰ä¸ªï¼šæ–‡å­—æ ‡é¢˜ã€æ–‡å­—æ ‡çº¢å’Œæ–‡å­—åŠ ç²—ï¼Œå¦‚æœä»€ä¹ˆéƒ½ä¸é€‰ï¼Œå°±ä¼šä»¥æ­£å¸¸æ–‡å­—è¾“å…¥ã€‚æœ‰ä¸¤ç§ç”¨æ³•ï¼šç¬¬ä¸€ç§å°±æ˜¯å…ˆé€‰æ‹©è¾“å…¥é€‰é¡¹ç„¶åå†è¾“å…¥æ–‡å­—ï¼Œå¦‚ç¬¬ä¸€å¼ å›¾æ‰€ç¤ºã€‚ç¬¬äºŒç§å°±æ˜¯ä»¥æ­£å¸¸æ ·å¼è¾“å…¥æ–‡å­—åå†é€šè¿‡å…‰æ ‡é€‰æ‹©æ–‡å­—çš„æ ·å¼ï¼Œå¦‚å›¾2æ‰€ç¤ºã€‚</p><p>è½¯ä»¶å®ç°ï¼šç¬¬ä¸€ç§ç”¨æ³•å®ç°æ–¹å¼,é€šè¿‡ç»™<strong>Edittext</strong>è®¾ç½®<strong>TextWatcher</strong>ç›‘å¬å™¨ï¼Œåœ¨<strong>TextWatcher</strong>çš„<strong>afterTextChanged()</strong> æ–¹æ³•é‡Œé¢æ ¹æ®è¾“å…¥é€‰é¡¹é€šè¿‡<strong>setSpan()</strong> æ–¹æ³•å®Œæˆæ ·å¼è®¾ç½®ã€‚ç¬¬äºŒç§ç”¨æ³•å®ç°æ–¹å¼ï¼Œæ ¹æ®å¯¹åº”çš„è¾“å…¥é€‰é¡¹ï¼Œé€šè¿‡<strong>EditText</strong>çš„<strong>getSelectionEnd()</strong> å’Œ<strong>getSelectionStart()</strong> æ–¹æ³•è·å–æ–‡å­—å…‰æ ‡èŒƒå›´ï¼Œæœ€åé€šè¿‡<strong>setSpan()</strong> æ–¹æ³•å®Œæˆæ ·å¼è®¾ç½®ã€‚å…¶ä¸­<strong>setSpan()</strong> æ–¹æ³•ä¸»è¦æ˜¯ç»™<strong>Editable</strong>è®¾ç½®ä¸åŒçš„<strong>TextAppearanceSpan</strong>æ ·å¼æ¥è¾¾åˆ°å¯Œæ–‡æœ¬æ•ˆæœã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210619200317.png" alt="image-20210619200316983"></p><p>å½“è¾“å…¥å®Œæˆåï¼Œé€šè¿‡<strong>addNote()</strong> æ–¹æ³•è¿›è¡Œç¬”è®°ä¿å­˜ï¼Œé¦–å…ˆé€šè¿‡<strong>getSpans()</strong> æ–¹æ³•è·å–ç¬”è®°å†…å®¹çš„æ ·å¼ï¼Œç„¶åé€šè¿‡<strong>Parcel</strong>ç±»çš„ç›¸å…³æ–¹æ³•æŠŠæ ·å¼å†…å®¹è½¬æ¢æˆäºŒè¿›åˆ¶æ•°æ®å­˜å‚¨ï¼Œæ¥ä¸‹æ¥è®¾ç½®ç¬”è®°çš„æ ‡é¢˜ã€å‰¯æ ‡é¢˜ã€åˆ›å»ºæ—¶é—´ç­‰ç­‰ï¼Œæœ€åä¿å­˜åˆ°æ•°æ®åº“ã€‚</p><p>å¾…åŠäº‹é¡¹çš„è¾“å…¥æ”¯æŒè¯­éŸ³è¾“å…¥å’Œçº¯æ–‡æœ¬è¾“å…¥ï¼Œè¯­éŸ³è¾“å…¥å®ç°è¿‡ç¨‹ä¸ç¬”è®°è¯­éŸ³è¾“å…¥è¿‡ç¨‹ç±»ä¼¼ï¼Œåªä¸è¿‡ä¸éœ€è¦ä¿å­˜è¯­éŸ³å½•éŸ³æ–‡ä»¶ã€‚æ–‡å­—è¾“å…¥å°±æ˜¯æ­£å¸¸æ ·å¼è¾“å…¥ï¼Œä¸éœ€è¦å…¶ä»–æ ·å¼ã€‚ä¿å­˜è¿‡ç¨‹ç±»ä¼¼ç¬”è®°ï¼Œä½†ä¸éœ€è¦å¤„ç†æ ·å¼ã€æ ‡é¢˜ç­‰å†…å®¹ã€‚</p><h4 id="æ˜¾ç¤ºæ¨¡å—-1"><a href="#æ˜¾ç¤ºæ¨¡å—-1" class="headerlink" title="æ˜¾ç¤ºæ¨¡å—"></a>æ˜¾ç¤ºæ¨¡å—</h4><p>ç¬”è®°ä»æ•°æ®åº“æŸ¥è¯¢å‡ºæ¥åï¼Œæ¯ä¸€ä¸ªç¬”è®°çš„contentå­—æ®µéƒ½è¦ç»è¿‡è‡ªå®šä¹‰<strong>ContentToSpannableString</strong>ç±»çš„<strong>contentToSpanStr ()</strong> æ–¹æ³•å¤„ç†ï¼Œé¦–å…ˆè¦é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼<strong>Pattern.compile(â€œ&lt;voice src&#x3D;â€™(.*?)â€™&#x2F;&gt;â€)</strong> æ‰¾å‡ºç¬”è®°å†…å®¹é‡Œé¢çš„è¯­éŸ³è·¯å¾„ï¼Œç„¶åé€šè¿‡è·¯å¾„æ‰¾åˆ°æœ¬åœ°è¯­éŸ³èµ„æºï¼Œå¦‚æœæœ¬åœ°æ²¡æœ‰å°±è¦è”ç½‘ä»åšæœäº‘ä¸‹è½½ï¼Œæœ‰äº†è¯­éŸ³èµ„æºåå°±è¦æŠŠå†…å®¹çš„è¯­éŸ³è·¯å¾„æ›¿æ¢æˆ<strong>ImageSpan</strong>å’Œ<strong>ClickableSpan</strong>ï¼Œè¿™æ ·å°±å¯ä»¥æ˜¾ç¤ºä¸€ä¸ªè¯­éŸ³å›¾æ ‡åŒæ—¶å¯ä»¥å®ç°ç‚¹å‡»æ’­æ”¾éŸ³é¢‘ï¼ŒéŸ³é¢‘æ’­æ”¾æ˜¯é€šè¿‡<strong>MediaPlayer</strong>ç±»æ¥å®Œæˆçš„ã€‚æ¥ä¸‹æ¥ï¼Œå°±æ˜¯é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼<strong>Pattern.compile(â€œ&lt;img src&#x3D;â€™(.*?)â€™&#x2F;&gt;â€)</strong> æ¥æŸ¥æ‰¾ç¬”è®°çš„å›¾ç‰‡èµ„æºè·¯å¾„ï¼Œç„¶åä¹Ÿæ˜¯ä¼˜å…ˆä»æœ¬åœ°æŸ¥æ‰¾å›¾ç‰‡ï¼Œæœ¬åœ°æ²¡æœ‰å†ä»åšæœäº‘ä¸‹è½½ï¼Œæ¥ç€æŠŠç¬”è®°å†…å®¹çš„å›¾ç‰‡è·¯å¾„æ›¿æ¢æˆ<strong>ImageSpan</strong>å’Œ<strong>ClickableSpan</strong>ï¼Œé‚£ä¹ˆ<strong>ImageSpan</strong>å°±æ˜¯å…·ä½“è¦æ˜¾ç¤ºçš„å›¾ç‰‡ï¼Œè€Œ<strong>ClickableSpan</strong>ç›‘å¬å›¾ç‰‡çš„ç‚¹å‡»äº‹ä»¶ï¼Œåœ¨ç‚¹å‡»äº‹ä»¶é‡Œé¢é€šè¿‡å¼€æºæ¡†æ¶<strong>MNImageBrowser</strong>çš„<strong>MNImageBrowser</strong>ç±»æ¥å®ç°å›¾ç‰‡çš„æŸ¥çœ‹ã€å•å‡»åˆ†äº«å›¾ç‰‡å’Œé•¿æŒ‰å›¾ç‰‡ä¿å­˜åˆ°æœ¬åœ°çš„åŠŸèƒ½ï¼Œå›¾ç‰‡åŠ è½½å¼•æ“è¦ç”¨åˆ°å¼€æºæ¡†æ¶<strong>Glide</strong>ï¼Œä¿å­˜å›¾ç‰‡åˆ°æœ¬åœ°è¦é€šè¿‡<strong>MediaStore.Images.Media.insertImage()</strong> æ–¹æ³•æŠŠå›¾ç‰‡æ’å…¥åˆ°å›¾åº“ï¼Œç„¶åå‘å¹¿æ’­é€šçŸ¥å›¾åº“åˆ·æ–°æ˜¾ç¤ºã€‚æœ€åï¼Œå°±æ˜¯æ¢å¤å¯Œæ–‡æœ¬æ˜¾ç¤ºï¼Œå…ˆåˆ¤æ–­Noteçš„<strong>restoreSpans</strong>å­—æ®µæ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ºç©ºï¼Œè®¾ç½®å¥½å­—ä½“åç›´æ¥è¿”å›è½¬æ¢æˆ<strong>SpannableStringBuilder</strong>çš„æ•°æ®ã€‚å¦‚æœä¸ä¸ºç©ºï¼Œé‚£ä¹ˆå°±éœ€è¦é€šè¿‡<strong>Parcel</strong>ååºåˆ—åŒ–æ¥æ¢å¤æ•°æ®ã€‚ä½¿ç”¨<strong>Parcel</strong>çš„<strong>unmarshall</strong>æ–¹æ³•æ¥æŠŠäºŒè¿›åˆ¶æ•°æ®æ¢å¤æˆåŸå§‹æ•°æ®ï¼Œç„¶åé€šè¿‡<strong>readParcelable</strong>æ–¹æ³•å¾—å‡ºè‡ªå®šä¹‰çš„<strong>SaveTextAppearanceSpan</strong>æ•°æ®ï¼Œæœ€åç»§ç»­é€šè¿‡<strong>unmarshall</strong>æ–¹æ³•è·å–å¯Œæ–‡æœ¬<strong>Parcel</strong>æ•°æ®ï¼Œç„¶åæŠŠå®ä¾‹åŒ–<strong>TextAppearanceSpan</strong>çš„å¯¹è±¡ä¾æ¬¡è®¾ç½®åˆ°<strong>SpannableStringBuilder</strong>å¯¹è±¡ä¸­å»ï¼Œå®Œæˆåè¿”å›æ•°æ®ä¾›<strong>Edittext</strong>æ˜¾ç¤ºã€‚</p><p>å¾…åŠäº‹é¡¹çš„æ•°æ®ç›´æ¥æŠŠåŸå§‹<strong>String</strong>å†…å®¹é€åˆ°<strong>Edittext</strong>æ˜¾ç¤ºå³å¯ã€‚</p><h4 id="æé†’æ¨¡å—-1"><a href="#æé†’æ¨¡å—-1" class="headerlink" title="æé†’æ¨¡å—"></a>æé†’æ¨¡å—</h4><p>åº”ç”¨å†…æé†’ï¼šé€šè¿‡<strong>AlarmManager</strong>åˆ›å»ºå®šæ—¶ä»»åŠ¡æ¥å®ç°ã€‚é¦–å…ˆï¼Œç³»ç»Ÿè¦è·å–æé†’æ—¶é—´ï¼Œè¿™é‡Œé€šè¿‡<strong>Android-PickerView</strong>å¼€æºåº“æ¥å®ç°ã€‚å¦‚å›¾1æ‰€ç¤ºï¼Œé€‰æ‹©å¥½æé†’æ—¶é—´åç‚¹å‡»ç¡®å®šï¼Œç„¶å<strong>TimePickerView</strong>ç±»çš„ç›‘å¬å™¨å°±ä¼šæ‰§è¡Œ<strong>onTimeSelect()</strong> æ–¹æ³•ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•é‡Œé¢ï¼Œé¦–å…ˆè¦åˆ¤æ–­è®¾ç½®çš„æé†’æ—¶é—´æ˜¯å¦æ—©äºç°åœ¨ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™æŠ›å‡ºæç¤ºï¼šâ€è®¾ç½®çš„æé†’æ—¶é—´ä¸èƒ½æ—©äºç°åœ¨â€ã€‚å¦‚æœä¸æ˜¯ï¼Œåˆ™æ‰“å¼€ä¸€ä¸ªæœåŠ¡<strong>AlarmService</strong>å»åˆ›å»ºå®šæ—¶ä»»åŠ¡ï¼Œåœ¨æ‰“å¼€æœåŠ¡ä¹‹å‰ï¼Œè¦ä¼ é€’ä¸‰ä¸ªé‡è¦æ„å›¾ï¼Œç¬¬ä¸€ä¸ªæ˜¯æé†’æ—¶é—´ï¼Œç¬¬äºŒä¸ªæ˜¯æ•°æ®çš„å”¯ä¸€æ ‡è¯†ï¼Œç¬¬ä¸‰ä¸ªæ˜¯ç§ç±»ï¼ŒåŒºåˆ†ç¬”è®°å’Œå¾…åŠäº‹é¡¹ã€‚æ‰“å¼€<strong>AlarmService</strong>åï¼Œé¦–å…ˆåˆå§‹åŒ–<strong>TextToSpeech</strong>ï¼Œä¸ºä¹‹åçš„è¯­éŸ³æé†’ä½œå‡†å¤‡ã€‚ç„¶åï¼Œå®ä¾‹åŒ–<strong>AlarmManager</strong>ç±»ï¼Œé…ç½®å¥½å®šæ—¶åˆ°ç‚¹åçš„è§¦å‘ä»»åŠ¡<strong>AlarmIntentService</strong>ï¼Œå¹¶ä¼ é€’æ•°æ®å”¯ä¸€æ ‡è¯†å’Œç§ç±»ã€‚è®¾ç½®å®šæ—¶æ—¶é—´è¦ç”¨åˆ°<strong>PendingIntent</strong>ç±»ï¼Œå¹¶æŒ‰ç…§ç¬”è®°å’Œå¾…åŠäº‹é¡¹è®¾ç½®å¥½å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œè¿™ä¸ªæ ‡è¯†ç¬¦å¯¹äºå–æ¶ˆæé†’è‡³å…³é‡è¦ã€‚æœ€åè°ƒç”¨<strong>AlarmManager</strong>çš„<strong>setExactAndAllowWhileIdle ()</strong> æ–¹æ³•ï¼Œè®¾ç½®å¥½å®šæ—¶ä»»åŠ¡ã€‚å½“æé†’æ—¶é—´åˆ°äº†ï¼Œ<strong>AlarmIntentService</strong>æœåŠ¡ä¼šè¢«ç³»ç»Ÿå”¤é†’ï¼Œåœ¨è¿™é‡Œé¢çš„åŠŸèƒ½å°±æ˜¯åœ¨é€šçŸ¥æ æ˜¾ç¤ºé€šçŸ¥å¹¶ä¸”è¯­éŸ³æ’­æŠ¥æé†’å†…å®¹ã€‚é€šçŸ¥æ˜¾ç¤ºåï¼Œå¯ä»¥é€šè¿‡é€šçŸ¥æ è¿›å…¥ç¬”è®°é¡µé¢æˆ–è€…å…³é—­è¯­éŸ³æ’­æŠ¥ã€‚ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œå½“è½¯ä»¶é‡æ–°å¯åŠ¨æ—¶ï¼Œä¼šå¼€å¯ä¸€ä¸ªçº¿ç¨‹é‡æ–°è®¾ç½®æ²¡æœ‰è¿‡æœŸçš„ç¬”è®°å®šæ—¶ä»»åŠ¡ã€‚</p><p>æ—¥å†æé†’ï¼šé€šè¿‡ç³»ç»Ÿæä¾›çš„<strong>Calendar</strong>æ—¥å†æœåŠ¡ç±»æ‰“å¼€æ—¥å†ï¼Œå¹¶ä¼ é€’æé†’å†…å®¹å’Œæ—¶é—´ï¼Œå…¶ä»–è®¾ç½®ç”±ç³»ç»Ÿçš„æ—¥å†æ¥æä¾›ã€‚å¦‚å›¾2æ‰€ç¤ºã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210619200353.png" alt="image-20210619200353483"></p><h4 id="æ•°æ®åŒæ­¥-1"><a href="#æ•°æ®åŒæ­¥-1" class="headerlink" title="æ•°æ®åŒæ­¥"></a>æ•°æ®åŒæ­¥</h4><p>äº‘åŒæ­¥åŠŸèƒ½é‡‡ç”¨çš„æœåŠ¡å•†æ˜¯åšæœäº‘ï¼Œæ‰€ä»¥å¼€å¯å¤‡ä»½ä¹‹å‰éœ€è¦æ³¨å†Œä¸€ä¸ªåšæœäº‘è´¦å·ï¼Œç„¶ååœ¨åšæœäº‘ç½‘é¡µç¬¬ä¸‰æ–¹åº”ç”¨ç®¡ç†é‚£é‡Œç”³è¯·ä¸€ä¸ªåº”ç”¨å¯†ç ï¼Œæœ€ååœ¨åº”ç”¨çš„ä¾§è¾¹æ å¡«ä¸Šè´¦å·å¯†ç ï¼Œç„¶åç‚¹å‡»ç™»é™†æŒ‰é’®ï¼Œè”ç½‘éªŒè¯è´¦å·å¯†ç æ˜¯å¦æ­£ç¡®ã€‚ç”¨æˆ·çš„è´¦å·å’Œå¯†ç ä¼šä¿å­˜åˆ°<strong>SharedPreferences</strong>é‡Œé¢ã€‚åº”ç”¨æœ¬åœ°éœ€è¦æ¥å…¥<strong>sardine-android</strong>å¼€æºæ¡†æ¶ï¼Œç„¶ååˆ›å»ºä¸€ä¸ª<strong>SynWithWebDav</strong>ç±»ï¼Œä¸“é—¨ç®¡ç†æ•°æ®åŒæ­¥ã€‚</p><p>åŒæ­¥è¿‡ç¨‹ï¼šä¸ºäº†è§¦å‘åŒæ­¥ï¼Œéœ€è¦åœ¨ç³»ç»Ÿå¼•å…¥å¼€æºæ¡†æ¶<strong>SmartRefreshLayout</strong>ï¼Œå®ƒæ”¯æŒä¸‹æ‹‰åˆ·æ–°ã€‚å¦‚å›¾æ‰€ç¤ºï¼Œåœ¨ç”¨æˆ·ä¸»ç•Œé¢ä¸‹æ‹‰ï¼Œä¼šæ˜¾ç¤ºä¸‹æ‹‰æ›´æ–°ç»„ä»¶<strong>RefreshLayout</strong>ã€‚åœ¨åŒæ­¥çš„è¿‡ç¨‹ä¸­ï¼Œä¸ºäº†é˜²æ­¢æ•°æ®å†²çªï¼Œä¼šç¦æ­¢åº”ç”¨å†…çš„è§¦æ‘¸æ´»åŠ¨ï¼ŒåŒæ­¥å®Œæˆåæ¢å¤è§¦æ‘¸ã€‚ç„¶åï¼Œ<strong>RefreshLayout</strong>ç›‘å¬å™¨æ¥æ”¶åˆ°è§†å›¾å±‚çš„æŒ‡ä»¤ï¼Œè§¦å‘<strong>onRefresh</strong>æ–¹æ³•ï¼Œåœ¨é‡Œé¢æ‰§è¡Œæ•°æ®åŒæ­¥ï¼š</p><p>ï¼ˆ1ï¼‰ é€šè¿‡<strong>getSystemService()</strong> æ–¹æ³•è·å–åˆ°<strong>ConnectivityManager</strong>ç³»ç»ŸæœåŠ¡ç±»ï¼Œä»è€Œå¾—çŸ¥å½“å‰ç½‘ç»œæƒ…å†µï¼Œå¦‚æœç½‘ç»œä¸å¯ç”¨åˆ™ç›´æ¥é€€å‡ºåŒæ­¥è¿‡ç¨‹å¹¶æç¤ºç”¨æˆ·ç½‘ç»œä¸å¯ç”¨ã€‚</p><p>ï¼ˆ2ï¼‰ ç¦æ­¢è§¦æ‘¸æ´»åŠ¨ï¼Œå¹¶é€šè¿‡<strong>SharedPreferences</strong>è·å–ç”¨æˆ·çš„è´¦å·å’Œå¯†ç ã€‚</p><p>ï¼ˆ3ï¼‰ å®ä¾‹åŒ–<strong>SynWithWebDav</strong>ç±»ï¼Œåœ¨å®ƒçš„æ„é€ å‡½æ•°é‡Œé¢å®Œæˆè´¦å·å’Œå¯†ç çš„è®¾ç½®ï¼Œå¦‚æœæ˜¯ç¬¬ä¸€ä¸ªåŒæ­¥ï¼Œè¿˜ä¼šåœ¨å¤–éƒ¨å­˜å‚¨ç©ºé—´æ–°å»ºä¸€ä¸ª<strong>noteBackup.db</strong>æ•°æ®åº“ç”¨äºåŒæ­¥ï¼Œå¹¶åœ¨é‡Œé¢æ–°å»º<strong>Note</strong>å’Œ<strong>Todo</strong>ä¸¤ä¸ªæ•°æ®è¡¨ã€‚</p><p>ï¼ˆ4ï¼‰ ç”±äºå›¾ç‰‡å’Œè¯­éŸ³æ•°æ®ä¸Šä¼ éœ€è¦èŠ±è´¹å¾ˆå¤šæ—¶é—´ï¼Œæ‰€ä»¥é¦–å…ˆå¼€è¾Ÿä¸€ä¸ªçº¿ç¨‹ç”¨äºå¤šåª’ä½“æ•°æ®åŒæ­¥ã€‚åœ¨æ–°çº¿ç¨‹é‡Œé¢ï¼Œå…ˆåœ¨<strong>MediaForNote</strong>æ•°æ®è¡¨é‡Œé¢è·å–<strong>status</strong>ä¸º0çš„æ•°æ®ï¼Œä»£è¡¨è¿˜æ²¡æœ‰åŒæ­¥çš„æ•°æ®ã€‚ç„¶åï¼Œé€šè¿‡<strong>MediaForNote</strong>é‡Œé¢çš„<strong>isPhoto()</strong> æ–¹æ³•åŒºåˆ†å¤šåª’ä½“èµ„æºè·¯å¾„ï¼Œæœ€åè°ƒç”¨<strong>SynWithWebDav</strong>çš„<strong>uploadFile()</strong> æ–¹æ³•è¿›è¡Œæ•°æ®ä¸Šä¼ ï¼Œé€šè¿‡å…¶è¿”å›å€¼åˆ¤æ–­æ˜¯å¦ä¸Šä¼ æˆåŠŸï¼ŒæˆåŠŸçš„è¯åˆ™è®¾ç½®<strong>status</strong>ä¸º2ï¼Œå¹¶ä¿å­˜åˆ°æ•°æ®åº“ã€‚</p><p>ï¼ˆ5ï¼‰ ä»<strong>SharedPreferences</strong>é‡Œé¢è·å–æœ€è¿‘çš„åŒæ­¥æ—¶é—´ï¼Œç„¶åè·å–äº‘ç«¯çš„<strong>noteBackup.db</strong>æ–‡ä»¶çš„æœ€è¿‘ä¿®æ”¹æ—¶é—´ã€‚å½“æ–‡ä»¶å­˜åœ¨å¹¶ä¸”ä¿®æ”¹æ—¶é—´å¤§äºæœ€è¿‘åŒæ­¥æ—¶é—´æ—¶ï¼Œé‚£ä¹ˆå°±éœ€è¦ä¸‹è½½æœ€æ–°çš„äº‘å¤‡ä»½æ–‡ä»¶ï¼Œç”¨äºåˆå¹¶äº‘ç«¯çš„æ›´æ”¹åˆ°æœ¬åœ°ã€‚å¦‚æœè¿‡ç¨‹ä¸­å‡ºç°ç½‘ç»œé”™è¯¯å°†ä¸­æ–­åŒæ­¥è¿‡ç¨‹ï¼Œé€€å‡ºä¸‹æ‹‰åˆ·æ–°å¹¶æ¢å¤è§¦æ‘¸ã€‚</p><p>ï¼ˆ6ï¼‰ å¦‚æœäº‘æ–‡ä»¶ä¸‹è½½æˆåŠŸæˆ–è€…äº‘ç«¯æ–‡ä»¶æ›´æ”¹æ—¶é—´å°äºç­‰äºæœ€è¿‘åŒæ­¥æ—¶é—´ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥å°±å¼€å§‹è¿›è¡Œç¬”è®°å’Œå¾…åŠäº‹é¡¹çš„æ•°æ®åŒæ­¥ã€‚é¦–å…ˆï¼Œå¦‚æœäº‘æ–‡ä»¶åŒæ­¥æˆåŠŸå°±éœ€è¦è°ƒç”¨<strong>SynWithWebDav</strong>çš„<strong>updateLocalNotes()<strong>å’Œ</strong>updateLocalTodos()</strong> æ–¹æ³•åˆå¹¶äº‘ç«¯æ›´æ”¹åˆ°æœ¬åœ°æ•°æ®åº“ã€‚æ¥ä¸‹æ¥å°±æ˜¯æŠŠæœ¬åœ°æ–°å¢æˆ–è€…æ›´æ”¹çš„æ•°æ®åˆå¹¶åˆ°äº‘ç«¯æ•°æ®åº“ï¼Œå³<strong>status</strong>ä¸º0æˆ–è€…1çš„ç¬”è®°å’Œå¾…åŠäº‹é¡¹ï¼Œä»æ•°æ®åº“æŸ¥è¯¢åˆ°æ•°æ®åï¼Œè°ƒç”¨<strong>SynWithWebDav</strong>çš„<strong>updateNotes()<strong>å’Œ</strong>updateTodos()</strong> æ–¹æ³•åˆå¹¶æ•°æ®åˆ°å¤‡ä»½æ–‡ä»¶ã€‚ç„¶åï¼Œè·å–<strong>status</strong>ä¸º-1çš„æ•°æ®ï¼Œè°ƒç”¨<strong>SynWithWebDav</strong>çš„<strong>deleteNotes()</strong> å’Œ<strong>deleteTodos()</strong> æ–¹æ³•é€šçŸ¥å¤‡ä»½æ•°æ®åº“è¯´æœ¬åœ°ä¸€äº›æ•°æ®å·²ç»åˆ é™¤ã€‚æœ€åï¼ŒæŠŠå¤‡ä»½æ–‡ä»¶ä¸Šä¼ åˆ°åšæœäº‘ï¼Œæ›´æ”¹æœ€è¿‘åŒæ­¥æ—¶é—´ã€‚å½“ç„¶ï¼Œå¦‚æœæœ¬åœ°å¤‡ä»½æ–‡ä»¶çš„æ›´æ”¹æ—¶é—´å°äºç­‰äºæœ€ååŒæ­¥æ—¶é—´åˆ™ä¸éœ€è¦ä¸Šä¼ ï¼Œç½‘ç»œå‡ºé”™ä¹Ÿä¼šé‡ç½®åŒæ­¥çŠ¶æ€ã€‚</p><p>ï¼ˆ7ï¼‰ æ‰€æœ‰æ•°æ®åŒæ­¥å®Œæˆåï¼Œé€€å‡ºä¸‹æ‹‰åˆ·æ–°å¹¶æ¢å¤å…¨å±€è§¦æ‘¸äº‹ä»¶ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210619200430.png" alt="åŒæ­¥ç•Œé¢"></p><h4 id="æœç´¢æ¨¡å—-1"><a href="#æœç´¢æ¨¡å—-1" class="headerlink" title="æœç´¢æ¨¡å—"></a>æœç´¢æ¨¡å—</h4><p>æ— è®ºæ˜¯ç¬”è®°ç•Œé¢è¿˜æ˜¯å¾…åŠäº‹é¡¹ç•Œé¢éƒ½æœ‰æœç´¢æ¡†ã€‚å¦‚å›¾æ‰€ç¤ºï¼Œå½“ç”¨æˆ·è¾“å…¥æŸ¥æ‰¾å­—ç¬¦æ—¶ï¼Œ<strong>SearchView</strong>ç»„ä»¶çš„ç›‘å¬å™¨å°±ä¼šæ¥æ”¶åˆ°æŒ‡ä»¤ï¼Œå¼€å§‹æ¿€æ´»<strong>onQueryTextChange()</strong> æ–¹æ³•ï¼Œç„¶ååœ¨é‡Œé¢è°ƒç”¨ç¼–å†™å¥½çš„<strong>search()</strong> æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•é€‚ç”¨äºæŸ¥æ‰¾ç¬”è®°ï¼Œå³ä¼šä»å¯¹åº”çš„ç»„åˆ«ä¸­ç­›é€‰å‡ºåŒ…å«æŸ¥æ‰¾å­—ç¬¦çš„ç¬”è®°ï¼Œç„¶åæŠŠç»“æœè¿”å›ï¼Œæœ€ååˆ·æ–°<strong>RecycleView</strong>æ˜¾ç¤ºã€‚å½“ç‚¹å‡»æœç´¢æ¡†çš„äº¤å‰ç¬¦å·æ—¶ï¼Œä»£è¡¨é€€å‡ºæŸ¥æ‰¾ï¼Œç›‘å¬å™¨ä¼šé‡æ–°è¿è¡Œ<strong>RecycleView</strong>åˆ·æ–°æ–¹æ³•ï¼Œç»§ç»­æ˜¾ç¤ºç»„å†…ç¬”è®°ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210619200505.png" alt="image-20210619200505641"></p><h4 id="ç®¡ç†æ¨¡å—-1"><a href="#ç®¡ç†æ¨¡å—-1" class="headerlink" title="ç®¡ç†æ¨¡å—"></a>ç®¡ç†æ¨¡å—</h4><p>ä¸ºäº†å®ç°æ–°å¢ä¿¡æ¯ã€åˆ é™¤ä¿¡æ¯ã€ä¿®æ”¹ä¿¡æ¯å’ŒæŸ¥æ‰¾ä¿¡æ¯ï¼Œè¿™é‡Œçš„ä¿¡æ¯åŒ…æ‹¬ç¬”è®°å’Œå¾…åŠäº‹é¡¹ï¼Œéœ€è¦è®¾ç½®ä¸¤ä¸ªç®¡ç†æ•°æ®è¡¨çš„ç±»ï¼Œä¸€ä¸ªæ˜¯ç”¨äºç®¡ç†ç¬”è®°çš„<strong>NoteDbManager</strong>ç±»ï¼Œä¸€ä¸ªæ˜¯ç”¨äºç®¡ç†å¾…åŠäº‹é¡¹çš„<strong>TodoDbManager</strong>ç±»ã€‚å®ƒä»¬æ¶‰åŠåˆ°<strong>LitePal</strong>çš„ä¸»è¦æ–¹æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p>ï¼ˆ1ï¼‰ æ–°å¢ä¿¡æ¯ï¼Œç”±äºç¬”è®°å’Œå¾…åŠäº‹é¡¹ç±»éƒ½æ‰©å±•äº†<strong>LitePalSupport</strong>ï¼Œæ‰€ä»¥å½“éœ€è¦æ–°å¢ä¸€æ¡ä¿¡æ¯æ—¶ï¼Œåªéœ€è¦è°ƒç”¨ <strong>save()</strong> æ–¹æ³•ã€‚</p><p>ï¼ˆ2ï¼‰ åˆ é™¤ä¿¡æ¯ï¼Œé¦–å…ˆè¦è·å–æ‰€è¦æ“ä½œçš„æ•°æ®è¡¨ï¼Œç„¶åè®¾ç½®ä¿¡æ¯çš„çº¦æŸé¡¹ï¼Œæ¯”å¦‚ä¿¡æ¯çš„å”¯ä¸€æ ‡è¯†å­—æ®µï¼Œæœ€åè®¾ç½®çº¦æŸé¡¹çš„å…·ä½“å€¼ã€‚å‡½æ•°åŸå‹ä¸º<strong>public static int deleteAll(Class&lt;?&gt; modelClass, Stringâ€¦ conditions)</strong> ã€‚</p><p>ï¼ˆ3ï¼‰ æ›´æ”¹ä¿¡æ¯ï¼Œæœ‰ä¸¤ç§æ–¹æ³•ï¼Œç¬¬ä¸€ç§å°±æ˜¯å¯¹å·²ç»å‚¨å­˜åˆ°æ•°æ®åº“çš„å¯¹è±¡è°ƒç”¨<strong>save()</strong> æ–¹æ³•ï¼Œç¬¦åˆè¿™ç§æƒ…å†µçš„æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯å·²ç»è°ƒç”¨è¿‡<strong>save()</strong> æ–¹æ³•çš„å¯¹è±¡ï¼Œå¦å¤–ä¸€ç§æƒ…å†µæ˜¯é€šè¿‡<strong>LitePal</strong>æä¾›çš„æ–¹æ³•æŸ¥è¯¢å‡ºæ¥çš„å¯¹è±¡ã€‚å¦å¤–ä¸€ç§æ–¹æ³•å°±æ˜¯å…ˆæ–°å»ºä¸€ä¸ªæ•°æ®å®ä¾‹ï¼Œç„¶åè®¾ç½®æƒ³æ›´æ”¹çš„å­—æ®µï¼Œæœ€åè°ƒç”¨<strong>public int updateAll(Stringâ€¦ conditions)</strong> æ–¹æ³•æ¥æ‰§è¡Œæ›´æ–°æ“ä½œï¼Œè¿™é‡Œä¹Ÿå¯ä»¥æŒ‡å®šå¯¹åº”çš„çº¦æŸæ¡ä»¶ï¼Œä¸è®¾ç½®çš„è¯ï¼Œé»˜è®¤æ›´æ–°æ‰€æœ‰æ•°æ®ã€‚</p><p>ï¼ˆ4ï¼‰ æŸ¥è¯¢ä¿¡æ¯ï¼Œé€šè¿‡<strong>LitePal</strong>å„ç§æŸ¥è¯¢æ–¹æ³•å¯ä»¥æœç´¢åˆ°æ‰€éœ€è¦çš„ä¿¡æ¯ï¼Œå½“éœ€è¦æŸ¥è¯¢æ•°æ®è¡¨çš„æ‰€æœ‰ä¿¡æ¯æ—¶ï¼Œåªéœ€è¦ä¼ å…¥å¯¹åº”çš„æ•°æ®ç±»ï¼Œæ¯”å¦‚<strong>LitePal.findAll(Note.class)<strong>ï¼Œä¼šè¿”å›ä¸€ä¸ª</strong>Note</strong>ç±»å‹çš„<strong>List</strong>é›†åˆã€‚å½“éœ€è¦æ·»åŠ çº¦æŸæ¡ä»¶æ—¶ï¼Œéœ€è¦ç»“åˆ<strong>find</strong>æ–¹æ³•å’Œ<strong>where</strong>æ–¹æ³•ï¼Œä¾‹å¦‚æŸ¥è¯¢åŒæ­¥æ ‡å¿—ä½æ—¶ï¼Œåªéœ€è¦è°ƒç”¨<strong>LitePal.where(â€œstatus &#x3D; ?â€</strong>,<strong>Integer.toString(status)).find(Note.class)</strong> æ–¹æ³•ï¼Œå°±ä¼šè¿”å›ç¬¦åˆæ¡ä»¶çš„<strong>List</strong>é›†åˆã€‚å½“éœ€è¦å¯¹æ‰€è·å–çš„æ•°æ®æ—¶æ’åºæ—¶ï¼Œéœ€è¦ç”¨åˆ°<strong>order</strong>æ–¹æ³•ï¼Œå…¶ä¸­<strong>desc</strong>è¡¨ç¤ºé™åºæ’åˆ—ï¼Œ<strong>asc</strong>æˆ–è€…ä¸å†™ä»£è¡¨å‡åºæ’åˆ—ã€‚æ¯”å¦‚å¯¹è·å–çš„ç¬”è®°æ•°æ®æŒ‰æ›´æ–°æ—¶é—´é™åºæ’åºï¼Œåˆ™è°ƒç”¨<strong>LitePal.order(â€œupdatedTime descâ€).find(Note.class)</strong> æ–¹æ³•ã€‚</p><p>ä»¥ä¸Šå°±æ˜¯å¯¹æ•°æ®åº“çš„å¢åˆ æ”¹æŸ¥ï¼Œæ¥ä¸‹æ¥å°±æ˜¯ç¬”è®°çš„åˆ†ç»„åŠŸèƒ½ï¼Œå¦‚å›¾1æ‰€ç¤ºï¼Œä¾é çš„æ˜¯<strong>Note</strong>ç±»é‡Œé¢çš„<strong>groupName</strong>å­—æ®µï¼Œæœ‰å››ä¸ªå–å€¼ï¼Œåˆ†åˆ«æ˜¯â€œæœªåˆ†ç»„â€ã€â€œç”Ÿæ´»â€ã€â€œå·¥ä½œâ€å’Œâ€œå›æ”¶ç«™â€ï¼Œåªè¦åœ¨ä¾§è¾¹æ é€‰æ‹©å¯¹åº”çš„é€‰é¡¹ï¼Œæ§åˆ¶å±‚å°±ä¼šä¾é <strong>groupName</strong>è¿™ä¸ªçº¦æŸæ¡ä»¶åœ¨æ•°æ®åº“æŸ¥æ‰¾ç¬¦åˆæ¡ä»¶çš„ä¿¡æ¯ï¼Œé‚£ä¹ˆè§†å›¾å±‚å°±å¯ä»¥æŸ¥çœ‹å¯¹åº”çš„ç»„å†…å†…å®¹äº†ã€‚ç”±äºä¸€èˆ¬ä¸å¿…è¦åœ¨å›æ”¶ç«™æ–°å»ºå†…å®¹ï¼Œæ‰€ä»¥åˆ‡æ¢åˆ°å›æ”¶ç«™æ—¶ï¼Œè¾“å…¥æŒ‰é’®ä¼šéšè—èµ·æ¥ã€‚æ­¤å¤–ï¼Œâ€œå…¨éƒ¨â€ä¸åŒ…æ‹¬â€œå›æ”¶ç«™â€ï¼ŒæŸ¥è¯¢æ—¶è¦è®¾ç½®å¥½çº¦æŸæ¡ä»¶ã€‚ç§»å…¥å›æ”¶ç«™å¯ä»¥é€šè¿‡é•¿æŒ‰ç¬”è®°æ¡ç›®é€‰æ‹©ï¼Œå¦‚å›¾2æ‰€ç¤ºã€‚æ›´æ”¹åˆ†ç»„å¯ä»¥åœ¨ç¬”è®°æµè§ˆç•Œé¢å®Œæˆï¼Œå¦‚å›¾3æ‰€ç¤ºã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210619200602.png" alt="image-20210619200602150"></p><h4 id="åˆ†äº«æ¨¡å—-1"><a href="#åˆ†äº«æ¨¡å—-1" class="headerlink" title="åˆ†äº«æ¨¡å—"></a>åˆ†äº«æ¨¡å—</h4><p>å‘é€æ–‡æœ¬å†…å®¹ï¼šåˆ›å»ºä¸€ä¸ª<strong>Intent</strong>å¹¶å°†å…¶æ“ä½œè¡Œä¸ºè®¾ç½®æˆ<strong>Intent.ACTION_SEND</strong>ï¼Œç„¶åè®¾ç½®åˆ†äº«çš„æ•°æ®ç±»å‹ä¸º<strong>text&#x2F;plain</strong>ï¼Œè°ƒç”¨<strong>putExtra()</strong> æ–¹æ³•æŠŠåä¸º<strong>Intent.EXTRA_TEXT</strong> çš„ç¬”è®°å†…å®¹æ”¾åˆ°<strong>Intent</strong>å¯¹è±¡é‡Œé¢å»ï¼Œæ¥ç€è°ƒç”¨<strong>Intent.createChooser()</strong> åˆ›å»ºä¸€ä¸ªåˆ†äº«<strong>Intent</strong>ï¼Œå¹¶å‘å…¶ä¼ é€’å‰é¢é‚£ä¸ª<strong>Intent</strong>å¯¹è±¡ï¼Œæœ€åè°ƒç”¨<strong>startActivity()</strong> æ–¹æ³•å®Œæˆåˆ†äº«åŠ¨ä½œï¼Œå¦‚å›¾1æ‰€ç¤ºã€‚</p><p>å‘é€å›¾ç‰‡ï¼šåœ¨æµè§ˆå›¾ç‰‡æ¡†æ¶<strong>MNImageBrowser</strong>é‡Œé¢è®¾ç½®å›¾ç‰‡çš„å•å‡»äº‹ä»¶ï¼Œä¹‹åçš„æ­¥éª¤åŸºæœ¬å’Œå‘é€æ–‡æœ¬å†…å®¹ç›¸åŒï¼Œä½†æœ‰ä¸¤ä¸ªåœ°æ–¹ä¸åŒï¼Œå‘é€å›¾ç‰‡è¦è®¾ç½®åˆ†äº«çš„æ•°æ®ç±»å‹ä¸º<strong>image&#x2F;jpeg</strong>ï¼Œé€šè¿‡<strong>putExtra()</strong> æ–¹æ³•æ”¾åˆ°<strong>Intent</strong>é‡Œé¢å»çš„æ˜¯åå­—ä¸º<strong>Intent.EXTRA_STREAM</strong>çš„å›¾ç‰‡<strong>Uri</strong>æ•°æ®ï¼Œå¦‚å›¾2æ‰€ç¤ºã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210619200633.png" alt="image-20210619200633904"></p><h4 id="æƒé™ç”³è¯·æ¨¡å—-1"><a href="#æƒé™ç”³è¯·æ¨¡å—-1" class="headerlink" title="æƒé™ç”³è¯·æ¨¡å—"></a>æƒé™ç”³è¯·æ¨¡å—</h4><p>æ™®é€šæƒé™ï¼šåœ¨<strong>AndroidManifest.xml</strong>æ–‡ä»¶æ·»åŠ æƒé™å£°æ˜ã€‚</p><p>å±é™©æƒé™ï¼šé¦–å…ˆåˆ›å»ºä¸€ä¸ªåŒ…å«å½•éŸ³ã€æ‹ç…§ã€è¯»å–æ–‡ä»¶å’Œå†™å…¥æ–‡ä»¶æƒé™çš„å­—ç¬¦ä¸²æ•°ç»„ï¼Œ ç„¶åé€šè¿‡<strong>ContextCompat.checkSelfPermission()</strong> æ–¹æ³•æ¥é€æ¡åˆ¤æ–­æ˜¯å¦å·²ç»è·å¾—æˆæƒã€‚æ¥ä¸‹æ¥ï¼Œå¯¹æ²¡æœ‰è·å¾—æˆæƒçš„æƒé™é€šè¿‡<strong>ActivityCompat.requestPermissions()</strong> æ–¹æ³•ä¸€æ¬¡æ€§ç”³è¯·æƒé™ã€‚æœ€åï¼Œåœ¨<strong>onRequestPermissionsResult()</strong> æ–¹æ³•ä¸­å¤„ç†æˆæƒç»“æœï¼Œå¦‚æœæ²¡æœ‰è·å¾—å¿…è¦æƒé™ï¼Œç¨‹åºå°†å…³é—­å¹¶é€€å‡ºã€‚æˆæƒè¿‡ç¨‹å¦‚å›¾æ‰€ç¤ºã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210619200657.png" alt="image-20210619200657822"></p><h4 id="æ•°æ®åº“å®ç°"><a href="#æ•°æ®åº“å®ç°" class="headerlink" title="æ•°æ®åº“å®ç°"></a>æ•°æ®åº“å®ç°</h4><p>æ•°æ®åº“é‡‡ç”¨çš„æ˜¯å®‰å“åŸç”Ÿæ”¯æŒçš„<strong>SQLite</strong>æ•°æ®åº“ï¼Œç”¨<strong>LitePal</strong>å¼€æºæ¡†æ¶å¯¹å…¶è¿›è¡Œæ“ä½œã€‚å¤šåŠŸèƒ½è®°äº‹æœ¬APPä¼šç»´æŠ¤ä¸¤ä¸ªæ•°æ®åº“ï¼Œä¸€ä¸ªæ˜¯å­˜å‚¨åœ¨å†…éƒ¨å­˜å‚¨å™¨çš„<strong>note.db</strong>æ•°æ®åº“æ–‡ä»¶ï¼Œç”¨äºæœ¬åœ°æ•°æ®çš„ä¿å­˜ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯å­˜å‚¨åœ¨å¤–éƒ¨å­˜å‚¨å™¨çš„<strong>noteBackup.db</strong>æ•°æ®åº“æ–‡ä»¶ï¼Œç”¨äºåšæœäº‘åŒæ­¥ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p>ï¼ˆ1ï¼‰ åŒ…å«åº“ï¼šé¦–å…ˆåœ¨<strong>build.gradle</strong>æ–‡ä»¶æ·»åŠ <strong>LitePal</strong>çš„ä¾èµ–é¡¹ï¼Œè¿™æ ·<strong>LitePal</strong>å¼€æºæ¡†æ¶å°±å¯¼å…¥è½¯ä»¶å·¥ç¨‹äº†ã€‚</p><p>ï¼ˆ2ï¼‰ é…ç½®<strong>litepal.xml</strong>ï¼šåœ¨é¡¹ç›®çš„<strong>assets</strong>æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªæ–‡ä»¶<strong>litepal.xml</strong>ï¼Œ   åœ¨æ–‡ä»¶é‡Œé¢å®šä¹‰å¥½æ•°æ®åº“åå­—å’Œç‰ˆæœ¬å·ã€‚</p><p>ï¼ˆ3ï¼‰ é…ç½®<strong>LitePal</strong>çš„ä¸Šä¸‹æ–‡å‚æ•°ï¼šåœ¨<strong>MyApplication</strong>ç±»çš„<strong>onCreate()</strong> å‡½æ•°é‡Œé¢è°ƒç”¨<strong>LitePal.initialize(this)</strong> å®Œæˆåˆå§‹åŒ–ã€‚</p><p>ï¼ˆ4ï¼‰ åˆ›å»ºæ•°æ®è¡¨ï¼šæ ¹æ®æ•°æ®è¡¨å­—æ®µå»ºå¥½<strong>Note</strong>ã€<strong>Todo</strong>å’Œ<strong>MediaForNote</strong>æ•°æ®ç±»å¹¶åœ¨<strong>litepal.xml</strong>æ–‡ä»¶æ·»åŠ æ•°æ®è¡¨çš„å£°æ˜åï¼Œå½“ç¨‹åºæ“ä½œæ•°æ®åº“æ—¶ï¼Œæ•°æ®è¡¨åœ¨æ•°æ®åº“ä¸­å°±ä¼šè‡ªåŠ¨ç”Ÿæˆã€‚åˆ°è¿™é‡Œï¼Œæ•°æ®åº“çš„å»ºè¡¨æ“ä½œå°±å®Œæˆäº†ã€‚ç¨‹åºå¯ä»¥é€šè¿‡<strong>LitePal</strong>æä¾›çš„æ¥å£å®Œæˆæ•°æ®åº“çš„å¢åˆ æ”¹æŸ¥ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>å®‰å“APP</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å®‰å“è®°äº‹æœ¬</tag>
      
      <tag>å®‰å“ä¾¿ç­¾</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ˜¥èŠ‚å›ä¹¡ï¼šè§é—»ä¸éšæƒ³</title>
    <link href="/article/432db37/"/>
    <url>/article/432db37/</url>
    
    <content type="html"><![CDATA[<h2 id="æ˜¥èŠ‚å›ä¹¡ï¼šè§é—»ä¸éšæƒ³"><a href="#æ˜¥èŠ‚å›ä¹¡ï¼šè§é—»ä¸éšæƒ³" class="headerlink" title="æ˜¥èŠ‚å›ä¹¡ï¼šè§é—»ä¸éšæƒ³"></a>æ˜¥èŠ‚å›ä¹¡ï¼šè§é—»ä¸éšæƒ³</h2><blockquote><p>ä½œè€…ï¼šéƒ‘è¤š</p></blockquote><p class="note note-info">å†…åœ°ä¸ºä»€ä¹ˆä¸ä¼šæˆä¸ºæ²¿æµ·</p><p>2016å¹´æ˜¥å¤©ï¼Œæˆ‘å’Œæœ‹å‹é©¾è½¦ä»æˆéƒ½å‡ºå‘ï¼Œç»è´µå·ã€å¹¿è¥¿ï¼ŒèŠ±ä¸‰å¤©æ—¶é—´åˆ°è¾¾å¹¿å·ã€‚è¿™ä¸€è¶Ÿæ¨ªç©¿ä¸­å›½è¥¿å—è…¹åœ°çš„æ—…è¡Œï¼Œè®©æˆ‘å‘ç°å¦‚æœæŠŠä¸­å›½æ¯”ä½œä¸€åªè›‹ç³•ï¼Œé‚£ä¹ˆç¹è£çš„ç ä¸‰è§’åªæ˜¯è›‹ç³•è¡¨é¢ä¸Šé‚£ä¸€å±‚è–„è–„çš„å¥¶æ²¹è€Œå·²ã€‚</p><p>è¿ç»µä¸æ–­çš„å±…æ°‘åŒºã€æ˜Ÿç½—å¯†å¸ƒçš„å·¥å‚ï¼Œä»¥åŠå»ºåœ¨éƒŠåŒºçš„å¤§å‹å•†è¶…ã€è½¦è¡Œç­‰æ±½è½¦æ—¶ä»£çš„ç‰¹å¾ï¼Œéƒ½è¦è¿›å…¥è‚‡åº†ç”šè‡³ä½›å±±å¢ƒå†…æ‰å¼€å§‹æ¶Œç°ã€‚è¿™æ—¶å€™ï¼Œç©¿è¶Šæ¼«é•¿å±±åŒºå’Œç”°é‡çš„æ— èŠä¼šè½¬åŒ–æˆå¯¹åŸå¸‚åŒ–å’Œç°ä»£åŒ–çš„æŒ¯å¥‹ä¹è§‚ï¼Œä½ è‡ªç„¶è€Œç„¶çš„å°±ä¼šè®¤ä¸ºï¼ŒåŸå¸‚åŒ–ä¼šç”±æ²¿æµ·åœ°åŒºå‘å†…åœ°ç¼“æ…¢æ¨è¿›ï¼Œæ²¿æµ·ä¸å†…åœ°çš„åŒºåˆ«åªæ˜¯æ—¶é—´é—®é¢˜ï¼Œåè€…æ™šèµ·æ­¥ä¸€äºŒåå¹´è€Œå·²ï¼Œä½ç”Ÿäº§ç‡å’ŒäººåŠ›èµ„æºå¯†é›†å‹çš„äº§ä¸šä¼šè‡ªç„¶è€Œç„¶çš„ä»æ²¿æµ·å‘å†…åœ°æº¢å‡ºï¼Œæ‰€æœ‰åœ¨æ²¿æµ·å‘ç”Ÿè¿‡çš„æ•…äº‹éƒ½æœ‰æœºä¼šä»ä¸œå‘è¥¿ï¼Œç”±å—è‡³åŒ—ï¼Œåœ¨å†…åœ°é‡æ¥ä¸€éã€‚</p><p>ç„¶è€Œåœ¨æ­¤è¯·å…ˆè®°ä½æˆ‘çš„ç»“è®ºï¼š<code>åœ¨é•¿ä¸‰è§’ç ä¸‰è§’å‘ç”Ÿçš„è¿™ä¸€åˆ‡ï¼Œä¹Ÿè®¸æ°¸è¿œä¸ä¼šåœ¨å†…åœ°å‘ç”Ÿï¼Œæ²¿æµ·å’Œå†…é™†çš„å‘½è¿æ—©å°±å·²ç»åˆ†é“æ‰¬é•³ï¼Œèµ°å‘ä¸åŒçš„æ–¹å‘ã€‚</code></p><p class="note note-info">1ï¼Œæ°´æ³¥é’¢ç­‹ç°ä»£åŒ–</p><p> æˆ‘è¿‡å»ä¸‰å¹´éƒ½æ²¡æœ‰åœ¨å››å·è€å®¶è¿‡æ˜¥èŠ‚ï¼Œä»Šå¹´å›å»ï¼Œç¬¬ä¸€ä¸ªæ„Ÿè§‰æ˜¯â€œå˜åŒ–å·¨å¤§â€ã€‚</p><p> ä»¥æˆ‘çˆ¸å¦ˆç”Ÿæ´»çš„å°å¿çº§å¸‚æ±Ÿæ²¹å¸‚ä¸ºä¾‹ï¼Œæ–°åŸåŒºçš„é¢ç§¯æ˜¯è€åŸçš„ä¸€åŠå¤§å°ï¼Œç¢§æ¡‚å›­å’Œæ’å¤§éƒ½åœ¨éƒŠåŒºå»ºäº†è¶…çº§å¤§ç›˜ï¼Œå®é¾™é›†å›¢åœ¨æ–°åŒºå»ºäº†ä¸€ä¸ªæ®è¯´æ˜¯å…¨åœ°çº§å¸‚èŒƒå›´å†…æœ€å¤§çš„å•†ä¸šç»¼åˆä½“ï¼Œå»å¹´åˆšåˆšå¼€å§‹è¥ä¸šã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ç»µé˜³å¸‚çš„æ–°æœºåœºã€ä»¥åŠæ®è¯´æ˜¯è¥¿éƒ¨æœ€å¤§çš„æ¸¸ä¹åœºç­‰å¤§å‹åœ¨å»ºé¡¹ç›®éƒ½åœ¨æ±Ÿæ²¹å¢ƒå†…ï¼Œè¿™ä¹Ÿä½¿å¾—æœ¬å¸‚çš„æˆ¿ä»·ä»ä¸¤å¹´å‰çš„3000å¤šå—ï¼Œé£™å‡åˆ°äº†äº”åƒä»¥ä¸Šï¼Œä¸€äº›æ–°ç›˜çš„è®¤è´­ä»·å·²ç»æ¥è¿‘ä¸ƒåƒã€‚ä¹°äº†æˆ¿å­çš„è‡ªç„¶æ˜¯æ¬¢å¤©å–œåœ°ï¼Œåœ¨å®¶åº­é¥­å±€ä¸Šï¼Œäº²æˆšä»¬éƒ½è®¤ä¸ºï¼Œç”±äºæœ¬å¸‚è¿˜æœ‰ä¸€åŠçš„äººå£æ²¡æœ‰è¿›å…¥åŸå¸‚ï¼Œä»¥åŠé™„è¿‘ä¸¤ä¸ªå†œä¸šå¿å¯¹æœ¬å¸‚çš„å¼ºçƒˆè®¤åŒï¼Œæ±Ÿæ²¹ä¼šæœ‰æ–°ä¸€æ³¢çš„äººå£æ¶Œå…¥ï¼Œæˆ¿ä»·å°†ä¼šè¿›ä¸€æ­¥æŠ¬é«˜ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210614162444.jpeg" alt="æˆ‘å®¶çª—å¤–çš„æ–°åŸåŒº"></p><p>è¿™ç§ä¹è§‚å½“ç„¶ä¸æ˜¯æ±Ÿæ²¹ç‹¬æœ‰çš„ï¼Œæ¯ä¸€ä¸ªåœ°æ–¹éƒ½åœ¨ä¸ºè‡ªå·±çš„æˆ¿ä»·å’Œæœªæ¥å‘å±•æ„Ÿåˆ°ä¹è§‚ï¼Œåœ¨ä¸Šé¢ä¸€çº§çš„åœ°çº§å¸‚ç»µé˜³å¸‚ï¼Œè¿‡å»ä¸¤å¹´çš„æˆ¿ä»·å‡ ä¹ä¹Ÿæœ‰ä¸€å€çš„æ¶¨å¹…ï¼Œæœ¬åœ°ç”µå°é¼“å¹å¤šå¹´çš„â€œæˆ¿ä»·è¿‡ä¸‡â€ç»ˆäºå®ç°äº†ï¼Œè¾ƒå¥½çš„æ–°å°åŒºæ¥¼é¢ä»·å·²ç»åœ¨ä¸€ä¸‡äºŒä»¥ä¸Šã€‚ä¸è¿‡ç»µé˜³å¸‚çš„æˆ¿ä»·é€»è¾‘å¹¶ä¸å®Œå…¨å› ä¸ºåŸºå»ºæˆ–è€…â€œåŸå¸‚å‡çº§â€ï¼Œè€Œæ˜¯æœ¬å¸‚æ´¥æ´¥ä¹é“çš„â€œï¼ˆä¸­å­¦ï¼‰æ•™è‚²å¼ºå¸‚â€ï¼Œäººä»¬ç›¸ä¿¡æœ¬å¸‚ä¸­å­¦çš„å¼ºçƒˆå¸å¼•åŠ›ï¼Œè®¤ä¸ºç”šè‡³é™•è¥¿ç”˜è‚ƒäº‘å—çš„å¾ˆå¤šäººéƒ½ä¸ºäº†å­å¥³ä¸Šä¸­å­¦ï¼Œæ­£åœ¨è¿å…¥æœ¬åœ°ï¼Œä¸ºæˆ¿ä»·ä¸Šæ¶¨æ¨æ³¢åŠ©æ¾œã€‚</p><p>å˜åŒ–çš„ä¸ä»…æ˜¯æˆ¿ä»·ï¼Œå‡ å¹´å†…ç°ä»£åŒ–å¤§å‹å•†è¶…æ–°å¼€äº†ä¸å°‘ï¼Œé¤é¥®ä¹Ÿç³ç…æ»¡ç›®ï¼Œæ—¥æ–™å’Œæ½®æ±•ç‰›è‚‰ç«é”…ä¸ä»…å¸¸è§ï¼Œè€Œä¸”éƒ½æœ‰äº†ç›¸å½“æ­£å®—çš„åº—ï¼ŒZARAã€æ±‰å ¡ç‹ç­‰è¿‡å»è®¤ä¸ºå¤§åŸå¸‚æ‰æœ‰çš„å•†ä¸šä¹Ÿå·²ç»åœ¨è¿™ä¸ªåŸå¸‚æ‰æ ¹ã€‚ä¸€ä¸ªæœ‹å‹å‘Šè¯‰æˆ‘ä»–æ‰“ç®—å¼•è¿›ç½‘çº¢å“ç‰Œå–œèŒ¶ï¼Œè¯´å®Œä»¥åä»–é—®æˆ‘ï¼Œâ€œä½ è§‰å¾—ç°åœ¨æˆ‘ä»¬è¿™é‡Œå’Œå¹¿å·çš„æ¶ˆè´¹æ¡£æ¬¡åŒºåˆ«å¤§å—ï¼Ÿâ€æˆ‘è¯´é™¤äº†è¿˜æ²¡æœ‰å¥¢ä¾ˆå“ä¸“å–åº—ï¼ŒåŒºåˆ«çœŸçš„ä¸å¤§ï¼Œæœ‹å‹ç«‹åˆ»çº æ­£æˆ‘ï¼Œå…¶å®æœ¬åœ°çš„å¥¢ä¾ˆå“æ¶ˆè´¹å·²ç»ç›¸å½“æµè¡Œäº†ï¼Œå®Œå…¨åº”è¯¥æ”¯æ’‘å¾—èµ·ä¸“å–åº—çš„æµé‡ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210614162456.jpeg" alt="æˆ‘å®¶æ¥¼ä¸‹çš„æ½®æ±•ç‰›è‚‰ç«é”…"></p><p>å½“ç„¶ï¼Œæ‰€æœ‰è¿™äº›éƒ½æ˜¯å…¶ä»–â€œå›ä¹¡è§é—»â€å¿…ç„¶è°ˆåŠçš„ï¼Œæ­¤å¤–è¦è°ˆåŠå®¶ä¹¡çš„ç°ä»£é¢è²Œï¼Œä¸å¹ä¸€ä¸‹é«˜é“ä¹Ÿä¸åˆæ—¶å®œï¼Œæ±Ÿæ²¹å¸‚å¯èƒ½æ˜¯ä¸­å›½å”¯ä¸€æ‹¥æœ‰ä¸‰ä¸ªé«˜é“ç«™çš„å¿çº§å¸‚ï¼Œå†åŠ ä¸Šæ­£åœ¨å»ºé€ çš„æœºåœºï¼Œå ªç§°åŸºå»ºç«äº‰çš„å¤§èµ¢å®¶ã€‚å®é™…ä¸Šå€ŸåŠ©é«˜é“ï¼Œæ˜¥èŠ‚æœŸé—´æˆ‘ç¬¬ä¸€æ¬¡å®ç°äº†ä¸€å¤©ä¹‹å†…è·¨è¶Šå››å·å››ä¸ªåŸå¸‚çš„æ—…è¡Œï¼Œåœ¨æ¯ä¸€ä¸ªåŸå¸‚éƒ½æœ‰åœç•™ï¼Œè€Œä¸”æ¨ªè·¨äº†å·å—å·åŒ—ã€‚</p><p>åœ¨ä¸æ–­ç”Ÿé•¿çš„é’¢ç­‹æ°´æ³¥é¢å‰ï¼Œä¸€åˆ‡éƒ½æ˜¯æ¬£æ¬£å‘è£çš„æ ·å­ï¼Œç”±äºå°åŸå¸‚æˆ¿ä»·æ›´ä½ã€ç”Ÿæ´»æˆæœ¬æ›´ä½ï¼Œä¹Ÿéš¾æ€ªæœ‰äººå–Šå‡ºäº†â€œä¸­å›½å†…åœ°ç”Ÿæ´»æ°´å¹³å·²æ¥è¿‘ç¾å›½â€çš„å£å·ã€‚</p><p class="note note-info">2ï¼Œå†œæ‘å¹¸ç¦é—¨æ§›</p><p>å›å®¶ç¬¬äºŒå¤©ï¼Œæˆ‘å’Œå¤ªå¤ªæ¥åˆ°æˆ‘å°æ—¶å€™ç”Ÿæ´»çš„å°é•‡ï¼Œå°é•‡å¹¶æ²¡æœ‰å’ŒåŸå¸‚ä¸€æ ·è“¬å‹ƒç”Ÿé•¿çš„æ–°åŒºä¸å•†å“æˆ¿ï¼Œå¯è§çš„ä¸»è¦å˜åŒ–æ˜¯æ¥¼æˆ¿å¤šäº†ï¼Œä»¥åŠé•‡ä¸Šå‡ ä¹æ¯ä¸ªå®¶åº­éƒ½æ™®åŠäº†æ±½è½¦ã€‚</p><p>ä¸åˆ°å†…åœ°ä¹¡é•‡ï¼Œä½ å¯èƒ½ä¸ä¼šçŸ¥é“æœ‰è¿™ä¹ˆå¤šé”€é‡æƒŠäººã€ä»·æ ¼ç‚¸è£‚çš„ä¸­å›½å“ç‰ŒSUVï¼Œä½œä¸ºä¸€ä¸ªæ±½è½¦çˆ±å¥½è€…ï¼Œå¾ˆå¤šè½¦è¿æˆ‘éƒ½æ˜¯ç¬¬ä¸€æ¬¡çœ‹è§å®ç‰©ã€‚å¥”è…¾ã€å®éªã€åŠ›å¸†ã€åŒ—æ±½å¹»é€Ÿã€ä¼—æ³°ã€é‡‘æ¯ã€ç‘é£ã€æ˜Œæ²³çš„SUVé˜µè¥æ¶µç›–äº†å†œæ‘å®¶åº­çš„ä¸»è¦è´­è½¦èŒƒå›´ï¼Œè¿™äº›è½¦çš„å…±åŒç‰¹ç‚¹æ˜¯ï¼šé€‚åº”å†œæ‘è·¯å†µã€ä½“å‹è¾ƒå¤§èƒ½è£…ã€åŠ ä¿é™©åœ¨å†…çš„å…¨å¥—è´­è½¦æˆæœ¬å¯ä»¥æ§åˆ¶åœ¨10ä¸‡ä»¥å†…ï¼Œä¸€èˆ¬ä¸è¶…è¿‡8ä¸‡ã€‚åŸä»¥ä¸ºä¼šé€šæ€å››æ–¹çš„å“ˆå¼—H6ã€ä¼ ç¥ºGS4ã€å‰åˆ©åšè¶Šï¼Œåè€Œå› ä¸ºå”®ä»·è¾ƒé«˜ï¼Œåœ¨é•‡é‡Œéš¾å¾—ä¸€è§ã€‚</p><p>æˆ‘ä»¬ä¸¤ä¸ªäººç«™åœ¨æˆ‘è¡¨å“¥çš„æ¥¼é¡¶ï¼Œæˆ‘å‘Šè¯‰æˆ‘å¤ªå¤ªï¼Œå»ºé€ è¿™æ ‹ä½“å‹åºå¤§ã€è®¾è®¡æç«¯éšæ„çš„æ¥¼æˆ¿èŠ±è´¹äº†50å¤šä¸‡å…ƒï¼Œåœ¨å®ƒä¿®å»ºçš„æ—¶å€™ï¼ŒåŒæ ·çš„é’±å¯ä»¥å»æ±Ÿæ²¹ä¹°ä¸¤å¥—å°æˆ·å‹ï¼Œäºæ˜¯å¥¹é—®æˆ‘ï¼Œâ€œè¿™é’±ä¸ºä»€ä¹ˆä¸å»æ±Ÿæ²¹ä¹°æ¥¼ç­‰å‡å€¼å‘¢ï¼Ÿâ€å®é™…ä¸Šï¼Œå‘¨è¾¹å¤§å¤§å°å°çš„å†œæ°‘è‡ªå»ºå°æ¥¼ï¼Œæˆæœ¬éƒ½åœ¨30ä¸‡ä»¥ä¸Šï¼Œè¿™ç¬”é’±ä¸¤ä¸‰å¹´å‰æ‹¿åˆ°æ±Ÿæ²¹å»ï¼Œéƒ½å¯ä»¥ä¹°ä¸€å¥—æˆ¿ã€‚åŸé‡Œçš„æˆ¿å­æœ‰æœºä¼šå‡å€¼ï¼Œè€Œä¸”æ–¹ä¾¿å‡ºç§Ÿï¼Œä½†ä¹¡é•‡çš„æˆ¿å­åªä¼šæ…¢æ…¢è´¬å€¼ï¼Œç§Ÿä¹Ÿä¸å®¹æ˜“ç§Ÿå‡ºå»ï¼Œè€Œä¸”ç§Ÿä»·æä½ï¼Œçœ‹èµ·æ¥æ˜¯éå¸¸ä¸åˆ’ç®—çš„é€‰æ‹©ï¼Œä½†å†œæ°‘æœ‰è‡ªå·±çš„è€ƒè™‘ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210614162512.jpeg" alt="é•‡é‡Œçš„å†œæ°‘è‡ªå»ºæˆ¿"></p><p>é¦–å…ˆï¼Œå®…åŸºåœ°åˆ’æ‹¨æ¥ä¹‹ä¸æ˜“ï¼Œä¸€æ—¦è·å¾—äº†æ‰¹å‡†ï¼Œå¿…é¡»å»ºæˆ¿æŠŠå®ƒå èµ·æ¥æ‰èƒ½æ”¾å¿ƒã€‚æ›´é‡è¦çš„æ˜¯ï¼Œå¦‚æœåœ¨åŸå¸‚ä¹°æˆ¿ï¼Œåç»­çš„åŸå¸‚ç”Ÿæ´»æˆæœ¬å§‹ç»ˆè¾ƒé«˜ï¼Œè€Œåœ¨å†œæ‘æœ‰ä¸€å¥—è¿™æ ·çš„æˆ¿å­ï¼Œå°±è®©è‡ªå·±å’Œå­å¥³ç»“å©šéƒ½æœ‰äº†ä½å¤„ï¼Œå†ä¹°ä¸Šä¸€è¾†è½¦ï¼ŒåŸºæœ¬ä¸Šç®—æ˜¯å†œæ‘ç”Ÿæ´»çš„stageé€šå…³äº†ï¼Œç”¨æˆ‘å¤ªå¤ªçš„è¯è¯´ï¼Œå°±æ˜¯â€œä½™ç”Ÿå¯ä»¥èººç€æ´»äº†â€ã€‚</p><p>ç”±äºé€€è€•è¿˜æ—ï¼Œæˆ‘è€å®¶ä¹¡é•‡å‘¨å›´çš„å†œæ°‘ï¼Œå¤§å¤šæ•°éƒ½åªç»´æŒå¾ˆå°‘çš„åœŸåœ°ï¼Œç•™åœ¨æœ¬åœ°ç”Ÿæ´»çš„ä»¥è€å¹´äººä¸ºä¸»ã€‚å†œæ‘â€œæ–°å†œä¿â€è¦†ç›–ç‡æé«˜ï¼Œå†åŠ ä¸Šæœ¬åœ°å¤§å¤šæ•°äººéƒ½æœ‰å¤±åœ°å†œæ°‘è¡¥è´´ï¼Œå› æ­¤å¾ˆå¤šæ™®é€šå†œæ°‘åœ¨60å²ä»¥åå¯ä»¥é¢†åˆ°ä¸€åƒå…ƒä»¥ä¸Šçš„ç¤¾ä¿ï¼Œä¸€å¯¹å¤«å¦»å°±æ˜¯ä¸¤åƒå¤šå…ƒï¼Œè¿™ç¬”æ”¶å…¥åœ¨åŸå¸‚ä¸å¤Ÿç”¨ï¼Œä½†åœ¨å†œæ‘å´æ˜¯è¶³å¤Ÿã€‚æˆ‘ä»¬ç®—äº†ä¸€ä¸‹ï¼ŒåŸæ¥åœ¨è€å®¶å°é•‡ï¼Œâ€œèººç€ç”Ÿæ´»â€çš„é—¨æ§›å°±æ˜¯30ä¸‡å…ƒçš„å»ºæˆ¿æˆæœ¬+10ä¸‡å…ƒè´­è½¦æˆæœ¬ï¼Œ40ä¸‡å…ƒå³å¯äººç”Ÿé€šå…³å®‰äº«æ™šå¹´ï¼Œè¿˜æŒºè®©äººç¾¡æ…•çš„ã€‚</p><p>ä¸è¿‡ï¼Œ40ä¸‡å…ƒåœ¨ä¹¡é•‡å’Œå†œæ‘å…¶å®æ˜¯ä¸€ä¸ªç›¸å½“é«˜çš„é—¨æ§›ï¼Œå¹´è½»äººå¦‚æœå‡ºé—¨æ‰“å·¥ç§¯æ”’è¿™40ä¸‡ï¼Œå³ä½¿æ¯å¹´å­˜3ä¸‡å…ƒï¼ˆä¹Ÿå°±æ˜¯æ¯ä¸ªæœˆç§¯æ”’2500å…ƒï¼‰ï¼Œå­˜å¤Ÿè¿™ç¬”é’±ä¹Ÿè¦åå¹´ä»¥ä¸Šã€‚è€Œè¦ç•™åœ¨æœ¬åœ°å®ç°è¿™ç¬”ç§¯ç´¯åŸºæœ¬ä¸Šæ˜¯ä¸å¯èƒ½çš„ï¼Œé•‡ä¸Šæå°‘æœ‰å·¥ä½œå²—ä½ï¼Œåœ¨æ‰‹æœºåº—å’Œå°é¥­é¦†å½“ä¸ªè¥ä¸šå‘˜ï¼Œä¸€ä¸ªæœˆéƒ½åªæœ‰ä¸€åƒå¤šå—é’±ï¼Œçœ‹ç»Ÿè®¡æ•°æ®çš„è¯ï¼Œç»µé˜³å¸‚2017å¹´çš„å†œæ‘å±…æ°‘äººå‡å¯æ”¯é…æ”¶å…¥ï¼Œåªæœ‰14752å…ƒã€‚</p><p>æ‰€ä»¥ï¼Œé•‡ä¸Šçš„â€œå¹³å‡å»ºæˆ¿å¹´é¾„â€ï¼Œæ¯”åŸå¸‚çš„â€œå¹³å‡è´­æˆ¿å¹´é¾„â€è¦å¤§å¾—å¤šï¼Œè¿™äº›å°æ¥¼çš„æˆ¿ä¸»å¹´é¾„åŸºæœ¬éƒ½åœ¨ä¸­å¹´ä»¥ä¸Šï¼ŒæŸç§ç¨‹åº¦ä¸Šï¼Œèƒ½ä½è¿›é•‡ä¸Šè¿™ç§å°æ¥¼ï¼Œå®ç°â€œæœ‰æˆ¿æœ‰è½¦â€å¹¶ä¸æ˜¯æ™®éç°è±¡ï¼Œè€Œæ˜¯æœ¬åœ°å†œæ‘çš„â€œæˆåŠŸè€…â€ã€‚</p><p>è¿™ä¹ˆä¸€çœ‹ï¼Œâ€œèººç€ç”Ÿæ´»â€ç¦»æ™®é€šå†œæ‘äººï¼Œå…¶å®åˆä»ç„¶å¾ˆè¿œã€‚</p><p>è€Œä¸”ï¼Œèººç€ç”Ÿæ´»ä¹Ÿæ²¡æœ‰é‚£ä¹ˆä¸°æ»¡ï¼Œæˆ‘æœ¬æ¥ä»¥ä¸ºï¼Œå®¶å®¶æˆ·æˆ·æœ‰è½¦ä¼šè®©æœ¬é•‡å¼€äº”è±å®å…‰è·‘å®¢è¿è¿™é—¨ç”Ÿæ„æ¶ˆå¤±ï¼Œç„¶è€Œå¹¶æ²¡æœ‰ï¼Œä¹°äº†è½¦ä¸ç­‰äºå®ç°æ±½è½¦ä»£æ­¥ï¼Œå› ä¸ºæ²¹è´¹å¯¹æ™®é€šäººæ¥è¯´å¤ªè´µäº†ã€‚ä¾‹å¦‚åˆ°ä¸´è¿‘çš„æ±Ÿæ²¹å¸‚å¾€è¿”ä¸€è¶Ÿï¼Œè‡ªå·±å¼€è½¦çš„è¯ï¼Œå·®ä¸å¤šéœ€è¦50å…ƒæ²¹è´¹ï¼Œè€Œæ­è½¦åªéœ€è¦20å…ƒï¼Œå› æ­¤å¾ˆå¤šäººçš„ç§å®¶è½¦åªæœ‰åœ¨å…¨å®¶å‡ºè¡Œæˆ–è€…å»ä¸æ–¹ä¾¿æ­è½¦çš„åœ°æ–¹æ‰ä¼šä½¿ç”¨ã€‚</p><p>é•‡ä¸ŠçœŸæ­£å®ç°äº†æ±½è½¦ä»£æ­¥çš„æ˜¯å…¬åŠ¡å‘˜å’Œæ•™å¸ˆç­‰â€œå›½å®¶å•ä½äººå‘˜â€ã€‚ä¸€å¯¹æœ‰ä¸€å®šå·¥ä½œå¹´é™çš„æ•™å¸ˆå¤«å¦‡ï¼Œå¦‚æœç®—ä¸Šä½æˆ¿å…¬ç§¯é‡‘ï¼Œå®¶åº­å¹´æ”¶å…¥å¯ä»¥è¾¾åˆ°15ä¸‡å…ƒï¼ˆå»å¹´åŒ—å·å¿æ•™å¸ˆçš„å¹´ç»ˆå¥–æ˜¯æ¯äººä¸‰ä¸‡å…ƒï¼Œå…¬åŠ¡å‘˜åˆ™ä¸ºäº”ä¸‡å…ƒï¼‰ã€‚è¿™äº›å®¶åº­çš„æ±½è½¦é€‰æ‹©ä¹Ÿæˆªç„¶ä¸åŒï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯åˆèµ„å“ç‰Œï¼Œè½¦ä»·åˆ†å¸ƒåœ¨15è‡³20ä¸‡å…ƒä¹‹é—´ã€‚å½“ç„¶ï¼Œä»–ä»¬ä¹Ÿä¸ç®—å½»åº•çš„æœ¬é•‡å±…æ°‘ï¼Œä¸€ä¸ªä¹¡é•‡çš„æ•™å¸ˆæˆ–è€…å…¬åŠ¡å‘˜å³ä½¿è¿˜æ²¡æœ‰åœ¨æ±Ÿæ²¹å¸‚æˆ–ç»µé˜³å¸‚ä¹°æˆ¿ï¼Œåˆ°ç»“å©šçš„æ—¶å€™ä¹Ÿä¸€å®šä¼šä¹°ï¼Œâ€œè¿›åŸâ€è¿™ä»¶äº‹åœ¨è·å¾—å…¬èŒçš„æ—¶å€™å°±å·²ç»æ³¨å®šäº†ã€‚</p><p>ä¸ºä»€ä¹ˆä¹¡é•‡çš„å…¬èŒäººå‘˜å¯ä»¥å®ç°â€œåŸå¸‚åŒ–â€è€Œå†œæ°‘ä¸å¯ä»¥ï¼Œå½’æ ¹ç»“åº•è¿˜æ˜¯æ”¶å…¥æ°´å¹³ã€‚ä¸€ä¸ªå†œæ°‘å³ä½¿æ”’å¤Ÿä¸€å¥—å…¨æ¬¾çš„é’±ï¼Œä¹Ÿéš¾ä»¥è´Ÿæ‹…åç»­çš„åŸå¸‚ç”Ÿæ´»æˆæœ¬ï¼Œåªèƒ½ç•™åœ¨æœ¬åœ°ç›–æ¥¼ã€ä¹°è½¦ï¼Œâ€œèººç€ç”Ÿæ´»â€å®é™…ä¸Šæ˜¯é€‰æ‹©ä½æ”¶å…¥ä½å¼€é”€æ¨¡å¼ã€‚</p><p class="note note-info">3ï¼Œå†…åœ°çš„å•†ä¸šæœºä¼š</p><p>å¦‚æœè¯´ä¹¡é•‡çš„â€œæˆåŠŸâ€é—¨æ§›æ˜¯40ä¸‡ï¼Œé‚£ä¹ˆåœ¨ç»µé˜³çš„é—¨æ§›æ˜¯å¤šå°‘ï¼Ÿ</p><p>æ¯ä¸ªåŸå¸‚éƒ½æµä¼ ç€â€œæœ¬åœ°æœ‰é’±äººä¼—å¤šï¼Œè±ªè½¦å¦‚äº‘â€çš„éƒ½å¸‚ä¼ è¯´ï¼Œç»µé˜³å½“ç„¶ä¹Ÿä¸ä¾‹å¤–ã€‚äººä»¬ä¸€èˆ¬è¯´çš„â€œè±ªè½¦â€æ˜¯ä»¥å“ç‰Œè€Œéä»·æ ¼åˆ’åˆ†ï¼Œä¾‹å¦‚ä¸°ç”°æ±‰å…°è¾¾ã€æœ¬ç”°å† é“ï¼Œæ²¡æœ‰äººè®¤ä¸ºå±äºè±ªè½¦èŒƒç•´ï¼Œä½†ä¸å®ƒä»¬å®é™…ä»·æ ¼å·®ä¸å¤šçš„å®é©¬X1æˆ–å¥¥è¿ªA4åˆ™ç®—æ˜¯å…¥é—¨è±ªè½¦ã€‚ä»¥è¿™ä¸ªæ ‡å‡†æ¥çœ‹ï¼Œç»µé˜³çš„â€œè±ªè½¦â€æ™®åŠåº¦ç¡®å®é¢‡é«˜ï¼Œæˆ‘çš„ä¸å°‘æœ‹å‹éƒ½å·²å®ç°äº†è±ªè½¦ä»£æ­¥ã€‚</p><p>ä½†æŠŠè±ªè½¦ç­‰äºè½¦ä¸»æœ‰é’±ï¼Œåˆ™æå¤§çš„é«˜ä¼°äº†è±ªè½¦çš„å«é‡‘é‡ã€‚è±ªè½¦å¯¹å¹¿ä¸œäººè€Œè¨€ï¼Œå±äºæ±½è½¦æ–¹é¢å¾ˆæ™®é€šçš„é€‰æ‹©ä¹‹ä¸€ï¼Œå¹¶ä¸å…·å¤‡ä»€ä¹ˆäººç”Ÿæ„ä¹‰ã€‚ä½†è±ªè½¦åœ¨å†…åœ°çš„æ„ä¹‰éå¸¸é‡å¤§ï¼Œå¼€ä¸ŠBBAå’Œä¹°æˆ¿ä¸€æ ·ï¼Œæ˜¯å°æœ‰æˆå°±ä¹‹åçš„å¿…ç„¶é€‰æ‹©ï¼Œä¹Ÿæ˜¯åœ¨ç«äº‰æ¸¸æˆä¸­é€šå…³çš„è¯æ˜ï¼Œå¦‚æœä¸€ä¸ªäººå¦‚æœå·²ç»æœ‰äº†ä¸€å¥—æˆ¿ï¼Œæ²¡æœ‰å¤ªå¤§çš„è¿˜è´·å‹åŠ›ï¼Œæ¯å¹´åˆæœ‰ä¸ªåå‡ äºŒåä¸‡çš„æ”¶å…¥ï¼Œå°±è¦å¼€å§‹åŠ¨å¿ƒæ€æŒ‰æ­ä¸€è¾†å®é©¬3ç³»ï¼Œâ€œèµ°ä¸Šäººç”Ÿå·…å³°â€äº†ã€‚</p><p>ä½†å®é™…ä¸Šï¼Œæœ‰æˆ¿æœ‰è½¦çš„æˆåŠŸåªæ˜¯é˜¶æ®µæ€§çš„ï¼Œåœ¨ç»µé˜³æˆ‘å’Œå‡ ä¸ªå‘å°åƒé¥­ï¼Œé¥­æ¡Œä¸Šé™¤äº†ä¸€å¯¹ä¸­å­¦æ•™å¸ˆå¤«å¦»å’Œä¸€ä½æŸæ”¯è¡Œå‰¯è¡Œé•¿ï¼Œå¦å¤–ä¸¤ä½å¼€ä¸Šäº†â€œè±ªè½¦â€çš„æœ‹å‹éƒ½æƒ³è·Ÿæˆ‘èŠèŠåˆ›ä¸šã€‚</p><p>å…¶ä¸­ä¸€ä½08å¹´ä»¥åå¼€å§‹æåŸºå»ºï¼Œé«˜å³°æ—¶æœŸæ¯å¹´æœ‰ä¸€ç™¾å¤šä¸‡çš„åˆ©æ¶¦ï¼Œå‡ å¹´å‰å…¬å¸æ•ˆç›Šå¥½çš„æ—¶å€™ç»™å®¶é‡Œä¹°äº†ä¸‰å¥—æˆ¿ï¼Œç»™è‡ªå·±ä¹°äº†å¡å®´ï¼Œè€å©†ä¹Ÿå¼€ä¸Šäº†å¥”é©°ï¼Œä½†è¿‘å‡ å¹´åŸºå»ºæ½®é€€ï¼Œè¿‡å»ä¸¤å¹´åŸºæœ¬æ²¡æœ‰æ”¶å…¥ï¼Œæ‰‹å¤´ä¸å‰©å¤šå°‘ä½™é’±ï¼Œå…¬å¸ä¹Ÿæ­£åœ¨åŠæ³¨é”€ã€‚å¦å¤–ä¸€ä½åœ¨å…¬è·¯è®¾è®¡é™¢ï¼ˆç§ä¼ï¼‰å·¥ä½œçš„æœ‹å‹ï¼Œ08å¹´å°±å¼€å§‹æœˆå…¥ä¸¤ä¸‡ï¼Œä½†æ”¶å…¥å·²ç»åå¹´æ²¡æœ‰å¢é•¿ï¼Œæœ¬åœ°æ¶ˆè´¹æ°´å¹³å´è¶Šæ¥è¶Šé«˜ï¼Œç›®å‰è§‰å¾—ç”Ÿæ´»é€æ¸åƒåŠ›ï¼Œä¸»è¦å¹´çºªå¤§äº†ç†¬å¤œç”»å›¾æ—¥æ¸åƒåŠ›ï¼Œä¹Ÿè§‰å¾—å¿…é¡»æ‰¾ä¸€ä¸ªå±äºè‡ªå·±çš„ç”Ÿæ„ï¼Œä¸èƒ½å†è¿™ä¹ˆæ‰‹åœå£åœã€‚</p><p>è·Ÿæ±‰å ¡ç‹ã€ZARAä¸€èµ·å‡ºç°çš„ï¼Œæ˜¯å¿«é€Ÿä¸Šæ¶¨çš„æ¶ˆè´¹æ°´å¹³ï¼Œä¹°å¡å®´çš„æœ‹å‹è¯´ï¼ŒåŸæœ¬ä»¥ä¸ºæŒ£ä¸ªåƒæŠŠä¸‡å°±è¶³å¤Ÿåœ¨è¿™ä¸ªåŸå¸‚å®‰åº¦æ™šå¹´ï¼Œç»“æœä¸€åƒä¸‡æ²¡æŒ£åˆ°ï¼Œç‰©ä»·å´è¶Šæ¥è¶Šé«˜ï¼Œæ¯”å¦‚å­å¥³è¯»ä¹¦ï¼Œä¸ç®¡ä¸Šå…¬ç«‹ç§ç«‹ï¼Œä¸€å¹´ä¸‰äº”ä¸‡æ€»æ˜¯å…ä¸äº†ï¼Œè€Œæ—¥å¸¸æ¶ˆè´¹ï¼Œå–èŒ¶æ³¡å§åƒç«é”…ï¼ŒåŒ…æ‹¬åœè½¦è´¹ï¼Œéƒ½åŸºæœ¬ä¸æ¯”æˆéƒ½ä½ã€‚</p><p>ç‰©ä»·å‡é«˜çš„åŒæ—¶ï¼Œæ”¶å…¥å´å¹¶æ²¡æœ‰åŒæ­¥æå‡ï¼Œåå¹´å‰ä¸€ä¸ªæœ¬åœ°é¥­é¦†å¸®å·¥çš„æœˆè–ªæ˜¯ä¸åˆ°ä¸¤åƒï¼Œç°åœ¨åˆ™æ˜¯ä¸¤åƒå¤šå—ï¼Œåå¹´å¢é•¿äº†å‡ ç™¾å—è€Œå·²ã€‚æœ€èƒ½ä½“ç°æ”¶å…¥çš„æ˜¯æˆ¿ç§Ÿï¼Œä¸€åƒäº”å·¦å³å°±èƒ½ç§Ÿåˆ°å¸‚ä¸­å¿ƒçš„å¤§ä¸¤æˆ¿ï¼Œä¹Ÿè·Ÿäº”å¹´å‰åŸºæœ¬æ¯«æ— å˜åŒ–ã€‚è¿‡å»åå¹´æ”¶å…¥æ°´å¹³å’Œæ¶ˆè´¹æ°´å¹³ä¸€èµ·å¢é•¿çš„åªæœ‰æ”¿åºœé›‡å‘˜å’Œå›½æœ‰ä¼äº‹ä¸šå•ä½ï¼Œåå¹´å‰æœ¬åœ°æ™®é€šæ•™å¸ˆçš„é€€ä¼‘å·¥èµ„æ˜¯ä¸‰åƒå·¦å³ï¼Œä¸ç§è¥ä¼ä¸šçš„å·¥ä½œä¸€ä¸¤å¹´çš„æœ¬ç§‘åº”å±Šç”ŸæŒå¹³ï¼Œä½†ä»Šå¤©ç§ä¼é‡Œçš„æœ¬ç§‘ç”Ÿä»ç„¶æ‹¿ç€ä¸‰åƒéƒ½çš„å·¥èµ„ï¼Œä½†ä¸€ä¸ª2018å¹´é€€ä¼‘çš„å°å­¦æ•™å¸ˆï¼Œé€€ä¼‘é‡‘å¯ä»¥æ‹¿åˆ°7000ä»¥ä¸Šã€‚</p><p>å½“ä½ å’Œä¸€ä¸ªç»µé˜³ç”Ÿæ„äººè®¨è®ºåˆ›ä¸šï¼Œå¾ˆå¤šäººçš„ç¬¬ä¸€å¥è¯æ˜¯â€œè¦æŒ£é’±å°±è¦æå¥½æ”¿åºœå…³ç³»ï¼ŒæŒ£æ”¿åºœçš„é’±â€â€”â€”å¤§æ¦‚è¿™æ‰æ˜¯å†…åœ°å’Œæ²¿æµ·æœ€æ˜æ˜¾çš„åŒºåˆ«ã€‚</p><p>è¿™å€’ä¸æ˜¯å› ä¸ºæœ¬åœ°ç”Ÿæ„äººå´‡æ‹œæƒåŠ›ï¼Œè€Œæ˜¯å¦‚æœä¸è·Ÿæ”¿åºœç©ï¼Œä½ å‰©ä¸‹çš„ç©ºé—´éå¸¸å°ã€‚å‘è¾¾çš„ç‰©æµä¸šå·²ç»æŠŠå…¨å›½å˜æˆä¸€ä¸ªç»Ÿä¸€å¸‚åœºï¼Œå¸¦æ¥çš„åæœä¹‹ä¸€æ˜¯è½åäº§èƒ½è¢«è¿…é€Ÿæ·˜æ±°ï¼Œæ¯”å¦‚ï¼Œä¸­å›½è¶Šæ¥è¶Šä¸éœ€è¦å†…åœ°çš„æœè£…é‹å¸½ç©å…·å‚äº†ï¼Œæœ‰é•¿ä¸‰è§’ç ä¸‰è§’å°±å¤Ÿäº†ã€‚</p><p>é™¤äº†å·²ç»åšåˆ°ä¸Šå¸‚æˆ–æ¥è¿‘ä¸Šå¸‚è§„æ¨¡çš„åŒ–å·¥ã€åŒ»è¯ã€é£Ÿå“åŠ å·¥ç­‰ä¸­å¤§å‹ä¼ä¸šï¼Œå†…åœ°æ™®é€šçš„æ°‘è¥ä¼ä¸šå·²ç»å¾ˆéš¾å†å‡ºå¤´åšå¤§ï¼Œ2017å¹´Aè‚¡ç”³æŠ¥ä¸Šå¸‚çš„388å®¶ä¼ä¸šï¼Œæœ‰270å®¶ä½äºé•¿ä¸‰è§’ã€ç ä¸‰è§’å’ŒåŒ—äº¬ï¼Œæ•´ä¸ªå››å·åªæœ‰9å®¶ã€‚</p><p>æ‰‹æœºï¼Œç”µå™¨ï¼ŒåŒ–å¦†å“ã€ç®±åŒ…ã€äº”é‡‘ï¼Œç”šè‡³å®¶å…·â€¦â€¦å®ƒä»¬çš„ç”Ÿäº§éƒ½è¶Šæ¥è¶Šé›†ä¸­äºæ²¿æµ·åœ°åŒºï¼Œå†…åœ°å”¯ä¸€èƒ½å‚ä¸çš„äº‹æƒ…æ˜¯è´­ä¹°å’Œåˆ†å‘ã€‚å•†å“æ¨èAPPâ€œç›–å¾—æ’è¡Œâ€åœ¨2017å¹´åšè¿‡ä¸€é¡¹ç»Ÿè®¡ï¼Œä»–ä»¬çš„900å¤šä¸ªå•†å“æ’è¡Œæ¦œä¸­ï¼Œæ¨èæ¶ˆè´¹è€…è´­ä¹°çš„ä¸­å›½å“ç‰Œæœ‰1633ä¸ªï¼Œå…¶ä¸­1348ä¸ªå“ç‰Œæ¥è‡ªä¸œéƒ¨æ²¿æµ·åœ°åŒºï¼Œåªæœ‰285ä¸ªå“ç‰Œå±äºå†…åœ°çœä»½ã€‚ä»…å¹¿ä¸œä¸€çœï¼Œå°±æœ‰469ä¸ªè¢«æ¨èå“ç‰Œï¼ŒåŸºæœ¬æ¶µç›–äº†æ‰€æœ‰çš„æ¶ˆè´¹å“ç±»ï¼Œè¢«æ¨èå“ç‰Œæœ€å¤šçš„å†…åœ°çœä»½æ˜¯å››å·çœï¼Œåªæœ‰39ä¸ªå“ç‰Œã€‚</p><p>ä¸€å®¶è¡Œä¸šå¤´éƒ¨å…¬å¸å¹¶ä¸ä»…ä»…åªä»£è¡¨å®ƒè‡ªå·±ï¼Œå®ƒçš„èƒŒåè¿˜æœ‰ä¸Šä¸‹æ¸¸äº§ä¸šé›†ç¾¤ã€‚ç»å¤§å¤šæ•°ç”Ÿäº§ä¼ä¸šçš„å¤´éƒ¨å…¬å¸ä½äºæ²¿æµ·åœ°åŒºï¼Œæ„å‘³ç€è¿™äº›è¡Œä¸šçš„é…å¥—äº§ä¸šã€ä¾›åº”é“¾ã€å·¥ä¸šç‰©æµç­‰å‘å±•å’Œå°±ä¸šæœºä¼šä¹Ÿéƒ½ä¸åœ¨å†…åœ°ã€‚</p><p>è€Œäº’è”ç½‘æ–°ç»æµçš„ç”Ÿäº§æ¯”ä¼ ç»Ÿç»æµæ›´åŠ é›†ä¸­ï¼Œä¾‹å¦‚äº’è”ç½‘å¹¿å‘Šçš„äº§ä¸šè§„æ¨¡æ˜¯3500äº¿ï¼Œç»å¤§éƒ¨åˆ†è¢«åŒ—äº¬ã€æ·±åœ³ã€æ­å·ä¸‰ä¸ªåŸå¸‚ç“œåˆ†ï¼›æ¸¸æˆæ˜¯ä¸€ä¸ª2000äº¿çš„äº§ä¸šï¼Œä½†åŒæ ·åªè¦å¹¿å·æ·±åœ³æˆéƒ½ç­‰å°‘æ•°å‡ ä¸ªåŸå¸‚ï¼Œå°±åŸºæœ¬ç“œåˆ†äº†å…¨å›½å¸‚åœºã€‚</p><p>å¯¹æ™®é€šå°å¾®ä¼ä¸šæ¥è¯´ï¼Œå†…åœ°åªå‰©ä¸‹ä¸¤ä¸ªç”Ÿæ„ï¼š1,é¤é¥®æˆ–æœ¬åœ°æœåŠ¡ã€‚2ï¼Œä»æ”¿åºœåˆ†é’±ï¼Œæˆ–è€…ä¾æ‰˜æ”¿åºœæƒåŠ›å¯»ç§Ÿçš„ç”Ÿæ„ï¼ˆèµŒåšæœºã€æ´—æµ´ä¸­å¿ƒç­‰ï¼‰ã€‚ä½†æ˜¯é¤é¥®å‘¢ï¼Œæ®éæ­£å¼ç»Ÿè®¡ï¼Œé¤é¥®ä¼ä¸šå¹´æ¢æ‰‹ç‡è¶…è¿‡ä¸‰æˆï¼Œä¹Ÿå°±æ˜¯å¹³å‡ä¸€å®¶é¤å…åªèƒ½å¼€ä¸‰å¹´å¤šå°±ç ´äº§äº†ã€‚</p><p>æ‰€ä»¥ä½ ä¸èƒ½ä¸ç†è§£ä¸ºä»€ä¹ˆå†…åœ°å¯¹â€œç¨³å®šâ€ï¼ˆå…¶å®ä¹Ÿå°±æ˜¯è¿‡å»çš„â€œé“é¥­ç¢—â€ï¼‰æœ‰é‚£ç§å˜æ€çš„çƒ­è¡·ï¼Œå› ä¸ºä½“åˆ¶å¤–ç¡®å®æ²¡ä»€ä¹ˆæœºä¼šå’Œç©ºé—´ã€‚</p><p>è¿˜æ˜¯è¯´å›æˆ‘å¼€å¡å®´çš„æœ‹å‹ï¼Œä»–ç°åœ¨æœ‰ç‚¹åæ‚”å½“åˆé”™è¿‡è€ƒå…¬åŠ¡å‘˜çš„æœºä¼šï¼Œæ‰“ç®—å¦‚æœæ‰¾ä¸åˆ°åˆé€‚çš„é¡¹ç›®ï¼Œåªå¥½é‡æ“æ—§ä¸šï¼Œå…ˆæ‰¾ä¸ª4Såº—å»åšåšé”€å”®ã€‚</p><p class="note note-info">4ï¼Œæ”¿åºœä¾é™„å‹ç»æµ</p><p>å†…åœ°åœ¨ç”Ÿäº§ä¸Šå˜å¾—ä¸å†è¢«éœ€è¦çš„åæœæ˜¯ï¼Œè¿‡å»å‡ å¹´æ‰€æœ‰å†…åœ°çœä»½çš„è´¢æ”¿æ”¶å…¥éƒ½æ— æ³•æ‰¿æ‹…è´¢æ”¿å¼€é”€ï¼Œéœ€è¦åˆ’æ‹¨æ²¿æµ·åœ°åŒºçš„æ”¶å…¥è¡¥è¡€ã€‚</p><p>åœ¨è´¢æ”¿ä¸Šï¼Œæ•´ä¸ªå†…åœ°éƒ½åœ¨å˜æˆè´Ÿèµ„äº§ï¼Œè€Œä¸”è¿™ç§è¶‹åŠ¿ä¸ä¼šå‘ç”Ÿåè½¬ã€‚</p><p>é‚£ä¹ˆGDPæ˜¯è°åˆ›é€ çš„ï¼Ÿ</p><p>ä»¥æˆ‘è€å®¶æ‰€åœ¨çš„ç»µé˜³å¸‚åŒ—å·å¿ä¸ºä¾‹ï¼ŒåŒ—å·å¿2017å¹´GDPæ˜¯50äº¿ï¼Œæ”¿åºœå…¬å…±é¢„ç®—æ”¶å…¥æ˜¯4.51äº¿ï¼Œè€Œæ”¿åºœæ”¯å‡ºæ˜¯24.45äº¿ã€‚å¯¹æ¯”åœ°éœ‡å‰çš„2007å¹´ï¼ŒåŒ—å·çš„GDPå¢é•¿äº†4å€ï¼Œè€Œæ”¿åºœæ”¯å‡ºå¢é•¿äº†8å€ã€‚</p><p>æ•´ä¸ªç»µé˜³å¸‚2017å¹´çš„GDPæ˜¯2075äº¿ï¼Œæ”¿åºœçš„å…¬å…±é¢„ç®—æ”¶å…¥æ˜¯111äº¿ï¼Œæ”¯å‡ºæ˜¯416äº¿ã€‚è·Ÿ2007å¹´æ¯”è¾ƒï¼Œç»µé˜³çš„GDPå¢é•¿äº†3å€ï¼Œæ”¿åºœæ”¯å‡ºå¢é•¿äº†4å€ï¼Œæ­¤å¤–è¿˜å¢åŠ äº†çº¦200äº¿åœ°æ–¹å€ºã€‚å¦‚æœæ‹¿ç»µé˜³å’Œæˆ‘ç”Ÿæ´»çš„å¹¿å·å¸‚ç•ªç¦ºåŒºåšä¸ªå¯¹æ¯”ï¼Œ2017å¹´ç•ªç¦ºåŒºçš„GDPå’Œç»µé˜³å·®ä¸å¤šï¼Œä¹Ÿæ˜¯2000äº¿ï¼Œç•ªç¦ºçš„æ”¿åºœå…¬å…±é¢„ç®—æ”¶å…¥æ˜¯141äº¿ï¼Œé«˜äºç»µé˜³çš„111äº¿ï¼Œä½†ç•ªç¦ºçš„å…¬å…±é¢„ç®—æ”¯å‡ºæ˜¯133äº¿ï¼Œè¿œä½äºç»µé˜³çš„416äº¿ã€‚</p><p>è¿™æ—¶å€™æˆ‘ä»¬ä¼šå‘ç°çœŸæ­£çš„å†…åœ°ç‰¹è‰²ï¼šæ”¿åºœæ˜¯ç»æµæ´»åŠ¨çš„ä¸»ä½“ã€‚</p><p>åœ¨è¿™ç§å¤§ç¯å¢ƒä¸‹ï¼Œå¦‚æœè¿›å…¥ä½“åˆ¶å†…ï¼Œä½ å°±æ˜¯é£Ÿåˆ©è€…ï¼Œèƒ½å¤Ÿå‚ä¸åˆ†è›‹ç³•ã€‚å¦‚æœä½ åœ¨ä½“åˆ¶å¤–ï¼Œæœ€æœ‰ä»·å€¼çš„æ–¹å‘ä¹Ÿæ˜¯å‚ä¸åˆ†ä½“åˆ¶å†…çš„å¤§è›‹ç³•ï¼Œè¿™ä¹Ÿå°±éš¾æ€ªç”Ÿæ„äººçœ¼ä¸­æœ¬åœ°æœ€ä¸»è¦æ˜¯ç”Ÿæ„å°±æ˜¯â€œæŒ£æ”¿åºœçš„é’±â€â€”â€”é›¶å…«å¹´ä»¥æ¥å¤§é‡æ¶Œç°çš„æœ¬åœ°æ–°å¯Œï¼Œä¸»è¦æ˜¯å› ä¸ºæŠ¢åˆ°äº†æ”¿åºœçš„åŸºå»ºè›‹ç³•ï¼Œæ”¿åºœå·¥ç¨‹çš„é’±å¤ªå®¹æ˜“æŒ£ï¼Œæ‰£é™¤å…³ç³»å’Œè¡Œè´¿æˆæœ¬ï¼Œä¸¤å°æŒ–æ˜æœºä¸€å¹´ä¹Ÿå¯ä»¥æŒ£ä¸€ä¸¤ç™¾ä¸‡ã€‚</p><p>è¿™å°±æ˜¯æˆ‘æ‰€è°“çš„â€œæ”¿åºœä¾é™„æ€§ç»æµâ€ï¼Œå³æœ¬åœ°ä¸»è¦çš„ç»æµæ´»åŠ¨æ˜¯å›´ç»•æ”¿åºœæ”¯å‡ºå±•å¼€çš„ï¼Œæ”¿åºœå¼€æ”¯å¸¦æ¥çš„å¢é•¿åªæƒ åŠå°‘æ•°äººï¼Œæ”¿åºœå·¥ä½œäººå‘˜å¸¦æ¥çš„æ¶ˆè´¹åŠ›ä¸Šå‡åˆ™å¯ä»¥ç¼”é€ è™šå‡ç¹è£ï¼Œç”±æ­¤äº§ç”Ÿç”±åŸºç¡€å»ºè®¾å’ŒæŠ•èµ„æ‹‰åŠ¨çš„â€œé’¢ç­‹æ°´æ³¥ç°ä»£åŒ–â€ä¸æ°‘é—´çš„ä½æ”¶å…¥ã€é«˜å¤±ä¸šç‡å¹¶å­˜ã€‚å¦‚æœæ²¡æœ‰æ”¿åºœä¸»å¯¼çš„åŸºå»ºå’Œæ”¿åºœé›‡å‘˜çš„æ¶ˆè´¹ï¼Œè¿™äº›åœ°æ–¹çš„ç»æµæ´»åŠ¨å®Œå…¨æ˜¯å¦ä¸€ç•ªå…‰æ™¯ã€‚</p><p>æœ€æœ‰ä»£è¡¨æ€§çš„æ˜¯æ”¿åºœå€¾åŠ›æ‰“é€ çš„ç»æµå¼€å‘åŒºï¼Œæœ¬åœ°çš„ç»æµå¼€å‘åŒºåˆ°å¤„ç ´äº§ä¼ä¸šï¼Œé“¶è¡Œçš„æœ‹å‹è¯´ï¼Œè¿™é‡Œé¢çš„å¤§éƒ¨åˆ†ä¼ä¸šéƒ½æ˜¯å› ä¸ºæ”¿åºœæ‰¶æŒè€Œå­˜åœ¨çš„ï¼Œä¸€æ—¦æ‹¿åˆ°è´·æ¬¾æˆ–è€…è¡¥è´´ï¼Œä¼ä¸šçš„ä½¿å‘½ä¹Ÿå°±ç»“æŸäº†ã€‚</p><p>æ”¿åºœä¾é™„å‹ç»æµæœ¬èº«ä¹Ÿæ˜¯è‡ªæˆ‘åŠ å¼ºçš„ï¼Œåœ°æ–¹æ”¿åºœå‘ç°ï¼ŒèŠ±æ›´é«˜çš„æˆæœ¬ä¾›å…»æ›´å¤šçš„äººï¼Œææ›´å¤šçš„åŸºå»ºï¼ˆäº‰å½“â€œåŸºå»ºç‹‚é­”â€ï¼‰ï¼Œæ‰èƒ½åœ¨è½¬ç§»æ”¯ä»˜ä¸­åˆ†åˆ°æ›´å¤šçš„é’±ã€‚å»å¹´å››å·æ¨å‡ºäº†æ–°çš„è¡Œæ”¿å’Œäº‹ä¸šå•ä½é€€ä¼‘å·¥èµ„æ”¿ç­–ï¼ŒæŒ‰ç…§è¿™ä¸ªæ”¿ç­–ï¼Œæœªæ¥å‡ å¹´åé€€ä¼‘çš„æ™®é€šä¹¡é•‡å…¬åŠ¡å‘˜æˆ–å°å­¦æ•™å¸ˆï¼Œéƒ½å¯ä»¥æ‹¿åˆ°æ¯æœˆä¸Šä¸‡å…ƒçš„é€€ä¼‘é‡‘â€”â€”è¿™ä¸ªæ”¿ç­–æœ€åå› æ²¡æœ‰å¾—åˆ°åŒç­‰åˆ©ç›Šçš„å·²é€€ä¼‘äººå‘˜çš„å¼ºçƒˆæŠ—è®®è€Œä¸­æ­¢ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210614162527.jpeg" alt="img"></p><p>å››å·æœ‰ä¸ä½çš„å¤±ä¸šç‡</p><p>ä¸è¿‡æˆ‘è§‰å¾—ï¼Œå†…åœ°å˜æˆæ”¿åºœä¾é™„æ€§ç»æµï¼Œæœ€å¤§çš„é—®é¢˜ä¸æ˜¯å˜æˆçº¯ç²¹çš„è´¢æ”¿è´Ÿèµ„äº§ï¼Œè€Œæ˜¯åœ¨æœªæ¥çš„ç»æµåˆ†å·¥ä¸­ï¼Œå½»åº•å¤±å»å‚ä¸çš„æœºä¼šã€‚</p><p>é‚£ä¹ˆä¹Ÿå°±æ˜¯æ°‘é—´ç»æµåƒä¸œåŒ—ä¸€æ ·æ²¦é™·ï¼Œè€Œæ”¿åºœå¼€é”€åˆ™ä¸å—å½±å“ï¼Œç”šè‡³è¶Šæ¥è¶Šé«˜ï¼Œä»¥ç»´æŒGDPæ•°å­—ã€‚</p><p class="note note-info"> 5ï¼Œæ²¿æµ·ä¸å†…åœ°</p><p>å¦‚æœå†…åœ°çš„å´©æºƒæ˜¯å¿…ç„¶çš„ï¼Œç„¶åæ²¿æµ·ä¼šä¸ä¼šå—å…¶æ‹–ç´¯å‘¢ï¼Ÿ</p><p>æˆ‘è®¤ä¸ºå†…åœ°çš„å´©æºƒå¹¶ä¸å¿…ç„¶æ‹–ç´¯æ²¿æµ·ï¼Œç›¸åï¼Œæ²¿æµ·ä½œä¸ºæœ€åçš„ç¨æ”¶å¥¶ç‰›ï¼Œä¼šå¾—åˆ°æœ€å¤šçš„å‘å±•æœºä¼šå’Œæ”¿ç­–èµ„æºï¼Œå› ä¸ºè¿™äº›åœ°æ–¹å®äº†å°±ä»€ä¹ˆéƒ½æ²¡äº†ã€‚ä¸ºäº†ç»æµå‘å±•è€Œæ”¾å¼€åœŸåœ°ï¼Œä¿æŠ¤ç§äº§ï¼Œå¼€æ”¾é‡‘èå’Œé€šä¿¡ï¼Œä¸€åˆ‡çš†æœ‰å¯èƒ½ï¼Œå¿…é¡»å¾—è®©æ²¿æµ·æŒ£é’±ï¼Œæ‰èƒ½å…»æ´»ä¸­å›½ã€‚</p><p>é™¤äº†ç»æµçŠ¶å†µçš„æ’•è£‚ï¼Œæœªæ¥å†…åœ°å’Œæ²¿æµ·å¯èƒ½ä¼šå› ä¸ºè¿™äº›åŸå› ï¼Œäº§ç”Ÿå…¶ä»–æ–¹é¢çš„å·®å¼‚ã€‚</p><p>å…¶å®ï¼Œå¦‚æœè§£å¼€æˆ·ç±å’ŒåœŸåœ°åˆ¶åº¦è¿™ä¸€å¯¹é”é“¾ï¼Œå†…åœ°çš„æœªæ¥ä¹Ÿæœªå¿…æ‚²è§‚ï¼Œå†…åœ°äººå¯ä»¥è‡ªç”±çš„å¾€æ²¿æµ·ç§»æ°‘ï¼Œè€Œè¶Šæ¥è¶Šå˜å¾—åœ°å¹¿äººç¨€çš„å†…åœ°ï¼ŒåœŸåœ°å¯ä»¥è¢«èµ„æœ¬é›†ä¸­ï¼Œäº§ç”Ÿå‡ºå·¨å¤§çš„ä»·å€¼ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>è¯»ä¹¦çœ‹æŠ¥</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å®¶ä¹¡</tag>
      
      <tag>collection</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>fluidå­—ä½“æ›´æ¢</title>
    <link href="/article/88a73be6/"/>
    <url>/article/88a73be6/</url>
    
    <content type="html"><![CDATA[<h1 id="fluidå­—ä½“æ›´æ¢"><a href="#fluidå­—ä½“æ›´æ¢" class="headerlink" title="fluidå­—ä½“æ›´æ¢"></a>fluidå­—ä½“æ›´æ¢</h1><p>å‚è€ƒé“¾æ¥ï¼š</p><p><a href="https://fluid-dev.github.io/hexo-fluid-docs/guide/#%E5%85%A8%E5%B1%80%E5%AD%97%E4%BD%93">é…ç½®æŒ‡å— | Hexo Fluid</a></p><p><a href="https://erenship.com/posts/40222.html#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%97%E4%BD%93">Hexoâ€™s Fluid ä¸»é¢˜ç§äººå®šåˆ¶ï¼ˆæŒç»­æ›´æ–°ï¼‰ - Eren ã® å®‡å®™èˆ¹</a></p><p><a href="https://bestzuo.cn/posts/notoserifsc.html">åšå®¢ç½‘ç«™å­—ä½“è®¾ç½®ï¼šæ€æºå®‹ä½“</a></p><p><a href="https://fonts.google.com/">Browse Fonts - Google Fonts</a></p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/font-family">font-family - CSSï¼ˆå±‚å æ ·å¼è¡¨ï¼‰ | MDN</a></p><p><a href="https://sspai.com/post/38705">æ€æºå®‹ä½“ï¼Œå¦‚ä½•è¯„ä»·ï¼Œä»¥åŠå¦‚ä½•æ­£ç¡®ä½¿ç”¨ - å°‘æ•°æ´¾</a></p><hr><h2 id="è¡¬çº¿ä½“å’Œæ— è¡¬çº¿ä½“"><a href="#è¡¬çº¿ä½“å’Œæ— è¡¬çº¿ä½“" class="headerlink" title="è¡¬çº¿ä½“å’Œæ— è¡¬çº¿ä½“"></a>è¡¬çº¿ä½“å’Œæ— è¡¬çº¿ä½“</h2><p>ç»´åŸºç™¾ç§‘çš„è§£æï¼š</p><p>è¡¬çº¿ä½“ï¼ˆè‹±è¯­ï¼šSerifï¼‰æ˜¯ä¸€ç§æœ‰è¡¬çº¿çš„å­—ä½“ï¼Œåˆç§°ä¸ºæœ‰è¡¬çº¿ä½“ã€è¡¬çº¿å­—ã€æ›²çº¿æè¾¹å­—ï¼Œä¿—ç§°ç™½ä½“å­—ï¼›è€Œä¸ä¹‹ç›¸å¯¹çš„ï¼Œæ²¡æœ‰è¡¬çº¿çš„å­—ä½“åˆ™è¢«ç§°ä¸ºæ— è¡¬çº¿ä½“ã€‚è¡¬çº¿æ˜¯å­—å½¢ç¬”ç”»çš„èµ·å§‹æ®µä¸æœ«ç«¯çš„è£…é¥°ç»†èŠ‚éƒ¨åˆ†ã€‚</p><p>æ— è¡¬çº¿ä½“ï¼ˆæ³•è¯­ï¼šsans-serifï¼‰æŒ‡æ²¡æœ‰è¡¬çº¿çš„å­—ä½“ï¼Œä¸è¡¬çº¿å­—ä½“ç›¸åï¼Œå®Œå…¨æŠ›å¼ƒè£…é¥°è¡¬çº¿ï¼Œåªå‰©ä¸‹ä¸»å¹²ï¼Œé€ å‹ç®€æ˜æœ‰åŠ›ï¼Œæ›´å…·ç°ä»£æ„Ÿï¼Œèµ·æºä¹Ÿå¾ˆæ™šã€‚é€‚ç”¨äºæ ‡é¢˜ã€å¹¿å‘Šï¼Œç¬é—´çš„è¯†åˆ«æ€§é«˜ã€‚åœ¨æ±‰å­—ç­‰ä¸œäºšå­—ä½“ä¸­ç§°â€œé»‘ä½“â€ï¼Œä¸æœ‰è¡¬çº¿çš„â€œç™½ä½“â€ç›¸å¯¹ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210614143120.png" alt="æ— è¡¬çº¿ä½“å’Œè¡¬çº¿ä½“åŒºåˆ«"></p><h2 id="æ€æºå®‹ä½“"><a href="#æ€æºå®‹ä½“" class="headerlink" title="æ€æºå®‹ä½“"></a>æ€æºå®‹ä½“</h2><p><strong>æ€æºå®‹ä½“</strong>ï¼ˆè‹±è¯­ï¼šSource Han Serifï¼ŒGoogleå…¬å¸åˆ™ç§°Noto Serif CJKï¼Œâ€œæ€æºâ€ä¸€è¯æ¥è‡ªäºæˆè¯­â€œé¥®æ°´æ€æºâ€ï¼‰æ˜¯<a href="https://zh.wikipedia.org/wiki/Adobe">Adobe</a>ä¸<a href="https://zh.wikipedia.org/wiki/Google">Google</a>æ‰€é¢†å¯¼å¼€å‘çš„å¼€æ”¾æºä»£ç å­—ä½“å®¶æ—ï¼Œä½¿ç”¨<a href="https://zh.wikipedia.org/wiki/SIL%E9%96%8B%E6%94%BE%E5%8E%9F%E5%A7%8B%E7%A2%BC%E5%AD%97%E5%9E%8B%E6%8E%88%E6%AC%8A">SILå¼€æ”¾æºä»£ç å­—ä½“è®¸å¯</a>åœ¨ <a href="https://zh.wikipedia.org/wiki/GitHub">GitHub</a> ä¸Šå‘å¸ƒã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210614143759.png" alt="image-20210614143742710"></p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210614143923.webp" alt="img"></p><h2 id="ä½¿ç”¨æ€æºå®‹ä½“"><a href="#ä½¿ç”¨æ€æºå®‹ä½“" class="headerlink" title="ä½¿ç”¨æ€æºå®‹ä½“"></a>ä½¿ç”¨æ€æºå®‹ä½“</h2><p>2018 å¹´åœ¨ Google Fonts ä¸Šå·²ç»æ‰˜ç®¡äº†æ€æºå®‹ä½“ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡æ‰˜ç®¡å¼•å…¥åˆ°æˆ‘ä»¬çš„åšå®¢ä¸­ã€‚æ‰“å¼€ <a href="https://fonts.google.com/">Google Fonts</a>ï¼Œæœç´¢æ€æºå®‹ä½“çš„è‹±æ–‡åï¼š<code>Noto Serif SC</code>ï¼Œåœ¨åˆ—è¡¨ä¸­é€‰æ‹©æˆ‘ä»¬ä¸ªäººè§‰å¾—åˆé€‚çš„å­—ä½“æ ·å¼ï¼Œç‚¹å‡»å³ä¾§çš„ <code>Select this style</code>ï¼Œæ³¨æ„æ­¤å¤„å¯æ ¹æ®è‡ªå·±éœ€è¦é€‰æ‹©å¤šä¸ªæ ·å¼ã€‚è®°å½•ä¸‹<code>link</code>é“¾æ¥ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210614144419.png" alt="image-20210614144406967"></p><p>æ–°å»ºfont.css,ç›¸å¯¹è·¯å¾„ä¸ºsource\css\font.css</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">html</span>, <span class="hljs-selector-tag">body</span>, <span class="hljs-selector-class">.markdown-body</span> &#123;<br>  <span class="hljs-attribute">font-family</span>: -apple-system, <span class="hljs-string">&#x27;Nimbus Roman No9 L&#x27;</span>, <span class="hljs-string">&#x27;PingFang SC&#x27;</span>, <span class="hljs-string">&#x27;Hiragino Sans GB&#x27;</span>, <span class="hljs-string">&#x27;Noto Serif SC&#x27;</span>, <span class="hljs-string">&#x27;Microsoft Yahei&#x27;</span>, <span class="hljs-string">&#x27;WenQuanYi Micro Hei&#x27;</span>, <span class="hljs-string">&#x27;ST Heiti&#x27;</span>, serif;<br>  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">18px</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å…¶ä¸­ <code>-apple-system</code>ã€<code>Nimbus Roman No9 L</code> åˆ†åˆ«å¯¹åº” Windowsã€macOS&#x2F;iOSã€Linux ä¸‹ä¸‰ç§ç³»ç»Ÿå†…ç½®è‹±æ–‡å­—ä½“ï¼Œ<code>PingFang SC</code>ï¼ˆè‹¹æ–¹ï¼‰ã€<code>Hiragino Sans GB</code>ï¼ˆå†¬é’é»‘ä½“ï¼‰ã€<code>Microsoft Yahei</code>ï¼ˆå¾®è½¯é›…é»‘ï¼‰å¯¹åº”ä¸‰ç§ç³»ç»Ÿå†…ç½®ä¸­æ–‡å­—ä½“ï¼ˆæŒ‰ç…§ä¸Šæ–‡è¯´æ³•ï¼ŒApple ç³»åˆ—åœ¨å‰ï¼ŒWindows åœ¨æœ€åï¼‰ï¼Œ<code>Josefin Sans</code> å’Œ <code>Noto Serif SC</code>ï¼ˆæ€æºå®‹ä½“ï¼‰åˆ™æ˜¯ä¸¤å¥—å…è®¸å…è´¹ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹å­—ä½“ã€‚</p><p>ä¿®æ”¹_config.ymlé‡Œé¢çš„custom_csså’Œcustom_headï¼š</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-comment"># ä¸»é¢˜å­—ä½“é…ç½®</span><br><span class="hljs-comment"># Font</span><br><span class="hljs-attr">font:</span><br>  <span class="hljs-attr">font_size:</span> <span class="hljs-string">18px</span><br>  <span class="hljs-attr">font-family:</span><br>  <span class="hljs-comment">#font-family: Georgia, -apple-system, &#x27;Nimbus Roman No9 L&#x27;, &#x27;PingFang SC&#x27;, &#x27;Hiragino Sans GB&#x27;, &#x27;Noto Serif SC&#x27;, &#x27;Microsoft Yahei&#x27;, &#x27;WenQuanYi Micro Hei&#x27;, &#x27;ST Heiti&#x27;, sans-serif;</span><br>  <span class="hljs-comment">#font_family: KaiTi, &quot;Noto Serif SC&quot;, Georgia, sans, serif;</span><br>  <span class="hljs-attr">code_font_size:</span> <span class="hljs-number">90</span><span class="hljs-string">%</span><br><br><span class="hljs-comment"># æŒ‡å®šè‡ªå®šä¹‰ .js æ–‡ä»¶è·¯å¾„ï¼Œæ”¯æŒåˆ—è¡¨ï¼›è·¯å¾„æ˜¯ç›¸å¯¹ source ç›®å½•ï¼Œå¦‚ /js/custom.js å¯¹åº”å­˜æ”¾ç›®å½• source/js/custom.js</span><br><span class="hljs-comment"># Specify the path of your custom js file, support list. The path is relative to the source directory, such as `/js/custom.js` corresponding to the directory `source/js/custom.js`</span><br><span class="hljs-attr">custom_js:</span><br><br><span class="hljs-comment"># æŒ‡å®šè‡ªå®šä¹‰ .css æ–‡ä»¶è·¯å¾„ï¼Œç”¨æ³•å’Œ custom_js ç›¸åŒ</span><br><span class="hljs-comment"># The usage is the same as custom_js</span><br><span class="hljs-attr">custom_css:</span> <span class="hljs-string">/css/font.css</span><br><br><span class="hljs-comment"># è‡ªå®šä¹‰ &lt;head&gt; èŠ‚ç‚¹ä¸­çš„ HTML å†…å®¹</span><br><span class="hljs-comment"># Customize &lt;head&gt; HTML content</span><br><span class="hljs-comment">#æ€æºå®‹ä½“</span><br><span class="hljs-attr">custom_head:</span> <span class="hljs-string">&#x27;&lt;link href=&quot;https://fonts.googleapis.com/css2?family=Noto+Serif+SC&amp;display=swap&quot; rel=&quot;stylesheet&quot;&gt;&#x27;</span><br><br><span class="hljs-comment"># è‡ªå®šä¹‰åº•éƒ¨ HTML å†…å®¹ï¼ˆä½äº footer ä¸Šæ–¹ï¼‰ï¼Œæ³¨æ„ä¸è¦å’Œ `post: custom` é…ç½®å†²çª</span><br><span class="hljs-comment"># Customize the HTML content at the bottom (located above the footer), be careful not to conflict with `post: custom`</span><br><span class="hljs-attr">custom_html:</span> <span class="hljs-string">&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>æƒ³æŸ¥çœ‹å­—ä½“è®¾ç½®æ˜¯å¦ç”Ÿæ•ˆï¼Œå¯ä»¥å®‰è£…ä»¥ä¸‹æ’ä»¶æŸ¥çœ‹ï¼ˆæ‰“å¼€çš„ç½‘é¡µéœ€è¦é‡æ–°åˆ·æ–°ï¼‰</p><p><a href="https://chrome.google.com/webstore/detail/whatfont/jabopobgcpjmedljpbcaablpmlmfcogm">WhatFont - Chrome ç½‘ä¸Šåº”ç”¨åº—</a></p><p>ç±»ä¼¼äºè¿™ç§æ•ˆæœ</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210614141407.png" alt="image-20210614140824957"></p>]]></content>
    
    
    <categories>
      
      <category>Hexoç›¸å…³</category>
      
    </categories>
    
    
    <tags>
      
      <tag>hexo</tag>
      
      <tag>fluid</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ¯ä¸ªäººçš„å®¶ä¹¡éƒ½åœ¨æ²¦é™·</title>
    <link href="/article/569c7f1/"/>
    <url>/article/569c7f1/</url>
    
    <content type="html"><![CDATA[<h1 id="æ¯ä¸ªäººçš„å®¶ä¹¡éƒ½åœ¨æ²¦é™·"><a href="#æ¯ä¸ªäººçš„å®¶ä¹¡éƒ½åœ¨æ²¦é™·" class="headerlink" title="æ¯ä¸ªäººçš„å®¶ä¹¡éƒ½åœ¨æ²¦é™·"></a>æ¯ä¸ªäººçš„å®¶ä¹¡éƒ½åœ¨æ²¦é™·</h1><blockquote><p>ä½œè€…ï¼šè‚‰å”åƒ§</p><p>è„šä¸‹é‚£ä¸€æŠ¹æ²¡æœ‰è‹”ç—•çš„ç»¿æ„ï¼Œå°±æ˜¯æˆ‘å¿ƒåº•çš„æ•…ä¹¡å§ï¼Œæˆ‘æƒ³ã€‚</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210614023039.jpeg" alt="brown wooden bridge over river"></p><p>æˆ‘çˆ¶æ¯éƒ½æ˜¯è‹å·äººã€‚æˆ‘çˆ¶äº²å¤§å­¦æ¯•ä¸šååˆ†é…åˆ°å¤§è¿ï¼Œæ²¡ä¸¤å¹´ï¼Œæˆ‘å¦ˆä¹Ÿè°ƒè¿‡å»äº†ã€‚å”‰ï¼Œå¤§è¿çš„æ—¥å­çœŸè‹¦å•Šï¼é‚£æ—¶å€™çš„çœé©å§”ä¼šä¸»ä»»é™ˆé”¡è”æœ‰ä¸ªå¤–å·å«é™ˆä¸‰ä¸¤ï¼Œæ„æ€æ˜¯è¾½å®äººæ°‘æ¯äººæ¯æœˆä¸‰ä¸¤æ²¹ã€‚æˆ‘è‡³ä»Šè¿˜è®°å¾—å°æ—¶å€™æˆ‘çˆ¸å¦ˆåƒé«˜ç²±ç±³æˆ–æ˜¯ç‰ç±³é¢é¥¼å­ï¼ŒæŠŠä»…æœ‰çš„ä¸€ç‚¹ç‚¹â€œç»†ç²®â€åšæˆç™½ç±³é¥­æˆ–é¦’å¤´ç»™æˆ‘åƒã€‚å½“ç„¶ä¹Ÿè®°å¾—å–è‚‰çª—å£é‚£é•¿é•¿çš„é˜Ÿä¼â€”â€”æ¯ä¸ªäººéƒ½å¯¹å–è‚‰çš„èƒè‚©è°„ç¬‘ï¼Œå·´æœ›ç€è‡ªå·±çš„é‚£å¼ è‚‰ç¥¨èƒ½ä¹°ä¸€ä»½å°½é‡è‚¥ä¸€ç‚¹å„¿çš„è‚‰ï¼Œå›å»å¥½ç†¬çŒªå¤§æ²¹ã€‚</p><p>è¿™æ ·çš„ç”Ÿæ´»å¯¹äºè‹å·äººæ¥è¯´æ˜¯æ— æ³•å®¹å¿çš„ã€‚æˆ‘å¦ˆæ€»æ˜¯æŠ±æ€¨ï¼ŒæŒ‚åœ¨å˜´è¾¹çš„è¯æ˜¯â€œä¸Šäº†è´¼èˆ¹â€ã€‚äºæ˜¯ï¼Œæˆ‘çˆ¸å°±æŒ–ç©ºå¿ƒæ€å¾€å—æ–¹è°ƒåŠ¨ã€‚å¯ä»–å­¦çš„æ˜¯é£æœºå‘åŠ¨æœºä¸“ä¸šï¼Œæ‰‹æŒ‡å¤´ææ¥æå»ï¼Œå¤§ç±³çŒªè‚‰æœ€å¤šçš„åœ°æ–¹å°±åªæœ‰åŒ—äº¬äº†ã€‚å¤šæ¬¡æ´»åŠ¨ä¹‹åï¼Œç»ˆäºæœ‰äº†å¸Œæœ›ï¼Œéƒ¨é‡Œçš„å¤§å®˜åœ¨å¤§è¿å’Œæˆ‘çˆ¸åˆ†æ‰‹æ—¶çš„å‘Šåˆ«è¯­éƒ½æ˜¯â€œå’±åŒ—äº¬è§â€äº†ï¼Œå¯äººå®¶å›å»ä¸€æŸ¥ï¼Œæˆ‘çˆ·çˆ·æ˜¯ä¸ªå›½æ°‘å…šè­¦å¯Ÿï¼Œæ—¥æœ¬äººæ¥äº†ä¹‹åè¿˜â€œä¼ªâ€è¿‡ã€‚è¿™æ ·çš„ååˆ†å­åä»£æ€ä¹ˆèƒ½æ··è¿›é¦–éƒ½å‘¢ï¼Ÿäºæ˜¯æœªé‚ã€‚</p><p>æˆ‘å¦ˆç»§ç»­æŠ±æ€¨ï¼Œæˆ‘çˆ¸åªå¥½é€€è€Œæ±‚å…¶æ¬¡ï¼Œè¦æ±‚è°ƒåˆ°å®‰å¾½å½“é˜³ä¸€ä¸ªå¾ˆå°çš„å‚å­å»ï¼Œä¸ºçš„å°±æ˜¯èƒ½åƒä¸Šå¤§ç±³ã€‚è¿™ä¸ªç†ç”±å®åœ¨æ˜¯ä¸Šä¸äº†æ¡Œé¢ï¼Œè¢«é¢†å¯¼åŠå—”åŠæ€’ä¸€é€šè‡­æŸä¹‹åï¼Œä¹Ÿå°±å½»åº•é“ä¸‹å¿ƒæ¥ï¼Œæ‰æ ¹å¤§è¿äº†ã€‚</p><p>ä½†æˆ‘å¦ˆä¸èƒ½æ¥å—å­©å­ä»¬ä¹Ÿå—è¿™ä»½ç½ªã€‚æ‰€ä»¥å¥¹éƒ½æ˜¯å›è‹å·ç”Ÿå­©å­ï¼Œç„¶åè®©æˆ‘å§¥å§¥å§¥çˆ·å¸¦ã€‚æˆ‘å“¥å’Œæˆ‘å§éƒ½æ˜¯è¿™æ ·ã€‚åˆ°äº†æˆ‘ï¼Œå´å‡ºäº†æ„å¤–ã€‚</p><p>æˆ‘å‡ºç”Ÿçš„å‰ä¸€å¹´ï¼Œæˆ‘å§¥çˆ·å¾—äº†ä¸€åœºé‡ç—…ï¼Œä¹°äº†ä¸€ä»˜å¯¿æå†²å–œã€‚åæ¥ç—…å¥½äº†ï¼Œé‚£ä»˜æ£ºææ¿å°±ä¸€ç›´æˆ³åœ¨é—¨åçš„æ°´ç¼¸è¾¹ä¸Šã€‚æˆ‘è¿˜æ²¡æ»¡æœˆçš„ä¸€ä¸ªæ™šä¸Šï¼Œå¤§äººä»¬åœ¨å–èŒ¶èŠå¤©ï¼Œæˆ‘ç¡åœ¨æˆ‘å¦ˆèº«è¾¹çš„ä¸€ä¸ªå°åºŠä¸Šï¼Œæˆ‘å“¥å’Œæˆ‘å§åœ¨æ°´ç¼¸ç›–å­ä¸ŠèµŒç¡¬å¸â€”â€”ç”¨ä¸€æšç¡¬å¸å»å‹å¦ä¸€æšç¡¬å¸çš„æ²¿å„¿ï¼Œå‹ç¿»äº†ç®—èµ¢ã€‚ä¸çŸ¥æ€ä¹ˆçš„ï¼Œå°±æŠŠä¸€å—æ£ºææ¿å¼„å€’äº†ï¼Œæ­£ç ¸åœ¨æˆ‘è„‘è¢‹ä¸Šã€‚å¾ˆå¥‡æ€ªï¼Œæ²¡è§è¡€å•ŠåŒ…ä»€ä¹ˆçš„ï¼Œæˆ‘ç”šè‡³è¿å“­éƒ½æ²¡å“­ã€‚è¿™è®©å…¨å®¶äººæ„Ÿåˆ°å¤§å¤§çš„ä¸å®‰ã€‚æˆ‘å§¥å§¥å› è€Œæ‹’ç»å¸¦æˆ‘ï¼Œæ€•æ—¥åæœ‰ä¸ªç—´å‘†è ¢å‚»ä»€ä¹ˆçš„è¯´ä¸æ¸…æ¥šã€‚</p><p>å°±è¿™æ ·ï¼Œæˆ‘æˆäº†å…¨å®¶äººçœ¼é‡Œæœ€å€’éœ‰çš„äººã€‚æˆ‘å¦ˆå¸¦æˆ‘å›å¤§è¿çš„æ—¶å€™ï¼Œæ®è¯´åœºé¢å¾ˆæ„Ÿäººï¼Œè‹å·çš„äº²æˆšä¸ªä¸ªæ³ªçœ¼å©†å¨‘ï¼Œè§‰å¾—æˆ‘è¿™ä¹ˆå°å°±å¼€å§‹å»å¤§è¿å•ƒè‹ç±³é¢é¥¼å­ï¼Œå®åœ¨æ˜¯â€œä½œå­½â€ã€‚è¿™ä¸ªæ£ºææ¿äº‹ä»¶çš„å¦ä¸€ä¸ªç»§å‘æ•ˆåº”æ˜¯ï¼šæˆ‘çˆ¸éå¸¸çƒ­è¡·äºç»™æˆ‘å‡ºè„‘ç­‹æ€¥è½¬å¼¯é¢˜ç›®ã€‚è®°å¾—æœ‰ä¸€æ¬¡æˆ‘çˆ¸çš„ä¸€ä¸ªåŒäº‹è®©æˆ‘çŒœä¸€ä¸ªè°œè¯­ï¼Œå…¶å®å°±æ˜¯é‚£ä¸ªæ€èŠ¬å…‹æ–¯ä¹‹è°œã€‚é‚£æ¬¡ä¸çŸ¥æ€ä¹ˆçš„å°±è’™å‡ºæ¥äº†ã€‚æˆ‘çˆ¸å¦ˆé‚£å«ä¸€ä¸ªç‹‚å–œï¼Œå¿ƒé‡Œçš„çŸ³å¤´ç®—æ˜¯è½äº†åœ°ã€‚</p><p>å°±è¿™ä¹ˆç€ï¼Œä¸€ç›´åˆ°å¹¼å„¿å›­å¤§ç­çš„æ—¶å€™æ‰å›è‹å·ã€‚è®©æˆ‘å¯¹è‹å·ã€å¯¹æ•…ä¹¡è¿™ä¸ªæ¦‚å¿µï¼Œæœ‰äº†ä¸€å±‚è¯´ä¸æ¸…æ¥šçš„éš”è†œã€‚æ—¶è‡³ä»Šæ—¥ï¼Œä¸è®ºèº«åœ¨ä½•å¤„ï¼Œéƒ½æœ‰ä¸€ç§â€œå¤–äººâ€çš„æ„Ÿè§‰ã€‚</p><p>åœ¨è‹å·ï¼Œæœ€ä¸ä¹ æƒ¯çš„ä¸œè¥¿å°±æ˜¯é©¬æ¡¶ï¼Œé‚£æ˜¯æˆ‘æ­»ä¹Ÿä¸è‚¯ç”¨çš„ã€‚å¼„å ‚é‡Œå°±æœ‰ä¸€ä¸ªå…¬å…±å•æ‰€ï¼Œé‚£åŒæ ·ä»¤äººè®¨åŒã€‚æ‰€ä»¥ï¼Œæˆ‘æ€»æ˜¯ç«™åœ¨å¤§é—¨çš„é—¨æ§›ä¸Šæœå¤–æ’’å°¿ã€‚æˆ‘å§¥çˆ·çœ‹åˆ°ï¼Œå°±ä¼šæ»¡è„¸å †ç¬‘åœ°ç”¨æ‰‹æŒ‡åœ¨æˆ‘çš„å°¿æµä¸Šæ‰“ä¸€ä¸‹ã€‚è¿™è®©æˆ‘å¾ˆå¥‡æ€ªâ€”â€”ä»–ä¸å«Œè„ä¹ˆï¼Ÿä»¥åæ‡‚äº‹äº†æ‰çŸ¥é“ï¼Œä»–ä¸èˆå¾—è¯´æˆ‘ï¼Œåªå¥½ç”¨è¿™æ ·æ¸©æŸ”çš„æ–¹å¼æ¥å°½ä¸€ä¸ªé•¿è¾ˆè®­æ•™çš„ä¹‰åŠ¡ã€‚</p><p>äºŒå§¨å¤«æ˜¯ä¸ªè®¨åŒçš„äººï¼Œå› ä¸ºä»–è´Ÿè´£å®šæœŸå¸¦æˆ‘å»ç†å‘å’Œæ´—æ¾¡ã€‚å¼„å ‚å£æœ‰ä¸€å®¶æ‰¬å·äººå¼€çš„å‰ƒå¤´åº—ï¼Œå¥¹å®¶çš„äºŒå¥³å„¿å°±åƒç”»é‡Œçš„äººä¸€æ ·å¥½çœ‹ï¼Œçœ‰æ¯›å¼¯å¼¯çš„ï¼Œçœ¼ç›ä¼šè¯´è¯ï¼Œæ¯”æˆ‘å¤§ä¸€å²ã€‚ç¬¬ä¸€æ¬¡çœ‹è§å¥¹çš„æ—¶å€™å¥¹æ­£åœ¨åƒä¸€æ ¹å’¸æ”¯åœï¼Œè§æˆ‘ç›®ä¸è½¬ç›åœ°ç›¯ç€å¥¹çœ‹ï¼Œä»¥ä¸ºæˆ‘é¦‹çš„æ˜¯é‚£æ ¹æ”¯åœï¼Œå°±æŠŠå˜´å¤–é¢çš„é‚£ä¸€åŠç»™äº†æˆ‘ã€‚ä¸­å­¦çš„æ—¶å€™å­¦é²è¿…çš„è±†è…è¥¿æ–½ï¼Œä¸€ä¸‹å­å°±æƒ³åˆ°äº†é‚£ä¸ªå§‘å¨˜ã€‚å¤šå¹´åå›è‹å·ï¼Œåˆè§åˆ°å¥¹ä¸€æ¬¡ï¼Œè¿˜æ˜¯åœ¨å¥¹å®¶çš„åº—é‡Œï¼Œæ­£åœ¨å¥¶ä¸€ä¸ªåŠå²å¤§çš„å­©å­ã€‚ä¹³æˆ¿è½¯è½¯çš„ï¼Œä¸‹å‚å¾—å¾ˆå‰å®³ã€‚çœ¼ç›ä¸å†ä¼šè¯´è¯äº†ã€‚</p><p>æˆ‘äºŒå§¨å¤«çš„å¯æ¨ä¹‹å¤„æ˜¯ä»–ä¸€å®šè¦æŠŠæˆ‘å¸¦åˆ°çŸ³è·¯ä¸Šçš„ä¸€å®¶åº—å»å‰ƒå¤´ã€‚è¿™ä½¿æˆ‘å¯¹å‰ƒå¤´æœ‰äº†åŒé‡çš„æŠµè§¦æƒ…ç»ªã€‚å¦å¤–ï¼Œæ¯æ¬¡æ´—å®Œæ¾¡ï¼Œä»–éƒ½è¦å¤§åˆºåˆºèººåœ¨æ¤…å­ä¸Šï¼Œæ‰¾äººç»™ä»–æ‰¦è„šï¼Œå’Œç”µå½±é‡Œçš„å‰¥å‰Šé˜¶çº§ä¸€æ¨¡ä¸€æ ·ã€‚</p><p>ç›¸æ¯”ä¹‹ä¸‹ï¼Œæˆ‘äºŒå§¨çš„ä¸¤ä¸ªå¥³å„¿ï¼Œä¹Ÿå°±æ˜¯æˆ‘çš„ä¸¤ä¸ªè¡¨å§ï¼Œæ˜¯æœ€å¯çˆ±çš„äººã€‚é‚£ä¸ªæ—¶å€™ï¼Œæˆ‘å§¥å§¥ç»™æˆ‘å“¥æ¯å¤©ä¸€æ¯›é’±çš„é›¶èŠ±é’±ï¼Œæˆ‘å’Œæˆ‘å§æ˜¯äº”åˆ†é’±ã€‚æˆ‘çš„ä¹ æƒ¯æ˜¯æ¯å¤©èŠ±ä¸‰åˆ†é’±ä¹°ä¸€æ”¯æ£’å†°ï¼Œå‰©ä¸‹çš„ä¸¤åˆ†é’±ä¹°äº‘ç‰‡ç³•ã€‚æœ‰çš„æ—¶å€™ï¼Œä¹Ÿä¼šæ­¥è¡Œåˆ°çŸ³è·¯å»ä¹°ä¸€æ”¯äº”åˆ†é’±çš„èµ¤è±†æ£’å†°ã€‚æˆ‘å§å§æ€»æ˜¯åŠæˆ‘æ”’å‡ å¤©ï¼Œç„¶åå’Œå¥¹æ­ä¼™ä¸€èµ·ä¹°å°æ ¸æ¡ƒï¼Œå¥¹è®¤ä¸ºè¿™æ ·æ‰æœ€åˆç®—ã€‚æˆ‘å¯¹æ­¤æœ‰ä¸åŒçš„çœ‹æ³•ï¼Œæˆ‘è®¤ä¸ºæ¯å¤©åƒæ£’å†°å’Œäº‘ç‰‡ç³•ï¼Œéš”ä¸‰å²”äº”åœ°åƒæˆ‘å§çš„å°æ ¸æ¡ƒæ‰æœ€åˆç®—ã€‚</p><p>æˆ‘çš„å¤§è¡¨å§æ’é˜Ÿå»äº†æ˜†å±±ï¼Œä¸‰å¤©ä¸¤å¤´æ³¡ç—…å·é€ƒå›æ¥ï¼Œå’Œå¥¹ä¸€èµ·é€ƒå›æ¥çš„è¿˜æœ‰å¥¹çš„ç”·æœ‹å‹ã€‚æœ‰ä¸€æ¬¡æˆ‘å»äºŒå§¨å®¶ï¼Œæ­£ç¢°ä¸Šè¿™ä½ç”·æœ‹å‹æŠŠæˆ‘å¤§è¡¨å§å‹åœ¨èº«å­ä¸‹é¢â€œæ¬ºè´Ÿâ€å¥¹ã€‚æˆ‘å¤§æ€’ï¼Œè½¬èº«è¦å»æŠ¥å‘Šæˆ‘å§¥çˆ·ã€‚é‚£å°å­ä¸€å¼€å§‹æå‡ºä¸ªä¸¤æ¯›é’±çš„ç¥¨å­ï¼Œæ ¹æœ¬æ²¡èµ·ä½œç”¨ã€‚ä¸€ç›´æ¶¨åˆ°äº”æ¯›ï¼Œæˆ‘æ‰ç®—æ¶ˆäº†æ°”ã€‚å¾ˆå¤šå¹´ä»¥åï¼Œæˆ‘å¤§è¡¨å§å¤«è¿˜åœ¨æè¿™äº‹å„¿ã€‚ä»–åœ¨æ˜†å±±ä¸€å¤©çš„å·¥åˆ†æ‰å…­åˆ†é’±ï¼Œäº”æ¯›é’±ï¼Œå½“æ—¶æ˜¯å¤šå¤§çš„ä¸€ç¬”æ¬¾é¡¹å•Šï¼</p><p>æˆ‘çš„äºŒè¡¨å§å…ˆåè°ˆè¿‡ä¸¤ä¸ªç”·æœ‹å‹ï¼Œå…¨è®©æˆ‘èµ¶ä¸Šäº†ã€‚ç¬¬ä¸€ä¸ªæ˜¯ä¸ªå¤§å­¦ç”Ÿï¼Œè§’ï¼ˆå¿µâ€œè·¯â€ï¼Œæ²¡è¿™ä¸ªå­—ï¼‰ç›´å†œæ‘çš„ã€‚é‚£æ—¶å€™è°ˆæœ‹å‹ï¼Œä¸è¿‡å°±æ˜¯æ¯äººæ¨ä¸€è¾†è‡ªè¡Œè½¦ï¼Œåœ¨é©¬è·¯ä¸Šèµ°æ¥èµ°å»ï¼Œè¿æ‰‹éƒ½ä¸ç¢°ä¸€ä¸‹ã€‚ä»–ä¿©ä¸ä¼—ä¸åŒä¹‹å¤„åœ¨äºæ¯äººè‡ªè¡Œè½¦ååº§ä¸Šéƒ½æœ‰ä¸€ä¸ªå­©å­â€”â€”æˆ‘å’Œæˆ‘å§å§ã€‚æ•²æ‰æ©„æ¦„ã€å¥¶æ²¹è¯æ¢…ã€å°æ ¸æ¡ƒï¼Œä»–ä»¬ä¸€è·¯èµ°ï¼Œæˆ‘ä»¬ä¸€è·¯åƒï¼ŒçœŸå¼€å¿ƒï¼</p><p>åæ¥ä¸çŸ¥é“ä¸ºä»€ä¹ˆè¿™ä¸ªå¤§å­¦ç”Ÿæ¥å¾—å°±å°‘äº†ï¼Œå¤§æ¦‚æ˜¯è¢«æˆ‘å§ä¿©åƒç©·äº†ï¼ŒæŠ—ä¸ä½äº†ã€‚äºŒè¡¨å§çš„ç¬¬äºŒä»»ç”·æœ‹å‹æ¯”è¾ƒæœ‰é’±ï¼Œä¸ä½†è®©æˆ‘ä»¬ååœ¨è‡ªè¡Œè½¦ååº§ä¸Šç®¡å¤Ÿåƒï¼Œç”šè‡³è¿˜å¸¦æˆ‘ä»¬å»è§‚å‰è¡—å†·é¥®åº—åƒè¿‡å‡ æ¬¡â€”â€”ä¸€æ¯›é’±çš„é«˜çº§å†·é¥®ï¼Œè¿˜æœ‰é…¸æ¢…æ±¤ã€‚é‚£ä½ç¬¬ä¸€ä»»ç”·å‹ï¼Œç°åœ¨å·²ç»å®Œå…¨è®°ä¸èµ·é•¿ç›¸ï¼Œå¶å°”æƒ³èµ·ä»–ï¼Œå´åªæ˜¯â€œé€šæ„Ÿâ€åˆ°ä¸ªå„¿å¤§æ°´çµçš„è¸è ä¸Šå»äº†ã€‚</p><p>é¦‹çš„æ¯›ç—…ä¸€ç›´ä¿ç•™åˆ°ç°åœ¨ã€‚æ—¶è‡³ä»Šæ—¥ï¼Œè¿˜æ˜¯è®©æˆ‘å“¥å¸¸å¹´ç»™æˆ‘å¯„ä¸€ç§è‹å·ç‰¹æœ‰çš„å°å¥¶æ²¹ç“œå­ã€‚èººåœ¨æ¤…å­ä¸Šä¸€è¾¹çœ‹ä¹¦ä¸€è¾¹å—‘ï¼Œæˆ‘è®¤ä¸ºäººç”Ÿçš„å¿«ä¹è«è¿‡äºæ­¤ã€‚</p><p>ä¸è¯´åƒäº†ï¼Œè¯´ç‚¹å„¿åˆ«çš„å§ã€‚</p><p>åœ¨è‹å·ï¼Œç”Ÿæ´»çš„ä¸»æ—‹å¾‹å°±æ˜¯æ²³ã€‚é‚£æ—¶å€™ï¼Œå®¶å®¶åƒæ°´éƒ½æ˜¯ç›´æ¥ä»æ²³é‡Œæ‰“ï¼Œå€’è¿›æ°´ç¼¸é‡Œä¹‹åï¼Œå†æ”¾å‡ å—æ˜çŸ¾æ…ä¸€æ…ã€‚ä¸Šåˆæœ‰ç©¿ç€ä¸œå´ç‰¹è‰²æœè£…çš„ä¹¡ä¸‹äººæ‘‡ç€å°èˆ¹æŒ¨æ¡å··å­å«å–æ–°é²œçš„éŸ­èœå’Œè‹‹èœã€‚æ²³ä¸­é—´æ€»æœ‰æ±½èˆ¹æ‹–äº†é•¿é•¿çš„ä¸€ä¸²æ°´æ³¥èˆ¹ï¼Œæ¥æ¥å›å›åœ°è¿é»„æ²™ã€‚è°å®¶è¦ä¹°ä¸ªé…±æ²¹ä»€ä¹ˆçš„ï¼Œå°±ä¼šæ±‚åœ¨æ²³é‡Œæ¸¸æ³³çš„å°ä¼™å­åŠä½è¿æ²™èˆ¹çš„èˆ¹å¸®å»çº¢æ——æ¡¥ï¼Œä¹°äº†å†ç­‰åå‘çš„æ±½èˆ¹åŠå›æ¥ã€‚ä¸‹åˆå¤•é˜³è¥¿ä¸‹çš„æ—¶å€™ï¼Œå¥³äººä»¬æ‹ç€å¤§æœ¨æ¡¶åˆ°æ²³è¾¹æ¥æ´—è¡£æœï¼Œå®¶å®¶çš„éšç§åœ¨æ­¤å˜å½¢å’Œä¼ æ’­ã€‚æ²¡æœ‰æ–°é—»çš„æ—¥å­é‡Œï¼Œå¥³äººä»¬å°±ä¼šæ‹¿æ— é”¡äººçš„å£éŸ³å¼€ç©ç¬‘ï¼Œè¿™æ˜¯ä¸ªæ°¸ä¸åŒå€¦çš„è¯é¢˜ã€‚æ¯”å¦‚ï¼Œæ— é”¡äººç®¡æœˆäº®å«â€œäº®æœˆâ€ã€ç®¡èºä¸å«â€œä¸èºâ€ï¼Œæ— é”¡äººåˆ’çš„ä¸¤æ¡èˆ¹è¦æ’è¿˜æ²¡æ’åˆ°çš„æ—¶å€™ï¼Œå¤§å®¶éƒ½ä¼šä¸€é½å¤§å«â€œå‹¿å¥½å“‰ï¼Œå‹¿å¥½å“‰ï¼â€å’šåœ°ä¸€å£°æ’åˆ°ä¹‹åï¼Œä¸¤æ¡èˆ¹ä¸Šçš„äººåå€’æŠšæŒå¹æ›°ï¼šâ€œé‚£ä¹ˆå¥½å“‰ï¼â€</p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210614015146.jpeg" alt="æœ‰æ¡¥æ¢å’Œæˆ¿å­çš„è¿æ²³"></p><p>æˆ‘å®¶å¯¹é—¨çš„å­¤è€å¤ªå¤ªï¼Œæ˜¯ä¸€ä¸ªå›½æ°‘å…šå†›å®˜çš„å°è€å©†ï¼Œå¹´è½»çš„æ—¶å€™æ˜¯å”±è¯„å¼¹çš„ã€‚æ¯åˆ°åƒè¿‡æ™šé¥­ï¼Œæ²³è¾¹çš„å¥³äººä¸€ç‰‡æ¬¢å£°ç¬‘è¯­ä¹‹é™…ï¼Œå¥¹å°±ä¼šåœ¨å ‚å±‹çš„å…«ä»™æ¡Œè¾¹åå®šï¼Œæå‡ºä¸€å—æŠ¹å¸ƒä¸€æ ·çš„è„æ‰‹ç»¢å”±ä¸Šä¸€æ®µã€‚ä¸»é¢˜éƒ½æ˜¯ç¼…æ€€å…ˆå¤«çš„ï¼Œä½†æ¯å¤©çš„è¯éƒ½ä¼šæœ‰åˆ›æ–°ã€‚å±…å§”ä¼šé‡Œçš„å¹²éƒ¨æ¥äº†å‡ æ¬¡è¦å¥¹æ³¨æ„å”±è¯çš„å†…å®¹ï¼Œä¸è¦ç»™å›½æ°‘å…šååŠ¨æ´¾æ¶‚è„‚æŠ¹ç²‰ï¼Œå¹¶å¨èƒå¥¹â€œå½“å¿ƒæ‰è¿›å»â€ï¼Œä½†éƒ½æ¯«æ— æ•ˆæœã€‚åªå¥½ç”±å¥¹å»äº†ã€‚è¯„å¼¹æˆ‘å¤§å¤šå¬ä¸æ‡‚ï¼Œé™¤äº†æ¯›ä¸»å¸­çš„é‚£é¦–ã€Šè¶æ‹èŠ±.ç­”ææ·‘ä¸€ã€‹ã€‚åªè®°å¾—æ¯å››å¥ä¸€æ®µï¼Œæœ€åä¸€å¥çš„æœ€åä¸¤ä¸ªå­—æ˜¯ä¸€ä¸ªå­—ã€ä¸€ä¸ªå­—ä¸€é¡¿ä¸€é¡¿åœ°å”±å‡ºæ¥ï¼Œè¿™æ˜¯è¯„å¼¹ç‰¹æœ‰çš„éŸµå‘³å„¿ã€‚æ¯”å¦‚ï¼šæ¯æ—¥é‡Œï¼Œå­¤ç¯å¯’è¡¾ï¼Œé•¿å¤œæ¼«æ¼«ç§‹é£â€”â€”æ²‰â€”â€”å¯‚ï¼</p><p>åœ¨æˆ‘çš„å¿ƒé‡Œï¼Œæˆ‘æ˜¯æŠŠè‹å·å½“æˆè‡ªå·±çš„æ•…ä¹¡çš„ã€‚ä½†æ˜¯é—æ†¾ï¼Œæˆ‘çš„è‹å·è¯ä»æ²¡è¿‡å…³è¿‡ï¼Œæ€»æ˜¯åœç•™åœ¨æ´‹æ³¾æµœçš„æ°´å¹³ã€‚åå€’æ˜¯ä¸Šæµ·è¯çš„æ°´å¹³è¦é«˜äº›ã€‚æ¯å¿µåŠè¾›å¼ƒç–¾çš„â€œé†‰é‡Œå´éŸ³ç›¸åªšå¥½ï¼Œè°å®¶ç™½å‘ç¿åªªâ€ï¼Œå¿ƒé‡Œæ€»æœ‰äº›èŒ«ç„¶ã€‚è®°å¾—æ²³è¾¹ä¸Šæœ‰ä¸€å¼ å¤§çŸ³æ¡Œï¼Œæ˜¯ç”¨æ¥æŠŠè¡£æœæ‘Šå¼€æ¥æ‹¿åˆ·å­å¾€ä¸Šåˆ·è‚¥çš‚çš„ã€‚é•¿å¹´ç´¯æœˆçš„è‚¥çš‚æ°´ï¼ŒæŠŠé‚£å—çŸ³æ¿æ¼‚å¾—éå¸¸å¹²å‡€æ»‘è…»ï¼Œå®Œå…¨ä¸é•¿é’è‹”ã€‚åªæ˜¯åœ¨æ¡Œè„šçš„åº•éƒ¨ï¼Œæœ‰é‚£ä¹ˆæ·¡æ·¡çš„ä¸€æŠ¹ç»¿æ„ã€‚æ— èŠçš„æ—¶å€™ï¼Œæ€»æ˜¯ä¸€ä¸ªäººååœ¨ä¸Šé¢ï¼Œçœ‹æ²³é¢ä¸Šå¤§å¤§å°å°çš„èˆ¹ï¼Œçœ‹é¢è‰²é»¢é»‘ã€è„šä¸«è‚¥ç¡•çš„èˆ¹å¨˜åœ¨èˆ¹å°¾å‡ç«åšé¥­ã€‚</p><p>è„šä¸‹é‚£ä¸€æŠ¹æ²¡æœ‰è‹”ç—•çš„ç»¿æ„ï¼Œå°±æ˜¯æˆ‘å¿ƒåº•çš„æ•…ä¹¡å§ï¼Œæˆ‘æƒ³ã€‚</p><hr><p><em>å›¾ç‰‡æ¥è‡ªUnsplash</em></p>]]></content>
    
    
    <categories>
      
      <category>è¯»ä¹¦çœ‹æŠ¥</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å®¶ä¹¡</tag>
      
      <tag>collection</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®‰å“SystemProperties.set()æ–¹æ³•æƒé™é—®é¢˜</title>
    <link href="/article/350fc249/"/>
    <url>/article/350fc249/</url>
    
    <content type="html"><![CDATA[<p>å¯¹äºç³»ç»Ÿä¸­çš„æ¯ä¸ªè¿›ç¨‹æ¥è¯´ï¼š</p><p>è¯»å–å±æ€§å€¼å¯¹ä»»ä½•è¿›ç¨‹éƒ½æ˜¯æ²¡æœ‰é™åˆ¶çš„ï¼Œç›´æ¥ç”±æœ¬è¿›ç¨‹ä»å…±äº«åŒºåŸŸä¸­è¯»å–ã€‚</p><p>ä¿®æ”¹å±æ€§å€¼åˆ™å¿…é¡»é€šè¿‡Initè¿›ç¨‹å®Œæˆï¼ŒåŒæ—¶Initè¿›ç¨‹è¿˜éœ€è¦æ£€æŸ¥å‘èµ·è¯·æ±‚çš„è¿›ç¨‹æ˜¯å¦å…·æœ‰ç›¸åº”çš„æƒé™ã€‚</p><h1 id="å®‰å“5-0ä¹‹å‰"><a href="#å®‰å“5-0ä¹‹å‰" class="headerlink" title="å®‰å“5.0ä¹‹å‰"></a>å®‰å“5.0ä¹‹å‰</h1><p><a href="https://www.androidos.net.cn/android/4.4w_r1/xref/system/core/init/property_service.c">å®‰å“4.4 system&#x2F;core&#x2F;init&#x2F;property_service.cæºä»£ç :</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br></pre></td><td class="code"><pre><code class="hljs java">..........<br><br><span class="hljs-comment">/* White list of permissions for setting property services. */</span><br>struct &#123;<br>    const <span class="hljs-type">char</span> *prefix;<br>    unsigned <span class="hljs-type">int</span> uid;<br>    unsigned <span class="hljs-type">int</span> gid;<br>&#125; property_perms[] = &#123;<br>    &#123; <span class="hljs-string">&quot;net.rmnet0.&quot;</span>,      AID_RADIO,    <span class="hljs-number">0</span> &#125;,<br>    &#123; <span class="hljs-string">&quot;net.gprs.&quot;</span>,        AID_RADIO,    <span class="hljs-number">0</span> &#125;,<br>    &#123; <span class="hljs-string">&quot;net.ppp&quot;</span>,          AID_RADIO,    <span class="hljs-number">0</span> &#125;,<br>    &#123; <span class="hljs-string">&quot;net.qmi&quot;</span>,          AID_RADIO,    <span class="hljs-number">0</span> &#125;,<br>    &#123; <span class="hljs-string">&quot;net.lte&quot;</span>,          AID_RADIO,    <span class="hljs-number">0</span> &#125;,<br>    &#123; <span class="hljs-string">&quot;net.cdma&quot;</span>,         AID_RADIO,    <span class="hljs-number">0</span> &#125;,<br>    &#123; <span class="hljs-string">&quot;ril.&quot;</span>,             AID_RADIO,    <span class="hljs-number">0</span> &#125;,<br>    &#123; <span class="hljs-string">&quot;gsm.&quot;</span>,             AID_RADIO,    <span class="hljs-number">0</span> &#125;,<br>    &#123; <span class="hljs-string">&quot;persist.radio&quot;</span>,    AID_RADIO,    <span class="hljs-number">0</span> &#125;,<br>    &#123; <span class="hljs-string">&quot;net.dns&quot;</span>,          AID_RADIO,    <span class="hljs-number">0</span> &#125;,<br>    &#123; <span class="hljs-string">&quot;sys.usb.config&quot;</span>,   AID_RADIO,    <span class="hljs-number">0</span> &#125;,<br>    &#123; <span class="hljs-string">&quot;net.&quot;</span>,             AID_SYSTEM,   <span class="hljs-number">0</span> &#125;,<br>    &#123; <span class="hljs-string">&quot;dev.&quot;</span>,             AID_SYSTEM,   <span class="hljs-number">0</span> &#125;,<br>    &#123; <span class="hljs-string">&quot;runtime.&quot;</span>,         AID_SYSTEM,   <span class="hljs-number">0</span> &#125;,<br>    &#123; <span class="hljs-string">&quot;hw.&quot;</span>,              AID_SYSTEM,   <span class="hljs-number">0</span> &#125;,<br>    &#123; <span class="hljs-string">&quot;sys.&quot;</span>,             AID_SYSTEM,   <span class="hljs-number">0</span> &#125;,<br>    &#123; <span class="hljs-string">&quot;sys.powerctl&quot;</span>,     AID_SHELL,    <span class="hljs-number">0</span> &#125;,<br>    &#123; <span class="hljs-string">&quot;service.&quot;</span>,         AID_SYSTEM,   <span class="hljs-number">0</span> &#125;,<br>    &#123; <span class="hljs-string">&quot;wlan.&quot;</span>,            AID_SYSTEM,   <span class="hljs-number">0</span> &#125;,<br>    &#123; <span class="hljs-string">&quot;bluetooth.&quot;</span>,       AID_BLUETOOTH,   <span class="hljs-number">0</span> &#125;,<br>    &#123; <span class="hljs-string">&quot;dhcp.&quot;</span>,            AID_SYSTEM,   <span class="hljs-number">0</span> &#125;,<br>    &#123; <span class="hljs-string">&quot;dhcp.&quot;</span>,            AID_DHCP,     <span class="hljs-number">0</span> &#125;,<br>    &#123; <span class="hljs-string">&quot;debug.&quot;</span>,           AID_SYSTEM,   <span class="hljs-number">0</span> &#125;,<br>    &#123; <span class="hljs-string">&quot;debug.&quot;</span>,           AID_SHELL,    <span class="hljs-number">0</span> &#125;,<br>    &#123; <span class="hljs-string">&quot;log.&quot;</span>,             AID_SHELL,    <span class="hljs-number">0</span> &#125;,<br>    &#123; <span class="hljs-string">&quot;service.adb.root&quot;</span>, AID_SHELL,    <span class="hljs-number">0</span> &#125;,<br>    &#123; <span class="hljs-string">&quot;service.adb.tcp.port&quot;</span>, AID_SHELL,    <span class="hljs-number">0</span> &#125;,<br>    &#123; <span class="hljs-string">&quot;persist.sys.&quot;</span>,     AID_SYSTEM,   <span class="hljs-number">0</span> &#125;,<br>    &#123; <span class="hljs-string">&quot;persist.service.&quot;</span>, AID_SYSTEM,   <span class="hljs-number">0</span> &#125;,<br>    &#123; <span class="hljs-string">&quot;persist.security.&quot;</span>, AID_SYSTEM,   <span class="hljs-number">0</span> &#125;,<br>    &#123; <span class="hljs-string">&quot;persist.service.bdroid.&quot;</span>, AID_BLUETOOTH,   <span class="hljs-number">0</span> &#125;,<br>    &#123; <span class="hljs-string">&quot;selinux.&quot;</span>         , AID_SYSTEM,   <span class="hljs-number">0</span> &#125;,<br>    &#123; NULL, <span class="hljs-number">0</span>, <span class="hljs-number">0</span> &#125;<br>&#125;;<br><br>.........<br><br>    <br><span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">check_mac_perms</span><span class="hljs-params">(const <span class="hljs-type">char</span> *name, <span class="hljs-type">char</span> *sctx)</span><br>&#123;<br>    <span class="hljs-keyword">if</span> (is_selinux_enabled() &lt;= <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br><br>    <span class="hljs-type">char</span> *tctx = NULL;<br>    const <span class="hljs-type">char</span> *class = <span class="hljs-string">&quot;property_service&quot;</span>;<br>    const <span class="hljs-type">char</span> *perm = <span class="hljs-string">&quot;set&quot;</span>;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><br>    <span class="hljs-keyword">if</span> (!sctx)<br>        <span class="hljs-keyword">goto</span> err;<br><br>    <span class="hljs-keyword">if</span> (!sehandle_prop)<br>        <span class="hljs-keyword">goto</span> err;<br><br>    <span class="hljs-keyword">if</span> (selabel_lookup(sehandle_prop, &amp;tctx, name, <span class="hljs-number">1</span>) != <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">goto</span> err;<br><br>    <span class="hljs-keyword">if</span> (selinux_check_access(sctx, tctx, class, perm, name) == <span class="hljs-number">0</span>)<br>        result = <span class="hljs-number">1</span>;<br><br>    freecon(tctx);<br> err:<br>    <span class="hljs-keyword">return</span> result;<br>&#125;<br><br><span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">check_control_mac_perms</span><span class="hljs-params">(const <span class="hljs-type">char</span> *name, <span class="hljs-type">char</span> *sctx)</span><br>&#123;<br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">     *  Create a name prefix out of ctl.&lt;service name&gt;</span><br><span class="hljs-comment">     *  The new prefix allows the use of the existing</span><br><span class="hljs-comment">     *  property service backend labeling while avoiding</span><br><span class="hljs-comment">     *  mislabels based on true property prefixes.</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-type">char</span> ctl_name[PROP_VALUE_MAX+<span class="hljs-number">4</span>];<br>    <span class="hljs-type">int</span> <span class="hljs-variable">ret</span> <span class="hljs-operator">=</span> snprintf(ctl_name, sizeof(ctl_name), <span class="hljs-string">&quot;ctl.%s&quot;</span>, name);<br><br>    <span class="hljs-keyword">if</span> (ret &lt; <span class="hljs-number">0</span> || (size_t) ret &gt;= sizeof(ctl_name))<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br><br>    <span class="hljs-keyword">return</span> check_mac_perms(ctl_name, sctx);<br>&#125;<br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment"> * Checks permissions for starting/stoping system services.</span><br><span class="hljs-comment"> * AID_SYSTEM and AID_ROOT are always allowed.</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * Returns 1 if uid allowed, 0 otherwise.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">check_control_perms</span><span class="hljs-params">(const <span class="hljs-type">char</span> *name, unsigned <span class="hljs-type">int</span> uid, unsigned <span class="hljs-type">int</span> gid, <span class="hljs-type">char</span> *sctx)</span> &#123;<br><br>    <span class="hljs-type">int</span> i;<br>    <span class="hljs-keyword">if</span> (uid == AID_SYSTEM || uid == AID_ROOT)<br>      <span class="hljs-keyword">return</span> check_control_mac_perms(name, sctx);<br><br>    <span class="hljs-comment">/* Search the ACL */</span><br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; control_perms[i].service; i++) &#123;<br>        <span class="hljs-keyword">if</span> (strcmp(control_perms[i].service, name) == <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">if</span> ((uid &amp;&amp; control_perms[i].uid == uid) ||<br>                (gid &amp;&amp; control_perms[i].gid == gid)) &#123;<br>                <span class="hljs-keyword">return</span> check_control_mac_perms(name, sctx);<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment"> * Checks permissions for setting system properties.</span><br><span class="hljs-comment"> * Returns 1 if uid allowed, 0 otherwise.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">check_perms</span><span class="hljs-params">(const <span class="hljs-type">char</span> *name, unsigned <span class="hljs-type">int</span> uid, unsigned <span class="hljs-type">int</span> gid, <span class="hljs-type">char</span> *sctx)</span><br>&#123;<br>    <span class="hljs-type">int</span> i;<br>    unsigned <span class="hljs-type">int</span> app_id;<br><br>    <span class="hljs-keyword">if</span>(!strncmp(name, <span class="hljs-string">&quot;ro.&quot;</span>, <span class="hljs-number">3</span>))<br>        name +=<span class="hljs-number">3</span>;<br><br>    <span class="hljs-keyword">if</span> (uid == <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">return</span> check_mac_perms(name, sctx);<br><br>    app_id = multiuser_get_app_id(uid);<br>    <span class="hljs-keyword">if</span> (app_id == AID_BLUETOOTH) &#123;<br>        uid = app_id;<br>    &#125;<br><br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; property_perms[i].prefix; i++) &#123;<br>        <span class="hljs-keyword">if</span> (strncmp(property_perms[i].prefix, name,<br>                    strlen(property_perms[i].prefix)) == <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">if</span> ((uid &amp;&amp; property_perms[i].uid == uid) ||<br>                (gid &amp;&amp; property_perms[i].gid == gid)) &#123;<br><br>                <span class="hljs-keyword">return</span> check_mac_perms(name, sctx);<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br>.......<br>    <br> <br><span class="hljs-keyword">void</span> <span class="hljs-title function_">handle_property_set_fd</span><span class="hljs-params">()</span><br>&#123;<br>    prop_msg msg;<br>    <span class="hljs-type">int</span> s;<br>    <span class="hljs-type">int</span> r;<br>    <span class="hljs-type">int</span> res;<br>    struct ucred cr;<br>    struct sockaddr_un addr;<br>    <span class="hljs-type">socklen_t</span> <span class="hljs-variable">addr_size</span> <span class="hljs-operator">=</span> sizeof(addr);<br>    <span class="hljs-type">socklen_t</span> <span class="hljs-variable">cr_size</span> <span class="hljs-operator">=</span> sizeof(cr);<br>    <span class="hljs-type">char</span> * source_ctx = NULL;<br><br>    <span class="hljs-keyword">if</span> ((s = accept(property_set_fd, (struct sockaddr *) &amp;addr, &amp;addr_size)) &lt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br><br>    <span class="hljs-comment">/* Check socket options here */</span><br>    <span class="hljs-keyword">if</span> (getsockopt(s, SOL_SOCKET, SO_PEERCRED, &amp;cr, &amp;cr_size) &lt; <span class="hljs-number">0</span>) &#123;<br>        close(s);<br>        ERROR(<span class="hljs-string">&quot;Unable to receive socket options\n&quot;</span>);<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br><br>    r = TEMP_FAILURE_RETRY(recv(s, &amp;msg, sizeof(msg), <span class="hljs-number">0</span>));<br>    <span class="hljs-keyword">if</span>(r != sizeof(prop_msg)) &#123;<br>        ERROR(<span class="hljs-string">&quot;sys_prop: mis-match msg size received: %d expected: %d errno: %d\n&quot;</span>,<br>              r, sizeof(prop_msg), errno);<br>        close(s);<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">switch</span>(msg.cmd) &#123;<br>    <span class="hljs-keyword">case</span> PROP_MSG_SETPROP:<br>        msg.name[PROP_NAME_MAX-<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;<br>        msg.value[PROP_VALUE_MAX-<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;<br><br>        <span class="hljs-keyword">if</span> (!is_legal_property_name(msg.name, strlen(msg.name))) &#123;<br>            ERROR(<span class="hljs-string">&quot;sys_prop: illegal property name. Got: \&quot;%s\&quot;\n&quot;</span>, msg.name);<br>            close(s);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br><br>        getpeercon(s, &amp;source_ctx);<br><br>        <span class="hljs-keyword">if</span>(memcmp(msg.name,<span class="hljs-string">&quot;ctl.&quot;</span>,<span class="hljs-number">4</span>) == <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-comment">// Keep the old close-socket-early behavior when handling</span><br>            <span class="hljs-comment">// ctl.* properties.</span><br>            close(s);<br>            <span class="hljs-keyword">if</span> (check_control_perms(msg.value, cr.uid, cr.gid, source_ctx)) &#123;<br>                handle_control_message((<span class="hljs-type">char</span>*) msg.name + <span class="hljs-number">4</span>, (<span class="hljs-type">char</span>*) msg.value);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                ERROR(<span class="hljs-string">&quot;sys_prop: Unable to %s service ctl [%s] uid:%d gid:%d pid:%d\n&quot;</span>,<br>                        msg.name + <span class="hljs-number">4</span>, msg.value, cr.uid, cr.gid, cr.pid);<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">if</span> (check_perms(msg.name, cr.uid, cr.gid, source_ctx)) &#123;<br>                property_set((<span class="hljs-type">char</span>*) msg.name, (<span class="hljs-type">char</span>*) msg.value);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                ERROR(<span class="hljs-string">&quot;sys_prop: permission denied uid:%d  name:%s\n&quot;</span>,<br>                      cr.uid, msg.name);<br>            &#125;<br><br>            <span class="hljs-comment">// Note: bionic&#x27;s property client code assumes that the</span><br>            <span class="hljs-comment">// property server will not close the socket until *AFTER*</span><br>            <span class="hljs-comment">// the property is written to memory.</span><br>            close(s);<br>        &#125;<br>        freecon(source_ctx);<br>        <span class="hljs-keyword">break</span>;<br><br>    <span class="hljs-keyword">default</span>:<br>        close(s);<br>        <span class="hljs-keyword">break</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>ä»ä¸Šé¢ä»£ç å¯ä»¥çœ‹å‡ºï¼Œæœ‰ä¸€ä¸ªç™½åå•åˆ—è¡¨æ¥åˆ¤æ–­åº”ç”¨æ˜¯å¦æœ‰æƒé™æ¥è®¾ç½®å±æ€§ã€‚ä¸€èˆ¬æ˜¯uidä¸ºAID_SYSTEMçš„ç³»ç»Ÿçº§åº”ç”¨æ‰æœ‰æƒé™è®¾ç½®å±æ€§ï¼Œè€Œä¸”å±æ€§åå­—å‰ç¼€ä¹Ÿè¦åŒ¹é…ç™½åå•ï¼Œæ¯”å¦‚persist.sys.å¼€å¤´ã€‚</p><h1 id="å®‰å“5å¼€å§‹"><a href="#å®‰å“5å¼€å§‹" class="headerlink" title="å®‰å“5å¼€å§‹"></a>å®‰å“5å¼€å§‹</h1><p><a href="https://www.androidos.net.cn/android/5.0.1_r1/xref/system/core/init/property_service.c">å®‰å“5.0.1 system&#x2F;core&#x2F;init&#x2F;property_service.cæºä»£ç </a>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><code class="hljs java">.......<br><span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">check_mac_perms</span><span class="hljs-params">(const <span class="hljs-type">char</span> *name, <span class="hljs-type">char</span> *sctx)</span><br>&#123;<br>    <span class="hljs-keyword">if</span> (is_selinux_enabled() &lt;= <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br><br>    <span class="hljs-type">char</span> *tctx = NULL;<br>    const <span class="hljs-type">char</span> *class = <span class="hljs-string">&quot;property_service&quot;</span>;<br>    const <span class="hljs-type">char</span> *perm = <span class="hljs-string">&quot;set&quot;</span>;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><br>    <span class="hljs-keyword">if</span> (!sctx)<br>        <span class="hljs-keyword">goto</span> err;<br><br>    <span class="hljs-keyword">if</span> (!sehandle_prop)<br>        <span class="hljs-keyword">goto</span> err;<br><br>    <span class="hljs-keyword">if</span> (selabel_lookup(sehandle_prop, &amp;tctx, name, <span class="hljs-number">1</span>) != <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">goto</span> err;<br><br>    <span class="hljs-keyword">if</span> (selinux_check_access(sctx, tctx, class, perm, (<span class="hljs-keyword">void</span>*) name) == <span class="hljs-number">0</span>)<br>        result = <span class="hljs-number">1</span>;<br><br>    freecon(tctx);<br> err:<br>    <span class="hljs-keyword">return</span> result;<br>&#125;<br><br><span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">check_control_mac_perms</span><span class="hljs-params">(const <span class="hljs-type">char</span> *name, <span class="hljs-type">char</span> *sctx)</span><br>&#123;<br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">     *  Create a name prefix out of ctl.&lt;service name&gt;</span><br><span class="hljs-comment">     *  The new prefix allows the use of the existing</span><br><span class="hljs-comment">     *  property service backend labeling while avoiding</span><br><span class="hljs-comment">     *  mislabels based on true property prefixes.</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-type">char</span> ctl_name[PROP_VALUE_MAX+<span class="hljs-number">4</span>];<br>    <span class="hljs-type">int</span> <span class="hljs-variable">ret</span> <span class="hljs-operator">=</span> snprintf(ctl_name, sizeof(ctl_name), <span class="hljs-string">&quot;ctl.%s&quot;</span>, name);<br><br>    <span class="hljs-keyword">if</span> (ret &lt; <span class="hljs-number">0</span> || (size_t) ret &gt;= sizeof(ctl_name))<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br><br>    <span class="hljs-keyword">return</span> check_mac_perms(ctl_name, sctx);<br>&#125;<br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment"> * Checks permissions for setting system properties.</span><br><span class="hljs-comment"> * Returns 1 if uid allowed, 0 otherwise.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">check_perms</span><span class="hljs-params">(const <span class="hljs-type">char</span> *name, <span class="hljs-type">char</span> *sctx)</span><br>&#123;<br>    <span class="hljs-type">int</span> i;<br>    unsigned <span class="hljs-type">int</span> app_id;<br><br>    <span class="hljs-keyword">if</span>(!strncmp(name, <span class="hljs-string">&quot;ro.&quot;</span>, <span class="hljs-number">3</span>))<br>        name +=<span class="hljs-number">3</span>;<br><br>    <span class="hljs-keyword">return</span> check_mac_perms(name, sctx);<br>&#125;<br>.......<br><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">handle_property_set_fd</span><span class="hljs-params">()</span><br>&#123;<br>    prop_msg msg;<br>    <span class="hljs-type">int</span> s;<br>    <span class="hljs-type">int</span> r;<br>    <span class="hljs-type">int</span> res;<br>    struct ucred cr;<br>    struct sockaddr_un addr;<br>    <span class="hljs-type">socklen_t</span> <span class="hljs-variable">addr_size</span> <span class="hljs-operator">=</span> sizeof(addr);<br>    <span class="hljs-type">socklen_t</span> <span class="hljs-variable">cr_size</span> <span class="hljs-operator">=</span> sizeof(cr);<br>    <span class="hljs-type">char</span> * source_ctx = NULL;<br>    struct pollfd ufds[<span class="hljs-number">1</span>];<br>    const <span class="hljs-type">int</span> <span class="hljs-variable">timeout_ms</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span> * <span class="hljs-number">1000</span>;  <span class="hljs-comment">/* Default 2 sec timeout for caller to send property. */</span><br>    <span class="hljs-type">int</span> nr;<br><br>    <span class="hljs-keyword">if</span> ((s = accept(property_set_fd, (struct sockaddr *) &amp;addr, &amp;addr_size)) &lt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br><br>    <span class="hljs-comment">/* Check socket options here */</span><br>    <span class="hljs-keyword">if</span> (getsockopt(s, SOL_SOCKET, SO_PEERCRED, &amp;cr, &amp;cr_size) &lt; <span class="hljs-number">0</span>) &#123;<br>        close(s);<br>        ERROR(<span class="hljs-string">&quot;Unable to receive socket options\n&quot;</span>);<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br><br>    ufds[<span class="hljs-number">0</span>].fd = s;<br>    ufds[<span class="hljs-number">0</span>].events = POLLIN;<br>    ufds[<span class="hljs-number">0</span>].revents = <span class="hljs-number">0</span>;<br>    nr = TEMP_FAILURE_RETRY(poll(ufds, <span class="hljs-number">1</span>, timeout_ms));<br>    <span class="hljs-keyword">if</span> (nr == <span class="hljs-number">0</span>) &#123;<br>        ERROR(<span class="hljs-string">&quot;sys_prop: timeout waiting for uid=%d to send property message.\n&quot;</span>, cr.uid);<br>        close(s);<br>        <span class="hljs-keyword">return</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (nr &lt; <span class="hljs-number">0</span>) &#123;<br>        ERROR(<span class="hljs-string">&quot;sys_prop: error waiting for uid=%d to send property message. err=%d %s\n&quot;</span>, cr.uid, errno, strerror(errno));<br>        close(s);<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br><br>    r = TEMP_FAILURE_RETRY(recv(s, &amp;msg, sizeof(msg), MSG_DONTWAIT));<br>    <span class="hljs-keyword">if</span>(r != sizeof(prop_msg)) &#123;<br>        ERROR(<span class="hljs-string">&quot;sys_prop: mis-match msg size received: %d expected: %zu errno: %d\n&quot;</span>,<br>              r, sizeof(prop_msg), errno);<br>        close(s);<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">switch</span>(msg.cmd) &#123;<br>    <span class="hljs-keyword">case</span> PROP_MSG_SETPROP:<br>        msg.name[PROP_NAME_MAX-<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;<br>        msg.value[PROP_VALUE_MAX-<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;<br><br>        <span class="hljs-keyword">if</span> (!is_legal_property_name(msg.name, strlen(msg.name))) &#123;<br>            ERROR(<span class="hljs-string">&quot;sys_prop: illegal property name. Got: \&quot;%s\&quot;\n&quot;</span>, msg.name);<br>            close(s);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br><br>        getpeercon(s, &amp;source_ctx);<br><br>        <span class="hljs-keyword">if</span>(memcmp(msg.name,<span class="hljs-string">&quot;ctl.&quot;</span>,<span class="hljs-number">4</span>) == <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-comment">// Keep the old close-socket-early behavior when handling</span><br>            <span class="hljs-comment">// ctl.* properties.</span><br>            close(s);<br>            <span class="hljs-keyword">if</span> (check_control_mac_perms(msg.value, source_ctx)) &#123;<br>                handle_control_message((<span class="hljs-type">char</span>*) msg.name + <span class="hljs-number">4</span>, (<span class="hljs-type">char</span>*) msg.value);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                ERROR(<span class="hljs-string">&quot;sys_prop: Unable to %s service ctl [%s] uid:%d gid:%d pid:%d\n&quot;</span>,<br>                        msg.name + <span class="hljs-number">4</span>, msg.value, cr.uid, cr.gid, cr.pid);<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">if</span> (check_perms(msg.name, source_ctx)) &#123;<br>                property_set((<span class="hljs-type">char</span>*) msg.name, (<span class="hljs-type">char</span>*) msg.value);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                ERROR(<span class="hljs-string">&quot;sys_prop: permission denied uid:%d  name:%s\n&quot;</span>,<br>                      cr.uid, msg.name);<br>            &#125;<br><br>            <span class="hljs-comment">// Note: bionic&#x27;s property client code assumes that the</span><br>            <span class="hljs-comment">// property server will not close the socket until *AFTER*</span><br>            <span class="hljs-comment">// the property is written to memory.</span><br>            close(s);<br>        &#125;<br>        freecon(source_ctx);<br>        <span class="hljs-keyword">break</span>;<br><br>    <span class="hljs-keyword">default</span>:<br>        close(s);<br>        <span class="hljs-keyword">break</span>;<br>    &#125;<br>&#125;<br>.......<br>   <br></code></pre></td></tr></table></figure><p>å»æ‰ç™½åå•æœºåˆ¶ï¼Œå¼•å…¥selinuxï¼Œé€šè¿‡selinuxæ¥æ§åˆ¶æƒé™è®¿é—®ã€‚å¦‚æœselinuxå…³é—­ï¼Œåˆ™ä»»ä½•åº”ç”¨éƒ½å¯ä»¥è®¾ç½®ï¼Œä¸å†é™å®šç³»ç»Ÿåº”ç”¨ã€‚ï¼ˆä½†selinuxå¯ä»¥è®¾ç½®åªæ”¾è¡Œç³»ç»Ÿçº§åº”ç”¨ï¼‰ã€‚</p><p>ä¾‹å­å‚è€ƒï¼š<a href="https://blog.csdn.net/qq_25815655/article/details/85339415?utm_medium=distribute.pc_relevant.none-task-blog-baidujs_title-0&spm=1001.2101.3001.4242">system.propæ·»åŠ è‡ªå·±çš„å­—æ®µ</a></p>]]></content>
    
    
    <categories>
      
      <category>Androidæºç åˆ†æ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>å±æ€§æœåŠ¡</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hexoä¼˜åŒ–è®¿é—®é€Ÿåº¦</title>
    <link href="/article/2da0019a/"/>
    <url>/article/2da0019a/</url>
    
    <content type="html"><![CDATA[<h1 id="Hexoä¼˜åŒ–è®¿é—®é€Ÿåº¦"><a href="#Hexoä¼˜åŒ–è®¿é—®é€Ÿåº¦" class="headerlink" title="Hexoä¼˜åŒ–è®¿é—®é€Ÿåº¦"></a>Hexoä¼˜åŒ–è®¿é—®é€Ÿåº¦</h1><p>æ›´å¤šè¯¦ç»†å†…å®¹è¯·å‚è€ƒï¼š<a href="https://akilar.top/posts/7c16c4bb/">Hexo åšå®¢è®¿é—®ä¼˜åŒ–æ—¥è®°</a></p><p><img src="https://cdn.jsdelivr.net/gh/wesley666/picgo/img/20210314162303.png" alt="img"></p><p>æœ¬ç«™ç›®å‰ä½¿ç”¨å·¥å…·ï¼š</p><p> ç”¨<a href="https://vercel.com/">Vercel</a>æ¥é™æ€æ‰˜ç®¡ï¼Œgithubæ¯æ¬¡æœ‰ä»£ç æ›´æ–°ï¼Œå®ƒéƒ½ä¼šè‡ªåŠ¨æ‹‰å–å¹¶éƒ¨ç½²ã€‚<a href="https://akilar.top/posts/812734f8/">ä½¿ç”¨Vercelæ¥åŠ é€ŸHexo</a></p><blockquote><p>æ³¨ï¼šå¦‚æœgithubæ›´æ–°åVercelæ²¡æœ‰è‡ªåŠ¨éƒ¨ç½²ï¼Œéœ€è¦åˆ°Vercelçš„Gitè®¾ç½®é‚£é‡Œæ”¹æˆmainåˆ†æ”¯ã€‚ï¼ˆ2020å¹´10æœˆågithubæ–°å»ºä»“åº“é»˜è®¤åˆ†æ”¯æ”¹ä¸ºmainï¼Œæ³¨æ„æ›´æ”¹ã€‚ï¼‰</p></blockquote><p>ç”¨<a href="https://www.jsdelivr.com/?docs=gh">jsdelivr</a>æ¥ä¸ºé¡µé¢é™æ€èµ„æºæä¾›åŠ é€Ÿã€‚<a href="https://www.itrhx.com/2019/08/01/A27-image-hosting/">Github+jsDelivr+PicGo æ‰“é€ ç¨³å®šå¿«é€Ÿã€é«˜æ•ˆå…è´¹å›¾åºŠ</a>ã€‚</p><h1 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h1><p><a href="https://akilar.top/posts/7c16c4bb/">Hexo åšå®¢è®¿é—®ä¼˜åŒ–æ—¥è®°</a></p><p><a href="https://www.julydate.com/post/60859300/">hexoåšå®¢è®¿é—®ä¼˜åŒ–-CDNé€‰ç”¨</a></p><p><a href="https://sspai.com/post/63028">Vercel ï¼Œå¼€ç®±å³ç”¨çš„ç½‘ç«™ç®¡ç†å°å·¥å…·</a></p><p><a href="https://erenship.com/posts/db37.html">Hexo åšå®¢ç«™ç‚¹åŠ é€Ÿä¸å®Œå…¨æŒ‡å—</a></p><p><a href="https://forever97.top/2020/12/11/vercel/">ä½¿ç”¨VercelåŠ é€Ÿåšå®¢è®¿é—®</a></p><p><a href="https://www.antmoe.com/posts/e33d1c55/index.html">å°åº·å¤§ä½¬çš„æ•™ç¨‹-ä¼˜é›…ä½¿ç”¨JsDeliveråŠ é€Ÿæ–‡ä»¶</a></p><p><a href="https://www.itrhx.com/2019/02/10/A18-free-cdn/">å…è´¹CDNï¼šjsDelivr + Github</a></p>]]></content>
    
    
    <categories>
      
      <category>Hexoç›¸å…³</category>
      
    </categories>
    
    
    <tags>
      
      <tag>hexo</tag>
      
      <tag>hexoé€Ÿåº¦ä¼˜åŒ–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®‰å“ç³»ç»Ÿåº”ç”¨æ¯”dataåˆ†åŒºåº”ç”¨ç‰ˆæœ¬å·æ–°æ€ä¹ˆåŠ</title>
    <link href="/article/feebec60/"/>
    <url>/article/feebec60/</url>
    
    <content type="html"><![CDATA[<p>å®‰å“9ä»£ç ï¼š</p><p><a href="https://android.googlesource.com/platform/frameworks/base/+/master/services/core/java/com/android/server/pm/PackageManagerService.java">PackageManagerService</a></p><blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Adds a new package to the internal data structures during platform initialization.</span><br><span class="hljs-comment">     * &lt;p&gt;After adding, the package is known to the system and available for querying.</span><br><span class="hljs-comment">     * &lt;p&gt;For packages located on the device ROM [eg. packages located in /system, /vendor,</span><br><span class="hljs-comment">     * etc...], additional checks are performed. Basic verification [such as ensuring</span><br><span class="hljs-comment">     * matching signatures, checking version codes, etc...] occurs if the package is</span><br><span class="hljs-comment">     * identical to a previously known package. If the package fails a signature check,</span><br><span class="hljs-comment">     * the version installed on /data will be removed. If the version of the new package</span><br><span class="hljs-comment">     * is less than or equal than the version on /data, it will be ignored.</span><br><span class="hljs-comment">     * &lt;p&gt;Regardless of the package location, the results are applied to the internal</span><br><span class="hljs-comment">     * structures and the package is made available to the rest of the system.</span><br><span class="hljs-comment">     * &lt;p&gt;<span class="hljs-doctag">NOTE:</span> The return value should be removed. It&#x27;s the passed in package object.</span><br><span class="hljs-comment">     */</span><br></code></pre></td></tr></table></figure></blockquote><p><strong>If the package fails a signature check,the version installed on &#x2F;data will be removed. If the version of the new package is less than or equal than the version on &#x2F;data, it will be ignored.</strong></p><p>æ„å‘³ç€ç³»ç»Ÿåˆ†åŒºåº”ç”¨ç‰ˆæœ¬å·å°äºæˆ–è€…ç­‰äºdataåˆ†åŒºçš„åº”ç”¨ï¼Œåˆ™dataåº”ç”¨ä¼šè¢«ä¿ç•™ã€‚ï¼ˆè¿™é‡Œæ˜¯æŒ‡é‚£äº›ç³»ç»Ÿåº”ç”¨é€šè¿‡æ›´æ–°æ–¹å¼å®‰è£…åˆ°dataåˆ†åŒºçš„ï¼‰</p>]]></content>
    
    
    <categories>
      
      <category>AndroidFrameworkFeature</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>PackageManagerService</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linuxç½‘ç»œå‡½æ•°send()å‡ºé”™å¯¼è‡´è¿›ç¨‹é€€å‡º</title>
    <link href="/article/f453e195/"/>
    <url>/article/f453e195/</url>
    
    <content type="html"><![CDATA[<p>åœ¨Linuxç³»ç»Ÿç¼–å†™socketç½‘ç»œé€šä¿¡ç¨‹åºçš„æ—¶å€™ï¼Œå¦‚æœç¨‹åºæ‰§è¡Œsendå‡½æ•°ï¼Œé‡åˆ°äº†ä¸€ä¸ªå…³é—­çš„socketï¼Œç³»ç»Ÿå°±ä¼šæŠ›å‡ºä¸€ä¸ªSIGPIPEä¿¡å·ã€‚è¿™ä¸ªä¿¡å·çš„ç¼ºçœå¤„ç†æ–¹æ³•æ˜¯é€€å‡ºå½“å‰è¿›ç¨‹ï¼Œé‡æ–°å®šä¹‰è¿™ä¸ªä¿¡å·çš„å¤„ç†æ–¹å¼å¯ä»¥é¿å…è¿™ä¸ªæƒ…å†µã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªç©ºå‡½æ•°</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">signal_send</span><span class="hljs-params">()</span>&#123;  &#125; <br><br><span class="hljs-comment">//æ³¨å†Œä¿¡å·å¤„ç†æ–¹å¼</span><br>signal(SIGPIPE, signal_send);<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>socket</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>adb logcatæ— æ³•æ¸…é™¤æ—¥å¿—</title>
    <link href="/article/63c66dd5/"/>
    <url>/article/63c66dd5/</url>
    
    <content type="html"><![CDATA[<p>æ‚¨å¯èƒ½å·²ç»æ‰“å¼€Android Studioï¼Œè¯·å…³é—­å®ƒå¹¶å†æ¬¡è¿è¡Œæ¸…é™¤æ—¥å¿—å‘½ä»¤ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Androidè°ƒè¯•ç›¸å…³</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/article/4a17b156/"/>
    <url>/article/4a17b156/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
